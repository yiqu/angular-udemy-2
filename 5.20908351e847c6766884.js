(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return _v});var r=n("ofXK"),i=n("3Pt+"),o=n("9jGm"),s=n("l7P3"),u=n("UmVK"),a=n("37S3"),c=n("fXoL");let h=(()=>{class t{}return t.\u0275mod=c.Mb({type:t}),t.\u0275inj=c.Lb({factory:function(e){return new(e||t)},providers:[],imports:[[u.a,r.c,i.j,a.a]]}),t})();var f=n("tyNb"),l=n("pLZG");const p=Object(s.n)("[Admin/UI] Admin page navigation",Object(s.s)()),d=Object(s.n)("[Admin/UI] Add a new exer select click",Object(s.s)()),v=Object(s.n)("[Admin/UI] Save exer button click",Object(s.s)()),y=Object(s.n)("[Admin/UI] Set form valid status",Object(s.s)()),b=Object(s.n)("[Admin/UI] Reset all options in new exer"),g=Object(s.n)("[Admin/API] Save all exer start",Object(s.s)()),m=Object(s.n)("[Admin/API] Save all exer success"),w=Object(s.n)("[Admin/API] Save all exer failed",Object(s.s)()),I=Object(s.n)("[Admin/API] Get all exer start"),O=Object(s.n)("[Admin/API] Get all exer success",Object(s.s)()),T=Object(s.n)("[Admin/API] Get all exer failed",Object(s.s)()),E=Object(s.o)("admin"),_=Object(s.q)(E,t=>t.currentActionPage),j=Object(s.q)(_,t=>{const e=[];return"new"===t?(e.push({btnName:"Add another",btnMenu:!0,btnMenuItems:["Time Based","Rep Based"]}),e.push({btnName:"Save"})):"edit"===t&&e.push({btnName:"Delete all"}),e}),S=Object(s.q)(E,t=>t.newExerType),x=Object(s.q)(E,t=>t.saveNewExerBtnClickTimeStamp),N=Object(s.q)(E,_,(t,e)=>"new"!==e||null==t.formValidState||t.formValidState),A=Object(s.q)(E,t=>t.loading),D=Object(s.q)(E,t=>t.allExers);let C=(()=>{class t{constructor(t){this.store=t,this.currentSelectedPage$=this.store.select(_),this.adminPanelButtons$=this.store.select(j),this.newlyAddedExerType$=this.store.select(S),this.onNewExerSaveClick$=this.store.select(x),this.exerFormStatus$=this.store.select(N).pipe(Object(l.a)(t=>null!=t)),this.isLoading$=this.store.select(A),this.allExers$=this.store.select(D)}setCurrentPageState(t){this.store.dispatch(p({page:t}))}addNewExer(t){this.store.dispatch(d({exerUnitType:t}))}onNewExerSaveClick(){const t=(new Date).getTime();this.store.dispatch(v({timeStamp:t}))}onSetFormValidStatus(t){this.store.dispatch(y({status:t}))}resetNewExer(){this.store.dispatch(b())}onSaveExers(t){this.store.dispatch(g({exers:t}))}getAllExers(){this.store.dispatch(I())}}return t.\u0275fac=function(e){return new(e||t)(c.Yb(s.h))},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var k=n("XiUz"),P=n("STbY"),L=n("bTqV"),U=n("znSr"),R=n("NFeN"),M=n("mrSG"),V=n("oC0T"),F=n.n(V);let q=(()=>{class t{transform(t){let e="done";switch(null==t?void 0:t.trim().toLowerCase()){case"add another":e="add";break;case"save":e="save";break;case"delete all":e="delete"}return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=c.Nb({name:"iconDisplay",type:t,pure:!0}),t})();function B(t,e){1&t&&(c.Sb(0),c.Ub(1,"span",7),c.Dc(2,"Please fix the errors before saving*"),c.Tb(),c.Rb())}function z(t,e){if(1&t){const t=c.Vb();c.Ub(0,"button",11),c.cc("click",function(){c.tc(t);const e=c.gc().$implicit;return c.gc(2).onPanelBtnClick(e)}),c.Ub(1,"span",12),c.Dc(2),c.Tb(),c.Ub(3,"mat-icon",13),c.Dc(4),c.hc(5,"iconDisplay"),c.Tb(),c.Tb()}if(2&t){const t=c.gc().$implicit;c.Cb(2),c.Ec(t.btnName),c.Cb(2),c.Ec(c.ic(5,2,t.btnName))}}const G=function(t){return{menuItems:t}};function H(t,e){if(1&t){const t=c.Vb();c.Ub(0,"button",14),c.cc("click",function(){c.tc(t);const e=c.gc().$implicit;return c.gc(2).onPanelBtnClick(e)}),c.Ub(1,"div",15),c.Ub(2,"div"),c.Dc(3),c.Tb(),c.Ub(4,"div",16),c.Ub(5,"mat-icon"),c.Dc(6,"keyboard_arrow_down"),c.Tb(),c.Tb(),c.Tb(),c.Ub(7,"mat-icon",13),c.Dc(8),c.hc(9,"iconDisplay"),c.Tb(),c.Tb()}if(2&t){const t=c.gc().$implicit;c.gc(2);const e=c.rc(13);c.mc("matMenuTriggerData",c.oc(6,G,t.btnMenuItems))("matMenuTriggerFor",e),c.Cb(3),c.Ec(t.btnName),c.Cb(5),c.Ec(c.ic(9,4,t.btnName))}}function K(t,e){if(1&t&&(c.Sb(0),c.Bc(1,z,6,4,"button",9),c.Bc(2,H,10,8,"button",10),c.Rb()),2&t){const t=e.$implicit;c.Cb(1),c.mc("ngIf",!t.btnMenu),c.Cb(1),c.mc("ngIf",t.btnMenu)}}function J(t,e){if(1&t&&(c.Sb(0),c.Bc(1,K,3,2,"ng-container",8),c.Rb()),2&t){const t=e.ngIf;c.Cb(1),c.mc("ngForOf",t)}}function $(t,e){if(1&t){const t=c.Vb();c.Ub(0,"button",18),c.cc("click",function(){c.tc(t);const n=e.$implicit;return c.gc(2).onPanelMenuClick(n)}),c.Dc(1),c.Tb()}if(2&t){const t=e.$implicit;c.Cb(1),c.Ec(t)}}function Y(t,e){1&t&&c.Bc(0,$,2,1,"button",17),2&t&&c.mc("ngForOf",e.menuItems)}const X=function(){return["/","admin"]};let W=(()=>{class t{constructor(t){this.as=t}ngOnInit(){}onPanelBtnClick(t){"Save"===t.btnName&&this.as.onNewExerSaveClick()}onPanelMenuClick(t){this.as.addNewExer(t)}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(C))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-admin"]],decls:15,vars:8,consts:[["fxLayout","column","fxLayoutGap","10px",1,"container","pb-3"],[1,"sticky-topp"],["fxLayout","row","fxLayoutAlign","space-between center",1,"title","mat-elevation-z0"],[3,"routerLink"],[4,"ngIf"],["menu","matMenu"],["matMenuContent",""],[1,"status-msg","ml-3"],[4,"ngFor","ngForOf"],["mat-button","","ngClass.lt-md","mat-icon-button","class","mr-3","ngClass.gt-sm","mat-flat-button","color","primary","type","button",3,"click",4,"ngIf"],["mat-button","","ngClass.lt-md","mat-icon-button","class","mr-3","ngClass.gt-sm","mat-flat-button","color","primary","type","button",3,"matMenuTriggerData","matMenuTriggerFor","click",4,"ngIf"],["mat-button","","ngClass.lt-md","mat-icon-button","ngClass.gt-sm","mat-flat-button","color","primary","type","button",1,"mr-3",3,"click"],["fxHide","","fxShow.gt-sm",""],["fxHide","","fxShow.lt-sm",""],["mat-button","","ngClass.lt-md","mat-icon-button","ngClass.gt-sm","mat-flat-button","color","primary","type","button",1,"mr-3",3,"matMenuTriggerData","matMenuTriggerFor","click"],["fxHide","","fxShow.gt-sm","","fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","5px"],["fxLayout","row","fxLayoutAlign","center center"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"]],template:function(t,e){1&t&&(c.Ub(0,"div",0),c.Ub(1,"div",1),c.Ub(2,"div",2),c.Ub(3,"div"),c.Ub(4,"a",3),c.Dc(5," Admin Panel "),c.Tb(),c.Bc(6,B,3,0,"ng-container",4),c.hc(7,"async"),c.Tb(),c.Ub(8,"div"),c.Bc(9,J,2,1,"ng-container",4),c.hc(10,"async"),c.Tb(),c.Tb(),c.Tb(),c.Pb(11,"router-outlet"),c.Tb(),c.Ub(12,"mat-menu",null,5),c.Bc(14,Y,1,1,"ng-template",6),c.Tb()),2&t&&(c.Cb(4),c.mc("routerLink",c.nc(7,X)),c.Cb(2),c.mc("ngIf",!c.ic(7,3,e.as.exerFormStatus$)),c.Cb(3),c.mc("ngIf",c.ic(10,5,e.as.adminPanelButtons$)))},directives:[k.c,k.d,k.b,f.e,r.k,f.g,P.a,P.b,r.j,L.a,U.a,U.b,R.a,P.e,P.c],pipes:[r.b,q],styles:[".title[_ngcontent-%COMP%]{font-size:19px;font-weight:700}.sticky-topp[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-left:0;height:4rem;border-bottom:1px solid #ccc}.sticky-topp[_ngcontent-%COMP%]   .status-msg[_ngcontent-%COMP%]{font-size:14px;color:#c45757}.loading-bar[_ngcontent-%COMP%]{margin:0;height:7px}"]}),t})();var Q=n("Xa2L"),Z=n("M9IT"),tt=n("Dh3D"),et=n("+0xr"),nt=n("IzEk"),rt=n("0IaG");let it=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}ngOnInit(){}onNoClick(){this.dialogRef.close(!1)}onYesClick(){this.dialogRef.close(!0)}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(rt.f),c.Ob(rt.a))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-shared-dialog"]],decls:10,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",3,"click"],["mat-button","",3,"click"]],template:function(t,e){1&t&&(c.Ub(0,"h1",0),c.Dc(1,"Confirmation"),c.Tb(),c.Ub(2,"div",1),c.Ub(3,"p"),c.Dc(4),c.Tb(),c.Tb(),c.Ub(5,"div",2),c.Ub(6,"button",3),c.cc("click",function(){return e.onNoClick()}),c.Dc(7,"No"),c.Tb(),c.Ub(8,"button",4),c.cc("click",function(){return e.onYesClick()}),c.Dc(9,"Yes"),c.Tb(),c.Tb()),2&t&&(c.Cb(4),c.Fc("Are you sure you want to ",null==e.data?null:e.data.actionName,""))},directives:[rt.g,rt.d,rt.c,L.a],styles:[""]}),t})(),ot=(()=>{class t{constructor(t){this.dialog=t}openConfirmDialog(t){return this.dialog.open(it,{minWidth:"300px",data:{actionName:t+" this exercise?"}}).afterClosed().pipe(Object(nt.a)(1))}}return t.\u0275fac=function(e){return new(e||t)(c.Yb(rt.b))},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var st=n("kmnG"),ut=n("qFsG"),at=n("B6IJ");let ct=(()=>{class t{transform(t){let e=t;switch(t){case"name":e="Exercise Name";break;case"id":e="Exercise ID";break;case"sets":e="Sets";break;case"countPerSet":e="Rep / Time (Per Set)";break;case"setUnitTypeIsTime":e="Time Based";break;case"options":e="Actions"}return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=c.Nb({name:"tableColumnDisplay",type:t,pure:!0}),Object(M.a)([F()()],t.prototype,"transform",null),t})(),ht=(()=>{class t{constructor(t){this.dp=t}transform(t,e,n){let r=t;switch(e){case"countPerSet":r=n?r+" seconds":r+" reps";break;case"setUnitTypeIsTime":r=r?"Yes":"No"}return r}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(at.a))},t.\u0275pipe=c.Nb({name:"tableDataDisplay",type:t,pure:!0}),t})();var ft=n("Q7j5");function lt(t,e){if(1&t&&(c.Ub(0,"th",14),c.Dc(1),c.hc(2,"tableColumnDisplay"),c.Tb()),2&t){const t=c.gc().$implicit;c.Cb(1),c.Fc(" ",c.ic(2,1,t)," ")}}function pt(t,e){if(1&t&&(c.Sb(0),c.Dc(1),c.hc(2,"tableDataDisplay"),c.Rb()),2&t){const t=c.gc().$implicit,e=c.gc().$implicit;c.Cb(1),c.Fc(" ",c.jc(2,1,t[e],e,t.setUnitTypeIsTime)," ")}}function dt(t,e){if(1&t){const t=c.Vb();c.Ub(0,"button",18),c.cc("click",function(){c.tc(t);const n=e.$implicit,r=c.gc(2).$implicit;return c.gc(3).onActionBtnClick(n,r)}),c.Dc(1),c.hc(2,"capitalizeFirstLetter"),c.Tb()}if(2&t){const t=e.$implicit;c.mc("color","delete"===t?"warn":"primary"),c.Cb(1),c.Fc(" ",c.ic(2,2,t)," ")}}function vt(t,e){if(1&t&&(c.Sb(0),c.Bc(1,dt,3,4,"button",17),c.Rb()),2&t){const t=c.gc(4);c.Cb(1),c.mc("ngForOf",t.optionButtons)}}function yt(t,e){if(1&t&&(c.Ub(0,"td",15),c.Bc(1,pt,3,5,"ng-container",16),c.Bc(2,vt,2,1,"ng-container",16),c.Tb()),2&t){const t=c.gc().$implicit;c.Cb(1),c.mc("ngIf","options"!==t),c.Cb(1),c.mc("ngIf","options"===t)}}function bt(t,e){if(1&t&&(c.Sb(0),c.Sb(1,11),c.Bc(2,lt,3,3,"th",12),c.Bc(3,yt,3,2,"td",13),c.Rb(),c.Rb()),2&t){const t=e.$implicit;c.Cb(1),c.mc("matColumnDef",t)}}function gt(t,e){1&t&&c.Pb(0,"tr",19)}const mt=function(t){return{"table-row-bg":t}};function wt(t,e){1&t&&c.Pb(0,"tr",20),2&t&&c.mc("ngClass",c.oc(1,mt,e.even))}function It(t,e){if(1&t&&(c.Ub(0,"tr",21),c.Ub(1,"td",22),c.Dc(2),c.Tb(),c.Tb()),2&t){c.gc();const t=c.rc(5);c.Cb(2),c.Fc('No data matching the filter "',t.value,'"')}}const Ot=function(t){return{border:t}},Tt=function(){return[1,30,60,100]};function Et(t,e){if(1&t){const t=c.Vb();c.Ub(0,"div",1),c.Ub(1,"mat-form-field"),c.Ub(2,"mat-label"),c.Dc(3,"Filter exercises ..."),c.Tb(),c.Ub(4,"input",2,3),c.cc("keyup",function(e){return c.tc(t),c.gc().applyFilter(e)}),c.Tb(),c.Tb(),c.Ub(6,"div",4),c.Ub(7,"table",5),c.Bc(8,bt,4,1,"ng-container",6),c.Bc(9,gt,1,0,"tr",7),c.Bc(10,wt,1,3,"tr",8),c.Bc(11,It,3,1,"tr",9),c.Tb(),c.Pb(12,"mat-paginator",10),c.Tb(),c.Tb()}if(2&t){const t=c.gc();c.mc("ngClass",c.oc(6,Ot,t.displayBorder)),c.Cb(7),c.mc("dataSource",t.dataSource),c.Cb(1),c.mc("ngForOf",t.cols),c.Cb(1),c.mc("matHeaderRowDef",t.cols),c.Cb(1),c.mc("matRowDefColumns",t.cols),c.Cb(2),c.mc("pageSizeOptions",c.nc(8,Tt))}}let _t=(()=>{class t{constructor(t){this.cs=t,this.columns=[],this.columnsData=[],this.optionButtons=[],this.paginator=null,this.sort=null,this.cols=[],this.dataSource=new et.l(this.columnsData)}ngOnInit(){}ngOnChanges(){this.cols=[...this.columns],this.hasOptions&&(this.cols=this.addOptionsColumn(this.cols)),this.dataSource=new et.l(this.columnsData),console.log(this.cols,this.columnsData)}ngAfterViewInit(){this.dataSource&&(this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}addOptionsColumn(t){return[...t,"options"]}onActionBtnClick(t,e){"edit"===t?console.log("edit",e):"delete"===t&&this.cs.openConfirmDialog("delete").subscribe(t=>{t&&console.log("delete",e)})}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(ot))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-shared-table"]],viewQuery:function(t,e){if(1&t&&(c.Gc(Z.a,!0),c.Gc(tt.a,!0)),2&t){let t;c.qc(t=c.dc())&&(e.paginator=t.first),c.qc(t=c.dc())&&(e.sort=t.first)}},inputs:{columns:"columns",columnsData:"columnsData",displayBorder:"displayBorder",hasOptions:"hasOptions",optionButtons:"optionButtons"},features:[c.Ab],decls:1,vars:1,consts:[["class","table-parent",3,"ngClass",4,"ngIf"],[1,"table-parent",3,"ngClass"],["matInput","","placeholder","Start typing...",3,"keyup"],["input",""],[1,"mat-elevation-z0"],["mat-table","","matSort","",3,"dataSource"],[4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["pageSize","30","showFirstLastButtons","",1,"mt-3",3,"pageSizeOptions"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[4,"ngIf"],["mat-stroked-button","","class","mr-2",3,"color","click",4,"ngFor","ngForOf"],["mat-stroked-button","",1,"mr-2",3,"color","click"],["mat-header-row",""],["mat-row","",3,"ngClass"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,e){1&t&&c.Bc(0,Et,13,9,"div",0),2&t&&c.mc("ngIf",e.cols&&e.cols.length>0&&e.columnsData&&e.columnsData.length>0)},directives:[r.k,U.a,r.i,st.c,st.g,ut.b,et.k,tt.a,r.j,et.g,et.j,et.h,Z.a,et.c,et.e,et.b,et.d,tt.b,et.a,L.a,et.f,et.i],pipes:[ct,ht,ft.a],styles:["table[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{width:25rem}.table-parent[_ngcontent-%COMP%]{overflow:auto}.table-row-bg[_ngcontent-%COMP%]{background-color:hsla(0,0%,80%,.16862745098039217)}.border[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:15px;padding:10px}"]}),t})();function jt(t,e){1&t&&(c.Sb(0),c.Ub(1,"div",3),c.Pb(2,"mat-spinner",4),c.Tb(),c.Rb())}function St(t,e){if(1&t&&(c.Ub(0,"div",5),c.Ub(1,"div",6),c.Pb(2,"app-shared-table",7),c.hc(3,"async"),c.Tb(),c.Tb()),2&t){const t=c.gc();c.Cb(2),c.mc("columns",t.columns)("columnsData",c.ic(3,4,t.as.allExers$))("hasOptions",!0)("optionButtons",t.optionBtns)}}let xt=(()=>{class t{constructor(t){this.as=t,this.columns=["id","sets","countPerSet","setUnitTypeIsTime"],this.optionBtns=["edit","delete"],this.as.setCurrentPageState("edit")}ngOnInit(){this.as.getAllExers()}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(C))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-admin-edit"]],decls:5,vars:4,consts:[[1,""],[4,"ngIf","ngIfElse"],["tableData",""],["fxLayout","row","fxLayoutAlign","center center",1,"mt-3"],["mode","indeterminate"],[1,"row","mb-3"],[1,"col"],[3,"columns","columnsData","hasOptions","optionButtons"]],template:function(t,e){if(1&t&&(c.Ub(0,"div",0),c.Bc(1,jt,3,0,"ng-container",1),c.hc(2,"async"),c.Bc(3,St,4,6,"ng-template",null,2,c.Cc),c.Tb()),2&t){const t=c.rc(4);c.Cb(1),c.mc("ngIf",c.ic(2,2,e.as.isLoading$))("ngIfElse",t)}},directives:[r.k,k.c,k.b,Q.b,_t],pipes:[r.b],styles:[".table-parent[_ngcontent-%COMP%]{width:100%}",".title[_ngcontent-%COMP%]{font-size:19px;font-weight:700}.sticky-topp[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-left:0;height:4rem;border-bottom:1px solid #ccc}.sticky-topp[_ngcontent-%COMP%]   .status-msg[_ngcontent-%COMP%]{font-size:14px;color:#c45757}.loading-bar[_ngcontent-%COMP%]{margin:0;height:7px}"]}),t})(),Nt=(()=>{class t{constructor(t,e,n,r){this.fb=t,this.router=e,this.route=n,this.as=r,this.as.setCurrentPageState(null)}ngOnInit(){}onActionClick(t){"add"===t?this.router.navigate(["../","new-exer"],{relativeTo:this.route}):"edit"===t&&this.router.navigate(["../","edit-exer"],{relativeTo:this.route})}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(i.e),c.Ob(f.c),c.Ob(f.a),c.Ob(C))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-admin-landing"]],decls:18,vars:0,consts:[[1,"row","mb-3","justify-content-center"],[1,"col-12","text-center"],[1,"row","justify-content-center"],["ngClass.lt-md","mb-3",1,"col-12","col-lg-2"],["fxLayout","column","fxLayoutAlign","center center"],["mat-fab","","color","primary",1,"mat-elevation-z0",3,"click"],[1,"col-12","col-lg-2"],["mat-fab","","color","accent",1,"mat-elevation-z0",3,"click"]],template:function(t,e){1&t&&(c.Ub(0,"div",0),c.Ub(1,"p",1),c.Dc(2,"Welcome to the admin panel. You can add, edit or delete exercises."),c.Tb(),c.Tb(),c.Ub(3,"div",2),c.Ub(4,"div",3),c.Ub(5,"div",4),c.Ub(6,"button",5),c.cc("click",function(){return e.onActionClick("add")}),c.Ub(7,"mat-icon"),c.Dc(8,"add"),c.Tb(),c.Tb(),c.Ub(9,"div"),c.Dc(10," New Exercise "),c.Tb(),c.Tb(),c.Tb(),c.Ub(11,"div",6),c.Ub(12,"div",4),c.Ub(13,"button",7),c.cc("click",function(){return e.onActionClick("edit")}),c.Ub(14,"mat-icon"),c.Dc(15,"edit"),c.Tb(),c.Tb(),c.Ub(16,"div"),c.Dc(17," Edit Exercises "),c.Tb(),c.Tb(),c.Tb(),c.Tb())},directives:[U.a,k.c,k.b,L.a,R.a],styles:[""]}),t})();var At=n("XNiG"),Dt=n("1G5W"),Ct=n("ooqH"),kt=n("d3UM"),Pt=n("1jcm"),Lt=n("FKr1");function Ut(t,e){1&t&&(c.Ub(0,"mat-error"),c.Dc(1," Name is required. "),c.Tb())}function Rt(t,e){if(1&t&&(c.Ub(0,"mat-option",15),c.Dc(1),c.Tb()),2&t){const t=e.$implicit;c.mc("value",t),c.Cb(1),c.Fc(" ",t," ")}}function Mt(t,e){if(1&t&&(c.Ub(0,"mat-option",15),c.Dc(1),c.Tb()),2&t){const t=e.$implicit;c.mc("value",t),c.Cb(1),c.Fc(" ",t," ")}}function Vt(t,e){if(1&t&&(c.Ub(0,"mat-form-field",8),c.Ub(1,"mat-label"),c.Dc(2,"Time Per Set (in seconds)"),c.Tb(),c.Ub(3,"mat-select",10),c.Bc(4,Mt,2,2,"mat-option",11),c.Tb(),c.Tb()),2&t){const t=c.gc(3);c.Cb(3),c.mc("formControlName","countPerSet"),c.Cb(1),c.mc("ngForOf",t.timeOptions)}}function Ft(t,e){if(1&t&&(c.Ub(0,"mat-option",15),c.Dc(1),c.Tb()),2&t){const t=e.$implicit;c.mc("value",t),c.Cb(1),c.Fc(" ",t," ")}}function qt(t,e){if(1&t&&(c.Ub(0,"mat-form-field",8),c.Ub(1,"mat-label"),c.Dc(2,"Reps Per Set"),c.Tb(),c.Ub(3,"mat-select",10),c.Bc(4,Ft,2,2,"mat-option",11),c.Tb(),c.Tb()),2&t){const t=c.gc(3);c.Cb(3),c.mc("formControlName","countPerSet"),c.Cb(1),c.mc("ngForOf",t.timeOptions)}}function Bt(t,e){if(1&t&&(c.Ub(0,"div",5),c.Ub(1,"div",6),c.Dc(2),c.Tb(),c.Ub(3,"div",7),c.Ub(4,"mat-form-field",8),c.Ub(5,"mat-label"),c.Dc(6,"Exercises Name"),c.Tb(),c.Pb(7,"input",9),c.Bc(8,Ut,2,0,"mat-error",1),c.Tb(),c.Ub(9,"mat-form-field",8),c.Ub(10,"mat-label"),c.Dc(11,"Total Sets"),c.Tb(),c.Ub(12,"mat-select",10),c.Bc(13,Rt,2,2,"mat-option",11),c.Tb(),c.Tb(),c.Ub(14,"mat-slide-toggle",12),c.Dc(15,"Use time"),c.Tb(),c.Sb(16,13),c.Bc(17,Vt,5,2,"mat-form-field",14),c.Bc(18,qt,5,2,"mat-form-field",14),c.Rb(),c.Tb(),c.Tb()),2&t){const t=e.index,n=c.gc(2);c.Cb(2),c.Fc(" Exercise #",t+1," "),c.Cb(1),c.mc("formGroupName",t),c.Cb(4),c.mc("formControlName","name"),c.Cb(1),c.mc("ngIf",n.exercisesFaAny.controls[t].controls.name.errors&&n.exercisesFaAny.controls[t].controls.name.errors.required),c.Cb(4),c.mc("formControlName","sets"),c.Cb(1),c.mc("ngForOf",n.setOptions),c.Cb(1),c.mc("formControlName","setUnitTypeIsTime"),c.Cb(2),c.mc("ngSwitch",n.exercisesFaAny.controls[t].controls.setUnitTypeIsTime.value),c.Cb(1),c.mc("ngSwitchCase",!0),c.Cb(1),c.mc("ngSwitchCase",!1)}}const zt=function(){return{width:"100%"}};function Gt(t,e){if(1&t){const t=c.Vb();c.Sb(0),c.Ub(1,"form",2),c.cc("ngSubmit",function(){return c.tc(t),c.gc().onFormSubmit()}),c.Ub(2,"div",3),c.Bc(3,Bt,19,10,"div",4),c.Tb(),c.Tb(),c.Rb()}if(2&t){const t=c.gc();c.Cb(1),c.mc("formGroup",t.mainFg)("ngStyle.lt-md",c.nc(3,zt)),c.Cb(2),c.mc("ngForOf",t.exercisesFa.controls)}}const Ht=[{path:"",component:W,children:[{path:"",redirectTo:"landing",pathMatch:"full"},{path:"landing",component:Nt},{path:"new-exer",component:(()=>{class t{constructor(t,e){this.fb=t,this.as=e,this.setOptions=[3,5,7,10],this.timeOptions=[10,20,30,40,50,60],this.compDest$=new At.a,this.mainFg=this.createMainFg(),this.as.setCurrentPageState("new")}get exercisesFa(){return this.mainFg.get("exercises")}get exercisesFaAny(){return this.mainFg.get("exercises")}ngOnInit(){this.mainFg.valueChanges.pipe(Object(Dt.a)(this.compDest$)).subscribe(t=>{}),this.as.newlyAddedExerType$.pipe(Object(Dt.a)(this.compDest$)).subscribe(t=>{t&&t.name&&this.exercisesFa.push(this.createExerciseFg(t.name))}),this.as.onNewExerSaveClick$.pipe(Object(l.a)(t=>!!t),Object(Dt.a)(this.compDest$)).subscribe(t=>{this.onFormSubmit()})}createMainFg(){return this.fb.group({exercises:this.fb.array([this.createExerciseFg("Time Based")])})}createExerciseFg(t){const e="Time Based"===t;return this.fb.group({name:Object(Ct.a)(null,!1,[i.r.required]),sets:Object(Ct.a)(3,!1),countPerSet:Object(Ct.a)(30,!1),setUnitTypeIsTime:Object(Ct.a)(e,!1)})}onAddAnother(){this.exercisesFa.push(this.createExerciseFg())}onFormSubmit(){this.checkFormValid(this.mainFg.valid),console.log(this.mainFg.value),this.mainFg.valid&&this.as.onSaveExers(this.mainFg.value.exercises)}checkFormValid(t){this.as.onSetFormValidStatus(t)}ngOnDestroy(){this.as.resetNewExer(),this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(i.e),c.Ob(C))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-admin-new"]],decls:2,vars:1,consts:[["fxLayout","column","fxLayoutAlign","center center"],[4,"ngIf"],["fxLayoutGap","10px",3,"formGroup","ngStyle.lt-md","ngSubmit"],["formArrayName","exercises"],["class","exer mb-3",4,"ngFor","ngForOf"],[1,"exer","mb-3"],["ngClass.gt-xs","arr-count text-center"],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","10px",3,"formGroupName"],[1,""],["type","text","matInput","","placeholder","Exercises name",3,"formControlName"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],["color","primary",1,"",3,"formControlName"],[3,"ngSwitch"],["class","",4,"ngSwitchCase"],[3,"value"]],template:function(t,e){1&t&&(c.Ub(0,"div",0),c.Bc(1,Gt,4,4,"ng-container",1),c.Tb()),2&t&&(c.Cb(1),c.mc("ngIf",e.mainFg))},directives:[k.c,k.b,r.k,i.s,i.o,k.d,i.h,U.c,i.d,r.j,U.a,i.i,st.c,st.g,ut.b,i.c,i.n,i.g,kt.a,Pt.a,r.m,r.n,st.b,Lt.n],styles:[".arr-count[_ngcontent-%COMP%]{width:35rem;background-color:#eee;border-radius:15px;padding:10px}mat-form-field[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   .exer[_ngcontent-%COMP%]{border:1px solid #eee;border-radius:35px;padding:20px}",".title[_ngcontent-%COMP%]{font-size:19px;font-weight:700}.sticky-topp[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-left:0;height:4rem;border-bottom:1px solid #ccc}.sticky-topp[_ngcontent-%COMP%]   .status-msg[_ngcontent-%COMP%]{font-size:14px;color:#c45757}.loading-bar[_ngcontent-%COMP%]{margin:0;height:7px}"]}),t})()},{path:"edit-exer",component:xt}]}];let Kt=(()=>{class t{}return t.\u0275mod=c.Mb({type:t}),t.\u0275inj=c.Lb({factory:function(e){return new(e||t)},imports:[[f.f.forChild(Ht)],f.f]}),t})();var Jt=n("bOdf"),$t=n("eIep"),Yt=n("Kojo"),Xt=n("Jgta"),Wt=n("zIRd"),Qt=n("q/0M"),Zt=n("qOnz"),te=function(t,e){return(te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function ee(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var ne,re="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ie=ie||{},oe=re||self;function se(){}function ue(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function ae(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ce="closure_uid_"+(1e9*Math.random()>>>0),he=0;function fe(t,e,n){return t.call.apply(t.bind,arguments)}function le(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function pe(t,e,n){return(pe=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?fe:le).apply(null,arguments)}function de(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function ve(){return Date.now()}function ye(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function be(){this.j=this.j,this.i=this.i}be.prototype.j=!1,be.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,ce)&&t[ce]||(t[ce]=++he)}(this)},be.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var ge=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},me=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function we(t){return Array.prototype.concat.apply([],arguments)}function Ie(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Oe(t){return/^[\s\xa0]*$/.test(t)}var Te,Ee=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function _e(t,e){return-1!=t.indexOf(e)}function je(t,e){return t<e?-1:t>e?1:0}t:{var Se=oe.navigator;if(Se){var xe=Se.userAgent;if(xe){Te=xe;break t}}Te=""}function Ne(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Ae(t){var e={};for(var n in t)e[n]=t[n];return e}var De="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ce(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<De.length;o++)n=De[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ke(t){return ke[" "](t),t}ke[" "]=se;var Pe,Le,Ue=_e(Te,"Opera"),Re=_e(Te,"Trident")||_e(Te,"MSIE"),Me=_e(Te,"Edge"),Ve=Me||Re,Fe=_e(Te,"Gecko")&&!(_e(Te.toLowerCase(),"webkit")&&!_e(Te,"Edge"))&&!(_e(Te,"Trident")||_e(Te,"MSIE"))&&!_e(Te,"Edge"),qe=_e(Te.toLowerCase(),"webkit")&&!_e(Te,"Edge");function Be(){var t=oe.document;return t?t.documentMode:void 0}t:{var ze="",Ge=(Le=Te,Fe?/rv:([^\);]+)(\)|;)/.exec(Le):Me?/Edge\/([\d\.]+)/.exec(Le):Re?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Le):qe?/WebKit\/(\S+)/.exec(Le):Ue?/(?:Version)[ \/]?(\S+)/.exec(Le):void 0);if(Ge&&(ze=Ge?Ge[1]:""),Re){var He=Be();if(null!=He&&He>parseFloat(ze)){Pe=String(He);break t}}Pe=ze}var Ke={};function Je(t){return function(t,e){var n=Ke;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=Ee(String(Pe)).split("."),r=Ee(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=je(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||je(0==s[2].length,0==u[2].length)||je(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}var $e=oe.document&&Re&&(Be()||parseInt(Pe,10))||void 0,Ye=!Re||9<=Number($e),Xe=Re&&!Je("9"),We=function(){if(!oe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{oe.addEventListener("test",se,e),oe.removeEventListener("test",se,e)}catch(n){}return t}();function Qe(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Ze(t,e){if(Qe.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Fe){t:{try{ke(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:tn[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Qe.prototype.b=function(){this.defaultPrevented=!0},ye(Ze,Qe);var tn={2:"touch",3:"pen",4:"mouse"};Ze.prototype.b=function(){Ze.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Xe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var en="closure_listenable_"+(1e6*Math.random()|0),nn=0;function rn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++nn,this.Y=this.Z=!1}function on(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function sn(t){this.src=t,this.a={},this.b=0}function un(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=ge(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(on(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function an(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}sn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=an(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new rn(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var cn="closure_lm_"+(1e6*Math.random()|0),hn={};function fn(t,e,n,r,i){if(r&&r.once)return pn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)fn(t,e[o],n,r,i);return null}return n=In(n),t&&t[en]?t.va(e,n,ae(r)?!!r.capture:!!r,i):ln(t,e,n,!1,r,i)}function ln(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=ae(i)?!!i.capture:!!i;if(s&&!Ye)return null;var u=mn(t);if(u||(t[cn]=u=new sn(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=gn,e=Ye?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)We||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(yn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function pn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)pn(t,e[o],n,r,i);return null}return n=In(n),t&&t[en]?t.wa(e,n,ae(r)?!!r.capture:!!r,i):ln(t,e,n,!0,r,i)}function dn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)dn(t,e[o],n,r,i);else r=ae(r)?!!r.capture:!!r,n=In(n),t&&t[en]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=an(o=t.a[e],n,r,i))&&(on(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=mn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=an(e,n,r,i)),(n=-1<t?e[t]:null)&&vn(n))}function vn(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[en])un(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(yn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=mn(e))?(un(n,t),0==n.b&&(n.src=null,e[cn]=null)):on(t)}}}function yn(t){return t in hn?hn[t]:hn[t]="on"+t}function bn(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&vn(t),n.call(r,e)}function gn(t,e){if(t.Y)return!0;if(!Ye){if(!e)t:{e=["window","event"];for(var n=oe,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return bn(t,e=new Ze(e,this))}return bn(t,new Ze(e,this))}function mn(t){return(t=t[cn])instanceof sn?t:null}var wn="__closure_events_fn_"+(1e9*Math.random()>>>0);function In(t){return"function"==typeof t?t:(t[wn]||(t[wn]=function(e){return t.handleEvent(e)}),t[wn])}function On(){be.call(this),this.c=new sn(this),this.J=this,this.C=null}function Tn(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Qe(e,t);else if(e instanceof Qe)e.target=e.target||t;else{var i=e;Ce(e=new Qe(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=En(s,r,!0,e)&&i}if(i=En(s=e.a=t,r,!0,e)&&i,i=En(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=En(s=e.a=n[o],r,!1,e)&&i}function En(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&un(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}ye(On,be),On.prototype[en]=!0,(ne=On.prototype).addEventListener=function(t,e,n,r){fn(this,t,e,n,r)},ne.removeEventListener=function(t,e,n,r){dn(this,t,e,n,r)},ne.G=function(){if(On.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)on(n[r]);delete e.a[t],e.b--}}this.C=null},ne.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ne.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var _n=oe.JSON.stringify;function jn(){this.b=this.a=null}var Sn,xn=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new An},function(t){t.reset()});function Nn(){var t=Pn,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function An(){this.next=this.b=this.a=null}function Dn(t){oe.setTimeout(function(){throw t},0)}function Cn(t,e){Sn||function(){var t=oe.Promise.resolve(void 0);Sn=function(){t.then(Ln)}}(),kn||(Sn(),kn=!0),Pn.add(t,e)}jn.prototype.add=function(t,e){var n=xn.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},An.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},An.prototype.reset=function(){this.next=this.b=this.a=null};var kn=!1,Pn=new jn;function Ln(){for(var t;t=Nn();){try{t.a.call(t.b)}catch(n){Dn(n)}var e=xn;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}kn=!1}function Un(t,e){On.call(this),this.b=t||1,this.a=e||oe,this.f=pe(this.Za,this),this.g=ve()}function Rn(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Mn(t,e,n){if("function"==typeof t)n&&(t=pe(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=pe(t.handleEvent,t)}return 2147483647<Number(e)?-1:oe.setTimeout(t,e||0)}function Vn(t){t.a=Mn(function(){t.a=null,t.c&&(t.c=!1,Vn(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}ye(Un,On),(ne=Un.prototype).aa=!1,ne.M=null,ne.Za=function(){if(this.aa){var t=ve()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Tn(this,"tick"),this.aa&&(Rn(this),this.start()))}},ne.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=ve())},ne.G=function(){Un.X.G.call(this),Rn(this),delete this.a};var Fn=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}te(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Vn(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(oe.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(be);function qn(t){be.call(this),this.b=t,this.a={}}ye(qn,be);var Bn=[];function zn(t,e,n,r){Array.isArray(n)||(n&&(Bn[0]=n.toString()),n=Bn);for(var i=0;i<n.length;i++){var o=fn(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Gn(t){Ne(t.a,function(t,e){this.a.hasOwnProperty(e)&&vn(t)},t),t.a={}}function Hn(){this.a=!0}function Kn(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return _n(n)}catch(u){return e}}(t,n)+(r?" "+r:"")})}qn.prototype.G=function(){qn.X.G.call(this),Gn(this)},qn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Hn.prototype.info=function(){};var Jn={},$n=null;function Yn(){return $n=$n||new On}function Xn(t){Qe.call(this,Jn.Fa,t)}function Wn(t){var e=Yn();Tn(e,new Xn(e,t))}function Qn(t,e){Qe.call(this,Jn.STAT_EVENT,t),this.stat=e}function Zn(t){var e=Yn();Tn(e,new Qn(e,t))}function tr(t){Qe.call(this,Jn.Ga,t)}function er(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return oe.setTimeout(function(){t()},e)}Jn.Fa="serverreachability",ye(Xn,Qe),Jn.STAT_EVENT="statevent",ye(Qn,Qe),Jn.Ga="timingevent",ye(tr,Qe);var nr={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},rr={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function ir(){}function or(){}ir.prototype.a=null;var sr,ur={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function ar(){Qe.call(this,"d")}function cr(){Qe.call(this,"c")}function hr(){}function fr(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new qn(this),this.P=lr,this.R=new Un(t=Ve?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}ye(ar,Qe),ye(cr,Qe),ye(hr,ir),sr=new hr;var lr=45e3,pr={},dr={};function vr(t,e,n){t.H=1,t.i=Rr(Dr(e)),t.j=n,t.I=!0,yr(t,null)}function yr(t,e){t.u=ve(),mr(t),t.l=Dr(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Xr(n.b,"t",r),t.D=0,t.a=Gi(t.g,t.g.C?e:null),0<t.O&&(t.F=new Fn(pe(t.Ca,t,t.a),t.O)),zn(t.J,t.a,"readystatechange",t.Xa),e=t.B?Ae(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Wn(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function br(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=gr(t,n);if(i==dr){4==e&&(t.h=4,Zn(14),r=!1),Kn(t.c,t.f,null,"[Incomplete Response]");break}if(i==pr){t.h=4,Zn(15),Kn(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Kn(t.c,t.f,i,null),Er(t,i)}4==e&&0==n.length&&(t.h=1,Zn(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Ui(e),e.F=!0,Zn(11))):(Kn(t.c,t.f,n,"[Invalid Chunked Response]"),Tr(t),Or(t))}function gr(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?dr:(n=Number(e.substring(n,r)),isNaN(n)?pr:(r+=1)+n>e.length?dr:(e=e.substr(r,n),t.D=r+n,e))}function mr(t){t.T=ve()+t.P,wr(t,t.P)}function wr(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=er(pe(t.Va,t),e)}function Ir(t){t.o&&(oe.clearTimeout(t.o),t.o=null)}function Or(t){0==t.g.v||t.A||Vi(t.g,t)}function Tr(t){Ir(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Rn(t.R),Gn(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Er(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||ri(n.b,t)))if(n.I=t.N,!t.C&&ri(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(Ad){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Mi(n),Si(n)}Li(n),Zn(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=er(pe(n.Sa,n),6e3));if(1>=ni(n.b)&&n.ea){try{n.ea()}catch(Ad){}n.ea=void 0}}else qi(n,11)}else if((t.C||n.a==t)&&Mi(n),!Oe(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(_e(h,"spdy")||_e(h,"quic")||_e(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(ii(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,Ur(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=ve()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=zi(a,a.C?a.ga:null,a.fa),p.C){oi(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(Ir(d),mr(d)),a.a=p}else Pi(a);0<n.g.length&&Ai(n)}else"stop"!=i[0]&&"close"!=i[0]||qi(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?qi(n,7):ji(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Wn(4)}catch(Ad){}}function _r(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(ue(t)||"string"==typeof t)me(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(ue(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(ue(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function jr(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof jr)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Sr(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];xr(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)xr(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function xr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ne=fr.prototype).setTimeout=function(t){this.P=t},ne.Xa=function(t){t=t.target;var e=this.F;e&&3==Oi(t)?e.f():this.Ca(t)},ne.Ca=function(t){try{if(t==this.a)t:{var e=Oi(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!Ve&&!this.a.$())){this.A||4!=e||7==n||Wn(8==n||0>=r?3:2),Ir(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Oe(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Zn(12),Tr(this),Or(this);break t}Kn(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Er(this,a)}this.I?(br(this,e,o),Ve&&this.b&&3==e&&(zn(this.J,this.R,"tick",this.Wa),this.R.start())):(Kn(this.c,this.f,o,null),Er(this,o)),4==e&&Tr(this),this.b&&!this.A&&(4==e?Vi(this.g,this):(this.b=!1,mr(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Zn(12)):(this.h=0,Zn(13)),Tr(this),Or(this)}}}catch(c){}},ne.Wa=function(){if(this.a){var t=Oi(this.a),e=this.a.$();this.D<e.length&&(Ir(this),br(this,t,e),this.b&&4!=t&&mr(this))}},ne.cancel=function(){this.A=!0,Tr(this)},ne.Va=function(){this.o=null;var t=ve();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(Wn(3),Zn(17)),Tr(this),this.h=2,Or(this)):wr(this,this.T-t)},(ne=jr.prototype).K=function(){Sr(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ne.L=function(){return Sr(this),this.a.concat()},ne.get=function(t,e){return xr(this.b,t)?this.b[t]:e},ne.set=function(t,e){xr(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ne.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Nr=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ar(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ar){this.a=void 0!==e?e:t.a,Cr(this,t.f),this.j=t.j,kr(this,t.c),Pr(this,t.h),this.g=t.g,e=t.b;var n=new Kr;n.c=e.c,e.a&&(n.a=new jr(e.a),n.b=e.b),Lr(this,n),this.i=t.i}else t&&(n=String(t).match(Nr))?(this.a=!!e,Cr(this,n[1]||"",!0),this.j=Mr(n[2]||""),kr(this,n[3]||"",!0),Pr(this,n[4]),this.g=Mr(n[5]||"",!0),Lr(this,n[6]||"",!0),this.i=Mr(n[7]||"")):(this.a=!!e,this.b=new Kr(null,this.a))}function Dr(t){return new Ar(t)}function Cr(t,e,n){t.f=n?Mr(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function kr(t,e,n){t.c=n?Mr(e,!0):e}function Pr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Lr(t,e,n){e instanceof Kr?(t.b=e,function(t,e){e&&!t.f&&(Jr(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&($r(this,e),Xr(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=Vr(e,Gr)),t.b=new Kr(e,t.a))}function Ur(t,e,n){t.b.set(e,n)}function Rr(t){return Ur(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^ve()).toString(36)),t}function Mr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Vr(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Fr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Fr(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ar.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Vr(e,qr,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Vr(e,qr,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Vr(n,"/"==n.charAt(0)?zr:Br,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Vr(n,Hr)),t.join("")};var qr=/[#\/\?@]/g,Br=/[#\?:]/g,zr=/[#\?]/g,Gr=/[#\?@]/g,Hr=/#/g;function Kr(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Jr(t){t.a||(t.a=new jr,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function $r(t,e){Jr(t),e=Wr(t,e),xr(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,xr((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Sr(t)))}function Yr(t,e){return Jr(t),e=Wr(t,e),xr(t.a.b,e)}function Xr(t,e,n){$r(t,e),0<n.length&&(t.c=null,t.a.set(Wr(t,e),Ie(n)),t.b+=n.length)}function Wr(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ne=Kr.prototype).add=function(t,e){Jr(this),this.c=null,t=Wr(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ne.forEach=function(t,e){Jr(this),this.a.forEach(function(n,r){me(n,function(n){t.call(e,n,r,this)},this)},this)},ne.L=function(){Jr(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ne.K=function(t){Jr(this);var e=[];if("string"==typeof t)Yr(this,t)&&(e=we(e,this.a.get(Wr(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=we(e,t[n])}return e},ne.set=function(t,e){return Jr(this),this.c=null,Yr(this,t=Wr(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ne.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ne.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Qr=function(){return function(t,e){this.b=t,this.a=e}}();function Zr(t){this.g=t||ti,t=oe.PerformanceNavigationTiming?0<(t=oe.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(oe.ia&&oe.ia.ya&&oe.ia.ya()&&oe.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var ti=10;function ei(t){return!!t.b||!!t.a&&t.a.size>=t.f}function ni(t){return t.b?1:t.a?t.a.size:0}function ri(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function ii(t,e){t.a?t.a.add(e):t.b=e}function oi(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function si(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=ee(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Ie(t.c)}function ui(){}function ai(){this.a=new ui}function ci(t,e,n){var r=n||"";try{_r(t,function(t,n){var i=t;ae(t)&&(i=_n(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(bv){throw e.push(r+"type="+encodeURIComponent("_badmap")),bv}}function hi(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Zr.prototype.cancel=function(){var t,e;if(this.c=si(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=ee(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},ui.prototype.stringify=function(t){return oe.JSON.stringify(t,void 0)},ui.prototype.parse=function(t){return oe.JSON.parse(t,void 0)};var fi=oe.JSON.parse;function li(t){On.call(this),this.headers=new jr,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=pi,this.D=this.F=!1}ye(li,On);var pi="",di=/^https?$/i,vi=["POST","PUT"];function yi(t){return"content-type"==t.toLowerCase()}function bi(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,gi(t),wi(t)}function gi(t){t.u||(t.u=!0,Tn(t,"complete"),Tn(t,"error"))}function mi(t){if(t.b&&void 0!==ie&&(!t.s[1]||4!=Oi(t)||2!=t.W()))if(t.l&&4==Oi(t))Mn(t.za,0,t);else if(Tn(t,"readystatechange"),4==Oi(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Nr)[1]||null;if(!o&&oe.self&&oe.self.location){var s=oe.self.location.protocol;o=s.substr(0,s.length-1)}i=!di.test(o?o.toLowerCase():"")}e=i}if(e)Tn(t,"complete"),Tn(t,"success");else{t.h=6;try{var u=2<Oi(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",gi(t)}}finally{wi(t)}}}function wi(t,e){if(t.a){Ii(t);var n=t.a,r=t.s[0]?se:null;t.a=null,t.s=null,e||Tn(t,"ready");try{n.onreadystatechange=r}catch(bv){}}}function Ii(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(oe.clearTimeout(t.m),t.m=null)}function Oi(t){return t.a?t.a.readyState:0}function Ti(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Ne(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ur(t,e,n))}function Ei(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function _i(t){this.pa=0,this.g=[],this.c=new Hn,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Ei("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Ei("baseRetryDelayMs",5e3,t),this.Ra=Ei("retryDelaySeedMs",1e4,t),this.Ma=Ei("forwardChannelMaxRetries",2,t),this.ma=Ei("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Zr(t&&t.concurrentRequestLimit),this.ka=new ai,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function ji(t){if(xi(t),3==t.v){var e=t.R++,n=Dr(t.B);Ur(n,"SID",t.J),Ur(n,"RID",e),Ur(n,"TYPE","terminate"),Ci(t,n),(e=new fr(t,t.c,e,void 0)).H=2,e.i=Rr(Dr(n)),n=!1,oe.navigator&&oe.navigator.sendBeacon&&(n=oe.navigator.sendBeacon(e.i.toString(),"")),!n&&oe.Image&&((new Image).src=e.i,n=!0),n||(e.a=Gi(e.g,null),e.a.ba(e.i)),e.u=ve(),mr(e)}Bi(t)}function Si(t){t.a&&(Ui(t),t.a.cancel(),t.a=null)}function xi(t){Si(t),t.j&&(oe.clearTimeout(t.j),t.j=null),Mi(t),t.b.cancel(),t.h&&("number"==typeof t.h&&oe.clearTimeout(t.h),t.h=null)}function Ni(t,e){t.g.push(new Qr(t.Oa++,e)),3==t.v&&Ai(t)}function Ai(t){ei(t.b)||t.h||(t.h=!0,Cn(t.Ba,t),t.u=0)}function Di(t,e){var n;n=e?e.f:t.R++;var r=Dr(t.B);Ur(r,"SID",t.J),Ur(r,"RID",n),Ur(r,"AID",t.P),Ci(t,r),t.i&&t.l&&Ti(r,t.i,t.l),n=new fr(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ki(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),ii(t.b,n),vr(n,r,e)}function Ci(t,e){t.f&&_r({},function(t,n){Ur(e,n,t)})}function ki(t,e,n){n=Math.min(t.g.length,n);var r=t.f?pe(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{ci(h,s,"req"+c+"_")}catch(So){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Pi(t){t.a||t.j||(t.T=1,Cn(t.Aa,t),t.o=0)}function Li(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=er(pe(t.Aa,t),Fi(t,t.o)),t.o++,0))}function Ui(t){null!=t.s&&(oe.clearTimeout(t.s),t.s=null)}function Ri(t){t.a=new fr(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Dr(t.la);Ur(e,"RID","rpc"),Ur(e,"SID",t.J),Ur(e,"CI",t.H?"0":"1"),Ur(e,"AID",t.P),Ci(t,e),Ur(e,"TYPE","xmlhttp"),t.i&&t.l&&Ti(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Rr(Dr(e)),n.j=null,n.I=!0,yr(n,t)}function Mi(t){null!=t.m&&(oe.clearTimeout(t.m),t.m=null)}function Vi(t,e){var n=null;if(t.a==e){Mi(t),Ui(t),t.a=null;var r=2}else{if(!ri(t.b,e))return;n=e.s,oi(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=ve()-e.u;var i=t.u;Tn(r=Yn(),new tr(r,n,e,i)),Ai(t)}else Pi(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(ni(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=er(pe(t.Ba,t,e),Fi(t,t.u)),t.u++,0)))}(t,e)||2==r&&Li(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:qi(t,5);break;case 4:qi(t,10);break;case 3:qi(t,6);break;default:qi(t,2)}}function Fi(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function qi(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=pe(t.Ya,t);n||(n=new Ar("//www.google.com/images/cleardot.gif"),oe.location&&"http"==oe.location.protocol||Cr(n,"https"),Rr(n)),function(t,e){var n=new Hn;if(oe.Image){var r=new Image;r.onload=de(hi,n,r,"TestLoadImage: loaded",!0,e),r.onerror=de(hi,n,r,"TestLoadImage: error",!1,e),r.onabort=de(hi,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=de(hi,n,r,"TestLoadImage: timeout",!1,e),oe.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Zn(2);t.v=0,t.f&&t.f.ra(e),Bi(t),xi(t)}function Bi(t){t.v=0,t.I=-1,t.f&&(0==si(t.b).length&&0==t.g.length||(t.b.c.length=0,Ie(t.g),t.g.length=0),t.f.qa())}function zi(t,e,n){var r=function(t){return t instanceof Ar?Dr(t):new Ar(t,void 0)}(n);if(""!=r.c)e&&kr(r,e+"."+r.c),Pr(r,r.h);else{var i=oe.location;r=function(t,e,n,r){var i=new Ar(null,void 0);return t&&Cr(i,t),e&&kr(i,e),n&&Pr(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&Ne(t.V,function(t,e){Ur(r,e,t)}),n=t.na,(e=t.A)&&n&&Ur(r,e,n),Ur(r,"VER",t.ha),Ci(t,r),r}function Gi(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new li(t.Na)).F=t.C,e}function Hi(){}function Ki(){if(Re&&!(10<=Number($e)))throw Error("Environmental error: no available transport.")}function Ji(t,e){On.call(this),this.a=new _i(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Oe(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Oe(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Xi(this)}function $i(t){ar.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Yi(){cr.call(this),this.status=1}function Xi(t){this.a=t}(ne=li.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:sr),this.a.onreadystatechange=pe(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void bi(this,o)}t=n||"";var i=new jr(this.headers);r&&_r(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=yi,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=oe.FormData&&t instanceof oe.FormData,!(0<=ge(vi,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Ii(this),0<this.o&&((this.D=function(t){return Re&&Je(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=pe(this.xa,this)):this.m=Mn(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){bi(this,o)}},ne.xa=function(){void 0!==ie&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Tn(this,"timeout"),this.abort(8))},ne.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Tn(this,"complete"),Tn(this,"abort"),wi(this))},ne.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),wi(this,!0)),li.X.G.call(this)},ne.za=function(){this.j||(this.A||this.l||this.g?mi(this):this.Ua())},ne.Ua=function(){mi(this)},ne.W=function(){try{return 2<Oi(this)?this.a.status:-1}catch(Le){return-1}},ne.$=function(){try{return this.a?this.a.responseText:""}catch(Le){return""}},ne.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),fi(e)}},ne.ua=function(){return this.h},ne.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ne=_i.prototype).ha=8,ne.v=1,ne.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new fr(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Ce(r=Ae(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=ki(this,n,e),Ur(i=Dr(this.B),"RID",t),Ur(i,"CVER",22),this.A&&Ur(i,"X-HTTP-Session-Id",this.A),Ci(this,i),this.i&&r&&Ti(i,this.i,r),ii(this.b,n),this.Ia&&Ur(i,"TYPE","init"),this.da?(Ur(i,"$req",e),Ur(i,"SID","null"),n.U=!0,vr(n,i,null)):vr(n,i,e),this.v=2}}else 3==this.v&&(t?Di(this,t):0==this.g.length||ei(this.b)||Di(this))},ne.Aa=function(){if(this.j=null,Ri(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=er(pe(this.Ta,this),t)}},ne.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Zn(10),Si(this),Ri(this))},ne.Sa=function(){null!=this.m&&(this.m=null,Si(this),Li(this),Zn(19))},ne.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Zn(2)):(this.c.info("Failed to ping google.com"),Zn(1))},(ne=Hi.prototype).ta=function(){},ne.sa=function(){},ne.ra=function(){},ne.qa=function(){},ne.Ja=function(){},Ki.prototype.a=function(t,e){return new Ji(t,e)},ye(Ji,On),Ji.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Zn(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=zi(t,null,t.fa),Ai(t)},Ji.prototype.close=function(){ji(this.a)},Ji.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Ni(this.a,e)}else this.l?((e={}).__data__=_n(t),Ni(this.a,e)):Ni(this.a,t)},Ji.prototype.G=function(){this.a.f=null,delete this.f,ji(this.a),delete this.a,Ji.X.G.call(this)},ye($i,ar),ye(Yi,cr),ye(Xi,Hi),Xi.prototype.ta=function(){Tn(this.a,"a")},Xi.prototype.sa=function(t){Tn(this.a,new $i(t))},Xi.prototype.ra=function(t){Tn(this.a,new Yi(t))},Xi.prototype.qa=function(){Tn(this.a,"b")},Ki.prototype.createWebChannel=Ki.prototype.a,Ji.prototype.send=Ji.prototype.h,Ji.prototype.open=Ji.prototype.g,Ji.prototype.close=Ji.prototype.close,nr.NO_ERROR=0,nr.TIMEOUT=8,nr.HTTP_ERROR=6,rr.COMPLETE="complete",or.EventType=ur,ur.OPEN="a",ur.CLOSE="b",ur.ERROR="c",ur.MESSAGE="d",On.prototype.listen=On.prototype.va,li.prototype.listenOnce=li.prototype.wa,li.prototype.getLastError=li.prototype.Qa,li.prototype.getLastErrorCode=li.prototype.ua,li.prototype.getStatus=li.prototype.W,li.prototype.getResponseJson=li.prototype.Pa,li.prototype.getResponseText=li.prototype.$,li.prototype.send=li.prototype.ba;var Wi=nr,Qi=rr,Zi=Jn,to=or,eo=li,no=n("30Go"),ro=new Qt.b("@firebase/firestore");function io(){return ro.logLevel}function oo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ro.logLevel<=Qt.a.DEBUG){var r=e.map(ao);ro.debug.apply(ro,Object(no.g)(["Firestore (8.2.2): "+t],r))}}function so(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ro.logLevel<=Qt.a.ERROR){var r=e.map(ao);ro.error.apply(ro,Object(no.g)(["Firestore (8.2.2): "+t],r))}}function uo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ro.logLevel<=Qt.a.WARN){var r=e.map(ao);ro.warn.apply(ro,Object(no.g)(["Firestore (8.2.2): "+t],r))}}function ao(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(bv){return t}}function co(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.2) INTERNAL ASSERTION FAILED: "+t;throw so(e),new Error(e)}function ho(t,e){t||co()}function fo(t,e){return t}function lo(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var po=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=lo(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function vo(t,e){return t<e?-1:t>e?1:0}function yo(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function bo(t){return t+"\0"}var go=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.i)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return vo(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();go.h=new go("");var mo={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},wo=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(no.c)(e,t),e}(Error),Io=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(go.fromBase64String(e))}catch(e){throw new wo(mo.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(go.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),Oo=function(t){this._=t};function To(){if("undefined"==typeof Uint8Array)throw new wo(mo.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Eo(){if("undefined"==typeof atob)throw new wo(mo.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var _o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e.fromBase64String=function(t){return Eo(),new e(Io.fromBase64String(t))},e.fromUint8Array=function(t){return To(),new e(Io.fromUint8Array(t))},e.prototype.toBase64=function(){return Eo(),this._.toBase64()},e.prototype.toUint8Array=function(){return To(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Oo),jo=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},So=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),xo=function(){function t(t){this.uid=t}return t.prototype.A=function(){return null!=this.uid},t.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();xo.UNAUTHENTICATED=new xo(null),xo.P=new xo("google-credentials-uid"),xo.g=new xo("first-party-uid");var No=function(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t},Ao=function(){function t(){this.p=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.v=function(){},t.prototype.S=function(t){this.p=t,t(xo.UNAUTHENTICATED)},t.prototype.D=function(){this.p=null},t}(),Do=function(){function t(t){var e=this;this.C=null,this.currentUser=xo.UNAUTHENTICATED,this.N=!1,this.O=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.O++,e.currentUser=e.F(),e.N=!0,e.p&&e.p(e.currentUser)},this.O=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.O,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.O!==e?(oo("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(ho("string"==typeof n.accessToken),new No(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.v=function(){this.forceRefresh=!0},t.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},t.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},t.prototype.F=function(){var t=this.auth&&this.auth.getUid();return ho(null===t||"string"==typeof t),new xo(t)},t}(),Co=function(){function t(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=xo.g}return Object.defineProperty(t.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),ko=function(){function t(t,e){this.k=t,this.M=e}return t.prototype.getToken=function(){return Promise.resolve(new Co(this.k,this.M))},t.prototype.S=function(t){t(xo.g)},t.prototype.D=function(){},t.prototype.v=function(){},t}(),Po=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}return t.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},t}();Po.U=-1;var Lo=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new wo(mo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new wo(mo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new wo(mo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new wo(mo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.K=function(t){return this.seconds===t.seconds?vo(this.nanoseconds,t.nanoseconds):vo(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Uo=function(){function t(t){this.timestamp=t}return t.j=function(e){return new t(e)},t.min=function(){return new t(new Lo(0,0))},t.prototype.u=function(t){return this.timestamp.K(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.G=function(){return this.timestamp},t}(),Ro=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&co(),void 0===n?n=t.length-e:n>t.length-e&&co(),this.segments=t,this.offset=e,this.H=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.J(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.Y(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.X=function(t){return this.Y(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},t.prototype.tt=function(){return this.segments[this.offset]},t.prototype.et=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.nt=function(){return 0===this.length},t.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},t.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Mo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.prototype.ot=function(){return this.rt().join("/")},e.prototype.toString=function(){return this.ot()},e.ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new wo(mo.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.at=function(){return new e([])},e}(Ro),Vo=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Fo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.ut=function(t){return Vo.test(t)},e.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.ut(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.ot()},e.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},e.lt=function(){return new e(["__name__"])},e._t=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new wo(mo.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new wo(mo.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new wo(mo.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new wo(mo.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.at=function(){return new e([])},e}(Ro),qo=function(){function t(t){this.path=t}return t.ft=function(e){return new t(Mo.ct(e))},t.dt=function(e){return new t(Mo.ct(e).X(5))},t.prototype.wt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Mo.J(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.J=function(t,e){return Mo.J(t.path,e.path)},t.Et=function(t){return t.length%2==0},t.Tt=function(e){return new t(new Mo(e.slice()))},t}();function Bo(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Go(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ho=function(){function t(t){this.fields=t,t.sort(Fo.J)}return t.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},t.prototype.isEqual=function(t){return yo(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),Ko=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Jo(t){if(ho(!!t),"string"==typeof t){var e=0,n=Ko.exec(t);if(ho(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:$o(t.seconds),nanos:$o(t.nanos)}}function $o(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Yo(t){return"string"==typeof t?go.fromBase64String(t):go.fromUint8Array(t)}function Xo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Wo(t){var e=t.mapValue.fields.__previous_value__;return Xo(e)?Wo(e):e}function Qo(t){var e=Jo(t.mapValue.fields.__local_write_time__.timestampValue);return new Lo(e.seconds,e.nanos)}function Zo(t){return null==t}function ts(t){return 0===t&&1/t==-1/0}function es(t){return"number"==typeof t&&Number.isInteger(t)&&!ts(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function ns(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Xo(t)?4:10:co()}function rs(t,e){var n=ns(t);if(n!==ns(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qo(t).isEqual(Qo(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Jo(t.timestampValue),r=Jo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Yo(t.bytesValue).isEqual(Yo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return $o(t.geoPointValue.latitude)===$o(e.geoPointValue.latitude)&&$o(t.geoPointValue.longitude)===$o(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return $o(t.integerValue)===$o(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=$o(t.doubleValue),r=$o(e.doubleValue);return n===r?ts(n)===ts(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return yo(t.arrayValue.values||[],e.arrayValue.values||[],rs);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Bo(n)!==Bo(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!rs(n[i],r[i])))return!1;return!0}(t,e);default:return co()}}function is(t,e){return void 0!==(t.values||[]).find(function(t){return rs(t,e)})}function os(t,e){var n=ns(t),r=ns(e);if(n!==r)return vo(n,r);switch(n){case 0:return 0;case 1:return vo(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=$o(t.integerValue||t.doubleValue),r=$o(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ss(t.timestampValue,e.timestampValue);case 4:return ss(Qo(t),Qo(e));case 5:return vo(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Yo(t),r=Yo(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=vo(n[i],r[i]);if(0!==o)return o}return vo(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=vo($o(t.latitude),$o(e.latitude));return 0!==n?n:vo($o(t.longitude),$o(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=os(n[i],r[i]);if(o)return o}return vo(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=vo(r[s],o[s]);if(0!==u)return u;var a=os(n[r[s]],i[o[s]]);if(0!==a)return a}return vo(r.length,o.length)}(t.mapValue,e.mapValue);default:throw co()}}function ss(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return vo(t,e);var n=Jo(t),r=Jo(e),i=vo(n.seconds,r.seconds);return 0!==i?i:vo(n.nanos,r.nanos)}function us(t){return as(t)}function as(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Jo(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Yo(t.bytesValue).toBase64():"referenceValue"in t?qo.dt(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=as(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+as(t.fields[o])}return e+"}"}(t.mapValue):co();var e}function cs(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function hs(t){return!!t&&"integerValue"in t}function fs(t){return!!t&&"arrayValue"in t}function ls(t){return!!t&&"nullValue"in t}function ps(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ds(t){return!!t&&"mapValue"in t}var vs=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ds(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},t.prototype.isEqual=function(t){return rs(this.proto,t.proto)},t}(),ys=function(){function t(t){void 0===t&&(t=vs.empty()),this.At=t,this.Rt=new Map}return t.prototype.set=function(t,e){return this.Pt(t,e),this},t.prototype.delete=function(t){return this.Pt(t,null),this},t.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===ns(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.et(),e)},t.prototype.yt=function(){var t=this.gt(Fo.at(),this.Rt);return null!=t?new vs(t):this.At},t.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=ds(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.gt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function bs(t){var e=[];return zo(t.fields||{},function(t,n){var r=new Fo([t]);if(ds(n)){var i=bs(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new Ho(e)}var gs=function(t,e){this.key=t,this.version=e},ms=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Vt=r,o.bt=!!i.bt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(no.c)(e,t),e.prototype.field=function(t){return this.Vt.field(t)},e.prototype.data=function(){return this.Vt},e.prototype.vt=function(){return this.Vt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(gs),ws=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(no.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(gs),Is=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(gs),Os=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function Ts(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Os(t,e,n,r,i,o,s)}function Es(t){var e=fo(t);if(null===e.St){var n=e.path.ot();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.ot()+t.op.toString()+us(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.ot()+t.dir}(t)}).join(","),Zo(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Rs(e.startAt)),e.endAt&&(n+="|ub:",n+=Rs(e.endAt)),e.St=n}return e.St}function _s(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Vs(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!rs(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!qs(t.startAt,e.startAt)&&qs(t.endAt,e.endAt)}function js(t){return qo.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ss=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(no.c)(e,t),e.create=function(t,n,r){return t.ht()?"in"===n||"not-in"===n?this.Dt(t,n,r):new xs(t,n,r):"array-contains"===n?new Cs(t,r):"in"===n?new ks(t,r):"not-in"===n?new Ps(t,r):"array-contains-any"===n?new Ls(t,r):new e(t,n,r)},e.Dt=function(t,e,n){return"in"===e?new Ns(t,n):new As(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Ct(os(e,this.value)):null!==e&&ns(this.value)===ns(e)&&this.Ct(os(e,this.value))},e.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return co()}},e.prototype.xt=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),xs=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=qo.dt(r.referenceValue),i}return Object(no.c)(e,t),e.prototype.matches=function(t){var e=qo.J(t.key,this.key);return this.Ct(e)},e}(Ss),Ns=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Ds(0,n),r}return Object(no.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ss),As=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Ds(0,n),r}return Object(no.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ss);function Ds(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return qo.dt(t.referenceValue)})}var Cs=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(no.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return fs(e)&&is(e.arrayValue,this.value)},e}(Ss),ks=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(no.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&is(this.value.arrayValue,e)},e}(Ss),Ps=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(no.c)(e,t),e.prototype.matches=function(t){if(is(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!is(this.value.arrayValue,e)},e}(Ss),Ls=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(no.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!fs(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return is(e.value.arrayValue,t)})},e}(Ss),Us=function(t,e){this.position=t,this.before=e};function Rs(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return us(t)}).join(",")}var Ms=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Vs(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Fs(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ht()?qo.J(qo.dt(s.referenceValue),n.key):os(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function qs(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!rs(t.position[n],e.position[n]))return!1;return!0}var Bs=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ot=null,this.Ft=null};function zs(t,e,n,r,i,o,s,u){return new Bs(t,e,n,r,i,o,s,u)}function Gs(t){return new Bs(t)}function Hs(t){return!Zo(t.limit)&&"F"===t.limitType}function Ks(t){return!Zo(t.limit)&&"L"===t.limitType}function Js(t){return t.Nt.length>0?t.Nt[0].field:null}function $s(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function Ys(t){return null!==t.collectionGroup}function Xs(t){var e=fo(t);if(null===e.Ot){e.Ot=[];var n=$s(e),r=Js(e);if(null!==n&&null===r)n.ht()||e.Ot.push(new Ms(n)),e.Ot.push(new Ms(Fo.lt(),"asc"));else{for(var i=!1,o=0,s=e.Nt;o<s.length;o++){var u=s[o];e.Ot.push(u),u.field.ht()&&(i=!0)}if(!i){var a=e.Nt.length>0?e.Nt[e.Nt.length-1].dir:"asc";e.Ot.push(new Ms(Fo.lt(),a))}}}return e.Ot}function Ws(t){var e=fo(t);if(!e.Ft)if("F"===e.limitType)e.Ft=Ts(e.path,e.collectionGroup,Xs(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Xs(e);r<i.length;r++){var o=i[r];n.push(new Ms(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new Us(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Us(e.startAt.position,!e.startAt.before):null;e.Ft=Ts(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.Ft}function Qs(t,e,n){return new Bs(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Zs(t,e){return _s(Ws(t),Ws(e))&&t.limitType===e.limitType}function tu(t){return Es(Ws(t))+"|lt:"+t.limitType}function eu(t){return"Query(target="+function(t){var e=t.path.ot();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.ot()+" "+e.op+" "+us(e.value);var e}).join(", ")+"]"),Zo(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.ot()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Rs(t.startAt)),t.endAt&&(e+=", endAt: "+Rs(t.endAt)),"Target("+e+")"}(Ws(t))+"; limitType="+t.limitType+")"}function nu(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.wt(t.collectionGroup)&&t.path.st(n):qo.Et(t.path)?t.path.isEqual(n):t.path.it(n)}(t,e)&&function(t,e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Fs(t.startAt,Xs(t),e)||t.endAt&&Fs(t.endAt,Xs(t),e))}(t,e)}function ru(t){return function(e,n){for(var r=!1,i=0,o=Xs(t);i<o.length;i++){var s=o[i],u=iu(s,e,n);if(0!==u)return u;r=r||s.field.ht()}return 0}}function iu(t,e,n){var r=t.field.ht()?qo.J(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?os(r,i):co()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return co()}}var ou=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Uo.min()),void 0===o&&(o=Uo.min()),void 0===s&&(s=go.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.kt,e,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.$t=function(e,n){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Bt=function(e){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,e,this.resumeToken)},t}();function su(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ts(e)?"-0":e}}function uu(t){return{integerValue:""+t}}function au(t,e){return es(e)?uu(e):su(t,e)}var cu=function(){this.Ut=void 0};function hu(t,e,n){return t instanceof pu?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof du?vu(t,e):t instanceof yu?bu(t,e):function(t,e){var n=lu(t,e),r=mu(n)+mu(t.Qt);return hs(n)&&hs(t.Qt)?uu(r):su(t.Kt,r)}(t,e)}function fu(t,e,n){return t instanceof du?vu(t,e):t instanceof yu?bu(t,e):n}function lu(t,e){return t instanceof gu?hs(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var pu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e}(cu),du=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(no.c)(e,t),e}(cu);function vu(t,e){for(var n=wu(e),r=function(t){n.some(function(e){return rs(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var yu=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(no.c)(e,t),e}(cu);function bu(t,e){for(var n=wu(e),r=function(t){n=n.filter(function(e){return!rs(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var gu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kt=e,r.Qt=n,r}return Object(no.c)(e,t),e}(cu);function mu(t){return $o(t.integerValue||t.doubleValue)}function wu(t){return fs(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Iu=function(t,e){this.field=t,this.transform=e},Ou=function(t,e){this.version=t,this.transformResults=e},Tu=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.jt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Eu(t,e){return void 0!==t.updateTime?e instanceof ms&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ms}var _u=function(){};function ju(t,e,n){return t instanceof Du?function(t,e,n){var r=t.value;if(n.transformResults){var i=Pu(t.fieldTransforms,e,n.transformResults);r=Uu(t.fieldTransforms,r,i)}return new ms(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Cu?function(t,e,n){if(!Eu(t.Gt,e))return new Is(t.key,n.version);var r=ku(t,e,n.transformResults?Pu(t.fieldTransforms,e,n.transformResults):[]);return new ms(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new ws(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Su(t,e,n,r){return t instanceof Du?function(t,e,n,r){if(!Eu(t.Gt,e))return e;var i=t.value,o=Lu(t.fieldTransforms,n,e);i=Uu(t.fieldTransforms,i,o);var s=Au(e);return new ms(t.key,s,i,{bt:!0})}(t,e,r):t instanceof Cu?function(t,e,n,r){if(!Eu(t.Gt,e))return e;var i=Au(e),o=ku(t,e,Lu(t.fieldTransforms,n,e));return new ms(t.key,i,o,{bt:!0})}(t,e,r):function(t,e){return Eu(t.Gt,e)?new ws(t.key,Uo.min()):e}(t,e)}function xu(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof ms?e.field(o.field):void 0,u=lu(o.transform,s||null);null!=u&&(n=null==n?(new ys).set(o.field,u):n.set(o.field,u))}return n?n.yt():null}(t.fieldTransforms,e)}function Nu(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&yo(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof du&&e instanceof du||t instanceof yu&&e instanceof yu?yo(t.elements,e.elements,rs):t instanceof gu&&e instanceof gu?rs(t.Qt,e.Qt):t instanceof pu&&e instanceof pu}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt))}function Au(t){return t instanceof ms?t.version:Uo.min()}var Du=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Gt=r,o.fieldTransforms=i,o.type=0,o}return Object(no.c)(e,t),e}(_u),Cu=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.zt=r,s.Gt=i,s.fieldTransforms=o,s.type=1,s}return Object(no.c)(e,t),e}(_u);function ku(t,e,n){var r;return r=function(t,e){var n=new ys(e);return t.zt.fields.forEach(function(e){if(!e.nt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.yt()}(t,r=e instanceof ms?e.data():vs.empty()),Uu(t.fieldTransforms,r,n)}function Pu(t,e,n){var r=[];ho(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof ms&&(u=e.field(o.field)),r.push(fu(s,u,n[i]))}return r}function Lu(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof ms&&(c=n.field(u.field)),i.push(hu(a,c,e))}return i}function Uu(t,e,n){for(var r=new ys(e),i=0;i<t.length;i++)r.set(t[i].field,n[i]);return r.yt()}var Ru,Mu,Vu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=2,r.fieldTransforms=[],r}return Object(no.c)(e,t),e}(_u),Fu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=3,r.fieldTransforms=[],r}return Object(no.c)(e,t),e}(_u),qu=function(t){this.count=t};function Bu(t){switch(t){case mo.OK:return co();case mo.CANCELLED:case mo.UNKNOWN:case mo.DEADLINE_EXCEEDED:case mo.RESOURCE_EXHAUSTED:case mo.INTERNAL:case mo.UNAVAILABLE:case mo.UNAUTHENTICATED:return!1;case mo.INVALID_ARGUMENT:case mo.NOT_FOUND:case mo.ALREADY_EXISTS:case mo.PERMISSION_DENIED:case mo.FAILED_PRECONDITION:case mo.ABORTED:case mo.OUT_OF_RANGE:case mo.UNIMPLEMENTED:case mo.DATA_LOSS:return!0;default:return co()}}function zu(t){if(void 0===t)return so("GRPC error has no .code"),mo.UNKNOWN;switch(t){case Ru.OK:return mo.OK;case Ru.CANCELLED:return mo.CANCELLED;case Ru.UNKNOWN:return mo.UNKNOWN;case Ru.DEADLINE_EXCEEDED:return mo.DEADLINE_EXCEEDED;case Ru.RESOURCE_EXHAUSTED:return mo.RESOURCE_EXHAUSTED;case Ru.INTERNAL:return mo.INTERNAL;case Ru.UNAVAILABLE:return mo.UNAVAILABLE;case Ru.UNAUTHENTICATED:return mo.UNAUTHENTICATED;case Ru.INVALID_ARGUMENT:return mo.INVALID_ARGUMENT;case Ru.NOT_FOUND:return mo.NOT_FOUND;case Ru.ALREADY_EXISTS:return mo.ALREADY_EXISTS;case Ru.PERMISSION_DENIED:return mo.PERMISSION_DENIED;case Ru.FAILED_PRECONDITION:return mo.FAILED_PRECONDITION;case Ru.ABORTED:return mo.ABORTED;case Ru.OUT_OF_RANGE:return mo.OUT_OF_RANGE;case Ru.UNIMPLEMENTED:return mo.UNIMPLEMENTED;case Ru.DATA_LOSS:return mo.DATA_LOSS;default:return co()}}(Mu=Ru||(Ru={}))[Mu.OK=0]="OK",Mu[Mu.CANCELLED=1]="CANCELLED",Mu[Mu.UNKNOWN=2]="UNKNOWN",Mu[Mu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mu[Mu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mu[Mu.NOT_FOUND=5]="NOT_FOUND",Mu[Mu.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mu[Mu.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mu[Mu.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mu[Mu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mu[Mu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mu[Mu.ABORTED=10]="ABORTED",Mu[Mu.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mu[Mu.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mu[Mu.INTERNAL=13]="INTERNAL",Mu[Mu.UNAVAILABLE=14]="UNAVAILABLE",Mu[Mu.DATA_LOSS=15]="DATA_LOSS";var Gu=function(){function t(t,e){this.J=t,this.root=e||Ku.EMPTY}return t.prototype.Ht=function(e,n){return new t(this.J,this.root.Ht(e,n,this.J).copy(null,null,Ku.Jt,null,null))},t.prototype.remove=function(e){return new t(this.J,this.root.remove(e,this.J).copy(null,null,Ku.Jt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.nt=function(){return this.root.nt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(){return this.root.Xt()},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.forEach=function(t){this.Zt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Zt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.te=function(t){return this.root.te(t)},t.prototype.ee=function(){return new Hu(this.root,null,this.J,!1)},t.prototype.ne=function(t){return new Hu(this.root,t,this.J,!1)},t.prototype.se=function(){return new Hu(this.root,null,this.J,!0)},t.prototype.ie=function(t){return new Hu(this.root,t,this.J,!0)},t}(),Hu=function(){function t(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}return t.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},t.prototype.ae=function(){return this.oe.length>0},t.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},t}(),Ku=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.nt=function(){return!1},t.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},t.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},t.prototype.min=function(){return this.left.nt()?this:this.left.min()},t.prototype.Yt=function(){return this.min().key},t.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},t.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},t.prototype.le=function(){if(this.left.nt())return t.EMPTY;var e=this;return e.left._e()||e.left.left._e()||(e=e.fe()),(e=e.copy(null,null,null,e.left.le(),null)).he()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.nt()||i.left._e()||i.left.left._e()||(i=i.fe()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left._e()&&(i=i.de()),i.right.nt()||i.right._e()||i.right.left._e()||(i=i.we()),0===n(e,i.key)){if(i.right.nt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.le())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.he()},t.prototype._e=function(){return this.color},t.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},t.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},t.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},t.prototype.Ee=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.de=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},t.prototype.me=function(){if(this._e()&&this.left._e())throw co();if(this.right._e())throw co();var t=this.left.me();if(t!==this.right.me())throw co();return t+(this._e()?0:1)},t}();Ku.EMPTY=null,Ku.RED=!0,Ku.Jt=!1,Ku.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw co()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw co()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw co()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw co()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw co()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ht=function(t,e,n){return new Ku(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.nt=function(){return!0},t.prototype.Zt=function(t){return!1},t.prototype.te=function(t){return!1},t.prototype.Yt=function(){return null},t.prototype.Xt=function(){return null},t.prototype._e=function(){return!1},t.prototype.Ie=function(){return!0},t.prototype.me=function(){return 0},t}());var Ju=function(){function t(t){this.J=t,this.data=new Gu(this.J)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Yt()},t.prototype.last=function(){return this.data.Xt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Zt(function(e,n){return t(e),!1})},t.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(this.J(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Re=function(t,e){var n;for(n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},t.prototype.Pe=function(t){var e=this.data.ne(t);return e.ae()?e.ce().key:null},t.prototype.ee=function(){return new $u(this.data.ee())},t.prototype.ne=function(t){return new $u(this.data.ne(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.nt=function(){return this.data.nt()},t.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ee(),r=e.data.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(0!==this.J(i,o))return!1}return!0},t.prototype.rt=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.J);return n.data=e,n},t}(),$u=function(){function t(t){this.ge=t}return t.prototype.ce=function(){return this.ge.ce().key},t.prototype.ae=function(){return this.ge.ae()},t}(),Yu=new Gu(qo.J);function Xu(){return Yu}function Wu(){return Xu()}var Qu=new Gu(qo.J);function Zu(){return Qu}var ta=new Gu(qo.J);function ea(){return ta}var na=new Ju(qo.J);function ra(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=na,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ia=new Ju(vo);function oa(){return ia}var sa=function(){function t(t){this.J=t?function(e,n){return t(e,n)||qo.J(e.key,n.key)}:function(t,e){return qo.J(t.key,e.key)},this.Ve=Zu(),this.pe=new Gu(this.J)}return t.be=function(e){return new t(e.J)},t.prototype.has=function(t){return null!=this.Ve.get(t)},t.prototype.get=function(t){return this.Ve.get(t)},t.prototype.first=function(){return this.pe.Yt()},t.prototype.last=function(){return this.pe.Xt()},t.prototype.nt=function(){return this.pe.nt()},t.prototype.indexOf=function(t){var e=this.Ve.get(t);return e?this.pe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.pe.Zt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pe.ee(),r=e.pe.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.J=this.J,r.Ve=e,r.pe=n,r},t}(),ua=function(){function t(){this.ve=new Gu(qo.J)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);n?0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):co():this.ve=this.ve.Ht(e,t)},t.prototype.Se=function(){var t=[];return this.ve.Zt(function(e,n){t.push(n)}),t},t}(),aa=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}return t.Oe=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,sa.be(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&Zs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),ca=function(){function t(t,e,n,r,i){this.Mt=t,this.Fe=e,this.ke=n,this.Me=r,this.Le=i}return t.$e=function(e,n){var r=new Map;return r.set(e,ha.Be(e,n)),new t(Uo.min(),r,oa(),Xu(),ra())},t}(),ha=function(){function t(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}return t.Be=function(e,n){return new t(go.h,n,ra(),ra(),ra())},t}(),fa=function(t,e,n,r){this.je=t,this.removedTargetIds=e,this.key=n,this.We=r},la=function(t,e){this.targetId=t,this.Ge=e},pa=function(t,e,n,r){void 0===n&&(n=go.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},da=function(){function t(){this.ze=0,this.He=ba(),this.Je=go.h,this.Ye=!1,this.Xe=!0}return Object.defineProperty(t.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),t.prototype.en=function(t){t.o()>0&&(this.Xe=!0,this.Je=t)},t.prototype.nn=function(){var t=ra(),e=ra(),n=ra();return this.He.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:co()}}),new ha(this.Je,this.Ye,t,e,n)},t.prototype.sn=function(){this.Xe=!1,this.He=ba()},t.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},t.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},t.prototype.cn=function(){this.ze+=1},t.prototype.an=function(){this.ze-=1},t.prototype.un=function(){this.Xe=!0,this.Ye=!0},t}(),va=function(){function t(t){this.hn=t,this.ln=new Map,this._n=Xu(),this.fn=ya(),this.dn=new Ju(vo)}return t.prototype.wn=function(t){for(var e=0,n=t.je;e<n.length;e++){var r=n[e];t.We instanceof ms?this.En(r,t.We):t.We instanceof ws&&this.Tn(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Tn(r=o[i],t.key,t.We)},t.prototype.In=function(t){var e=this;this.mn(t,function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:co()}})},t.prototype.mn=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ln.forEach(function(t,r){n.Rn(r)&&e(r)})},t.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,r=this.gn(e);if(r){var i=r.target;if(js(i))if(0===n){var o=new qo(i.path);this.Tn(e,o,new ws(o,Uo.min()))}else ho(1===n);else this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e))}},t.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach(function(r,i){var o=e.gn(i);if(o){if(r.qe&&js(o.target)){var s=new qo(o.target.path);null!==e._n.get(s)||e.bn(i,s)||e.Tn(i,s,new ws(s,t))}r.tn&&(n.set(i,r.nn()),r.sn())}});var r=ra();this.fn.forEach(function(t,n){var i=!0;n.Re(function(t){var n=e.gn(t);return!n||2===n.kt||(i=!1,!1)}),i&&(r=r.add(t))});var i=new ca(t,n,this.dn,this._n,r);return this._n=Xu(),this.fn=ya(),this.dn=new Ju(vo),i},t.prototype.En=function(t,e){if(this.Rn(t)){var n=this.bn(t,e.key)?2:0;this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t))}},t.prototype.Tn=function(t,e,n){if(this.Rn(t)){var r=this.An(t);this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n))}},t.prototype.removeTarget=function(t){this.ln.delete(t)},t.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},t.prototype.cn=function(t){this.An(t).cn()},t.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new da,this.ln.set(t,e)),e},t.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new Ju(vo),this.fn=this.fn.Ht(t,e)),e},t.prototype.Rn=function(t){var e=null!==this.gn(t);return e||oo("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},t.prototype.Pn=function(t){var e=this;this.ln.set(t,new da),this.hn.Sn(t).forEach(function(n){e.Tn(t,n,null)})},t.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},t}();function ya(){return new Gu(qo.J)}function ba(){return new Gu(qo.J)}var ga={asc:"ASCENDING",desc:"DESCENDING"},ma={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wa=function(t,e){this.T=t,this.qt=e};function Ia(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Oa(t,e){return t.qt?e.toBase64():e.toUint8Array()}function Ta(t,e){return Ia(t,e.G())}function Ea(t){return ho(!!t),Uo.j(function(t){var e=Jo(t);return new Lo(e.seconds,e.nanos)}(t))}function _a(t,e){return function(t){return new Mo(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).ot()}function ja(t){var e=Mo.ct(t);return ho(Xa(e)),e}function Sa(t,e){return _a(t.T,e.path)}function xa(t,e){var n=ja(e);if(n.get(1)!==t.T.projectId)throw new wo(mo.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.T.projectId);if(n.get(3)!==t.T.database)throw new wo(mo.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.T.database);return new qo(Ca(n))}function Na(t,e){return _a(t.T,e)}function Aa(t){var e=ja(t);return 4===e.length?Mo.at():Ca(e)}function Da(t){return new Mo(["projects",t.T.projectId,"databases",t.T.database]).ot()}function Ca(t){return ho(t.length>4&&"documents"===t.get(4)),t.X(5)}function ka(t,e,n){return{name:Sa(t,e),fields:n.proto.mapValue.fields}}function Pa(t,e,n){var r=xa(t,e.name),i=Ea(e.updateTime),o=new vs({mapValue:{fields:e.fields}});return new ms(r,i,o,{hasCommittedMutations:!!n})}function La(t,e){var n;if(e instanceof Du)n={update:ka(t,e.key,e.value)};else if(e instanceof Vu)n={delete:Sa(t,e.key)};else if(e instanceof Cu)n={update:ka(t,e.key,e.data),updateMask:Ya(e.zt)};else{if(!(e instanceof Fu))return co();n={verify:Sa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof pu)return{fieldPath:e.field.ot(),setToServerValue:"REQUEST_TIME"};if(n instanceof du)return{fieldPath:e.field.ot(),appendMissingElements:{values:n.elements}};if(n instanceof yu)return{fieldPath:e.field.ot(),removeAllFromArray:{values:n.elements}};if(n instanceof gu)return{fieldPath:e.field.ot(),increment:n.Qt};throw co()}(0,t)})),e.Gt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ta(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:co()}(t,e.Gt)),n}function Ua(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Tu.updateTime(Ea(t.updateTime)):void 0!==t.exists?Tu.exists(t.exists):Tu.jt()}(e.currentDocument):Tu.jt(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(ho("REQUEST_TIME"===e.setToServerValue),n=new pu):"appendMissingElements"in e?n=new du(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new yu(e.removeAllFromArray.values||[]):"increment"in e?n=new gu(t,e.increment):co();var r=Fo._t(e.fieldPath);return new Iu(r,n)}(t,e)}):[];if(e.update){var i=xa(t,e.update.name),o=new vs({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new Ho((t.fieldPaths||[]).map(function(t){return Fo._t(t)}))}(e.updateMask);return new Cu(i,o,s,n,r)}return new Du(i,o,n,r)}if(e.delete){var u=xa(t,e.delete);return new Vu(u,n)}if(e.verify){var a=xa(t,e.verify);return new Fu(a,n)}return co()}function Ra(t,e){return{documents:[Na(t,e.path)]}}function Ma(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Na(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Na(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(ps(t.value))return{unaryFilter:{field:Ha(t.field),op:"IS_NAN"}};if(ls(t.value))return{unaryFilter:{field:Ha(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ps(t.value))return{unaryFilter:{field:Ha(t.field),op:"IS_NOT_NAN"}};if(ls(t.value))return{unaryFilter:{field:Ha(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ha(t.field),op:Ga(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:Ha(t.field),direction:za(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.qt||Zo(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=qa(e.startAt)),e.endAt&&(n.structuredQuery.endAt=qa(e.endAt)),n}function Va(t){var e=Aa(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ho(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Fa(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new Ms(Ka(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return Zo(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Ba(n.startAt));var h=null;return n.endAt&&(h=Ba(n.endAt)),zs(e,i,u,s,a,"F",c,h)}function Fa(t){return t?void 0!==t.unaryFilter?[$a(t)]:void 0!==t.fieldFilter?[Ja(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return Fa(t)}).reduce(function(t,e){return t.concat(e)}):co():[]}function qa(t){return{before:t.before,values:t.position}}function Ba(t){return new Us(t.values||[],!!t.before)}function za(t){return ga[t]}function Ga(t){return ma[t]}function Ha(t){return{fieldPath:t.ot()}}function Ka(t){return Fo._t(t.fieldPath)}function Ja(t){return Ss.create(Ka(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return co()}}(t.fieldFilter.op),t.fieldFilter.value)}function $a(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ka(t.unaryFilter.field);return Ss.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ka(t.unaryFilter.field);return Ss.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ka(t.unaryFilter.field);return Ss.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ka(t.unaryFilter.field);return Ss.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return co()}}function Ya(t){var e=[];return t.fields.forEach(function(t){return e.push(t.ot())}),{fieldPaths:e}}function Xa(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Wa=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Qa=function(){function t(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.On=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.On&&co(),this.On=!0,this.Nn?this.error?this.Fn(n,this.error):this.kn(e,this.result):new t(function(t,i){r.Cn=function(n){r.kn(e,n).next(t,i)},r.xn=function(e){r.Fn(n,e).next(t,i)}})},t.prototype.Mn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Ln=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.kn=function(e,n){return e?this.Ln(function(){return e(n)}):t.resolve(n)},t.prototype.Fn=function(e,n){return e?this.Ln(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.$n=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Bn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.$n(r)},t}(),Za=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new Wa,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new nc(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){var r=uc(e.target.error);n.qn.reject(new nc(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new nc(n,e)}},Object.defineProperty(t.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(oo("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new ic(e)},t}(),tc=function(){function t(e,n,r){this.name=e,this.version=n,this.Qn=r,12.2===t.Kn(Object(Zt.g)())&&so("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return oo("SimpleDb","Removing database:",t),oc(window.indexedDB.deleteDatabase(t)).Mn()},t.jn=function(){if("undefined"==typeof indexedDB)return!1;if(t.Wn())return!0;var e=Object(Zt.g)(),n=t.Kn(e),r=0<n&&n<10,i=t.Gn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},t.Hn=function(t,e){return t.store(e)},t.Kn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Gn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Jn=function(t){return Object(no.b)(this,void 0,void 0,function(){var e,n=this;return Object(no.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(oo("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new nc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new wo(mo.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new nc(t,n))},i.onupgradeneeded=function(t){oo("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Qn.Yn(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){oo("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}})})},t.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(no.b)(this,void 0,void 0,function(){var i,o,s,u,a;return Object(no.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object(no.d)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Jn(t)];case 2:return u.db=f.sent(),e=Za.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),Qa.reject(t)}).Mn(),a={},s.catch(function(){}),[4,e.Un];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return oo("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),ec=function(){function t(t){this.ts=t,this.es=!1,this.ns=null}return Object.defineProperty(t.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.es=!0},t.prototype.rs=function(t){this.ns=t},t.prototype.delete=function(){return oc(this.ts.delete())},t}(),nc=function(t){function e(e,n){var r=this;return(r=t.call(this,mo.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(no.c)(e,t),e}(wo);function rc(t){return"IndexedDbTransactionError"===t.name}var ic=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(oo("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(oo("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),oc(n)},t.prototype.add=function(t){return oo("SimpleDb","ADD",this.store.name,t,t),oc(this.store.add(t))},t.prototype.get=function(t){var e=this;return oc(this.store.get(t)).next(function(n){return void 0===n&&(n=null),oo("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return oo("SimpleDb","DELETE",this.store.name,t),oc(this.store.delete(t))},t.prototype.count=function(){return oo("SimpleDb","COUNT",this.store.name),oc(this.store.count())},t.prototype.os=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.cs(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.us=function(t,e){oo("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.hs=!1;var r=this.cursor(n);return this.cs(r,function(t,e,n){return n.delete()})},t.prototype.ls=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.cs(r,e)},t.prototype._s=function(t){var e=this.cursor({});return new Qa(function(n,r){e.onerror=function(t){var e=uc(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.cs=function(t,e){var n=[];return new Qa(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ec(i),s=e(i.primaryKey,i.value,o);if(s instanceof Qa){var u=s.catch(function(t){return o.done(),Qa.reject(t)});n.push(u)}o.Nn?r():null===o.ss?i.continue():i.continue(o.ss)}else r()}}).next(function(){return Qa.$n(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function oc(t){return new Qa(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=uc(t.target.error);n(e)}})}var sc=!1;function uc(t){var e=tc.Kn(Object(Zt.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new wo("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return sc||(sc=!0,setTimeout(function(){throw r},0)),r}}return t}var ac=function(){function t(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new Wa,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}return t.Is=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},t.prototype.Ps=function(){return this.Rs()},t.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new wo(mo.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Rs=function(){var t=this;this.fs.ys(function(){return null!==t.As?(t.clearTimeout(),t.op().then(function(e){return t.Ts.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},t}();function cc(t,e){if(so("AsyncQueue",e+": "+t),rc(t))return new wo(mo.UNAVAILABLE,e+": "+t);throw t}var hc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",fc=function(){function t(){this.gs=[]}return t.prototype.Vs=function(t){this.gs.push(t)},t.prototype.ps=function(){this.gs.forEach(function(t){return t()})},t}();function lc(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=dc(e)),e=pc(t.get(n),e);return dc(e)}function pc(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function dc(t){return t+"\x01\x01"}function vc(t){var e=t.length;if(ho(e>=2),2===e)return ho("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Mo.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&co(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:co()}o=s+2}return new Mo(r)}var yc=function(t,e){this.seconds=t,this.nanoseconds=e},bc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};bc.store="owner",bc.key="owner";var gc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};gc.store="mutationQueues",gc.keyPath="userId";var mc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};mc.store="mutations",mc.keyPath="batchId",mc.userMutationsIndex="userMutationsIndex",mc.userMutationsKeyPath=["userId","batchId"];var wc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,lc(e)]},t.key=function(t,e,n){return[t,lc(e),n]},t}();wc.store="documentMutations",wc.PLACEHOLDER=new wc;var Ic=function(t,e){this.path=t,this.readTime=e},Oc=function(t,e){this.path=t,this.version=e},Tc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Tc.store="remoteDocuments",Tc.readTimeIndex="readTimeIndex",Tc.readTimeIndexPath="readTime",Tc.collectionReadTimeIndex="collectionReadTimeIndex",Tc.collectionReadTimeIndexPath=["parentPath","readTime"];var Ec=function(t){this.byteSize=t};Ec.store="remoteDocumentGlobal",Ec.key="remoteDocumentGlobalKey";var _c=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};_c.store="targets",_c.keyPath="targetId",_c.queryTargetsIndexName="queryTargetsIndex",_c.queryTargetsKeyPath=["canonicalId","targetId"];var jc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};jc.store="targetDocuments",jc.keyPath=["targetId","path"],jc.documentTargetsIndex="documentTargetsIndex",jc.documentTargetsKeyPath=["path","targetId"];var Sc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Sc.key="targetGlobalKey",Sc.store="targetGlobal";var xc=function(t,e){this.collectionId=t,this.parent=e};xc.store="collectionParents",xc.keyPath=["collectionId","parent"];var Nc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Nc.store="clientMetadata",Nc.keyPath="clientId";var Ac=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Ac.store="bundles",Ac.keyPath="bundleId";var Dc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Dc.store="namedQueries",Dc.keyPath="name";var Cc=Object(no.g)(Object(no.g)(Object(no.g)(Object(no.g)([gc.store,mc.store,wc.store,Tc.store,_c.store,bc.store,Sc.store,jc.store],[Nc.store]),[Ec.store]),[xc.store]),[Ac.store,Dc.store]),kc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).bs=e,r.vs=n,r}return Object(no.c)(e,t),e}(fc);function Pc(t,e){var n=fo(t);return tc.Hn(n.bs,e)}var Lc=function(){function t(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ds=function(t,e,n){for(var r=n.Cs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ju(o,e,r[i]))}return e},t.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=Su(s,e,0,this.Ss));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=Su(s,e,0,this.Ss))}return e},t.prototype.Ns=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.xs(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ra())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&yo(this.mutations,t.mutations,function(t,e){return Nu(t,e)})&&yo(this.baseMutations,t.baseMutations,function(t,e){return Nu(t,e)})},t}(),Uc=function(){function t(t,e,n,r){this.batch=t,this.Os=e,this.Cs=n,this.Fs=r}return t.from=function(e,n,r){ho(e.mutations.length===r.length);for(var i=ea(),o=e.mutations,s=0;s<o.length;s++)i=i.Ht(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Rc=function(t){this.ks=t};function Mc(t,e){if(e.document)return Pa(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=qo.Tt(e.noDocument.path),r=zc(e.noDocument.readTime);return new ws(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=qo.Tt(e.unknownDocument.path);return r=zc(e.unknownDocument.version),new Is(i,r)}return co()}function Vc(t,e,n){var r=Fc(n),i=e.key.path.Z().rt();if(e instanceof ms){var o=function(t,e){return{name:Sa(t,e.key),fields:e.vt().mapValue.fields,updateTime:Ia(t,e.version.G())}}(t.ks,e),s=e.hasCommittedMutations;return new Tc(null,null,o,s,r,i)}if(e instanceof ws){var u=e.key.path.rt(),a=Bc(e.version);return s=e.hasCommittedMutations,new Tc(null,new Ic(u,a),null,s,r,i)}if(e instanceof Is){var c=e.key.path.rt(),h=Bc(e.version);return new Tc(new Oc(c,h),null,null,!0,r,i)}return co()}function Fc(t){var e=t.G();return[e.seconds,e.nanoseconds]}function qc(t){var e=new Lo(t[0],t[1]);return Uo.j(e)}function Bc(t){var e=t.G();return new yc(e.seconds,e.nanoseconds)}function zc(t){var e=new Lo(t.seconds,t.nanoseconds);return Uo.j(e)}function Gc(t,e){for(var n=(e.baseMutations||[]).map(function(e){return Ua(t.ks,e)}),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map(function(e){return Ua(t.ks,e)}),s=Lo.fromMillis(e.localWriteTimeMs);return new Lc(e.batchId,s,n,o)}function Hc(t){var e,n,r=zc(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?zc(t.lastLimboFreeSnapshotVersion):Uo.min();return void 0!==t.query.documents?(ho(1===(n=t.query).documents.length),e=Ws(Gs(Aa(n.documents[0])))):e=function(t){return Ws(Va(t))}(t.query),new ou(e,t.targetId,0,t.lastListenSequenceNumber,r,i,go.fromBase64String(t.resumeToken))}function Kc(t,e){var n,r=Bc(e.Mt),i=Bc(e.lastLimboFreeSnapshotVersion);n=js(e.target)?Ra(t.ks,e.target):Ma(t.ks,e.target);var o=e.resumeToken.toBase64();return new _c(e.targetId,Es(e.target),r,o,e.sequenceNumber,i,n)}function Jc(t){var e=Va({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Qs(e,e.limit,"L"):e}var $c=function(){function t(){}return t.prototype.Ms=function(t,e){return Yc(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:zc(e.createTime),version:e.version};var e})},t.prototype.Ls=function(t,e){return Yc(t).put({bundleId:(n=e).id,createTime:Bc(Ea(n.createTime)),version:n.version});var n},t.prototype.$s=function(t,e){return Xc(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:Jc(e.bundledQuery),readTime:zc(e.readTime)};var e})},t.prototype.Bs=function(t,e){return Xc(t).put(function(t){return{name:t.name,readTime:Bc(Ea(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Yc(t){return Pc(t,Ac.store)}function Xc(t){return Pc(t,Dc.store)}var Wc=function(){function t(){this.qs=new Qc}return t.prototype.Us=function(t,e){return this.qs.add(e),Qa.resolve()},t.prototype.Qs=function(t,e){return Qa.resolve(this.qs.getEntries(e))},t}(),Qc=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new Ju(Mo.J),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.et(),n=t.Z(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Ju(Mo.J)).rt()},t}(),Zc=function(){function t(){this.Ks=new Qc}return t.prototype.Us=function(t,e){var n=this;if(!this.Ks.has(e)){var r=e.et(),i=e.Z();t.Vs(function(){n.Ks.add(e)});var o={collectionId:r,parent:lc(i)};return th(t).put(o)}return Qa.resolve()},t.prototype.Qs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[bo(e),""],!1,!0);return th(t).os(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(vc(o.parent))}return n})},t}();function th(t){return Pc(t,xc.store)}var eh={js:!1,Ws:0,Gs:0,zs:0},nh=function(){function t(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}return t.Xs=function(e){return new t(e,t.Zs,t.ti)},t}();function rh(t){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(e){if(t.code!==mo.FAILED_PRECONDITION||t.message!==hc)throw t;return oo("LocalStore","Unexpectedly lost primary lease"),[2]})})}nh.Zs=10,nh.ti=1e3,nh.ei=new nh(41943040,nh.Zs,nh.ti),nh.ni=new nh(-1,0,0);var ih=function(){function t(t,e){this.si=t,this.ii=e,this.ri={}}return t.prototype.get=function(t){var e=this.si(t),n=this.ri[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.ii(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){zo(this.ri,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.nt=function(){return Go(this.ri)},t}(),oh=function(){function t(){this.oi=new ih(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}return t.prototype.ai=function(t){var e=this.oi.get(t);return e?e.readTime:Uo.min()},t.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},t.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},t.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?Qa.resolve(n.li):this.di(t,e)},t.prototype.getEntries=function(t,e){return this.wi(t,e)},t.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},t.prototype.hi=function(){},t}();function sh(t,e,n){var r=t.store(mc.store),i=t.store(wc.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ls({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){ho(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=wc.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Qa.$n(o).next(function(){return c})}function uh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw co();e=t.noDocument}return JSON.stringify(e).length}var ah=function(){function t(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}return t.Ai=function(e,n,r,i){return ho(""!==e.uid),new t(e.A()?e.uid:"",n,r,i)},t.prototype.Ri=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return hh(t).ls({index:mc.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Pi=function(t,e,n,r){var i=this,o=fh(t),s=hh(t);return s.add({}).next(function(u){ho("number"==typeof u);for(var a=new Lc(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return La(t.ks,e)}),i=n.mutations.map(function(e){return La(t.ks,e)});return new mc(e,n.batchId,n.Ss.toMillis(),r,i)}(i.Kt,i.userId,a),h=[],f=new Ju(function(t,e){return vo(t.ot(),e.ot())}),l=0,p=r;l<p.length;l++){var d=p[l],v=wc.key(i.userId,d.key.path,u);f=f.add(d.key.path.Z()),h.push(s.put(c)),h.push(o.put(v,wc.PLACEHOLDER))}return f.forEach(function(e){h.push(i.Ti.Us(t,e))}),t.Vs(function(){i.mi[u]=a.keys()}),Qa.$n(h).next(function(){return a})})},t.prototype.yi=function(t,e){var n=this;return hh(t).get(e).next(function(t){return t?(ho(t.userId===n.userId),Gc(n.Kt,t)):null})},t.prototype.gi=function(t,e){var n=this;return this.mi[e]?Qa.resolve(this.mi[e]):this.yi(t,e).next(function(t){if(t){var r=t.keys();return n.mi[e]=r,r}return null})},t.prototype.Vi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return hh(t).ls({index:mc.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(ho(e.batchId>=r),o=Gc(n.Kt,e)),i.done()}).next(function(){return o})},t.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return hh(t).ls({index:mc.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return hh(t).os(mc.userMutationsIndex,n).next(function(t){return t.map(function(t){return Gc(e.Kt,t)})})},t.prototype.vi=function(t,e){var n=this,r=wc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return fh(t).ls({range:i},function(r,i,s){var u=r[0],a=r[2],c=vc(r[1]);if(u===n.userId&&e.path.isEqual(c))return hh(t).get(a).next(function(t){if(!t)throw co();ho(t.userId===n.userId),o.push(Gc(n.Kt,t))});s.done()}).next(function(){return o})},t.prototype.Si=function(t,e){var n=this,r=new Ju(vo),i=[];return e.forEach(function(e){var o=wc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=fh(t).ls({range:s},function(t,i,o){var s=t[0],u=t[2],a=vc(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()});i.push(u)}),Qa.$n(i).next(function(){return n.Di(t,r)})},t.prototype.Ci=function(t,e){var n=this,r=e.path,i=r.length+1,o=wc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Ju(vo);return fh(t).ls({range:s},function(t,e,o){var s=t[0],a=t[2],c=vc(t[1]);s===n.userId&&r.st(c)?c.length===i&&(u=u.add(a)):o.done()}).next(function(){return n.Di(t,u)})},t.prototype.Di=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(hh(t).get(e).next(function(t){if(null===t)throw co();ho(t.userId===n.userId),r.push(Gc(n.Kt,t))}))}),Qa.$n(i).next(function(){return r})},t.prototype.xi=function(t,e){var n=this;return sh(t.bs,this.userId,e).next(function(r){return t.Vs(function(){n.Ni(e.batchId)}),Qa.forEach(r,function(e){return n.Ii.Oi(t,e)})})},t.prototype.Ni=function(t){delete this.mi[t]},t.prototype.Fi=function(t){var e=this;return this.Ri(t).next(function(n){if(!n)return Qa.resolve();var r=IDBKeyRange.lowerBound(wc.prefixForUser(e.userId)),i=[];return fh(t).ls({range:r},function(t,n,r){if(t[0]===e.userId){var o=vc(t[1]);i.push(o)}else r.done()}).next(function(){ho(0===i.length)})})},t.prototype.ki=function(t,e){return ch(t,this.userId,e)},t.prototype.Mi=function(t){var e=this;return lh(t).get(this.userId).next(function(t){return t||new gc(e.userId,-1,"")})},t}();function ch(t,e,n){var r=wc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return fh(t).ls({range:o,hs:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function hh(t){return Pc(t,mc.store)}function fh(t){return Pc(t,wc.store)}function lh(t){return Pc(t,gc.store)}var ph=function(){function t(t){this.Li=t}return t.prototype.next=function(){return this.Li+=2,this.Li},t.$i=function(){return new t(0)},t.Bi=function(){return new t(-1)},t}(),dh=function(){function t(t,e){this.Ii=t,this.Kt=e}return t.prototype.qi=function(t){var e=this;return this.Ui(t).next(function(n){var r=new ph(n.highestTargetId);return n.highestTargetId=r.next(),e.Qi(t,n).next(function(){return n.highestTargetId})})},t.prototype.Ki=function(t){return this.Ui(t).next(function(t){return Uo.j(new Lo(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.ji=function(t){return this.Ui(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.Wi=function(t,e,n){var r=this;return this.Ui(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Qi(t,i)})},t.prototype.Gi=function(t,e){var n=this;return this.zi(t,e).next(function(){return n.Ui(t).next(function(r){return r.targetCount+=1,n.Hi(e,r),n.Qi(t,r)})})},t.prototype.Ji=function(t,e){return this.zi(t,e)},t.prototype.Yi=function(t,e){var n=this;return this.Xi(t,e.targetId).next(function(){return vh(t).delete(e.targetId)}).next(function(){return n.Ui(t)}).next(function(e){return ho(e.targetCount>0),e.targetCount-=1,n.Qi(t,e)})},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return vh(t).ls(function(s,u){var a=Hc(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Yi(t,a)))}).next(function(){return Qa.$n(o)}).next(function(){return i})},t.prototype.mn=function(t,e){return vh(t).ls(function(t,n){var r=Hc(n);e(r)})},t.prototype.Ui=function(t){return yh(t).get(Sc.key).next(function(t){return ho(null!==t),t})},t.prototype.Qi=function(t,e){return yh(t).put(Sc.key,e)},t.prototype.zi=function(t,e){return vh(t).put(Kc(this.Kt,e))},t.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.tr=function(t){return this.Ui(t).next(function(t){return t.targetCount})},t.prototype.er=function(t,e){var n=Es(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return vh(t).ls({range:r,index:_c.queryTargetsIndexName},function(t,n,r){var o=Hc(n);_s(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.nr=function(t,e,n){var r=this,i=[],o=bh(t);return e.forEach(function(e){var s=lc(e.path);i.push(o.put(new jc(n,s))),i.push(r.Ii.sr(t,n,e))}),Qa.$n(i)},t.prototype.ir=function(t,e,n){var r=this,i=bh(t);return Qa.forEach(e,function(e){var o=lc(e.path);return Qa.$n([i.delete([n,o]),r.Ii.rr(t,n,e)])})},t.prototype.Xi=function(t,e){var n=bh(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.cr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=bh(t),i=ra();return r.ls({range:n,hs:!0},function(t,e,n){var r=vc(t[1]),o=new qo(r);i=i.add(o)}).next(function(){return i})},t.prototype.ki=function(t,e){var n=lc(e.path),r=IDBKeyRange.bound([n],[bo(n)],!1,!0),i=0;return bh(t).ls({index:jc.documentTargetsIndex,hs:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Dn=function(t,e){return vh(t).get(e).next(function(t){return t?Hc(t):null})},t}();function vh(t){return Pc(t,_c.store)}function yh(t){return Pc(t,Sc.store)}function bh(t){return Pc(t,jc.store)}function gh(t,e){var n=t[1],r=e[1],i=vo(t[0],e[0]);return 0===i?vo(n,r):i}var mh=function(){function t(t){this.ar=t,this.buffer=new Ju(gh),this.ur=0}return t.prototype.hr=function(){return++this.ur},t.prototype.lr=function(t){var e=[t,this.hr()];if(this.buffer.size<this.ar)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();gh(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),wh=function(){function t(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}return t.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},t.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(t.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),t.prototype.Er=function(t){var e=this,n=this.dr?3e5:6e4;oo("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",n,function(){return Object(no.b)(e,void 0,void 0,function(){var e;return Object(no.d)(this,function(n){switch(n.label){case 0:this.wr=null,this.dr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mr(this._r)];case 2:return n.sent(),[3,7];case 3:return rc(e=n.sent())?(oo("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,rh(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Er(t)];case 8:return n.sent(),[2]}})})})},t}(),Ih=function(){function t(t,e){this.Ar=t,this.params=e}return t.prototype.Rr=function(t,e){return this.Ar.Pr(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.yr=function(t,e){var n=this;if(0===e)return Qa.resolve(Po.U);var r=new mh(e);return this.Ar.mn(t,function(t){return r.lr(t.sequenceNumber)}).next(function(){return n.Ar.gr(t,function(t){return r.lr(t)})}).next(function(){return r.maxValue})},t.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},t.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},t.prototype.pr=function(t,e){var n=this;return-1===this.params.Hs?(oo("LruGarbageCollector","Garbage collection skipped; disabled"),Qa.resolve(eh)):this.br(t).next(function(r){return r<n.params.Hs?(oo("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Hs),eh):n.vr(t,e)})},t.prototype.br=function(t){return this.Ar.br(t)},t.prototype.vr=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.Rr(t,this.params.Js).next(function(e){return e>c.params.Ys?(oo("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Ys+" from "+e),r=c.params.Ys):r=e,o=Date.now(),c.yr(t,r)}).next(function(r){return n=r,s=Date.now(),c.Zi(t,n,e)}).next(function(e){return i=e,u=Date.now(),c.Vr(t,n)}).next(function(t){return a=Date.now(),io()<=Qt.a.DEBUG&&oo("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),Qa.resolve({js:!0,Ws:r,Gs:i,zs:t})})},t}(),Oh=function(){function t(t,e){this.db=t,this._r=function(t,e){return new Ih(t,e)}(this,e)}return t.prototype.Pr=function(t){var e=this.Sr(t);return this.db.Dr().tr(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Sr=function(t){var e=0;return this.gr(t,function(t){e++}).next(function(){return e})},t.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},t.prototype.gr=function(t,e){return this.Cr(t,function(t,n){return e(n)})},t.prototype.sr=function(t,e,n){return Th(t,n)},t.prototype.rr=function(t,e,n){return Th(t,n)},t.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},t.prototype.Oi=function(t,e){return Th(t,e)},t.prototype.Nr=function(t,e){return function(t,e){var n=!1;return lh(t)._s(function(r){return ch(t,r,e).next(function(t){return t&&(n=!0),Qa.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Vr=function(t,e){var n=this,r=this.db.Fr().Or(),i=[],o=0;return this.Cr(t,function(s,u){if(u<=e){var a=n.Nr(t,s).next(function(e){if(!e)return o++,r.fi(t,s).next(function(){return r._i(s),bh(t).delete([0,lc(s.path)])})});i.push(a)}}).next(function(){return Qa.$n(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.Lt(t.vs);return this.db.Dr().Ji(t,n)},t.prototype.kr=function(t,e){return Th(t,e)},t.prototype.Cr=function(t,e){var n,r=bh(t),i=Po.U;return r.ls({index:jc.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Po.U&&e(new qo(vc(n)),i),i=s,n=o):i=Po.U}).next(function(){i!==Po.U&&e(new qo(vc(n)),i)})},t.prototype.br=function(t){return this.db.Fr().Mr(t)},t}();function Th(t,e){return bh(t).put(function(t,e){return new jc(0,lc(t.path),e)}(e,t.vs))}var Eh=function(){function t(t,e){this.Kt=t,this.Ti=e}return t.prototype.ui=function(t,e,n){return Sh(t).put(xh(e),n)},t.prototype._i=function(t,e){var n=Sh(t),r=xh(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Lr(t,r)})},t.prototype.fi=function(t,e){var n=this;return Sh(t).get(xh(e)).next(function(t){return n.$r(t)})},t.prototype.Br=function(t,e){var n=this;return Sh(t).get(xh(e)).next(function(t){var e=n.$r(t);return e?{li:e,size:uh(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Wu();return this.qr(t,e,function(t,e){var i=n.$r(e);r=r.Ht(t,i)}).next(function(){return r})},t.prototype.Ur=function(t,e){var n=this,r=Wu(),i=new Gu(qo.J);return this.qr(t,e,function(t,e){var o=n.$r(e);o?(r=r.Ht(t,o),i=i.Ht(t,uh(e))):(r=r.Ht(t,null),i=i.Ht(t,0))}).next(function(){return{Qr:r,Kr:i}})},t.prototype.qr=function(t,e,n){if(e.nt())return Qa.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return Sh(t).ls({range:r},function(t,e,r){for(var s=qo.Tt(t);o&&qo.J(o,s)<0;)n(o,null),o=i.ce();o&&o.isEqual(s)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()}).next(function(){for(;o;)n(o,null),o=i.ae()?i.ce():null})},t.prototype.jr=function(t,e,n){var r=this,i=Zu(),o=e.path.length+1,s={};if(n.isEqual(Uo.min())){var u=e.path.rt();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.rt(),c=Fc(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Tc.collectionReadTimeIndex}return Sh(t).ls(s,function(t,n,s){if(t.length===o){var u=Mc(r.Kt,n);e.path.st(u.key.path)?u instanceof ms&&nu(e,u)&&(i=i.Ht(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Or=function(t){return new _h(this,!!t&&t.Wr)},t.prototype.Mr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return jh(t).get(Ec.key).next(function(t){return ho(!!t),t})},t.prototype.Lr=function(t,e){return jh(t).put(Ec.key,e)},t.prototype.$r=function(t){if(t){var e=Mc(this.Kt,t);return e instanceof ws&&e.version.isEqual(Uo.min())?null:e}return null},t}(),_h=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Gr=e,r.Wr=n,r.zr=new ih(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(no.c)(e,t),e.prototype.Ei=function(t){var e=this,n=[],r=0,i=new Ju(function(t,e){return vo(t.ot(),e.ot())});return this.oi.forEach(function(o,s){var u=e.zr.get(o);if(s.li){var a=Vc(e.Gr.Kt,s.li,e.ai(o));i=i.add(o.path.Z());var c=uh(a);r+=c-u,n.push(e.Gr.ui(t,o,a))}else if(r-=u,e.Wr){var h=Vc(e.Gr.Kt,new ws(o,Uo.min()),e.ai(o));n.push(e.Gr.ui(t,o,h))}else n.push(e.Gr._i(t,o))}),i.forEach(function(r){n.push(e.Gr.Ti.Us(t,r))}),n.push(this.Gr.updateMetadata(t,r)),Qa.$n(n)},e.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next(function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)})},e.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next(function(t){var e=t.Qr;return t.Kr.forEach(function(t,e){n.zr.set(t,e)}),e})},e}(oh);function jh(t){return Pc(t,Ec.store)}function Sh(t){return Pc(t,Tc.store)}function xh(t){return t.path.rt()}var Nh=function(){function t(t){this.Kt=t}return t.prototype.Yn=function(t,e,n,r){var i=this;ho(n<r&&n>=0&&r<=11);var o=new Za("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(bc.store)}(t),function(t){t.createObjectStore(gc.store,{keyPath:gc.keyPath}),t.createObjectStore(mc.store,{keyPath:mc.keyPath,autoIncrement:!0}).createIndex(mc.userMutationsIndex,mc.userMutationsKeyPath,{unique:!0}),t.createObjectStore(wc.store)}(t),Ah(t),function(t){t.createObjectStore(Tc.store)}(t));var s=Qa.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(jc.store),t.deleteObjectStore(_c.store),t.deleteObjectStore(Sc.store)}(t),Ah(t)),s=s.next(function(){return function(t){var e=t.store(Sc.store),n=new Sc(0,0,Uo.min().G(),0);return e.put(Sc.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(mc.store).os().next(function(n){t.deleteObjectStore(mc.store),t.createObjectStore(mc.store,{keyPath:mc.keyPath,autoIncrement:!0}).createIndex(mc.userMutationsIndex,mc.userMutationsKeyPath,{unique:!0});var r=e.store(mc.store),i=n.map(function(t){return r.put(t)});return Qa.$n(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Nc.store,{keyPath:Nc.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Hr(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Ec.store)}(t),i.Jr(o)})),n<7&&r>=7&&(s=s.next(function(){return i.Yr(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Xr(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Tc.store);e.createIndex(Tc.readTimeIndex,Tc.readTimeIndexPath,{unique:!1}),e.createIndex(Tc.collectionReadTimeIndex,Tc.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Zr(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(Ac.store,{keyPath:Ac.keyPath})}(t),function(t){t.createObjectStore(Dc.store,{keyPath:Dc.keyPath})}(t)})),s},t.prototype.Jr=function(t){var e=0;return t.store(Tc.store).ls(function(t,n){e+=uh(n)}).next(function(){var n=new Ec(e);return t.store(Ec.store).put(Ec.key,n)})},t.prototype.Hr=function(t){var e=this,n=t.store(gc.store),r=t.store(mc.store);return n.os().next(function(n){return Qa.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(mc.userMutationsIndex,i).next(function(r){return Qa.forEach(r,function(r){ho(r.userId===n.userId);var i=Gc(e.Kt,r);return sh(t,n.userId,i).next(function(){})})})})})},t.prototype.Yr=function(t){var e=t.store(jc.store),n=t.store(Tc.store);return t.store(Sc.store).get(Sc.key).next(function(t){var r=[];return n.ls(function(n,i){var o=new Mo(n),s=function(t){return[0,lc(t)]}(o);r.push(e.get(s).next(function(n){return n?Qa.resolve():function(n){return e.put(new jc(0,lc(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Qa.$n(r)})})},t.prototype.Xr=function(t,e){t.createObjectStore(xc.store,{keyPath:xc.keyPath});var n=e.store(xc.store),r=new Qc,i=function(t){if(r.add(t)){var e=t.et(),i=t.Z();return n.put({collectionId:e,parent:lc(i)})}};return e.store(Tc.store).ls({hs:!0},function(t,e){var n=new Mo(t);return i(n.Z())}).next(function(){return e.store(wc.store).ls({hs:!0},function(t,e){var n=vc(t[1]);return i(n.Z())})})},t.prototype.Zr=function(t){var e=this,n=t.store(_c.store);return n.ls(function(t,r){var i=Hc(r),o=Kc(e.Kt,i);return n.put(o)})},t}();function Ah(t){t.createObjectStore(jc.store,{keyPath:jc.keyPath}).createIndex(jc.documentTargetsIndex,jc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(_c.store,{keyPath:_c.keyPath}).createIndex(_c.queryTargetsIndexName,_c.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Sc.store)}var Dh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ch=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.eo=o,this.window=s,this.document=u,this.no=c,this.so=h,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!t.jn())throw new wo(mo.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new Oh(this,i),this.lo=n+"main",this.Kt=new Rc(a),this._o=new tc(this.lo,11,new Nh(this.Kt)),this.fo=new dh(this.Ii,this.Kt),this.Ti=new Zc,this.wo=function(t,e){return new Eh(t,e)}(this.Kt,this.Ti),this.Eo=new $c,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===h&&so("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.Io().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new wo(mo.FAILED_PRECONDITION,Dh);return t.mo(),t.Ao(),t.Ro(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.fo.ji(e)})}).then(function(e){t.io=new Po(e,t.no)}).then(function(){t.ro=!0}).catch(function(e){return t._o&&t._o.close(),Promise.reject(e)})},t.prototype.Po=function(t){var e=this;return this.ho=function(n){return Object(no.b)(e,void 0,void 0,function(){return Object(no.d)(this,function(e){return this.Tr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.yo=function(t){var e=this;this._o.Zn(function(n){return Object(no.b)(e,void 0,void 0,function(){return Object(no.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys(function(){return Object(no.b)(e,void 0,void 0,function(){return Object(no.d)(this,function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Io=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Ph(e).put(new Nc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.po(e).next(function(e){e||(t.isPrimary=!1,t.eo.bo(function(){return t.ho(!1)}))})}).next(function(){return t.vo(e)}).next(function(n){return t.isPrimary&&!n?t.So(e).next(function(){return!1}):!!n&&t.Do(e).next(function(){return!0})})}).catch(function(e){if(rc(e))return oo("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return oo("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.eo.bo(function(){return t.ho(e)}),t.isPrimary=e})},t.prototype.po=function(t){var e=this;return kh(t).get(bc.key).next(function(t){return Qa.resolve(e.Co(t))})},t.prototype.xo=function(t){return Ph(t).delete(this.clientId)},t.prototype.No=function(){return Object(no.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(no.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.Oo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=Pc(t,Nc.store);return e.os().next(function(t){var n=r.Fo(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return Qa.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.To)for(e=0,n=t;e<n.length;e++)this.To.removeItem(this.ko(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,function(){return t.Io().then(function(){return t.No()}).then(function(){return t.Ro()})})},t.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.vo=function(t){var e=this;return this.so?Qa.resolve(!0):kh(t).get(bc.key).next(function(n){if(null!==n&&e.Oo(n.leaseTimestampMs,5e3)&&!e.Mo(n.ownerId)){if(e.Co(n)&&e.networkEnabled)return!0;if(!e.Co(n)){if(!n.allowTabSynchronization)throw new wo(mo.FAILED_PRECONDITION,Dh);return!1}}return!(!e.networkEnabled||!e.inForeground)||Ph(t).os().next(function(t){return void 0===e.Fo(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&oo("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.Lo=function(){return Object(no.b)(this,void 0,void 0,function(){var t=this;return Object(no.d)(this,function(e){switch(e.label){case 0:return this.ro=!1,this.$o(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[bc.store,Nc.store],function(e){var n=new kc(e,Po.U);return t.So(n).next(function(){return t.xo(n)})})];case 1:return e.sent(),this._o.close(),this.Uo(),[2]}})})},t.prototype.Fo=function(t,e){var n=this;return t.filter(function(t){return n.Oo(t.updateTimeMs,e)&&!n.Mo(t.clientId)})},t.prototype.Qo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return Ph(e).os().next(function(e){return t.Fo(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.Ko=function(t){return ah.Ai(t,this.Kt,this.Ti,this.Ii)},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.jo=function(){return this.Ti},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r,i=this;return oo("IndexedDbPersistence","Starting transaction:",t),this._o.runTransaction(t,"readonly"===e?"readonly":"readwrite",Cc,function(o){return r=new kc(o,i.io?i.io.next():Po.U),"readwrite-primary"===e?i.po(r).next(function(t){return!!t||i.vo(r)}).next(function(e){if(!e)throw so("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.eo.bo(function(){return i.ho(!1)}),new wo(mo.FAILED_PRECONDITION,hc);return n(r)}).next(function(t){return i.Do(r).next(function(){return t})}):i.Go(r).next(function(){return n(r)})}).then(function(t){return r.ps(),t})},t.prototype.Go=function(t){var e=this;return kh(t).get(bc.key).next(function(t){if(null!==t&&e.Oo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new wo(mo.FAILED_PRECONDITION,Dh)})},t.prototype.Do=function(t){var e=new bc(this.clientId,this.allowTabSynchronization,Date.now());return kh(t).put(bc.key,e)},t.jn=function(){return tc.jn()},t.prototype.So=function(t){var e=this,n=kh(t);return n.get(bc.key).next(function(t){return e.Co(t)?(oo("IndexedDbPersistence","Releasing primary lease."),n.delete(bc.key)):Qa.resolve()})},t.prototype.Oo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(so("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()})},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},t.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.$o(),e.eo.ys(function(){return e.Lo()})},this.window.addEventListener("unload",this.oo))},t.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},t.prototype.Mo=function(t){var e;try{var n=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return oo("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return so("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.$o=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){so("Failed to set zombie client id.",t)}},t.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},t.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function kh(t){return Pc(t,bc.store)}function Ph(t){return Pc(t,Nc.store)}function Lh(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Uh=function(t,e){this.progress=t,this.zo=e},Rh=function(){function t(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}return t.prototype.Jo=function(t,e){var n=this;return this.Ho.vi(t,e).next(function(r){return n.Yo(t,e,r)})},t.prototype.Yo=function(t,e,n){return this.wo.fi(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].xs(e,t);return t})},t.prototype.Xo=function(t,e,n){var r=Wu();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].xs(t,e);r=r.Ht(t,e)}),r},t.prototype.Zo=function(t,e){var n=this;return this.wo.getEntries(t,e).next(function(e){return n.tc(t,e)})},t.prototype.tc=function(t,e){var n=this;return this.Ho.Si(t,e).next(function(r){var i=n.Xo(t,e,r),o=Xu();return i.forEach(function(t,e){e||(e=new ws(t,Uo.min())),o=o.Ht(t,e)}),o})},t.prototype.jr=function(t,e,n){return function(t){return qo.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ec(t,e.path):Ys(e)?this.nc(t,e,n):this.sc(t,e,n)},t.prototype.ec=function(t,e){return this.Jo(t,new qo(e)).next(function(t){var e=Zu();return t instanceof ms&&(e=e.Ht(t.key,t)),e})},t.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=Zu();return this.Ti.Qs(t,i).next(function(s){return Qa.forEach(s,function(s){var u=function(t,e){return new Bs(e,null,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.sc(t,u,n).next(function(t){t.forEach(function(t,e){o=o.Ht(t,e)})})}).next(function(){return o})})},t.prototype.sc=function(t,e,n){var r,i,o=this;return this.wo.jr(t,e,n).next(function(n){return r=n,o.Ho.Ci(t,e)}).next(function(e){return o.ic(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=Su(a,r.get(c),0,o.Ss);r=h instanceof ms?r.Ht(c,h):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){nu(e,n)||(r=r.remove(t))}),r})},t.prototype.ic=function(t,e,n){for(var r=ra(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Cu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ms&&(c=c.Ht(t,e))}),c})},t}(),Mh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}return t.cc=function(e,n){for(var r=ra(),i=ra(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Vh=function(){function t(){}return t.prototype.ac=function(t){this.uc=t},t.prototype.jr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Nt.length||1===t.Nt.length&&t.Nt[0].field.ht())}(e)||n.isEqual(Uo.min())?this.hc(t,e):this.uc.Zo(t,r).next(function(o){var s=i.lc(e,o);return(Hs(e)||Ks(e))&&i._c(e.limitType,s,r,n)?i.hc(t,e):(io()<=Qt.a.DEBUG&&oo("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),eu(e)),i.uc.jr(t,e,n).next(function(t){return s.forEach(function(e){t=t.Ht(e.key,e)}),t}))})},t.prototype.lc=function(t,e){var n=new Ju(ru(t));return e.forEach(function(e,r){r instanceof ms&&nu(t,r)&&(n=n.add(r))}),n},t.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.hc=function(t,e){return io()<=Qt.a.DEBUG&&oo("QueryEngine","Using full collection scan to execute query:",eu(e)),this.uc.jr(t,e,Uo.min())},t}(),Fh=function(){function t(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new Gu(vo),this.wc=new ih(function(t){return Es(t)},_s),this.Ec=Uo.min(),this.Ho=t.Ko(n),this.Tc=t.Fr(),this.fo=t.Dr(),this.Ic=new Rh(this.Tc,this.Ho,this.persistence.jo()),this.Eo=t.Wo(),this.fc.ac(this.Ic)}return t.prototype.mr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.pr(n,e.dc)})},t}();function qh(t,e,n,r){return new Fh(t,e,n,r)}function Bh(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(no.d)(this,function(s){switch(s.label){case 0:return n=fo(t),r=n.Ho,i=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.Ho.bi(t).next(function(s){return o=s,r=n.persistence.Ko(e),i=new Rh(n.Tc,r,n.persistence.jo()),r.bi(t)}).next(function(e){for(var n=[],r=[],s=ra(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)s=s.add(y[v].key)}return i.Zo(t,s).next(function(t){return{mc:t,Ac:n,Rc:r}})})})];case 1:return o=s.sent(),[2,(n.Ho=r,n.Ic=i,n.fc.ac(n.Ic),o)]}})})}function zh(t,e){var n=fo(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Tc.Or({Wr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Qa.resolve();return o.forEach(function(t){s=s.next(function(){return r.fi(e,t)}).next(function(e){var o=e,s=n.Fs.get(t);ho(null!==s),(!o||o.version.u(s)<0)&&(o=i.Ds(t,o,n))&&r.ui(o,n.Os)})}),s.next(function(){return t.Ho.xi(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.Ho.Fi(t)}).next(function(){return n.Ic.Zo(t,r)})})}function Gh(t){var e=fo(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function Hh(t,e){var n=fo(t),r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Tc.Or({Wr:!0});i=n.dc;var s=[];e.Fe.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.fo.ir(t,e.Ke,o).next(function(){return n.fo.nr(t,e.Ue,o)}));var a=e.resumeToken;if(a.o()>0){var c=u.$t(a,r).Lt(t.vs);i=i.Ht(o,c),function(t,e,n){return ho(e.resumeToken.o()>0),0===t.resumeToken.o()||e.Mt.W()-t.Mt.W()>=3e8||n.Ue.size+n.Qe.size+n.Ke.size>0}(u,c,e)&&s.push(n.fo.Ji(t,c))}}});var u=Xu();if(e.Me.forEach(function(r,i){e.Le.has(r)&&s.push(n.persistence.Ii.kr(t,r))}),s.push(Kh(t,o,e.Me,r,void 0).next(function(t){u=t})),!r.isEqual(Uo.min())){var a=n.fo.Ki(t).next(function(e){return n.fo.Wi(t,t.vs,r)});s.push(a)}return Qa.$n(s).next(function(){return o.apply(t)}).next(function(){return n.Ic.tc(t,u)})}).then(function(t){return n.dc=i,t})}function Kh(t,e,n,r,i){var o=ra();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=Xu();return n.forEach(function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof ws&&s.version.isEqual(Uo.min())?(e._i(n,a),o=o.Ht(n,s)):null==u||s.version.u(u.version)>0||0===s.version.u(u.version)&&u.hasPendingWrites?(e.ui(s,a),o=o.Ht(n,s)):oo("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)}),o})}function Jh(t,e){var n=fo(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Ho.Vi(t,e)})}function $h(t,e){var n=fo(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.fo.er(t,e).next(function(i){return i?Qa.resolve(r=i):n.fo.qi(t).next(function(i){return r=new ou(e,i,0,t.vs),n.fo.Gi(t,r).next(function(){return r})})})}).then(function(t){var r=n.dc.get(t.targetId);return(null===r||t.Mt.u(r.Mt)>0)&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t})}function Yh(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(no.d)(this,function(u){switch(u.label){case 0:r=fo(t),i=r.dc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Ii.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!rc(s=u.sent()))throw s;return oo("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(i.target),[2]}})})}function Xh(t,e,n){var r=fo(t),i=Uo.min(),o=ra();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=fo(t),i=r.wc.get(n);return void 0!==i?Qa.resolve(r.dc.get(i)):r.fo.er(e,n)}(r,t,Ws(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.fo.cr(t,e.targetId).next(function(t){o=t})}).next(function(){return r.fc.jr(t,e,n?i:Uo.min(),n?o:ra())}).next(function(t){return{documents:t,Pc:o}})})}function Wh(t,e){var n=fo(t),r=fo(n.fo),i=n.dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function Qh(t){var e=fo(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=fo(t),i=Xu(),o=Fc(n),s=Sh(e),u=IDBKeyRange.lowerBound(o,!0);return s.ls({index:Tc.readTimeIndex,range:u},function(t,e){var n=Mc(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{zo:i,readTime:qc(o)}})}(e.Tc,t,e.Ec)}).then(function(t){var n=t.zo;return e.Ec=t.readTime,n})}function Zh(t){return Object(no.b)(this,void 0,void 0,function(){var e;return Object(no.d)(this,function(n){return[2,(e=fo(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Sh(t),n=Uo.min();return e.ls({index:Tc.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=qc(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.Ec=t})]})})}function tf(t,e,n,r){return Object(no.b)(this,void 0,void 0,function(){var i,o,s,u,a,c,h,f,l,p;return Object(no.d)(this,function(d){switch(d.label){case 0:for(i=fo(t),o=ra(),s=Xu(),u=ea(),a=0,c=n;a<c.length;a++)f=e.yc((h=c[a]).metadata.name),h.document&&(o=o.add(f)),s=s.Ht(f,e.gc(h)),u=u.Ht(f,e.Vc(h.metadata.readTime));return l=i.Tc.Or({Wr:!0}),[4,$h(i,function(t){return Ws(Gs(Mo.ct("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return Kh(t,l,s,Uo.min(),u).next(function(e){return l.apply(t),e}).next(function(e){return i.fo.Xi(t,p.targetId).next(function(){return i.fo.nr(t,o,p.targetId)}).next(function(){return i.Ic.tc(t,e)})})})]}})})}function ef(t,e,n){return void 0===n&&(n=ra()),Object(no.b)(this,void 0,void 0,function(){var r,i;return Object(no.d)(this,function(o){switch(o.label){case 0:return[4,$h(t,Ws(Jc(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=fo(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Ea(e.readTime);if(r.Mt.u(o)>=0)return i.Eo.Bs(t,e);var s=r.$t(go.h,o);return i.dc=i.dc.Ht(s.targetId,s),i.fo.Ji(t,s).next(function(){return i.fo.Xi(t,r.targetId)}).next(function(){return i.fo.nr(t,n,r.targetId)}).next(function(){return i.Eo.Bs(t,e)})})]}})})}var nf=function(){function t(t){this.Kt=t,this.bc=new Map,this.vc=new Map}return t.prototype.Ms=function(t,e){return Qa.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){var n;return this.bc.set(e.id,{id:(n=e).id,version:n.version,createTime:Ea(n.createTime)}),Qa.resolve()},t.prototype.$s=function(t,e){return Qa.resolve(this.vc.get(e))},t.prototype.Bs=function(t,e){return this.vc.set(e.name,function(t){return{name:t.name,query:Jc(t.bundledQuery),readTime:Ea(t.readTime)}}(e)),Qa.resolve()},t}(),rf=function(){function t(){this.Sc=new Ju(of.Dc),this.Cc=new Ju(of.xc)}return t.prototype.nt=function(){return this.Sc.nt()},t.prototype.sr=function(t,e){var n=new of(t,e);this.Sc=this.Sc.add(n),this.Cc=this.Cc.add(n)},t.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},t.prototype.rr=function(t,e){this.Oc(new of(t,e))},t.prototype.Fc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},t.prototype.kc=function(t){var e=this,n=new qo(new Mo([])),r=new of(n,t),i=new of(n,t+1),o=[];return this.Cc.Ae([r,i],function(t){e.Oc(t),o.push(t.key)}),o},t.prototype.Mc=function(){var t=this;this.Sc.forEach(function(e){return t.Oc(e)})},t.prototype.Oc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},t.prototype.Lc=function(t){var e=new qo(new Mo([])),n=new of(e,t),r=new of(e,t+1),i=ra();return this.Cc.Ae([n,r],function(t){i=i.add(t.key)}),i},t.prototype.ki=function(t){var e=new of(t,0),n=this.Sc.Pe(e);return null!==n&&t.isEqual(n.key)},t}(),of=function(){function t(t,e){this.key=t,this.$c=e}return t.Dc=function(t,e){return qo.J(t.key,e.key)||vo(t.$c,e.$c)},t.xc=function(t,e){return vo(t.$c,e.$c)||qo.J(t.key,e.key)},t}(),sf=function(){function t(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new Ju(of.Dc)}return t.prototype.Ri=function(t){return Qa.resolve(0===this.Ho.length)},t.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++;var o=new Lc(i,e,n,r);this.Ho.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.qc=this.qc.add(new of(a.key,i)),this.Ti.Us(t,a.key.path.Z())}return Qa.resolve(o)},t.prototype.yi=function(t,e){return Qa.resolve(this.Uc(e))},t.prototype.Vi=function(t,e){var n=this.Qc(e+1),r=n<0?0:n;return Qa.resolve(this.Ho.length>r?this.Ho[r]:null)},t.prototype.pi=function(){return Qa.resolve(0===this.Ho.length?-1:this.Bc-1)},t.prototype.bi=function(t){return Qa.resolve(this.Ho.slice())},t.prototype.vi=function(t,e){var n=this,r=new of(e,0),i=new of(e,Number.POSITIVE_INFINITY),o=[];return this.qc.Ae([r,i],function(t){var e=n.Uc(t.$c);o.push(e)}),Qa.resolve(o)},t.prototype.Si=function(t,e){var n=this,r=new Ju(vo);return e.forEach(function(t){var e=new of(t,0),i=new of(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,i],function(t){r=r.add(t.$c)})}),Qa.resolve(this.Kc(r))},t.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,i=n;qo.Et(i)||(i=i.child(""));var o=new of(new qo(i),0),s=new Ju(vo);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(s=s.add(t.$c)),!0)},o),Qa.resolve(this.Kc(s))},t.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Uc(t);null!==r&&n.push(r)}),n},t.prototype.xi=function(t,e){var n=this;ho(0===this.jc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return Qa.forEach(e.mutations,function(i){var o=new of(i.key,e.batchId);return r=r.delete(o),n.Ii.Oi(t,i.key)}).next(function(){n.qc=r})},t.prototype.Ni=function(t){},t.prototype.ki=function(t,e){var n=new of(e,0),r=this.qc.Pe(n);return Qa.resolve(e.isEqual(r&&r.key))},t.prototype.Fi=function(t){return Qa.resolve()},t.prototype.jc=function(t,e){return this.Qc(t)},t.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},t.prototype.Uc=function(t){var e=this.Qc(t);return e<0||e>=this.Ho.length?null:this.Ho[e]},t}(),uf=function(){function t(t,e){this.Ti=t,this.Wc=e,this.docs=new Gu(qo.J),this.size=0}return t.prototype.ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Wc(e);return this.docs=this.docs.Ht(r,{li:e,size:s,readTime:n}),this.size+=s-o,this.Ti.Us(t,r.path.Z())},t.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.fi=function(t,e){var n=this.docs.get(e);return Qa.resolve(n?n.li:null)},t.prototype.getEntries=function(t,e){var n=this,r=Wu();return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),Qa.resolve(r)},t.prototype.jr=function(t,e,n){for(var r=Zu(),i=new qo(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.value,a=u.li,c=u.readTime;if(!e.path.st(s.key.path))break;c.u(n)<=0||a instanceof ms&&nu(e,a)&&(r=r.Ht(a.key,a))}return Qa.resolve(r)},t.prototype.Gc=function(t,e){return Qa.forEach(this.docs,function(t){return e(t)})},t.prototype.Or=function(t){return new af(this)},t.prototype.Mr=function(t){return Qa.resolve(this.size)},t}(),af=function(t){function e(e){var n=this;return(n=t.call(this)||this).Gr=e,n}return Object(no.c)(e,t),e.prototype.Ei=function(t){var e=this,n=[];return this.oi.forEach(function(r,i){i&&i.li?n.push(e.Gr.ui(t,i.li,e.ai(r))):e.Gr._i(r)}),Qa.$n(n)},e.prototype.di=function(t,e){return this.Gr.fi(t,e)},e.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},e}(oh),cf=function(){function t(t){this.persistence=t,this.zc=new ih(function(t){return Es(t)},_s),this.lastRemoteSnapshotVersion=Uo.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new rf,this.targetCount=0,this.Yc=ph.$i()}return t.prototype.mn=function(t,e){return this.zc.forEach(function(t,n){return e(n)}),Qa.resolve()},t.prototype.Ki=function(t){return Qa.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ji=function(t){return Qa.resolve(this.Hc)},t.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),Qa.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),Qa.resolve()},t.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new ph(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},t.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,Qa.resolve()},t.prototype.Ji=function(t,e){return this.zi(e),Qa.resolve()},t.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),this.targetCount-=1,Qa.resolve()},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.zc.delete(s),o.push(r.Xi(t,u.targetId)),i++)}),Qa.$n(o).next(function(){return i})},t.prototype.tr=function(t){return Qa.resolve(this.targetCount)},t.prototype.er=function(t,e){var n=this.zc.get(e)||null;return Qa.resolve(n)},t.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),Qa.resolve()},t.prototype.ir=function(t,e,n){this.Jc.Fc(e,n);var r=this.persistence.Ii,i=[];return r&&e.forEach(function(e){i.push(r.Oi(t,e))}),Qa.$n(i)},t.prototype.Xi=function(t,e){return this.Jc.kc(e),Qa.resolve()},t.prototype.cr=function(t,e){var n=this.Jc.Lc(e);return Qa.resolve(n)},t.prototype.ki=function(t,e){return Qa.resolve(this.Jc.ki(e))},t}(),hf=function(){function t(t,e){var n=this;this.Xc={},this.io=new Po(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new cf(this),this.Ti=new Wc,this.wo=function(t,e){return new uf(t,function(t){return n.Ii.Zc(t)})}(this.Ti),this.Kt=new Rc(e),this.Eo=new nf(this.Kt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Lo=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.yo=function(){},t.prototype.Vo=function(){},t.prototype.jo=function(){return this.Ti},t.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new sf(this.Ti,this.Ii),this.Xc[t.R()]=e),e},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r=this;oo("MemoryPersistence","Starting transaction:",t);var i=new ff(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},t.prototype.na=function(t,e){return Qa.Bn(Object.values(this.Xc).map(function(n){return function(){return n.ki(t,e)}}))},t}(),ff=function(t){function e(e){var n=this;return(n=t.call(this)||this).vs=e,n}return Object(no.c)(e,t),e}(fc),lf=function(){function t(t){this.persistence=t,this.sa=new rf,this.ia=null}return t.ra=function(e){return new t(e)},Object.defineProperty(t.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw co()},enumerable:!1,configurable:!0}),t.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),Qa.resolve()},t.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),Qa.resolve()},t.prototype.Oi=function(t,e){return this.oa.add(e.toString()),Qa.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},t.prototype.ta=function(){this.ia=new Set},t.prototype.ea=function(t){var e=this,n=this.persistence.Fr().Or();return Qa.forEach(this.oa,function(r){var i=qo.ft(r);return e.ca(t,i).next(function(t){t||n._i(i)})}).next(function(){return e.ia=null,n.apply(t)})},t.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},t.prototype.Zc=function(t){return 0},t.prototype.ca=function(t,e){var n=this;return Qa.Bn([function(){return Qa.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},t}();function pf(t,e){return"firestore_clients_"+t+"_"+e}function df(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.A()&&(r+="_"+e.uid),r}function vf(t,e){return"firestore_targets_"+t+"_"+e}var yf=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.aa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new wo(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(so("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),bf=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.aa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new wo(r.error.code,r.error.message)),i?new t(e,r.state,o):(so("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),gf=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.aa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=oa(),s=0;i&&s<r.activeTargetIds.length;++s)i=es(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(so("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),mf=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.aa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(so("SharedClientState","Failed to parse online state: "+e),null)},t}(),wf=function(){function t(){this.activeTargetIds=oa()}return t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),If=function(){function t(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new Gu(vo),this.Tr=!1,this.Ia=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=pf(this.persistenceKey,this._a),this.Aa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ta=this.Ta.Ht(this._a,new wf),this.Ra=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ga=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Va=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wa)}return t.jn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(no.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object(no.d)(this,function(f){switch(f.label){case 0:return[4,this.fa.Qo()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(pf(this.persistenceKey,r)))&&(o=gf.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(u=this.ba(s))&&this.va(u),a=0,c=this.Ia;a<c.length;a++)this.Ea(c[a]);return this.Ia=[],this.window.addEventListener("unload",function(){return h.Lo()}),this.Tr=!0,[2]}})})},t.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},t.prototype.Sa=function(){return this.Da(this.Ta)},t.prototype.Ca=function(t){var e=!1;return this.Ta.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.xa=function(t){this.Na(t,"pending")},t.prototype.Oa=function(t,e,n){this.Na(t,e,n),this.Fa(t)},t.prototype.ka=function(t){var e="not-current";if(this.Ca(t)){var n=this.storage.getItem(vf(this.persistenceKey,t));if(n){var r=bf.aa(t,n);r&&(e=r.state)}}return this.Ma.ha(t),this.pa(),e},t.prototype.La=function(t){this.Ma.la(t),this.pa()},t.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},t.prototype.Ba=function(t){this.removeItem(vf(this.persistenceKey,t))},t.prototype.qa=function(t,e,n){this.Ua(t,e,n)},t.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Fa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},t.prototype.Ka=function(t){this.ja(t)},t.prototype.Wa=function(){this.Ga()},t.prototype.Lo=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return oo("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){oo("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){oo("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(oo("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void so("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.eo.bo(function(){return Object(no.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(no.d)(this,function(u){if(this.Tr){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(e=this.Ja(n.key,n.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Ya(n.key,n.newValue)))return[2,this.Xa(r)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(i=this.Za(n.key,n.newValue)))return[2,this.tu(i)]}else if(n.key===this.ga){if(null!==n.newValue&&(o=this.ba(n.newValue)))return[2,this.va(o)]}else if(n.key===this.Aa)(s=function(t){var e=Po.U;if(null!=t)try{var n=JSON.parse(t);ho("number"==typeof n),e=n}catch(t){so("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Po.U&&this.L(s);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),t.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},t.prototype.Na=function(t,e,n){var r=new yf(this.currentUser,t,e,n),i=df(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ua())},t.prototype.Fa=function(t){var e=df(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.ja=function(t){this.storage.setItem(this.ga,JSON.stringify({clientId:this._a,onlineState:t}))},t.prototype.Ua=function(t,e,n){var r=vf(this.persistenceKey,t),i=new bf(t,e,n);this.setItem(r,i.ua())},t.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},t.prototype.za=function(t){var e=this.Ra.exec(t);return e?e[1]:null},t.prototype.Ja=function(t,e){var n=this.za(t);return gf.aa(n,e)},t.prototype.Ya=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return yf.aa(new xo(void 0!==n[2]?n[2]:null),r,e)},t.prototype.Za=function(t,e){var n=this.ya.exec(t),r=Number(n[1]);return bf.aa(r,e)},t.prototype.ba=function(t){return mf.aa(t)},t.prototype.Xa=function(t){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(oo("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},t.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fa.iu(s,u).then(function(){n.Ta=r})},t.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},t.prototype.Da=function(t){var e=oa();return t.forEach(function(t,n){e=e.ye(n.activeTargetIds)}),e},t}(),Of=function(){function t(){this.ru=new wf,this.ou={},this.da=null,this.L=null}return t.prototype.xa=function(t){},t.prototype.Oa=function(t,e,n){},t.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},t.prototype.qa=function(t,e,n){this.ou[t]=e},t.prototype.La=function(t){this.ru.la(t)},t.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.Ba=function(t){delete this.ou[t]},t.prototype.Sa=function(){return this.ru.activeTargetIds},t.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.start=function(){return this.ru=new wf,Promise.resolve()},t.prototype.Qa=function(t,e,n){},t.prototype.Ka=function(t){},t.prototype.Lo=function(){},t.prototype.q=function(t){},t.prototype.Wa=function(){},t}(),Tf=function(){function t(){}return t.prototype.cu=function(t){},t.prototype.Lo=function(){},t}(),Ef=function(){function t(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}return t.prototype.cu=function(t){this._u.push(t)},t.prototype.Lo=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},t.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},t.prototype.uu=function(){oo("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},t.prototype.lu=function(){oo("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},t.jn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),_f={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},jf=function(){function t(t){this.du=t.du,this.wu=t.wu}return t.prototype.Eu=function(t){this.Tu=t},t.prototype.Iu=function(t){this.mu=t},t.prototype.onMessage=function(t){this.Au=t},t.prototype.close=function(){this.wu()},t.prototype.send=function(t){this.du(t)},t.prototype.Ru=function(){this.Tu()},t.prototype.Pu=function(t){this.mu(t)},t.prototype.yu=function(t){this.Au(t)},t}(),Sf=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.I=e.I,n}return Object(no.c)(e,t),e.prototype.Du=function(t,e,n,r){return new Promise(function(i,o){var s=new eo;s.listenOnce(Qi.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Wi.NO_ERROR:var e=s.getResponseJson();oo("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Wi.TIMEOUT:oo("Connection",'RPC "'+t+'" timed out'),o(new wo(mo.DEADLINE_EXCEEDED,"Request time out"));break;case Wi.HTTP_ERROR:var n=s.getStatus();if(oo("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(mo).indexOf(e)>=0?e:mo.UNKNOWN}(r.status);o(new wo(u,r.message))}else o(new wo(mo.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new wo(mo.UNAVAILABLE,"Connection failed."));break;default:co()}}finally{oo("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.xu=function(t,e){var n=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Ki,i=Yn(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(o.initMessageHeaders,e),Object(Zt.l)()||Object(Zt.n)()||Object(Zt.j)()||Object(Zt.k)()||Object(Zt.o)()||Object(Zt.i)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");oo("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new jf({du:function(t){c?oo("Connection","Not sending because WebChannel is closed:",t):(a||(oo("Connection","Opening WebChannel transport."),u.open(),a=!0),oo("Connection","WebChannel sending:",t),u.send(t))},wu:function(){return u.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,to.EventType.OPEN,function(){c||oo("Connection","WebChannel transport opened.")}),f(u,to.EventType.CLOSE,function(){c||(c=!0,oo("Connection","WebChannel transport closed"),h.Pu())}),f(u,to.EventType.ERROR,function(t){c||(c=!0,uo("Connection","WebChannel transport errored:",t),h.Pu(new wo(mo.UNAVAILABLE,"The operation could not be completed")))}),f(u,to.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];ho(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){oo("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=Ru[t];if(void 0!==e)return zu(e)}(i),s=r.message;void 0===o&&(o=mo.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Pu(new wo(o,s)),u.close()}else oo("Connection","WebChannel received:",n),h.yu(n)}}),f(i,Zi.STAT_EVENT,function(t){10===t.stat?oo("Connection","Detected buffering proxy"):11===t.stat&&oo("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Ru()},0),h},e}(function(){function t(t){this.gu=t,this.T=t.T,this.Vu=(t.ssl?"https":"http")+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}return t.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);oo("RestConnection","Sending: ",i,n);var o={};return this.Su(o,r),this.Du(t,i,o,n).then(function(t){return oo("RestConnection","Received: ",t),t},function(e){throw uo("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},t.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.2",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},t.prototype.vu=function(t,e){return this.Vu+"/v1/"+e+":"+_f[t]},t}());function xf(){return"undefined"!=typeof window?window:null}function Nf(){return"undefined"!=typeof document?document:null}function Af(t){return new wa(t,!0)}var Df=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Ou=r,this.Fu=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}return t.prototype.reset=function(){this.ku=0},t.prototype.$u=function(){this.ku=this.Fu},t.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);i>0&&oo("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,function(){return e.Lu=Date.now(),t()}),this.ku*=this.Ou,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Fu&&(this.ku=this.Fu)},t.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},t.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},t.prototype.qu=function(){return(Math.random()-.5)*this.ku},t}(),Cf=function(){function t(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.ju=i,this.listener=o,this.state=0,this.Wu=0,this.Gu=null,this.stream=null,this.zu=new Df(t,e)}return t.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ju=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Yu()},t.prototype.stop=function(){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Xu=function(){this.state=0,this.zu.reset()},t.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,function(){return t.th()}))},t.prototype.eh=function(t){this.nh(),this.stream.send(t)},t.prototype.th=function(){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},t.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},t.prototype.close=function(t,e){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.Wu++,3!==t?this.zu.reset():e&&e.code===mo.RESOURCE_EXHAUSTED?(so(e.toString()),so("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===mo.UNAUTHENTICATED&&this.ju.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}})})},t.prototype.sh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.Wu),n=this.Wu;this.ju.getToken().then(function(e){t.Wu===n&&t.rh(e)},function(n){e(function(){var e=new wo(mo.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)})})},t.prototype.rh=function(t){var e=this,n=this.ih(this.Wu);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return Object(no.b)(t,void 0,void 0,function(){return Object(no.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.oh=function(t){return oo("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ih=function(t){var e=this;return function(n){e.eo.ys(function(){return e.Wu===t?n():(oo("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),kf=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Kt=i,s}return Object(no.c)(e,t),e.prototype.ah=function(t){return this.Ku.xu("Listen",t)},e.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:co()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.qt?(ho(void 0===e||"string"==typeof e),go.fromBase64String(e||"")):(ho(void 0===e||e instanceof Uint8Array),go.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?mo.UNKNOWN:zu(t.code);return new wo(e,t.message||"")}(u);n=new pa(r,i,o,s||null)}else if("documentChange"in e){i=xa(t,(r=e.documentChange).document.name),o=Ea(r.document.updateTime);var u=new vs({mapValue:{fields:r.document.fields}}),a=(s=new ms(i,o,u,{}),r.targetIds||[]);n=new fa(a,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=xa(t,(r=e.documentDelete).document),o=r.readTime?Ea(r.readTime):Uo.min(),u=new ws(i,o),n=new fa([],s=r.removedTargetIds||[],u.key,u);else if("documentRemove"in e)i=xa(t,(r=e.documentRemove).document),n=new fa([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return co();var c=e.filter;i=new qu(r=c.count||0),n=new la(o=c.targetId,i)}return n}(this.Kt,t),n=function(t){if(!("targetChange"in t))return Uo.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Uo.min():e.readTime?Ea(e.readTime):Uo.min()}(t);return this.listener.uh(e,n)},e.prototype.hh=function(t){var e={};e.database=Da(this.Kt),e.addTarget=function(t,e){var n,r=e.target;return(n=js(r)?{documents:Ra(t,r)}:{query:Ma(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=Oa(t,e.resumeToken):e.Mt.u(Uo.min())>0&&(n.readTime=Ia(t,e.Mt.G())),n}(this.Kt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return co()}}(0,e.kt);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.eh(e)},e.prototype.lh=function(t){var e={};e.database=Da(this.Kt),e.removeTarget=t,this.eh(e)},e}(Cf),Pf=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Kt=i,s._h=!1,s}return Object(no.c)(e,t),Object.defineProperty(e.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.sh=function(){this._h&&this.dh([])},e.prototype.ah=function(t){return this.Ku.xu("Write",t)},e.prototype.onMessage=function(t){if(ho(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=function(t,e){return t&&t.length>0?(ho(void 0!==e),t.map(function(t){return function(t,e){var n=Ea(t.updateTime?t.updateTime:e);n.isEqual(Uo.min())&&(n=Ea(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Ou(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=Ea(t.commitTime);return this.listener.wh(n,e)}return ho(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},e.prototype.Th=function(){var t={};t.database=Da(this.Kt),this.eh(t)},e.prototype.dh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return La(e.Kt,t)})};this.eh(n)},e}(Cf),Lf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ku=n,i.Kt=r,i.Ih=!1,i}return Object(no.c)(e,t),e.prototype.mh=function(){if(this.Ih)throw new wo(mo.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.bu(t,e,n,i)}).catch(function(t){throw t.code===mo.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.Cu(t,e,n,i)}).catch(function(t){throw t.code===mo.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.terminate=function(){this.Ih=!1},e}(function(){}),Uf=function(){function t(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}return t.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},t.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,this.Ah>=1&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},t.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},t.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},t.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(so(e),this.Ph=!1):oo("OnlineStateTracker",e)},t.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},t}(),Rf=function(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Oh=new Set,this.Fh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return Object(no.b)(o,void 0,void 0,function(){return Object(no.d)(this,function(t){switch(t.label){case 0:return Kf(this)?(oo("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(no.b)(this,void 0,void 0,function(){var e;return Object(no.d)(this,function(n){switch(n.label){case 0:return(e=fo(t)).Oh.add(4),[4,Vf(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Oh.delete(4),[4,Mf(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new Uf(n,r)};function Mf(t){return Object(no.b)(this,void 0,void 0,function(){var e,n;return Object(no.d)(this,function(r){switch(r.label){case 0:if(!Kf(t))return[3,4];e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Vf(t){return Object(no.b)(this,void 0,void 0,function(){var e,n;return Object(no.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ff(t,e){var n=fo(t);n.Nh.has(e.targetId)||(n.Nh.set(e.targetId,e),Hf(n)?Gf(n):ul(n).Ju()&&Bf(n,e))}function qf(t,e){var n=fo(t),r=ul(n);n.Nh.delete(e),r.Ju()&&zf(n,e),0===n.Nh.size&&(r.Ju()?r.Zu():Kf(n)&&n.Mh.set("Unknown"))}function Bf(t,e){t.Lh.cn(e.targetId),ul(t).hh(e)}function zf(t,e){t.Lh.cn(e),ul(t).lh(e)}function Gf(t){t.Lh=new va({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),ul(t).start(),t.Mh.yh()}function Hf(t){return Kf(t)&&!ul(t).Hu()&&t.Nh.size>0}function Kf(t){return 0===fo(t).Oh.size}function Jf(t){t.Lh=void 0}function $f(t){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(e){return t.Nh.forEach(function(e,n){Bf(t,e)}),[2]})})}function Yf(t,e){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(n){return Jf(t),Hf(t)?(t.Mh.ph(e),Gf(t)):t.Mh.set("Unknown"),[2]})})}function Xf(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var r,i,o;return Object(no.d)(this,function(s){switch(s.label){case 0:if(t.Mh.set("Online"),!(e instanceof pa&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(no.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Nh.has(o=i[r])?[4,t.Ch.$h(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Nh.delete(o),t.Lh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),oo("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Wf(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof fa?t.Lh.wn(e):e instanceof la?t.Lh.yn(e):t.Lh.In(e),n.isEqual(Uo.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Gh(t.Sh)];case 8:return i=s.sent(),n.u(i)>=0?[4,function(t,e){var n=t.Lh.pn(e);return n.Fe.forEach(function(n,r){if(n.resumeToken.o()>0){var i=t.Nh.get(r);i&&t.Nh.set(r,i.$t(n.resumeToken,e))}}),n.ke.forEach(function(e){var n=t.Nh.get(e);if(n){t.Nh.set(e,n.$t(go.h,n.Mt)),zf(t,e);var r=new ou(n.target,e,1,n.sequenceNumber);Bf(t,r)}}),t.Ch.Bh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return oo("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Wf(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function Wf(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var r=this;return Object(no.d)(this,function(i){switch(i.label){case 0:if(!rc(e))throw e;return t.Oh.add(1),[4,Vf(t)];case 1:return i.sent(),t.Mh.set("Offline"),n||(n=function(){return Gh(t.Sh)}),t.fs.bo(function(){return Object(no.b)(r,void 0,void 0,function(){return Object(no.d)(this,function(e){switch(e.label){case 0:return oo("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Oh.delete(1),[4,Mf(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function Qf(t,e){return e().catch(function(n){return Wf(t,n,e)})}function Zf(t){return Object(no.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(no.d)(this,function(s){switch(s.label){case 0:e=fo(t),n=al(e),r=e.xh.length>0?e.xh[e.xh.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Kf(t)&&t.xh.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,Jh(e.Sh,r)];case 3:return null===(i=s.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=i.batchId,function(t,e){t.xh.push(e);var n=al(t);n.Ju()&&n.fh&&n.dh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Wf(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return tl(e)&&el(e),[2]}})})}function tl(t){return Kf(t)&&!al(t).Hu()&&t.xh.length>0}function el(t){al(t).start()}function nl(t){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(e){return al(t).Th(),[2]})})}function rl(t){return Object(no.b)(this,void 0,void 0,function(){var e,n,r;return Object(no.d)(this,function(i){for(e=al(t),n=0,r=t.xh;n<r.length;n++)e.dh(r[n].mutations);return[2]})})}function il(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var r,i;return Object(no.d)(this,function(o){switch(o.label){case 0:return r=t.xh.shift(),i=Uc.from(r,e,n),[4,Qf(t,function(){return t.Ch.qh(i)})];case 1:return o.sent(),[4,Zf(t)];case 2:return o.sent(),[2]}})})}function ol(t,e){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(n){switch(n.label){case 0:return e&&al(t).fh?[4,function(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r;return Object(no.d)(this,function(i){switch(i.label){case 0:return Bu(r=e.code)&&r!==mo.ABORTED?(n=t.xh.shift(),al(t).Xu(),[4,Qf(t,function(){return t.Ch.Uh(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,Zf(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return tl(t)&&el(t),[2]}})})}function sl(t,e){return Object(no.b)(this,void 0,void 0,function(){var n;return Object(no.d)(this,function(r){switch(r.label){case 0:return n=fo(t),e?(n.Oh.delete(2),[4,Mf(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Oh.add(2),[4,Vf(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function ul(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=fo(t);return r.mh(),new kf(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:$f.bind(null,t),Iu:Yf.bind(null,t),uh:Xf.bind(null,t)}),t.Fh.push(function(n){return Object(no.b)(e,void 0,void 0,function(){return Object(no.d)(this,function(e){switch(e.label){case 0:return n?(t.Qh.Xu(),Hf(t)?Gf(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:e.sent(),Jf(t),e.label=3;case 3:return[2]}})})})),t.Qh}function al(t){var e=this;return t.Kh||(t.Kh=function(t,e,n){var r=fo(t);return r.mh(),new Pf(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:nl.bind(null,t),Iu:ol.bind(null,t),Eh:rl.bind(null,t),wh:il.bind(null,t)}),t.Fh.push(function(n){return Object(no.b)(e,void 0,void 0,function(){return Object(no.d)(this,function(e){switch(e.label){case 0:return n?(t.Kh.Xu(),[4,Zf(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:e.sent(),t.xh.length>0&&(oo("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),e.label=4;case 4:return[2]}})})})),t.Kh}var cl=function(){this.jh=void 0,this.listeners=[]},hl=function(){this.queries=new ih(function(t){return tu(t)},Zs),this.onlineState="Unknown",this.Wh=new Set};function fl(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(no.d)(this,function(c){switch(c.label){case 0:if(n=fo(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new cl),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Gh(r)];case 2:return s.jh=c.sent(),[3,4];case 3:return u=c.sent(),a=cc(u,"Initialization of query '"+eu(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zh(n.onlineState),o.jh&&e.Hh(o.jh)&&vl(n),[2]}})})}function ll(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(no.d)(this,function(u){return n=fo(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Jh(r))]:[2]})})}function pl(t,e){for(var n=fo(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.jh=s}}r&&vl(n)}function dl(t,e,n){var r=fo(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function vl(t){t.Wh.forEach(function(t){t.next()})}var yl=function(){function t(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new aa(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},t.prototype.onError=function(t){this.Yh.error(t)},t.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},t.prototype.el=function(t,e){return!t.fromCache||!(this.options.sl&&"Offline"!==e||t.docs.nt()&&"Offline"!==e)},t.prototype.tl=function(t){return t.docChanges.length>0||!!(t.xe||this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.nl=function(t){t=aa.Oe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},t}(),bl=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.il=function(){return"metadata"in this.payload},t}(),gl=function(){function t(t){this.Kt=t}return t.prototype.yc=function(t){return xa(this.Kt,t)},t.prototype.gc=function(t){return t.metadata.exists?Pa(this.Kt,t.document,!1):new ws(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},t.prototype.Vc=function(t){return Ea(t)},t}();!function(){function t(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.cl=function(t){for(var e=new Map,n=new gl(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||ra()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(no.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(no.d)(this,function(o){switch(o.label){case 0:return[4,tf(this.Sh,new gl(this.Kt),this.documents,this.rl.id)];case 1:t=o.sent(),e=this.cl(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,ef(this.Sh,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Uh(Object.assign({},this.progress),t))]}})})}}();var ml=function(t){this.key=t},wl=function(t){this.key=t},Il=function(){function t(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=ra(),this.Ce=ra(),this.ll=ru(t),this._l=new sa(this.ll)}return Object.defineProperty(t.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),t.prototype.dl=function(t,e){var n=this,r=e?e.wl:new ua,i=e?e._l:this._l,o=e?e.Ce:this.Ce,s=i,u=!1,a=Hs(this.query)&&i.size===this.query.limit?i.last():null,c=Ks(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt(function(t,e){var h=i.get(t),f=e instanceof ms?e:null;f&&(f=nu(n.query,f)?f:null);var l=!!h&&n.Ce.has(h.key),p=!!f&&(f.bt||n.Ce.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.El(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.ll(f,a)>0||c&&n.ll(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),Hs(this.query)||Ks(this.query))for(;s.size>this.query.limit;){var h=Hs(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{_l:s,wl:r,_c:u,Ce:o}},t.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},t.prototype.Ei=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return co()}};return n(t)-n(e)}(t.type,e.type)||r.ll(t.doc,e.doc)}),this.Tl(n);var s=e?this.Il():[],u=0===this.hl.size&&this.qe?1:0,a=u!==this.ul;return this.ul=u,0!==o.length||a?{snapshot:new aa(this.query,t._l,i,o,t.Ce,0===u,a,!1),ml:s}:{ml:s}},t.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new ua,Ce:this.Ce,_c:!1},!1)):{ml:[]}},t.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},t.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},t.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=ra(),this._l.forEach(function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))});var n=[];return e.forEach(function(e){t.hl.has(e)||n.push(new wl(e))}),this.hl.forEach(function(t){e.has(t)||n.push(new ml(t))}),n},t.prototype.Rl=function(t){this.al=t.Pc,this.hl=ra();var e=this.dl(t.documents);return this.Ei(e,!0)},t.prototype.Pl=function(){return aa.Oe(this.query,this._l,this.Ce,0===this.ul)},t}(),Ol=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Tl=function(t){this.key=t,this.yl=!1},El=function(){function t(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new ih(function(t){return tu(t)},Zs),this.Dl=new Map,this.Cl=[],this.xl=new Gu(qo.J),this.Nl=new Map,this.Ol=new rf,this.Fl={},this.kl=new Map,this.Ml=ph.Bi(),this.onlineState="Unknown",this.Ll=void 0}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),t}();function _l(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(no.d)(this,function(u){switch(u.label){case 0:return n=tp(t),(i=n.Sl.get(e))?(n.pl.ka(i.targetId),r=i.view.Pl(),[3,4]):[3,1];case 1:return[4,$h(n.Sh,Ws(e))];case 2:return o=u.sent(),s=n.pl.ka(o.targetId),[4,jl(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.$l&&Ff(n.gl,o),u.label=4;case 4:return[2,r]}})})}function jl(t,e,n,r){return Object(no.b)(this,void 0,void 0,function(){var i,o,s,u,a,c;return Object(no.d)(this,function(h){switch(h.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return Object(no.b)(this,void 0,void 0,function(){var i,o,s;return Object(no.d)(this,function(u){switch(u.label){case 0:return(i=e.view.dl(n))._c?[4,Xh(t.Sh,e.query,!1).then(function(t){return e.view.dl(t.documents,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.Fe.get(e.targetId),s=e.view.Ei(i,t.$l,o),[2,(Vl(t,e.targetId,s.ml),s.snapshot)]}})})}(t,e,n,r)},[4,Xh(t.Sh,e,!0)];case 1:return i=h.sent(),o=new Il(e,i.Pc),s=o.dl(i.documents),u=ha.Be(n,r&&"Offline"!==t.onlineState),a=o.Ei(s,t.$l,u),Vl(t,n,a.ml),c=new Ol(e,n,o),[2,(t.Sl.set(e,c),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),a.snapshot)]}})})}function Sl(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i;return Object(no.d)(this,function(o){switch(o.label){case 0:return n=fo(t),r=n.Sl.get(e),(i=n.Dl.get(r.targetId)).length>1?[2,(n.Dl.set(r.targetId,i.filter(function(t){return!Zs(t,e)})),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,Yh(n.Sh,r.targetId,!1).then(function(){n.pl.Ba(r.targetId),qf(n.gl,r.targetId),Rl(n,r.targetId)}).catch(rh)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Rl(n,r.targetId),[4,Yh(n.Sh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function xl(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(no.d)(this,function(u){switch(u.label){case 0:r=ep(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=fo(t),i=Lo.now(),o=e.reduce(function(t,e){return t.add(e.key)},ra());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Ic.Zo(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=xu(c,n.get(c.key));null!=h&&s.push(new Cu(c.key,h,bs(h.proto.mapValue),Tu.exists(!0)))}return r.Ho.Pi(t,i,s,e)})}).then(function(t){var e=t.Ns(n);return{batchId:t.batchId,oi:e}})}(r.Sh,e)];case 2:return i=u.sent(),r.pl.xa(i.batchId),function(t,e,n){var r=t.Fl[t.currentUser.R()];r||(r=new Gu(vo)),r=r.Ht(e,n),t.Fl[t.currentUser.R()]=r}(r,i.batchId,n),[4,Bl(r,i.oi)];case 3:return u.sent(),[4,Zf(r.gl)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=cc(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Nl(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r;return Object(no.d)(this,function(i){switch(i.label){case 0:n=fo(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Hh(n.Sh,e)];case 2:return r=i.sent(),e.Fe.forEach(function(t,e){var r=n.Nl.get(e);r&&(ho(t.Ue.size+t.Qe.size+t.Ke.size<=1),t.Ue.size>0?r.yl=!0:t.Qe.size>0?ho(r.yl):t.Ke.size>0&&(ho(r.yl),r.yl=!1))}),[4,Bl(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,rh(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Al(t,e,n){var r=fo(t);if(r.$l&&0===n||!r.$l&&1===n){var i=[];r.Sl.forEach(function(t,n){var r=n.view.zh(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=fo(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zh(e)&&(r=!0)}),r&&vl(n)}(r.Vl,e),i.length&&r.vl.uh(i),r.onlineState=e,r.$l&&r.pl.Ka(e)}}function Dl(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(no.d)(this,function(c){switch(c.label){case 0:return(r=fo(t)).pl.qa(e,"rejected",n),i=r.Nl.get(e),(o=i&&i.key)?(s=(s=new Gu(qo.J)).Ht(o,new ws(o,Uo.min())),u=ra().add(o),a=new ca(Uo.min(),new Map,new Ju(vo),s,u),[4,Nl(r,a)]):[3,2];case 1:return c.sent(),r.xl=r.xl.remove(o),r.Nl.delete(e),ql(r),[3,4];case 2:return[4,Yh(r.Sh,e,!1).then(function(){return Rl(r,e,n)}).catch(rh)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Cl(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i;return Object(no.d)(this,function(o){switch(o.label){case 0:n=fo(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,zh(n.Sh,e)];case 2:return i=o.sent(),Ul(n,r,null),Ll(n,r),n.pl.Oa(r,"acknowledged"),[4,Bl(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,rh(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function kl(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var r,i;return Object(no.d)(this,function(o){switch(o.label){case 0:r=fo(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=fo(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.Ho.yi(t,e).next(function(e){return ho(null!==e),r=e.keys(),n.Ho.xi(t,e)}).next(function(){return n.Ho.Fi(t)}).next(function(){return n.Ic.Zo(t,r)})})}(r.Sh,e)];case 2:return i=o.sent(),Ul(r,e,n),Ll(r,e),r.pl.Oa(e,"rejected",n),[4,Bl(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,rh(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Pl(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(no.d)(this,function(u){switch(u.label){case 0:Kf((n=fo(t)).gl)||oo("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=fo(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})}(n.Sh)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.kl.get(r)||[]).push(e),n.kl.set(r,i),[3,4]);case 3:return o=u.sent(),s=cc(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function Ll(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function Ul(t,e,n){var r=fo(t),i=r.Fl[r.currentUser.R()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Fl[r.currentUser.R()]=i}}function Rl(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Ol.kc(e).forEach(function(e){t.Ol.ki(e)||Ml(t,e)})}function Ml(t,e){var n=t.xl.get(e);null!==n&&(qf(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),ql(t))}function Vl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof ml?(t.Ol.sr(o.key,e),Fl(t,o)):o instanceof wl?(oo("SyncEngine","Document no longer in limbo: "+o.key),t.Ol.rr(o.key,e),t.Ol.ki(o.key)||Ml(t,o.key)):co()}}function Fl(t,e){var n=e.key;t.xl.get(n)||(oo("SyncEngine","New document in limbo: "+n),t.Cl.push(n),ql(t))}function ql(t){for(;t.Cl.length>0&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Tl(e)),t.xl=t.xl.Ht(e,n),Ff(t.gl,new ou(Ws(Gs(e.path)),n,2,Po.U))}}function Bl(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(no.d)(this,function(u){switch(u.label){case 0:return r=fo(t),i=[],o=[],s=[],r.Sl.nt()?[3,3]:(r.Sl.forEach(function(t,u){s.push(r.Bl(u,e,n).then(function(t){if(t){r.$l&&r.pl.qa(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Mh.cc(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.vl.uh(i),[4,function(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return Object(no.d)(this,function(h){switch(h.label){case 0:n=fo(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Qa.forEach(e,function(e){return Qa.forEach(e.rc,function(r){return n.persistence.Ii.sr(t,e.targetId,r)}).next(function(){return Qa.forEach(e.oc,function(r){return n.persistence.Ii.rr(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!rc(r=h.sent()))throw r;return oo("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.dc.get(u),c=a.Bt(a.Mt),n.dc=n.dc.Ht(u,c));return[2]}})})}(r.Sh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function zl(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r;return Object(no.d)(this,function(i){switch(i.label){case 0:return(n=fo(t)).currentUser.isEqual(e)?[3,3]:(oo("SyncEngine","User change. New user:",e.R()),[4,Bh(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.kl.forEach(function(t){t.forEach(function(t){t.reject(new wo(mo.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.kl.clear()}(n),n.pl.Qa(e,r.Ac,r.Rc),[4,Bl(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function Gl(t,e){var n=fo(t),r=n.Nl.get(e);if(r&&r.yl)return ra().add(r.key);var i=ra(),o=n.Dl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Sl.get(u[s]);i=i.ye(a.view.fl)}return i}function Hl(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i;return Object(no.d)(this,function(o){switch(o.label){case 0:return[4,Xh((n=fo(t)).Sh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Rl(r),[2,(n.$l&&Vl(n,e.targetId,i.ml),i)]}})})}function Kl(t){return Object(no.b)(this,void 0,void 0,function(){var e;return Object(no.d)(this,function(n){return[2,Qh((e=fo(t)).Sh).then(function(t){return Bl(e,t)})]})})}function Jl(t,e,n,r){return Object(no.b)(this,void 0,void 0,function(){var i,o;return Object(no.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=fo(t),r=fo(n.Ho);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.gi(t,e).next(function(e){return e?n.Ic.Zo(t,e):Qa.resolve(null)})})}((i=fo(t)).Sh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Zf(i.gl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Ul(i,e,r||null),Ll(i,e),function(t,e){fo(fo(t).Ho).Ni(e)}(i.Sh,e)):co(),s.label=4;case 4:return[4,Bl(i,o)];case 5:return s.sent(),[3,7];case 6:oo("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function $l(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(no.d)(this,function(c){switch(c.label){case 0:return tp(n=fo(t)),ep(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,Yl(n,r.rt())]);case 1:return i=c.sent(),n.Ll=!0,[4,sl(n.gl,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)Ff(n.gl,s[o]);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(u=[],a=Promise.resolve(),n.Dl.forEach(function(t,e){n.pl.$a(e)?u.push(e):a=a.then(function(){return Rl(n,e),Yh(n.Sh,e,!0)}),qf(n.gl,e)}),[4,a]);case 4:return c.sent(),[4,Yl(n,u)];case 5:return c.sent(),function(t){var e=fo(t);e.Nl.forEach(function(t,n){qf(e.gl,n)}),e.Ol.Mc(),e.Nl=new Map,e.xl=new Gu(qo.J)}(n),n.Ll=!1,[4,sl(n.gl,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function Yl(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,f,l,p,d;return Object(no.d)(this,function(v){switch(v.label){case 0:n=fo(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.Dl.get(u=s[o]))&&0!==c.length?[4,$h(n.Sh,Ws(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.Sl.get(f[h]),[4,Hl(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Wh(n.Sh,u)];case 8:return d=v.sent(),[4,$h(n.Sh,d)];case 9:return a=v.sent(),[4,jl(n,Xl(d),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vl.uh(i),r)]}})})}function Xl(t){return zs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Wl(t){var e=fo(t);return fo(fo(e.Sh).persistence).Qo()}function Ql(t,e,n,r){return Object(no.b)(this,void 0,void 0,function(){var i,o,s;return Object(no.d)(this,function(u){switch(u.label){case 0:return(i=fo(t)).Ll?(oo("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Qh(i.Sh)];case 3:return o=u.sent(),s=ca.$e(e,"current"===n),[4,Bl(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,Yh(i.Sh,e,!0)];case 6:return u.sent(),Rl(i,e,r),[3,8];case 7:co(),u.label=8;case 8:return[2]}})})}function Zl(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f;return Object(no.d)(this,function(l){switch(l.label){case 0:if(!(r=tp(t)).Ll)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.Dl.has(s=o[i])?(oo("SyncEngine","Adding an already active target "+s),[3,5]):[4,Wh(r.Sh,s)]:[3,6];case 2:return u=l.sent(),[4,$h(r.Sh,u)];case 3:return a=l.sent(),[4,jl(r,Xl(u),a.targetId,!1)];case 4:l.sent(),Ff(r.gl,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(no.d)(this,function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,Yh(r.Sh,t,!1).then(function(){qf(r.gl,t),Rl(r,t)}).catch(rh)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function tp(t){var e=fo(t);return e.gl.Ch.Bh=Nl.bind(null,e),e.gl.Ch.Sn=Gl.bind(null,e),e.gl.Ch.$h=Dl.bind(null,e),e.vl.uh=pl.bind(null,e.Vl),e.vl.ql=dl.bind(null,e.Vl),e}function ep(t){var e=fo(t);return e.gl.Ch.qh=Cl.bind(null,e),e.gl.Ch.Uh=kl.bind(null,e),e}var np=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(e){switch(e.label){case 0:return this.Kt=Af(t.gu.T),this.pl=this.Wl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return qh(this.persistence,new Vh,t.Yl,this.Kt)},t.prototype.Gl=function(t){return new hf(lf.ra,this.Kt)},t.prototype.Wl=function(t){return new Of},t.prototype.terminate=function(){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.Lo()];case 1:return t.sent(),[4,this.persistence.Lo()];case 2:return t.sent(),[2]}})})},t}(),rp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(no.c)(e,t),e.prototype.initialize=function(e){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Zh(this.Sh)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,ep(this.Xl.fa)];case 4:return n.sent(),[4,Zf(this.Xl.gl)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return qh(this.persistence,new Vh,t.Yl,this.Kt)},e.prototype.Hl=function(t){return new wh(this.persistence.Ii._r,t.fs)},e.prototype.Gl=function(t){var e=Lh(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?nh.Xs(this.cacheSizeBytes):nh.ei;return new Ch(this.synchronizeTabs,e,t.clientId,n,t.fs,xf(),Nf(),this.Kt,this.pl,!!this.forceOwnership)},e.prototype.Wl=function(t){return new Of},e}(np),ip=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(no.c)(e,t),e.prototype.initialize=function(e){return Object(no.b)(this,void 0,void 0,function(){var n,r=this;return Object(no.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.fa,this.pl instanceof If?(this.pl.fa={nu:Jl.bind(null,n),su:Ql.bind(null,n),iu:Zl.bind(null,n),Qo:Wl.bind(null,n),eu:Kl.bind(null,n)},[4,this.pl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Po(function(t){return Object(no.b)(r,void 0,void 0,function(){return Object(no.d)(this,function(e){switch(e.label){case 0:return[4,$l(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Tr?this.zl.start(this.Sh):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Wl=function(t){var e=xf();if(!If.jn(e))throw new wo(mo.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Lh(t.gu.T,t.gu.persistenceKey);return new If(e,t.fs,n,t.clientId,t.Yl)},e}(rp),op=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(no.b)(this,void 0,void 0,function(){var n=this;return Object(no.d)(this,function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return Al(n.fa,t,1)},this.gl.Ch.s_=zl.bind(null,this.fa),[4,sl(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new hl},t.prototype.Zl=function(t){var e=Af(t.gu.T),n=new Sf(t.gu);return function(t,e,n){return new Lf(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Sh,n=this.Dh,r=t.fs,i=function(t){return Al(s.fa,t,0)},o=Ef.jn()?new Ef:new Tf,new Rf(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new El(t,e,n,r,i,o);return s&&(u.Ll=!0),u}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},t.prototype.terminate=function(){return function(t){return Object(no.b)(this,void 0,void 0,function(){var e;return Object(no.d)(this,function(n){switch(n.label){case 0:return e=fo(t),oo("RemoteStore","RemoteStore shutting down."),e.Oh.add(5),[4,Vf(e)];case 1:return n.sent(),e.kh.Lo(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},t}(),sp=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),up=(function(){function t(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new Wa,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.o_.cancel()},t.prototype.getMetadata=function(){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Kl=function(){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},t.prototype.a_=function(){return Object(no.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(no.d)(this,function(i){switch(i.label){case 0:return[4,this.u_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.c_.decode(t),n=Number(e),isNaN(n)&&this.h_("length string ("+e+") is not valid number"),[4,this.l_(n)]);case 2:return r=i.sent(),[2,new bl(JSON.parse(r),t.length+n)]}})})},t.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.u_=function(){return Object(no.b)(this,void 0,void 0,function(){var t,e;return Object(no.d)(this,function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.l_=function(t){return Object(no.b)(this,void 0,void 0,function(){var e;return Object(no.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.f_=function(){return Object(no.b)(this,void 0,void 0,function(){var t,e;return Object(no.d)(this,function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new wo(mo.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new Fo(t)}return t.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},t}()),ap=function(t){this._methodName=t};function cp(t,e,n){if(!n)throw new wo(mo.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function hp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new wo(mo.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function fp(t,e,n,r){if(!0===e&&!0===r)throw new wo(mo.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function lp(t){if(!qo.Et(t))throw new wo(mo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function pp(t){if(qo.Et(t))throw new wo(mo.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function dp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":co()}function vp(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new wo(mo.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=dp(t);throw new wo(mo.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function yp(t,e){if(e<=0)throw new wo(mo.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var bp=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new wo(mo.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new wo(mo.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,fp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),gp=new Map,mp=function(){function t(t,e){this.w_="(lite)",this.E_=new bp({}),this.T_=!1,t instanceof So?(this.I_=t,this.m_=new Ao):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new wo(mo.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new So(t.options.projectId)}(t),this.m_=new Do(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new wo(mo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new wo(mo.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new bp(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Ao;switch(t.type){case"gapi":var e=t.client;return ho(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ko(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new wo(mo.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.b_=function(){return(t=gp.get(this))&&(oo("ComponentProvider","Removing Datastore"),gp.delete(this),t.terminate()),Promise.resolve();var t},t}(),wp=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Op(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),Ip=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Op=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Gs(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Object(no.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new wp(this.firestore,null,new qo(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(Ip);function Tp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Oo&&(t=t._),cp("collection","path",e),t instanceof mp)return pp(n=Mo.ct.apply(Mo,Object(no.g)([e],r))),new Op(t,null,n);if(!(t instanceof wp||t instanceof Op))throw new wo(mo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return pp(n=Mo.ct.apply(Mo,Object(no.g)([t.path],r)).child(Mo.ct(e))),new Op(t.firestore,null,n)}function Ep(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Oo&&(t=t._),1===arguments.length&&(e=po.t()),cp("doc","path",e),t instanceof mp)return lp(n=Mo.ct.apply(Mo,Object(no.g)([e],r))),new wp(t,null,new qo(n));if(!(t instanceof wp||t instanceof Op))throw new wo(mo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return lp(n=t.D_.child(Mo.ct.apply(Mo,Object(no.g)([e],r)))),new wp(t.firestore,t instanceof Op?t.v_:null,new qo(n))}function _p(t,e){return t instanceof Oo&&(t=t._),e instanceof Oo&&(e=e._),(t instanceof wp||t instanceof Op)&&(e instanceof wp||e instanceof Op)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function jp(t,e){return t instanceof Oo&&(t=t._),e instanceof Oo&&(e=e._),t instanceof Ip&&e instanceof Ip&&t.firestore===e.firestore&&Zs(t.C_,e.C_)&&t.v_===e.v_}var Sp=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new wo(mo.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new wo(mo.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.K=function(t){return vo(this.x_,t.x_)||vo(this.N_,t.N_)},t}(),xp=/^__.*__$/,Np=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return null!==this.zt?new Cu(t,this.data,this.zt,e,this.fieldTransforms):new Du(t,this.data,e,this.fieldTransforms)},t}(),Ap=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return new Cu(t,this.data,this.zt,e,this.fieldTransforms)},t}();function Dp(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw co()}}var Cp=function(){function t(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.F_(),this.fieldTransforms=i||[],this.zt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.F_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return Qp(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.W_)},t.prototype.contains=function(t){return void 0!==this.zt.find(function(e){return t.st(e)})||void 0!==this.fieldTransforms.find(function(e){return t.st(e.field)})},t.prototype.F_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Dp(this.k_)&&xp.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),kp=function(){function t(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||Af(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Cp({k_:t,methodName:e,W_:n,path:Fo.at(),B_:!1,j_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},t}();function Pp(t){var e=t.p_(),n=Af(t.I_);return new kp(t.I_,!!e.ignoreUndefinedProperties,n)}function Lp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);$p("Data must be an object, but it was:",s,r);var u,a,c=Kp(r,s);if(o.merge)u=new Ho(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=Yp(e,l[f],n);if(!s.contains(p))throw new wo(mo.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Zp(h,p)||h.push(p)}u=new Ho(h),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new Np(new vs(c),u,a)}var Up=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw t.K_(1===t.k_?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(ap);function Rp(t,e,n){return new Cp({k_:3,W_:e.settings.W_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var Mp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e.prototype.z_=function(t){return new Iu(t.path,new pu)},e.prototype.isEqual=function(t){return t instanceof e},e}(ap),Vp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(no.c)(e,t),e.prototype.z_=function(t){var e=Rp(this,t,!0),n=this.H_.map(function(t){return Hp(t,e)}),r=new du(n);return new Iu(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(ap),Fp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(no.c)(e,t),e.prototype.z_=function(t){var e=Rp(this,t,!0),n=this.H_.map(function(t){return Hp(t,e)}),r=new yu(n);return new Iu(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(ap),qp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Object(no.c)(e,t),e.prototype.z_=function(t){var e=new gu(t.Kt,au(t.Kt,this.J_));return new Iu(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(ap);function Bp(t,e,n,r){var i=t.G_(1,e,n);$p("Data must be an object, but it was:",i,r);var o=[],s=new ys;zo(r,function(t,r){var u=Wp(e,t,n);r instanceof Oo&&(r=r._);var a=i.U_(u);if(r instanceof Up)o.push(u);else{var c=Hp(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new Ho(o);return new Ap(s.yt(),u,i.fieldTransforms)}function zp(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Yp(e,r,n)],a=[i];if(o.length%2!=0)throw new wo(mo.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Yp(e,o[c])),a.push(o[c+1]);for(var h=[],f=new ys,l=u.length-1;l>=0;--l)if(!Zp(h,u[l])){var p=u[l],d=a[l];d instanceof Oo&&(d=d._);var v=s.U_(p);if(d instanceof Up)h.push(p);else{var y=Hp(d,v);null!=y&&(h.push(p),f.set(p,y))}}var b=new Ho(h);return new Ap(f.yt(),b,s.fieldTransforms)}function Gp(t,e,n,r){return void 0===r&&(r=!1),Hp(n,t.G_(r?4:3,e))}function Hp(t,e){if(t instanceof Oo&&(t=t._),Jp(t))return $p("Unsupported field value:",e,t),Kp(t,e);if(t instanceof ap)return function(t,e){if(!Dp(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Hp(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Oo&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return au(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Lo.fromDate(t);return{timestampValue:Ia(e.Kt,n)}}if(t instanceof Lo)return n=new Lo(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ia(e.Kt,n)};if(t instanceof Sp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Io)return{bytesValue:Oa(e.Kt,t.l)};if(t instanceof wp){var r=t.firestore.I_;if(!r.isEqual(n=e.T))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:_a(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+dp(t))}(t,e)}function Kp(t,e){var n={};return Go(t)?e.path&&e.path.length>0&&e.zt.push(e.path):zo(t,function(t,r){var i=Hp(r,e.L_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Jp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Lo||t instanceof Sp||t instanceof Io||t instanceof wp||t instanceof ap)}function $p(t,e,n){if(!Jp(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=dp(n);throw e.K_("an object"===r?t+" a custom object":t+" "+r)}}function Yp(t,e,n){if(e instanceof Oo&&(e=e._),e instanceof up)return e.d_;if("string"==typeof e)return Wp(t,e);throw Qp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Xp=new RegExp("[~\\*/\\[\\]]");function Wp(t,e,n){if(e.search(Xp)>=0)throw Qp("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(up.bind.apply(up,Object(no.g)([void 0],e.split("."))))).d_}catch(r){throw Qp("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Qp(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new wo(mo.INVALID_ARGUMENT,(u+=". ")+t+a)}function Zp(t,e){return t.some(function(t){return t.isEqual(e)})}var td=function(){function t(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Object(no.b)(this,void 0,void 0,function(){var e,n=this;return Object(no.d)(this,function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new wo(mo.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i,o,s,u;return Object(no.d)(this,function(a){switch(a.label){case 0:return n=fo(t),r=Da(n.Kt)+"/documents",i={documents:e.map(function(t){return Sa(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){ho(!!e.found);var n=xa(t,e.found.name),r=Ea(e.found.updateTime),i=new vs({mapValue:{fields:e.found.fields}});return new ms(n,r,i,{})}(t,e):"missing"in e?function(t,e){ho(!!e.missing),ho(!!e.readTime);var n=xa(t,e.missing),r=Ea(e.readTime);return new ws(n,r)}(t,e):co()}(n.Kt,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());ho(!!e),u.push(e)}),u)]}})})}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof ws||t instanceof ms?n.sf(t):co()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.O_(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.O_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new Vu(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Object(no.b)(this,void 0,void 0,function(){var t,e=this;return Object(no.d)(this,function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=qo.ft(n);e.mutations.push(new Fu(r,e.Gt(r)))}),[4,function(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i;return Object(no.d)(this,function(o){switch(o.label){case 0:return n=fo(t),r=Da(n.Kt)+"/documents",i={writes:e.map(function(t){return La(n.Kt,t)})},[4,n.bu("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}})})},t.prototype.sf=function(t){var e;if(t instanceof ms)e=t.version;else{if(!(t instanceof ws))throw co();e=Uo.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new wo(mo.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Tu.updateTime(e):Tu.jt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(Uo.min()))throw new wo(mo.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Tu.updateTime(e)}return Tu.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),ed=function(){function t(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new Df(this.fs,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.zu.Bu(function(){return Object(no.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(no.d)(this,function(r){return t=new td(this.Dh),(e=this.uf(t))&&e.then(function(e){n.fs.ys(function(){return t.commit().then(function(){n.Ts.resolve(e)}).catch(function(t){n.hf(t)})})}).catch(function(t){n.hf(t)}),[2]})})})},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Zo(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Bu(e)}return!1},t}(),nd=function(){function t(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=xo.UNAUTHENTICATED,this.clientId=po.t(),this._f=function(){},this.N=new Wa,this.credentials.S(function(t){oo("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}return t.prototype.getConfiguration=function(){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},t.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},t.prototype.df=function(){if(this.fs.wf)throw new wo(mo.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new Wa;return this.fs.Tf(function(){return Object(no.b)(t,void 0,void 0,function(){var t,n;return Object(no.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=r.sent(),n=cc(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function rd(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(no.d)(this,function(o){switch(o.label){case 0:return t.fs.Af(),oo("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Yl,t.ff(function(n){r.isEqual(n)||(r=n,t.fs.bo(function(){return Object(no.b)(i,void 0,void 0,function(){return Object(no.d)(this,function(t){switch(t.label){case 0:return[4,Bh(e.Sh,n)];case 1:return t.sent(),[2]}})})}))}),e.persistence.yo(function(){return t.terminate()}),t.mf=e,[2]}})})}function id(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r;return Object(no.d)(this,function(i){switch(i.label){case 0:return t.fs.Af(),[4,od(t)];case 1:return n=i.sent(),oo("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff(function(n){return t.fs.bo(function(){return function(t,e){return Object(no.b)(this,void 0,void 0,function(){var n,r;return Object(no.d)(this,function(i){switch(i.label){case 0:return(n=fo(t)).fs.Af(),oo("RemoteStore","RemoteStore received new credentials"),r=Kf(n),n.Oh.add(3),[4,Vf(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Oh.delete(3),[4,Mf(n)];case 3:return i.sent(),[2]}})})}(e.gl,n)})}),t.If=e,[2]}})})}function od(t){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(e){switch(e.label){case 0:return t.mf?[3,2]:(oo("FirestoreClient","Using default OfflineComponentProvider"),[4,rd(t,new np)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}})})}function sd(t){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(e){switch(e.label){case 0:return t.If?[3,2]:(oo("FirestoreClient","Using default OnlineComponentProvider"),[4,id(t,new op)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}})})}function ud(t){return od(t).then(function(t){return t.persistence})}function ad(t){return od(t).then(function(t){return t.Sh})}function cd(t){return sd(t).then(function(t){return t.gl})}function hd(t){return sd(t).then(function(t){return t.fa})}function fd(t){return Object(no.b)(this,void 0,void 0,function(){var e,n;return Object(no.d)(this,function(r){switch(r.label){case 0:return[4,sd(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=_l.bind(null,e.fa),n.Jh=Sl.bind(null,e.fa),n)]}})})}function ld(t,e,n){var r=this;void 0===n&&(n={});var i=new Wa;return t.fs.ys(function(){return Object(no.b)(r,void 0,void 0,function(){var r;return Object(no.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new sp({next:function(o){e.ys(function(){return ll(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new wo(mo.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new wo(mo.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new yl(Gs(n.path),o,{includeMetadataChanges:!0,sl:!0});return fl(t,s)},[4,fd(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}function pd(t,e,n){var r=this;void 0===n&&(n={});var i=new Wa;return t.fs.ys(function(){return Object(no.b)(r,void 0,void 0,function(){var r;return Object(no.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new sp({next:function(n){e.ys(function(){return ll(t,s)}),n.fromCache&&"server"===r.source?i.reject(new wo(mo.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new yl(n,o,{includeMetadataChanges:!0,sl:!0});return fl(t,s)},[4,fd(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}var dd=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new Df(this,"async_queue_retry"),this.vf=function(){var e=Nf();e&&oo("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=Nf();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.ys=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Nf();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},t.prototype.bo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},t.prototype.Cf=function(){return Object(no.b)(this,void 0,void 0,function(){var t,e=this;return Object(no.d)(this,function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!rc(t=n.sent()))throw t;return oo("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.zu.Bu(function(){return e.Cf()}),n.label=5;case 5:return[2]}})})},t.prototype.Df=function(t){var e=this,n=this.Rf.then(function(){return e.pf=!0,t().catch(function(t){throw e.Vf=t,e.pf=!1,so("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.pf=!1,t})});return this.Rf=n,n},t.prototype.Ir=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=ac.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&co()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Object(no.b)(this,void 0,void 0,function(){var t;return Object(no.d)(this,function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Of=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},t.prototype.Ff=function(t){var e=this;return this.Nf().then(function(){e.gf.sort(function(t,e){return t.ws-e.ws});for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()})},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),vd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new dd,r.w_="name"in e?e.name:"[DEFAULT]",r}return Object(no.c)(e,t),e.prototype.b_=function(){return this.Lf||bd(this),this.Lf.terminate()},e}(mp);function yd(t){return t.Lf||bd(t),t.Lf.df(),t.Lf}function bd(t){var e=t.p_(),n=function(t,e,n){return new jo(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.Lf=new nd(t.m_,t.Mf,n)}function gd(t,e,n){var r=this,i=new Wa;return t.fs.enqueue(function(){return Object(no.b)(r,void 0,void 0,function(){var r;return Object(no.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,rd(t,n)];case 1:return o.sent(),[4,id(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===mo.FAILED_PRECONDITION||t.code===mo.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function md(t){if(t.R_||t.P_)throw new wo(mo.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var wd=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),ns(t)){case 0:return null;case 1:return t.booleanValue;case 2:return $o(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Yo(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.jf(t.arrayValue,e);case 10:return this.Wf(t.mapValue,e);default:throw co()}},t.prototype.Wf=function(t,e){var n=this,r={};return zo(t.fields||{},function(t,i){r[t]=n.$f(i,e)}),r},t.prototype.Kf=function(t){return new Sp($o(t.latitude),$o(t.longitude))},t.prototype.jf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},t.prototype.qf=function(t,e){switch(e){case"previous":var n=Wo(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(Qo(t));default:return null}},t.prototype.Bf=function(t){var e=Jo(t);return new Lo(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=Mo.ct(t);ho(Xa(n));var r=new So(n.get(1),n.get(3)),i=new qo(n.X(5));return r.isEqual(e)||so("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Id=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new wp(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Od(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field(Td("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),Od=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Id);function Td(t,e){return"string"==typeof e?Wp(t,e):e instanceof Oo?e._.d_:e.d_}function Ed(t){if(Ks(t)&&0===t.Nt.length)throw new wo(mo.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var _d=function(){};function jd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.Yf(t)}return t}var Sd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return Object(no.c)(e,t),e.prototype.Yf=function(t){var e=Pp(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.ht()){if("array-contains"===o||"array-contains-any"===o)throw new wo(mo.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Pd(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(kd(r,t,h[c]));u={arrayValue:{values:a}}}else u=kd(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Pd(s,o),u=Gp(n,"where",s,"in"===o||"not-in"===o);var f=Ss.create(i,o,u);return function(t,e){if(e.xt()){var n=$s(t);if(null!==n&&!n.isEqual(e.field))throw new wo(mo.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Js(t);null!==r&&Ld(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new wo(mo.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.C_,0,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new Ip(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new Bs(t.path,t.collectionGroup,t.Nt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(_d),xd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return Object(no.c)(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new wo(mo.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new wo(mo.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ms(e,n);return function(t,e){if(null===Js(t)){var n=$s(t);null!==n&&Ld(0,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new Ip(t.firestore,t.v_,function(t,e){var n=t.Nt.concat([e]);return new Bs(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(_d),Nd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return Object(no.c)(e,t),e.prototype.Yf=function(t){return new Ip(t.firestore,t.v_,Qs(t.C_,this.nd,this.sd))},e}(_d),Ad=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(no.c)(e,t),e.prototype.Yf=function(t){var e=Cd(t,this.type,this.rd,this.od);return new Ip(t.firestore,t.v_,function(t,e){return new Bs(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(_d),Dd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(no.c)(e,t),e.prototype.Yf=function(t){var e=Cd(t,this.type,this.rd,this.od);return new Ip(t.firestore,t.v_,function(t,e){return new Bs(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(_d);function Cd(t,e,n,r){if(n[0]instanceof Oo&&(n[0]=n[0]._),n[0]instanceof Id)return function(t,e,n,r,i){if(!r)throw new wo(mo.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=Xs(t);s<u.length;s++){var a=u[s];if(a.field.ht())o.push(cs(e,r.key));else{var c=r.field(a.field);if(Xo(c))throw new wo(mo.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.ot();throw new wo(mo.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Us(o,i)}(t.C_,t.firestore.I_,e,n[0].Jf,r);var i=Pp(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new wo(mo.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new wo(mo.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ys(t)&&-1!==c.indexOf("/"))throw new wo(mo.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Mo.ct(c));if(!qo.Et(h))throw new wo(mo.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new qo(h);u.push(cs(e,f))}else{var l=Gp(n,r,c);u.push(l)}}return new Us(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function kd(t,e,n){if(n instanceof Oo&&(n=n._),"string"==typeof n){if(""===n)throw new wo(mo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ys(e)&&-1!==n.indexOf("/"))throw new wo(mo.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Mo.ct(n));if(!qo.Et(r))throw new wo(mo.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return cs(t,new qo(r))}if(n instanceof wp)return cs(t,n.S_);throw new wo(mo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+dp(n)+".")}function Pd(t,e){if(!Array.isArray(t)||0===t.length)throw new wo(mo.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new wo(mo.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ld(t,e,n){if(!n.isEqual(e))throw new wo(mo.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ud(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}function Rd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Md=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(no.c)(e,t),e.prototype.Uf=function(t){return new Io(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new wp(this.firestore,null,e)},e}(wd),Vd=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Fd=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).zf=e,u.ad=e,u.metadata=o,u}return Object(no.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new qd(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field(Td("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(Id),qd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Fd),Bd=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new Vd(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach(function(r){t.call(e,new qd(n.zf,n.Hf,r.key,r,new Vd(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.Ne)throw new wo(mo.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map(function(e){return{type:"added",doc:new qd(t.zf,t.Hf,e.doc.key,e.doc,new Vd(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),oldIndex:-1,newIndex:n++}})}var r=t.ud.De;return t.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new qd(t.zf,t.Hf,e.doc.key,e.doc,new Vd(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:zd(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.ld=e),this.hd},t}();function zd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return co()}}function Gd(t,e){return t instanceof Fd&&e instanceof Fd?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof Bd&&e instanceof Bd&&t.zf===e.zf&&jp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var Hd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(no.c)(e,t),e.prototype.Uf=function(t){return new Io(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new wp(this.firestore,null,e)},e}(wd);function Kd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=vp(t,wp);var o=vp(t.firestore,vd),s=Pp(o);return e instanceof Oo&&(e=e._),$d(o,[("string"==typeof e||e instanceof up?zp(s,"updateDoc",t.S_,e,n,r):Bp(s,"updateDoc",t.S_,e)).O_(t.S_,Tu.exists(!0))])}function Jd(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof Oo&&(t=t._);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Ud(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(Ud(i[u])){var l=i[u];i[u]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[u+1]=null===(n=l.error)||void 0===n?void 0:n.bind(l),i[u+2]=null===(r=l.complete)||void 0===r?void 0:r.bind(l)}if(t instanceof wp)c=vp(t.firestore,vd),h=Gs(t.S_.path),a={next:function(e){i[u]&&i[u](Yd(c,t,e))},error:i[u+1],complete:i[u+2]};else{var p=vp(t,Ip);c=vp(p.firestore,vd),h=p.C_;var d=new Hd(c);a={next:function(t){i[u]&&i[u](new Bd(c,d,p,t))},error:i[u+1],complete:i[u+2]},Ed(t.C_)}return function(t,e,n,r){var i=this,o=new sp(r),s=new yl(e,o,n);return t.fs.ys(function(){return Object(no.b)(i,void 0,void 0,function(){var e;return Object(no.d)(this,function(n){switch(n.label){case 0:return e=fl,[4,fd(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.r_(),t.fs.ys(function(){return Object(no.b)(i,void 0,void 0,function(){var e;return Object(no.d)(this,function(n){switch(n.label){case 0:return e=ll,[4,fd(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(yd(c),h,f,a)}function $d(t,e){return function(t,e){var n=this,r=new Wa;return t.fs.ys(function(){return Object(no.b)(n,void 0,void 0,function(){var n;return Object(no.d)(this,function(i){switch(i.label){case 0:return n=xl,[4,hd(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(yd(t),e)}function Yd(t,e,n){var r=n.docs.get(e.S_),i=new Hd(t);return new Fd(t,i,e.S_,r,new Vd(n.hasPendingWrites,n.fromCache),e.v_)}var Xd=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=Pp(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=Wd(t,this.zf),i=Rd(r.v_,e,n),o=Lp(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.O_(r.S_,Tu.jt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,s=Wd(t,this.zf);return e instanceof Oo&&(e=e._),o="string"==typeof e||e instanceof up?zp(this.wd,"WriteBatch.update",s.S_,e,n,r):Bp(this.wd,"WriteBatch.update",s.S_,e),this.fd.push(o.O_(s.S_,Tu.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=Wd(t,this.zf);return this.fd=this.fd.concat(new Vu(e.S_,Tu.jt())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new wo(mo.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Wd(t,e){if(t instanceof Oo&&(t=t._),t.firestore!==e)throw new wo(mo.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Qd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return Object(no.c)(e,t),e.prototype.get=function(e){var n=this,r=Wd(e,this.zf),i=new Hd(this.zf);return t.prototype.get.call(this,e).then(function(t){return new Fd(n.zf,i,r.S_,t.Jf,new Vd(!1,!1),r.v_)})},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=Pp(t)}return t.prototype.get=function(t){var e=this,n=Wd(t,this.zf),r=new Md(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return co();var i=t[0];if(i instanceof ws)return new Id(e.zf,r,n.S_,null,n.v_);if(i instanceof ms)return new Id(e.zf,r,i.key,i,n.v_);throw co()})},t.prototype.set=function(t,e,n){var r=Wd(t,this.zf),i=Rd(r.v_,e,n),o=Lp(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Wd(t,this.zf);return e instanceof Oo&&(e=e._),o="string"==typeof e||e instanceof up?zp(this.wd,"Transaction.update",s.S_,e,n,r):Bp(this.wd,"Transaction.update",s.S_,e),this.Td.update(s.S_,o),this},t.prototype.delete=function(t){var e=Wd(t,this.zf);return this.Td.delete(e.S_),this},t}()),Zd=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){md(t=vp(t,vd));var n=yd(t),r=t.p_(),i=new op;return gd(n,i,new rp(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){md(t=vp(t,vd));var e=yd(t),n=t.p_(),r=new op;return gd(e,r,new ip(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new wo(mo.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Wa;return t.Mf.Tf(function(){return Object(no.b)(e,void 0,void 0,function(){var e;return Object(no.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(no.b)(this,void 0,void 0,function(){return Object(no.d)(this,function(e){switch(e.label){case 0:return tc.jn()?[4,tc.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(Lh(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._)},t}(),tv=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof So||(i.md=e),i}return Object(no.c)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=vp(t,mp)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&uo("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this._,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(no.b)(e,void 0,void 0,function(){var e,n;return Object(no.d)(this,function(r){switch(r.label){case 0:return[4,ud(t)];case 1:return e=r.sent(),[4,cd(t)];case 2:return n=r.sent(),[2,(e.Vo(!0),function(t){var e=fo(t);return e.Oh.delete(0),Mf(e)}(n))]}})})})}(yd(vp(this._,vd)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(no.b)(e,void 0,void 0,function(){var e,n;return Object(no.d)(this,function(r){switch(r.label){case 0:return[4,ud(t)];case 1:return e=r.sent(),[4,cd(t)];case 2:return n=r.sent(),[2,(e.Vo(!1),function(t){return Object(no.b)(this,void 0,void 0,function(){var e;return Object(no.d)(this,function(n){switch(n.label){case 0:return(e=fo(t)).Oh.add(0),[4,Vf(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(yd(vp(this._,vd)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&fp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Wa;return t.fs.ys(function(){return Object(no.b)(e,void 0,void 0,function(){var e;return Object(no.d)(this,function(r){switch(r.label){case 0:return e=Pl,[4,hd(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(yd(vp(this._,vd)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new sp(e);return t.fs.ys(function(){return Object(no.b)(n,void 0,void 0,function(){var e;return Object(no.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){fo(t).Wh.add(e),e.next()},[4,fd(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.r_(),t.fs.ys(function(){return Object(no.b)(n,void 0,void 0,function(){var e;return Object(no.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){fo(t).Wh.delete(e)},[4,fd(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(yd(t=vp(t,vd)),Ud(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new wo(mo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new pv(this,Tp(this._,t))}catch(t){throw ov(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new iv(this,Ep(this._,t))}catch(t){throw ov(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new hv(this,function(t,e){if(t=vp(t,mp),cp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new wo(mo.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Ip(t,null,function(t){return new Bs(Mo.at(),t)}(e))}(this._,t))}catch(t){throw ov(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Wa;return t.fs.ys(function(){return Object(no.b)(n,void 0,void 0,function(){var n;return Object(no.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return sd(t).then(function(t){return t.Dh})}(t)];case 1:return n=i.sent(),new ed(t.fs,n,e,r).run(),[2]}})})}),r.promise}(yd(t),function(n){return e(new Qd(t,n))})}(this._,function(n){return t(new nv(e,n))})},e.prototype.batch=function(){var t=this;return yd(this._),new rv(new Xd(this._,function(e){return $d(t._,e)}))},e.prototype.loadBundle=function(t){throw new wo(mo.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new wo(mo.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(Oo),ev=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(no.c)(e,t),e.prototype.Uf=function(t){return new _o(new Io(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return iv.Ad(e,this.firestore,null)},e}(wd),nv=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r.Hf=new ev(e),r}return Object(no.c)(e,t),e.prototype.get=function(t){var e=this,n=dv(t);return this._.get(n).then(function(t){return new av(e.zf,new Fd(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))})},e.prototype.set=function(t,e,n){var r=dv(t);return n?(hp("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=dv(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(no.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=dv(t);return this._.delete(e),this},e}(Oo),rv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e.prototype.set=function(t,e,n){var r=dv(t);return n?(hp("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=dv(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(no.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=dv(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(Oo),iv=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new ev(e),r}return Object(no.c)(e,t),e.Rd=function(t,n,r){if(t.length%2!=0)throw new wo(mo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new e(n,new wp(n._,r,new qo(t)))},e.Ad=function(t,n,r){return new e(n,new wp(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new pv(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new pv(this.firestore,Tp(this._,t))}catch(t){throw ov(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Oo&&(t=t._),t instanceof wp&&_p(this._,t)},e.prototype.set=function(t,e){e=hp("DocumentReference.set",e);try{return function(t,e,n){t=vp(t,wp);var r=vp(t.firestore,vd),i=Rd(t.v_,e,n);return $d(r,[Lp(Pp(r),"setDoc",t.S_,i,null!==t.v_,n).O_(t.S_,Tu.jt())])}(this._,t,e)}catch(t){throw ov(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Kd(this._,t):Kd.apply(void 0,Object(no.g)([this._,t,e],n))}catch(t){throw ov(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return $d(vp((t=this._).firestore,vd),[new Vu(t.S_,Tu.jt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=sv(e),i=uv(e,function(e){return new av(t.firestore,new Fd(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))});return Jd(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=vp(t,wp);var e=vp(t.firestore,vd),n=yd(e),r=new Hd(e);return function(t,e){var n=this,r=new Wa;return t.fs.ys(function(){return Object(no.b)(n,void 0,void 0,function(){var n;return Object(no.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var r,i;return Object(no.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=fo(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)})}(t,e)];case 1:return(i=o.sent())instanceof ms?n.resolve(i):i instanceof ws?n.resolve(null):n.reject(new wo(mo.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=cc(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,ad(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.S_).then(function(n){return new Fd(e,r,t.S_,n,new Vd(n instanceof ms&&n.bt,!0),t.v_)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=vp(t,wp);var e=vp(t.firestore,vd);return ld(yd(e),t.S_,{source:"server"}).then(function(n){return Yd(e,t,n)})}(this._):function(t){t=vp(t,wp);var e=vp(t.firestore,vd);return ld(yd(e),t.S_).then(function(n){return Yd(e,t,n)})}(this._)).then(function(t){return new av(e.firestore,new Fd(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Oo);function ov(t,e,n){return t.message=t.message.replace(e,n),t}function sv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Ud(r))return r}return{}}function uv(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Ud(t[0])?t[0]:Ud(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var av=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(no.c)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new iv(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return Gd(this._,t._)},e}(Oo),cv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e.prototype.data=function(t){return this._.data(t)},e}(av),hv=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new ev(e),r}return Object(no.c)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,jd(this._,function(t,e,n){var r=e,i=Td("where",t);return new Sd(i,r,n)}(t,n,r)))}catch(t){throw ov(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,jd(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=Td("orderBy",t);return new xd(r,n)}(t,n)))}catch(t){throw ov(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,jd(this._,function(t){return yp("limit",t),new Nd("limit",t,"F")}(t)))}catch(t){throw ov(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,jd(this._,function(t){return yp("limitToLast",t),new Nd("limitToLast",t,"L")}(t)))}catch(t){throw ov(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,jd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ad("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw ov(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,jd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ad("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw ov(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,jd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Dd("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw ov(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,jd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Dd("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw ov(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return jp(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=vp(t,Ip);var e=vp(t.firestore,vd),n=yd(e),r=new Hd(e);return function(t,e){var n=this,r=new Wa;return t.fs.ys(function(){return Object(no.b)(n,void 0,void 0,function(){var n;return Object(no.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(no.b)(this,void 0,void 0,function(){var r,i,o,s,u;return Object(no.d)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Xh(t,e,!0)];case 1:return u=a.sent(),r=new Il(e,u.Pc),i=r.dl(u.documents),o=r.Ei(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=cc(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}})})},[4,ad(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.C_).then(function(n){return new Bd(e,r,t,n)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=vp(t,Ip);var e=vp(t.firestore,vd),n=yd(e),r=new Hd(e);return pd(n,t.C_,{source:"server"}).then(function(n){return new Bd(e,r,t,n)})}(this._):function(t){t=vp(t,Ip);var e=vp(t.firestore,vd),n=yd(e),r=new Hd(e);return Ed(t.C_),pd(n,t.C_).then(function(n){return new Bd(e,r,t,n)})}(this._)).then(function(t){return new lv(e.firestore,new Bd(e.firestore._,e.Hf,e._,t.ud))})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=sv(e),i=uv(e,function(e){return new lv(t.firestore,new Bd(t.firestore._,t.Hf,t._,e.ud))});return Jd(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Oo),fv=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(no.c)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new cv(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(Oo),lv=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(no.c)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new hv(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map(function(e){return new cv(t.zf,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new fv(e.zf,t)})},e.prototype.forEach=function(t,e){var n=this;this._.forEach(function(r){t.call(e,new cv(n.zf,r))})},e.prototype.isEqual=function(t){return Gd(this._,t._)},e}(Oo),pv=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return Object(no.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new iv(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new iv(this.firestore,void 0===t?Ep(this._):Ep(this._,t))}catch(t){throw ov(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=vp(t.firestore,vd),r=Ep(t),i=Rd(t.v_,e);return $d(n,[Lp(Pp(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).O_(r.S_,Tu.exists(!1))]).then(function(){return r})}(this._,t).then(function(t){return new iv(e.firestore,t)})},e.prototype.isEqual=function(t){return _p(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(hv);function dv(t){return t instanceof Oo&&(t=t._),vp(t,wp)}var vv=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(up.bind.apply(up,Object(no.g)([void 0],e))))||this}return Object(no.c)(e,t),e.documentId=function(){return new e(Fo.lt().ot())},e.prototype.isEqual=function(t){return t instanceof Oo&&(t=t._),t instanceof up&&this._.d_.isEqual(t.d_)},e}(Oo),yv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(no.c)(e,t),e.serverTimestamp=function(){var t=new Mp("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Up("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vp("arrayUnion",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Fp("arrayRemove",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new qp("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(Oo);!function(){function t(){this.Pd={},this.yd=new Wa,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.yd.promise.catch(t)},t.prototype.then=function(t,e){return this.yd.promise.then(t,e)},t.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},t.prototype.jl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},t.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)}}();var bv,gv=n("/6Yf"),mv={Firestore:tv,GeoPoint:Sp,Timestamp:Lo,Blob:_o,Transaction:nv,WriteBatch:rv,DocumentReference:iv,DocumentSnapshot:av,Query:hv,QueryDocumentSnapshot:cv,QuerySnapshot:lv,CollectionReference:pv,FieldPath:vv,FieldValue:yv,setLogLevel:function(t){ro.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new gv.a("firestore",function(t){return function(t,e){return new tv(t,new vd(t,e),new Zd)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},mv)))})(bv=Wt.a),bv.registerVersion("@firebase/firestore","2.1.2");let wv=(()=>{class t{constructor(){this.db=Xt.a.firestore(),this.availableExers=this.db.collection("health").doc("availableExers"),this.availableExerList=this.availableExers.collection("list")}upsertExercises(t){const e=this.db.batch();return t.forEach(t=>{const n=this.availableExerList.doc(t.name);e.set(n,t)}),e.update(this.availableExers,{lastUpdated:(new Date).getTime()}),e.commit()}getExercises(){return this.availableExerList.get()}convertCollectionDocData(t){let e=[];return t&&t.size>0&&t.forEach(t=>{e.push(Object.assign(Object.assign({},t.data()),{id:t.id}))}),e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Iv=n("dNgK");let Ov=(()=>{class t{constructor(t){this._snackBar=t,this.horizontalPosition="start",this.verticalPosition="bottom"}openSnackBar(t,e=3e3){this._snackBar.open(t,"Close",{duration:e,horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition})}}return t.\u0275fac=function(e){return new(e||t)(c.Yb(Iv.a))},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Tv=[(()=>{class t{constructor(t,e,n){this.actions$=t,this.as=e,this.sbs=n,this.saveExercises$=Object(o.c)(()=>this.actions$.pipe(Object(o.d)(g),Object(Jt.a)(t=>this.as.upsertExercises(t.exers).then(e=>(this.sbs.openSnackBar("Successfully saved "+t.exers.length+" exercises"),m()),t=>{this.sbs.openSnackBar("Error occured!",6e3);const e=Yt.a(t);return console.log(t),w({errMsg:e})})))),this.getAllExercises$=Object(o.c)(()=>this.actions$.pipe(Object(o.d)(I),Object($t.a)(()=>this.as.getExercises().then(t=>{const e=this.as.convertCollectionDocData(t);return O({exers:e})},t=>{this.sbs.openSnackBar("Error occured!",6e3);const e=Yt.a(t);return T({errMsg:e})}))))}}return t.\u0275fac=function(e){return new(e||t)(c.Yb(o.a),c.Yb(wv),c.Yb(Ov))},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac}),t})()],Ev=Object(s.p)({currentActionPage:null,loading:!1,allExers:[]},Object(s.r)(p,(t,{page:e})=>Object.assign(Object.assign({},t),{currentActionPage:e})),Object(s.r)(d,(t,{exerUnitType:e})=>Object.assign(Object.assign({},t),{newExerType:{name:e}})),Object(s.r)(v,(t,{timeStamp:e})=>Object.assign(Object.assign({},t),{saveNewExerBtnClickTimeStamp:e})),Object(s.r)(y,(t,{status:e})=>Object.assign(Object.assign({},t),{formValidState:e})),Object(s.r)(b,t=>Object.assign(Object.assign({},t),{saveNewExerBtnClickTimeStamp:void 0,newExerType:void 0,formValidState:!0})),Object(s.r)(g,(t,{exers:e})=>Object.assign(Object.assign({},t),{exersBeingAdded:[...e],loading:!0})),Object(s.r)(m,t=>Object.assign(Object.assign({},t),{loading:!1,errMsg:void 0,error:!1})),Object(s.r)(w,(t,{errMsg:e})=>Object.assign(Object.assign({},t),{loading:!1,errMsg:e,error:!0})),Object(s.r)(I,t=>Object.assign(Object.assign({},t),{loading:!0})),Object(s.r)(O,(t,{exers:e})=>Object.assign(Object.assign({},t),{loading:!1,errMsg:void 0,error:!1,allExers:e})),Object(s.r)(T,(t,{errMsg:e})=>Object.assign(Object.assign({},t),{loading:!1,errMsg:e,error:!0})));let _v=(()=>{class t{}return t.\u0275mod=c.Mb({type:t}),t.\u0275inj=c.Lb({factory:function(e){return new(e||t)},providers:[],imports:[[Kt,u.a,r.c,i.q,i.j,s.j.forFeature("admin",Ev),o.b.forFeature(Tv),a.a,h]]}),t})()}}]);