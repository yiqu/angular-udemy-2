(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return Gd});var r=n("ofXK"),i=n("3Pt+"),o=n("9jGm"),s=n("l7P3"),u=n("UmVK"),a=n("37S3"),c=n("tyNb"),h=n("fXoL"),f=n("pLZG");const l=Object(s.n)("[Admin/UI] Admin page navigation",Object(s.s)()),p=Object(s.n)("[Admin/UI] Add a new exer select click",Object(s.s)()),d=Object(s.n)("[Admin/UI] Save exer button click",Object(s.s)()),v=Object(s.n)("[Admin/UI] Set form valid status",Object(s.s)()),y=Object(s.n)("[Admin/UI] Reset all options in new exer"),b=Object(s.n)("[Admin/API] Save all exer start",Object(s.s)()),g=Object(s.n)("[Admin/API] Save all exer success"),m=Object(s.n)("[Admin/API] Save all exer failed",Object(s.s)()),w=Object(s.o)("admin"),I=Object(s.q)(w,t=>t.currentActionPage),T=Object(s.q)(I,t=>{const e=[];return"new"===t?(e.push({btnName:"Add another",btnMenu:!0,btnMenuItems:["Time Based","Rep Based"]}),e.push({btnName:"Save"})):"edit"===t&&e.push({btnName:"Delete"}),e}),E=Object(s.q)(w,t=>t.newExerType),_=Object(s.q)(w,t=>t.saveNewExerBtnClickTimeStamp),O=Object(s.q)(w,I,(t,e)=>"new"!==e||null==t.formValidState||t.formValidState),j=Object(s.q)(w,t=>t.loading);let S=(()=>{class t{constructor(t){this.store=t,this.currentSelectedPage$=this.store.select(I),this.adminPanelButtons$=this.store.select(T),this.newlyAddedExerType$=this.store.select(E),this.onNewExerSaveClick$=this.store.select(_),this.exerFormStatus$=this.store.select(O).pipe(Object(f.a)(t=>null!=t)),this.isLoading$=this.store.select(j)}setCurrentPageState(t){this.store.dispatch(l({page:t}))}addNewExer(t){this.store.dispatch(p({exerUnitType:t}))}onNewExerSaveClick(){const t=(new Date).getTime();this.store.dispatch(d({timeStamp:t}))}onSetFormValidStatus(t){this.store.dispatch(v({status:t}))}resetNewExer(){this.store.dispatch(y())}onSaveExers(t){this.store.dispatch(b({exers:t}))}}return t.\u0275fac=function(e){return new(e||t)(h.Yb(s.h))},t.\u0275prov=h.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var N=n("XiUz"),A=n("STbY"),x=n("bTqV"),k=n("znSr"),C=n("NFeN"),D=n("bv9b");n("mrSG"),n("oC0T");let P=(()=>{class t{transform(t){let e="done";switch(null==t?void 0:t.trim().toLowerCase()){case"add another":e="add";break;case"save":e="save";break;case"delete all":e="delete"}return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=h.Nb({name:"iconDisplay",type:t,pure:!0}),t})();function L(t,e){1&t&&(h.Sb(0),h.Ub(1,"span",8),h.Bc(2,"Please fix the errors before saving*"),h.Tb(),h.Rb())}function R(t,e){if(1&t){const t=h.Vb();h.Ub(0,"button",12),h.cc("click",function(){h.sc(t);const e=h.gc().$implicit;return h.gc(2).onPanelBtnClick(e)}),h.Ub(1,"span",13),h.Bc(2),h.Tb(),h.Ub(3,"mat-icon",14),h.Bc(4),h.hc(5,"iconDisplay"),h.Tb(),h.Tb()}if(2&t){const t=h.gc().$implicit;h.Cb(2),h.Cc(t.btnName),h.Cb(2),h.Cc(h.ic(5,2,t.btnName))}}const U=function(t){return{menuItems:t}};function M(t,e){if(1&t){const t=h.Vb();h.Ub(0,"button",15),h.cc("click",function(){h.sc(t);const e=h.gc().$implicit;return h.gc(2).onPanelBtnClick(e)}),h.Ub(1,"div",16),h.Ub(2,"div"),h.Bc(3),h.Tb(),h.Ub(4,"div",17),h.Ub(5,"mat-icon"),h.Bc(6,"keyboard_arrow_down"),h.Tb(),h.Tb(),h.Tb(),h.Ub(7,"mat-icon",14),h.Bc(8),h.hc(9,"iconDisplay"),h.Tb(),h.Tb()}if(2&t){const t=h.gc().$implicit;h.gc(2);const e=h.qc(16);h.lc("matMenuTriggerData",h.nc(6,U,t.btnMenuItems))("matMenuTriggerFor",e),h.Cb(3),h.Cc(t.btnName),h.Cb(5),h.Cc(h.ic(9,4,t.btnName))}}function V(t,e){if(1&t&&(h.Sb(0),h.Ac(1,R,6,4,"button",10),h.Ac(2,M,10,8,"button",11),h.Rb()),2&t){const t=e.$implicit;h.Cb(1),h.lc("ngIf",!t.btnMenu),h.Cb(1),h.lc("ngIf",t.btnMenu)}}function F(t,e){if(1&t&&(h.Sb(0),h.Ac(1,V,3,2,"ng-container",9),h.Rb()),2&t){const t=e.ngIf;h.Cb(1),h.lc("ngForOf",t)}}function q(t,e){1&t&&(h.Sb(0),h.Pb(1,"mat-progress-bar",18),h.Rb())}function B(t,e){if(1&t){const t=h.Vb();h.Ub(0,"button",20),h.cc("click",function(){h.sc(t);const n=e.$implicit;return h.gc(2).onPanelMenuClick(n)}),h.Bc(1),h.Tb()}if(2&t){const t=e.$implicit;h.Cb(1),h.Cc(t)}}function z(t,e){1&t&&h.Ac(0,B,2,1,"button",19),2&t&&h.lc("ngForOf",e.menuItems)}const G=function(){return["/","admin"]};let H=(()=>{class t{constructor(t){this.as=t}ngOnInit(){}onPanelBtnClick(t){"Save"===t.btnName&&this.as.onNewExerSaveClick()}onPanelMenuClick(t){this.as.addNewExer(t)}}return t.\u0275fac=function(e){return new(e||t)(h.Ob(S))},t.\u0275cmp=h.Ib({type:t,selectors:[["app-admin"]],decls:18,vars:11,consts:[["fxLayout","column","fxLayoutGap","10px",1,"container","pb-3"],[1,"sticky-topp"],["fxLayout","row","fxLayoutAlign","space-between center",1,"title","mat-elevation-z0"],[3,"routerLink"],[4,"ngIf"],[1,"loading-bar"],["menu","matMenu"],["matMenuContent",""],[1,"status-msg","ml-3"],[4,"ngFor","ngForOf"],["mat-button","","ngClass.lt-md","mat-icon-button","class","mr-3","ngClass.gt-sm","mat-flat-button","color","primary","type","button",3,"click",4,"ngIf"],["mat-button","","ngClass.lt-md","mat-icon-button","class","mr-3","ngClass.gt-sm","mat-flat-button","color","primary","type","button",3,"matMenuTriggerData","matMenuTriggerFor","click",4,"ngIf"],["mat-button","","ngClass.lt-md","mat-icon-button","ngClass.gt-sm","mat-flat-button","color","primary","type","button",1,"mr-3",3,"click"],["fxHide","","fxShow.gt-sm",""],["fxHide","","fxShow.lt-sm",""],["mat-button","","ngClass.lt-md","mat-icon-button","ngClass.gt-sm","mat-flat-button","color","primary","type","button",1,"mr-3",3,"matMenuTriggerData","matMenuTriggerFor","click"],["fxHide","","fxShow.gt-sm","","fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","5px"],["fxLayout","row","fxLayoutAlign","center center"],["mode","indeterminate"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"]],template:function(t,e){1&t&&(h.Ub(0,"div",0),h.Ub(1,"div",1),h.Ub(2,"div",2),h.Ub(3,"div"),h.Ub(4,"a",3),h.Bc(5," Admin Panel "),h.Tb(),h.Ac(6,L,3,0,"ng-container",4),h.hc(7,"async"),h.Tb(),h.Ub(8,"div"),h.Ac(9,F,2,1,"ng-container",4),h.hc(10,"async"),h.Tb(),h.Tb(),h.Tb(),h.Ub(11,"div",5),h.Ac(12,q,2,0,"ng-container",4),h.hc(13,"async"),h.Tb(),h.Pb(14,"router-outlet"),h.Tb(),h.Ub(15,"mat-menu",null,6),h.Ac(17,z,1,1,"ng-template",7),h.Tb()),2&t&&(h.Cb(4),h.lc("routerLink",h.mc(10,G)),h.Cb(2),h.lc("ngIf",!h.ic(7,4,e.as.exerFormStatus$)),h.Cb(3),h.lc("ngIf",h.ic(10,6,e.as.adminPanelButtons$)),h.Cb(3),h.lc("ngIf",h.ic(13,8,e.as.isLoading$)))},directives:[N.c,N.d,N.b,c.e,r.k,c.g,A.a,A.b,r.j,x.a,k.a,k.b,C.a,A.e,D.a,A.c],pipes:[r.b,P],styles:[".title[_ngcontent-%COMP%]{font-size:19px;font-weight:700}.sticky-topp[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-left:0;height:4rem;border-bottom:1px solid #ccc}.sticky-topp[_ngcontent-%COMP%]   .status-msg[_ngcontent-%COMP%]{font-size:14px;color:#c45757}.loading-bar[_ngcontent-%COMP%]{margin:0;height:7px}"]}),t})(),K=(()=>{class t{constructor(t){this.as=t,this.as.setCurrentPageState("edit")}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(h.Ob(S))},t.\u0275cmp=h.Ib({type:t,selectors:[["app-admin-edit"]],decls:1,vars:0,template:function(t,e){1&t&&h.Bc(0,"Edit\n")},styles:[""]}),t})(),J=(()=>{class t{constructor(t,e,n,r){this.fb=t,this.router=e,this.route=n,this.as=r,this.as.setCurrentPageState(null)}ngOnInit(){}onActionClick(t){"add"===t?this.router.navigate(["../","new-exer"],{relativeTo:this.route}):"edit"===t&&this.router.navigate(["../","edit-exer"],{relativeTo:this.route})}}return t.\u0275fac=function(e){return new(e||t)(h.Ob(i.e),h.Ob(c.c),h.Ob(c.a),h.Ob(S))},t.\u0275cmp=h.Ib({type:t,selectors:[["app-admin-landing"]],decls:18,vars:0,consts:[[1,"row","mb-3","justify-content-center"],[1,"col-12","text-center"],[1,"row","justify-content-center"],["ngClass.lt-md","mb-3",1,"col-12","col-lg-2"],["fxLayout","column","fxLayoutAlign","center center"],["mat-fab","","color","primary",1,"mat-elevation-z0",3,"click"],[1,"col-12","col-lg-2"],["mat-fab","","color","accent",1,"mat-elevation-z0",3,"click"]],template:function(t,e){1&t&&(h.Ub(0,"div",0),h.Ub(1,"p",1),h.Bc(2,"Welcome to the admin panel. You can add, edit or delete exercises."),h.Tb(),h.Tb(),h.Ub(3,"div",2),h.Ub(4,"div",3),h.Ub(5,"div",4),h.Ub(6,"button",5),h.cc("click",function(){return e.onActionClick("add")}),h.Ub(7,"mat-icon"),h.Bc(8,"add"),h.Tb(),h.Tb(),h.Ub(9,"div"),h.Bc(10," New Exercise "),h.Tb(),h.Tb(),h.Tb(),h.Ub(11,"div",6),h.Ub(12,"div",4),h.Ub(13,"button",7),h.cc("click",function(){return e.onActionClick("edit")}),h.Ub(14,"mat-icon"),h.Bc(15,"edit"),h.Tb(),h.Tb(),h.Ub(16,"div"),h.Bc(17," Edit Exercises "),h.Tb(),h.Tb(),h.Tb(),h.Tb())},directives:[k.a,N.c,N.b,x.a,C.a],styles:[""]}),t})();var X=n("XNiG"),Y=n("1G5W"),$=n("ooqH"),W=n("kmnG"),Q=n("qFsG"),Z=n("d3UM"),tt=n("1jcm"),et=n("FKr1");function nt(t,e){1&t&&(h.Ub(0,"mat-error"),h.Bc(1," Name is required. "),h.Tb())}function rt(t,e){if(1&t&&(h.Ub(0,"mat-option",15),h.Bc(1),h.Tb()),2&t){const t=e.$implicit;h.lc("value",t),h.Cb(1),h.Dc(" ",t," ")}}function it(t,e){if(1&t&&(h.Ub(0,"mat-option",15),h.Bc(1),h.Tb()),2&t){const t=e.$implicit;h.lc("value",t),h.Cb(1),h.Dc(" ",t," ")}}function ot(t,e){if(1&t&&(h.Ub(0,"mat-form-field",8),h.Ub(1,"mat-label"),h.Bc(2,"Time Per Set (in seconds)"),h.Tb(),h.Ub(3,"mat-select",10),h.Ac(4,it,2,2,"mat-option",11),h.Tb(),h.Tb()),2&t){const t=h.gc(3);h.Cb(3),h.lc("formControlName","countPerSet"),h.Cb(1),h.lc("ngForOf",t.timeOptions)}}function st(t,e){if(1&t&&(h.Ub(0,"mat-option",15),h.Bc(1),h.Tb()),2&t){const t=e.$implicit;h.lc("value",t),h.Cb(1),h.Dc(" ",t," ")}}function ut(t,e){if(1&t&&(h.Ub(0,"mat-form-field",8),h.Ub(1,"mat-label"),h.Bc(2,"Reps Per Set"),h.Tb(),h.Ub(3,"mat-select",10),h.Ac(4,st,2,2,"mat-option",11),h.Tb(),h.Tb()),2&t){const t=h.gc(3);h.Cb(3),h.lc("formControlName","countPerSet"),h.Cb(1),h.lc("ngForOf",t.timeOptions)}}function at(t,e){if(1&t&&(h.Ub(0,"div",5),h.Ub(1,"div",6),h.Bc(2),h.Tb(),h.Ub(3,"div",7),h.Ub(4,"mat-form-field",8),h.Ub(5,"mat-label"),h.Bc(6,"Exercises Name"),h.Tb(),h.Pb(7,"input",9),h.Ac(8,nt,2,0,"mat-error",1),h.Tb(),h.Ub(9,"mat-form-field",8),h.Ub(10,"mat-label"),h.Bc(11,"Total Sets"),h.Tb(),h.Ub(12,"mat-select",10),h.Ac(13,rt,2,2,"mat-option",11),h.Tb(),h.Tb(),h.Ub(14,"mat-slide-toggle",12),h.Bc(15,"Use time"),h.Tb(),h.Sb(16,13),h.Ac(17,ot,5,2,"mat-form-field",14),h.Ac(18,ut,5,2,"mat-form-field",14),h.Rb(),h.Tb(),h.Tb()),2&t){const t=e.index,n=h.gc(2);h.Cb(2),h.Dc(" Exercise #",t+1," "),h.Cb(1),h.lc("formGroupName",t),h.Cb(4),h.lc("formControlName","name"),h.Cb(1),h.lc("ngIf",n.exercisesFaAny.controls[t].controls.name.errors&&n.exercisesFaAny.controls[t].controls.name.errors.required),h.Cb(4),h.lc("formControlName","sets"),h.Cb(1),h.lc("ngForOf",n.setOptions),h.Cb(1),h.lc("formControlName","setUnitTypeIsTime"),h.Cb(2),h.lc("ngSwitch",n.exercisesFaAny.controls[t].controls.setUnitTypeIsTime.value),h.Cb(1),h.lc("ngSwitchCase",!0),h.Cb(1),h.lc("ngSwitchCase",!1)}}const ct=function(){return{width:"100%"}};function ht(t,e){if(1&t){const t=h.Vb();h.Sb(0),h.Ub(1,"form",2),h.cc("ngSubmit",function(){return h.sc(t),h.gc().onFormSubmit()}),h.Ub(2,"div",3),h.Ac(3,at,19,10,"div",4),h.Tb(),h.Tb(),h.Rb()}if(2&t){const t=h.gc();h.Cb(1),h.lc("formGroup",t.mainFg)("ngStyle.lt-md",h.mc(3,ct)),h.Cb(2),h.lc("ngForOf",t.exercisesFa.controls)}}const ft=[{path:"",component:H,children:[{path:"",redirectTo:"landing",pathMatch:"full"},{path:"landing",component:J},{path:"new-exer",component:(()=>{class t{constructor(t,e){this.fb=t,this.as=e,this.setOptions=[3,5,7,10],this.timeOptions=[10,20,30,40,50,60],this.compDest$=new X.a,this.mainFg=this.createMainFg(),this.as.setCurrentPageState("new")}get exercisesFa(){return this.mainFg.get("exercises")}get exercisesFaAny(){return this.mainFg.get("exercises")}ngOnInit(){this.mainFg.valueChanges.pipe(Object(Y.a)(this.compDest$)).subscribe(t=>{}),this.as.newlyAddedExerType$.pipe(Object(Y.a)(this.compDest$)).subscribe(t=>{t&&t.name&&this.exercisesFa.push(this.createExerciseFg(t.name))}),this.as.onNewExerSaveClick$.pipe(Object(f.a)(t=>!!t),Object(Y.a)(this.compDest$)).subscribe(t=>{this.onFormSubmit()})}createMainFg(){return this.fb.group({exercises:this.fb.array([this.createExerciseFg("Time Based")])})}createExerciseFg(t){const e="Time Based"===t;return this.fb.group({name:Object($.a)(null,!1,[i.r.required]),sets:Object($.a)(3,!1),countPerSet:Object($.a)(30,!1),setUnitTypeIsTime:Object($.a)(e,!1)})}onAddAnother(){this.exercisesFa.push(this.createExerciseFg())}onFormSubmit(){this.checkFormValid(this.mainFg.valid),console.log(this.mainFg.value),this.mainFg.valid&&this.as.onSaveExers(this.mainFg.value.exercises)}checkFormValid(t){this.as.onSetFormValidStatus(t)}ngOnDestroy(){this.as.resetNewExer(),this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(h.Ob(i.e),h.Ob(S))},t.\u0275cmp=h.Ib({type:t,selectors:[["app-admin-new"]],decls:2,vars:1,consts:[["fxLayout","column","fxLayoutAlign","center center"],[4,"ngIf"],["fxLayoutGap","10px",3,"formGroup","ngStyle.lt-md","ngSubmit"],["formArrayName","exercises"],["class","exer mb-3",4,"ngFor","ngForOf"],[1,"exer","mb-3"],["ngClass.gt-xs","arr-count text-center"],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","10px",3,"formGroupName"],[1,""],["type","text","matInput","","placeholder","Exercises name",3,"formControlName"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],["color","primary",1,"",3,"formControlName"],[3,"ngSwitch"],["class","",4,"ngSwitchCase"],[3,"value"]],template:function(t,e){1&t&&(h.Ub(0,"div",0),h.Ac(1,ht,4,4,"ng-container",1),h.Tb()),2&t&&(h.Cb(1),h.lc("ngIf",e.mainFg))},directives:[N.c,N.b,r.k,i.s,i.o,N.d,i.h,k.c,i.d,r.j,k.a,i.i,W.c,W.g,Q.b,i.c,i.n,i.g,Z.a,tt.a,r.m,r.n,W.b,et.n],styles:[".arr-count[_ngcontent-%COMP%]{width:35rem;background-color:#eee;border-radius:15px;padding:10px}mat-form-field[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   .exer[_ngcontent-%COMP%]{border:1px solid #eee;border-radius:35px;padding:20px}"]}),t})()},{path:"edit-exer",component:K}]}];let lt=(()=>{class t{}return t.\u0275mod=h.Mb({type:t}),t.\u0275inj=h.Lb({factory:function(e){return new(e||t)},imports:[[c.f.forChild(ft)],c.f]}),t})();var pt=n("bOdf"),dt=n("Kojo"),vt=n("Jgta"),yt=n("zIRd"),bt=n("q/0M"),gt=n("qOnz"),mt=function(t,e){return(mt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function wt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var It,Tt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Et=Et||{},_t=Tt||self;function Ot(){}function jt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function St(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Nt="closure_uid_"+(1e9*Math.random()>>>0),At=0;function xt(t,e,n){return t.call.apply(t.bind,arguments)}function kt(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Ct(t,e,n){return(Ct=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?xt:kt).apply(null,arguments)}function Dt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Pt(){return Date.now()}function Lt(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Rt(){this.j=this.j,this.i=this.i}Rt.prototype.j=!1,Rt.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,Nt)&&t[Nt]||(t[Nt]=++At)}(this)},Rt.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var Ut=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Mt=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Vt(t){return Array.prototype.concat.apply([],arguments)}function Ft(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function qt(t){return/^[\s\xa0]*$/.test(t)}var Bt,zt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Gt(t,e){return-1!=t.indexOf(e)}function Ht(t,e){return t<e?-1:t>e?1:0}t:{var Kt=_t.navigator;if(Kt){var Jt=Kt.userAgent;if(Jt){Bt=Jt;break t}}Bt=""}function Xt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Yt(t){var e={};for(var n in t)e[n]=t[n];return e}var $t="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Wt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<$t.length;o++)n=$t[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Qt(t){return Qt[" "](t),t}Qt[" "]=Ot;var Zt,te,ee=Gt(Bt,"Opera"),ne=Gt(Bt,"Trident")||Gt(Bt,"MSIE"),re=Gt(Bt,"Edge"),ie=re||ne,oe=Gt(Bt,"Gecko")&&!(Gt(Bt.toLowerCase(),"webkit")&&!Gt(Bt,"Edge"))&&!(Gt(Bt,"Trident")||Gt(Bt,"MSIE"))&&!Gt(Bt,"Edge"),se=Gt(Bt.toLowerCase(),"webkit")&&!Gt(Bt,"Edge");function ue(){var t=_t.document;return t?t.documentMode:void 0}t:{var ae="",ce=(te=Bt,oe?/rv:([^\);]+)(\)|;)/.exec(te):re?/Edge\/([\d\.]+)/.exec(te):ne?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(te):se?/WebKit\/(\S+)/.exec(te):ee?/(?:Version)[ \/]?(\S+)/.exec(te):void 0);if(ce&&(ae=ce?ce[1]:""),ne){var he=ue();if(null!=he&&he>parseFloat(ae)){Zt=String(he);break t}}Zt=ae}var fe={};function le(t){return function(t,e){var n=fe;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=zt(String(Zt)).split("."),r=zt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=Ht(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||Ht(0==s[2].length,0==u[2].length)||Ht(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}var pe=_t.document&&ne&&(ue()||parseInt(Zt,10))||void 0,de=!ne||9<=Number(pe),ve=ne&&!le("9"),ye=function(){if(!_t.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_t.addEventListener("test",Ot,e),_t.removeEventListener("test",Ot,e)}catch(n){}return t}();function be(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function ge(t,e){if(be.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(oe){t:{try{Qt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:me[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}be.prototype.b=function(){this.defaultPrevented=!0},Lt(ge,be);var me={2:"touch",3:"pen",4:"mouse"};ge.prototype.b=function(){ge.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ve)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var we="closure_listenable_"+(1e6*Math.random()|0),Ie=0;function Te(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Ie,this.Y=this.Z=!1}function Ee(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function _e(t){this.src=t,this.a={},this.b=0}function Oe(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=Ut(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Ee(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function je(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}_e.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=je(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Te(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Se="closure_lm_"+(1e6*Math.random()|0),Ne={};function Ae(t,e,n,r,i){if(r&&r.once)return ke(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ae(t,e[o],n,r,i);return null}return n=Ve(n),t&&t[we]?t.va(e,n,St(r)?!!r.capture:!!r,i):xe(t,e,n,!1,r,i)}function xe(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=St(i)?!!i.capture:!!i;if(s&&!de)return null;var u=Ue(t);if(u||(t[Se]=u=new _e(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Re,e=de?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ye||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pe(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function ke(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)ke(t,e[o],n,r,i);return null}return n=Ve(n),t&&t[we]?t.wa(e,n,St(r)?!!r.capture:!!r,i):xe(t,e,n,!0,r,i)}function Ce(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Ce(t,e[o],n,r,i);else r=St(r)?!!r.capture:!!r,n=Ve(n),t&&t[we]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=je(o=t.a[e],n,r,i))&&(Ee(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Ue(t))&&(e=t.a[e.toString()],t=-1,e&&(t=je(e,n,r,i)),(n=-1<t?e[t]:null)&&De(n))}function De(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[we])Oe(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pe(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ue(e))?(Oe(n,t),0==n.b&&(n.src=null,e[Se]=null)):Ee(t)}}}function Pe(t){return t in Ne?Ne[t]:Ne[t]="on"+t}function Le(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&De(t),n.call(r,e)}function Re(t,e){if(t.Y)return!0;if(!de){if(!e)t:{e=["window","event"];for(var n=_t,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Le(t,e=new ge(e,this))}return Le(t,new ge(e,this))}function Ue(t){return(t=t[Se])instanceof _e?t:null}var Me="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ve(t){return"function"==typeof t?t:(t[Me]||(t[Me]=function(e){return t.handleEvent(e)}),t[Me])}function Fe(){Rt.call(this),this.c=new _e(this),this.J=this,this.C=null}function qe(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new be(e,t);else if(e instanceof be)e.target=e.target||t;else{var i=e;Wt(e=new be(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Be(s,r,!0,e)&&i}if(i=Be(s=e.a=t,r,!0,e)&&i,i=Be(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Be(s=e.a=n[o],r,!1,e)&&i}function Be(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&Oe(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}Lt(Fe,Rt),Fe.prototype[we]=!0,(It=Fe.prototype).addEventListener=function(t,e,n,r){Ae(this,t,e,n,r)},It.removeEventListener=function(t,e,n,r){Ce(this,t,e,n,r)},It.G=function(){if(Fe.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Ee(n[r]);delete e.a[t],e.b--}}this.C=null},It.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},It.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var ze=_t.JSON.stringify;function Ge(){this.b=this.a=null}var He,Ke=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new Xe},function(t){t.reset()});function Je(){var t=Qe,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Xe(){this.next=this.b=this.a=null}function Ye(t){_t.setTimeout(function(){throw t},0)}function $e(t,e){He||function(){var t=_t.Promise.resolve(void 0);He=function(){t.then(Ze)}}(),We||(He(),We=!0),Qe.add(t,e)}Ge.prototype.add=function(t,e){var n=Ke.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xe.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Xe.prototype.reset=function(){this.next=this.b=this.a=null};var We=!1,Qe=new Ge;function Ze(){for(var t;t=Je();){try{t.a.call(t.b)}catch(n){Ye(n)}var e=Ke;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}We=!1}function tn(t,e){Fe.call(this),this.b=t||1,this.a=e||_t,this.f=Ct(this.Za,this),this.g=Pt()}function en(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function nn(t,e,n){if("function"==typeof t)n&&(t=Ct(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Ct(t.handleEvent,t)}return 2147483647<Number(e)?-1:_t.setTimeout(t,e||0)}function rn(t){t.a=nn(function(){t.a=null,t.c&&(t.c=!1,rn(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}Lt(tn,Fe),(It=tn.prototype).aa=!1,It.M=null,It.Za=function(){if(this.aa){var t=Pt()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qe(this,"tick"),this.aa&&(en(this),this.start()))}},It.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=Pt())},It.G=function(){tn.X.G.call(this),en(this),delete this.a};var on=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}mt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:rn(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(_t.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(Rt);function sn(t){Rt.call(this),this.b=t,this.a={}}Lt(sn,Rt);var un=[];function an(t,e,n,r){Array.isArray(n)||(n&&(un[0]=n.toString()),n=un);for(var i=0;i<n.length;i++){var o=Ae(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function cn(t){Xt(t.a,function(t,e){this.a.hasOwnProperty(e)&&De(t)},t),t.a={}}function hn(){this.a=!0}function fn(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return ze(n)}catch(u){return e}}(t,n)+(r?" "+r:"")})}sn.prototype.G=function(){sn.X.G.call(this),cn(this)},sn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},hn.prototype.info=function(){};var ln={},pn=null;function dn(){return pn=pn||new Fe}function vn(t){be.call(this,ln.Fa,t)}function yn(t){var e=dn();qe(e,new vn(e,t))}function bn(t,e){be.call(this,ln.STAT_EVENT,t),this.stat=e}function gn(t){var e=dn();qe(e,new bn(e,t))}function mn(t){be.call(this,ln.Ga,t)}function wn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return _t.setTimeout(function(){t()},e)}ln.Fa="serverreachability",Lt(vn,be),ln.STAT_EVENT="statevent",Lt(bn,be),ln.Ga="timingevent",Lt(mn,be);var In={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Tn={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function En(){}function _n(){}En.prototype.a=null;var On,jn={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Sn(){be.call(this,"d")}function Nn(){be.call(this,"c")}function An(){}function xn(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new sn(this),this.P=kn,this.R=new tn(t=ie?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}Lt(Sn,be),Lt(Nn,be),Lt(An,En),On=new An;var kn=45e3,Cn={},Dn={};function Pn(t,e,n){t.H=1,t.i=nr($n(e)),t.j=n,t.I=!0,Ln(t,null)}function Ln(t,e){t.u=Pt(),Mn(t),t.l=$n(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vr(n.b,"t",r),t.D=0,t.a=ci(t.g,t.g.C?e:null),0<t.O&&(t.F=new on(Ct(t.Ca,t,t.a),t.O)),an(t.J,t.a,"readystatechange",t.Xa),e=t.B?Yt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),yn(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function Rn(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Un(t,n);if(i==Dn){4==e&&(t.h=4,gn(14),r=!1),fn(t.c,t.f,null,"[Incomplete Response]");break}if(i==Cn){t.h=4,gn(15),fn(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}fn(t.c,t.f,i,null),zn(t,i)}4==e&&0==n.length&&(t.h=1,gn(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),ei(e),e.F=!0,gn(11))):(fn(t.c,t.f,n,"[Invalid Chunked Response]"),Bn(t),qn(t))}function Un(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Dn:(n=Number(e.substring(n,r)),isNaN(n)?Cn:(r+=1)+n>e.length?Dn:(e=e.substr(r,n),t.D=r+n,e))}function Mn(t){t.T=Pt()+t.P,Vn(t,t.P)}function Vn(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=wn(Ct(t.Va,t),e)}function Fn(t){t.o&&(_t.clearTimeout(t.o),t.o=null)}function qn(t){0==t.g.v||t.A||ii(t.g,t)}function Bn(t){Fn(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,en(t.R),cn(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function zn(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||Tr(n.b,t)))if(n.I=t.N,!t.C&&Tr(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(Yp){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;ri(n),Kr(n)}ti(n),gn(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=wn(Ct(n.Sa,n),6e3));if(1>=Ir(n.b)&&n.ea){try{n.ea()}catch(Yp){}n.ea=void 0}}else si(n,11)}else if((t.C||n.a==t)&&ri(n),!qt(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(Gt(h,"spdy")||Gt(h,"quic")||Gt(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(Er(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,er(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=Pt()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=ai(a,a.C?a.ga:null,a.fa),p.C){_r(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(Fn(d),Mn(d)),a.a=p}else Zr(a);0<n.g.length&&Yr(n)}else"stop"!=i[0]&&"close"!=i[0]||si(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?si(n,7):Hr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);yn(4)}catch(Yp){}}function Gn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(jt(t)||"string"==typeof t)Mt(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(jt(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(jt(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Hn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Hn)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Kn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Jn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Jn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Jn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(It=xn.prototype).setTimeout=function(t){this.P=t},It.Xa=function(t){t=t.target;var e=this.F;e&&3==qr(t)?e.f():this.Ca(t)},It.Ca=function(t){try{if(t==this.a)t:{var e=qr(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!ie&&!this.a.$())){this.A||4!=e||7==n||yn(8==n||0>=r?3:2),Fn(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!qt(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,gn(12),Bn(this),qn(this);break t}fn(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,zn(this,a)}this.I?(Rn(this,e,o),ie&&this.b&&3==e&&(an(this.J,this.R,"tick",this.Wa),this.R.start())):(fn(this.c,this.f,o,null),zn(this,o)),4==e&&Bn(this),this.b&&!this.A&&(4==e?ii(this.g,this):(this.b=!1,Mn(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,gn(12)):(this.h=0,gn(13)),Bn(this),qn(this)}}}catch(c){}},It.Wa=function(){if(this.a){var t=qr(this.a),e=this.a.$();this.D<e.length&&(Fn(this),Rn(this,t,e),this.b&&4!=t&&Mn(this))}},It.cancel=function(){this.A=!0,Bn(this)},It.Va=function(){this.o=null;var t=Pt();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(yn(3),gn(17)),Bn(this),this.h=2,qn(this)):Vn(this,this.T-t)},(It=Hn.prototype).K=function(){Kn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},It.L=function(){return Kn(this),this.a.concat()},It.get=function(t,e){return Jn(this.b,t)?this.b[t]:e},It.set=function(t,e){Jn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},It.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Yn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Yn){this.a=void 0!==e?e:t.a,Wn(this,t.f),this.j=t.j,Qn(this,t.c),Zn(this,t.h),this.g=t.g,e=t.b;var n=new fr;n.c=e.c,e.a&&(n.a=new Hn(e.a),n.b=e.b),tr(this,n),this.i=t.i}else t&&(n=String(t).match(Xn))?(this.a=!!e,Wn(this,n[1]||"",!0),this.j=rr(n[2]||""),Qn(this,n[3]||"",!0),Zn(this,n[4]),this.g=rr(n[5]||"",!0),tr(this,n[6]||"",!0),this.i=rr(n[7]||"")):(this.a=!!e,this.b=new fr(null,this.a))}function $n(t){return new Yn(t)}function Wn(t,e,n){t.f=n?rr(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Qn(t,e,n){t.c=n?rr(e,!0):e}function Zn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tr(t,e,n){e instanceof fr?(t.b=e,function(t,e){e&&!t.f&&(lr(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pr(this,e),vr(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=ir(e,cr)),t.b=new fr(e,t.a))}function er(t,e,n){t.b.set(e,n)}function nr(t){return er(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Pt()).toString(36)),t}function rr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ir(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,or),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function or(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Yn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(ir(e,sr,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(ir(e,sr,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(ir(n,"/"==n.charAt(0)?ar:ur,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",ir(n,hr)),t.join("")};var sr=/[#\/\?@]/g,ur=/[#\?:]/g,ar=/[#\?]/g,cr=/[#\?@]/g,hr=/#/g;function fr(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function lr(t){t.a||(t.a=new Hn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function pr(t,e){lr(t),e=yr(t,e),Jn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Jn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Kn(t)))}function dr(t,e){return lr(t),e=yr(t,e),Jn(t.a.b,e)}function vr(t,e,n){pr(t,e),0<n.length&&(t.c=null,t.a.set(yr(t,e),Ft(n)),t.b+=n.length)}function yr(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(It=fr.prototype).add=function(t,e){lr(this),this.c=null,t=yr(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},It.forEach=function(t,e){lr(this),this.a.forEach(function(n,r){Mt(n,function(n){t.call(e,n,r,this)},this)},this)},It.L=function(){lr(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},It.K=function(t){lr(this);var e=[];if("string"==typeof t)dr(this,t)&&(e=Vt(e,this.a.get(yr(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=Vt(e,t[n])}return e},It.set=function(t,e){return lr(this),this.c=null,dr(this,t=yr(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},It.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},It.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var br=function(){return function(t,e){this.b=t,this.a=e}}();function gr(t){this.g=t||mr,t=_t.PerformanceNavigationTiming?0<(t=_t.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_t.ia&&_t.ia.ya&&_t.ia.ya()&&_t.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var mr=10;function wr(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Ir(t){return t.b?1:t.a?t.a.size:0}function Tr(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Er(t,e){t.a?t.a.add(e):t.b=e}function _r(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Or(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=wt(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Ft(t.c)}function jr(){}function Sr(){this.a=new jr}function Nr(t,e,n){var r=n||"";try{Gn(t,function(t,n){var i=t;St(t)&&(i=ze(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(Rd){throw e.push(r+"type="+encodeURIComponent("_badmap")),Rd}}function Ar(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}gr.prototype.cancel=function(){var t,e;if(this.c=Or(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=wt(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},jr.prototype.stringify=function(t){return _t.JSON.stringify(t,void 0)},jr.prototype.parse=function(t){return _t.JSON.parse(t,void 0)};var xr=_t.JSON.parse;function kr(t){Fe.call(this),this.headers=new Hn,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Cr,this.D=this.F=!1}Lt(kr,Fe);var Cr="",Dr=/^https?$/i,Pr=["POST","PUT"];function Lr(t){return"content-type"==t.toLowerCase()}function Rr(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Ur(t),Vr(t)}function Ur(t){t.u||(t.u=!0,qe(t,"complete"),qe(t,"error"))}function Mr(t){if(t.b&&void 0!==Et&&(!t.s[1]||4!=qr(t)||2!=t.W()))if(t.l&&4==qr(t))nn(t.za,0,t);else if(qe(t,"readystatechange"),4==qr(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Xn)[1]||null;if(!o&&_t.self&&_t.self.location){var s=_t.self.location.protocol;o=s.substr(0,s.length-1)}i=!Dr.test(o?o.toLowerCase():"")}e=i}if(e)qe(t,"complete"),qe(t,"success");else{t.h=6;try{var u=2<qr(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",Ur(t)}}finally{Vr(t)}}}function Vr(t,e){if(t.a){Fr(t);var n=t.a,r=t.s[0]?Ot:null;t.a=null,t.s=null,e||qe(t,"ready");try{n.onreadystatechange=r}catch(Rd){}}}function Fr(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(_t.clearTimeout(t.m),t.m=null)}function qr(t){return t.a?t.a.readyState:0}function Br(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Xt(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):er(t,e,n))}function zr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gr(t){this.pa=0,this.g=[],this.c=new hn,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=zr("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=zr("baseRetryDelayMs",5e3,t),this.Ra=zr("retryDelaySeedMs",1e4,t),this.Ma=zr("forwardChannelMaxRetries",2,t),this.ma=zr("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gr(t&&t.concurrentRequestLimit),this.ka=new Sr,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Hr(t){if(Jr(t),3==t.v){var e=t.R++,n=$n(t.B);er(n,"SID",t.J),er(n,"RID",e),er(n,"TYPE","terminate"),Wr(t,n),(e=new xn(t,t.c,e,void 0)).H=2,e.i=nr($n(n)),n=!1,_t.navigator&&_t.navigator.sendBeacon&&(n=_t.navigator.sendBeacon(e.i.toString(),"")),!n&&_t.Image&&((new Image).src=e.i,n=!0),n||(e.a=ci(e.g,null),e.a.ba(e.i)),e.u=Pt(),Mn(e)}ui(t)}function Kr(t){t.a&&(ei(t),t.a.cancel(),t.a=null)}function Jr(t){Kr(t),t.j&&(_t.clearTimeout(t.j),t.j=null),ri(t),t.b.cancel(),t.h&&("number"==typeof t.h&&_t.clearTimeout(t.h),t.h=null)}function Xr(t,e){t.g.push(new br(t.Oa++,e)),3==t.v&&Yr(t)}function Yr(t){wr(t.b)||t.h||(t.h=!0,$e(t.Ba,t),t.u=0)}function $r(t,e){var n;n=e?e.f:t.R++;var r=$n(t.B);er(r,"SID",t.J),er(r,"RID",n),er(r,"AID",t.P),Wr(t,r),t.i&&t.l&&Br(r,t.i,t.l),n=new xn(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Qr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Er(t.b,n),Pn(n,r,e)}function Wr(t,e){t.f&&Gn({},function(t,n){er(e,n,t)})}function Qr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?Ct(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{Nr(h,s,"req"+c+"_")}catch(Hi){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zr(t){t.a||t.j||(t.T=1,$e(t.Aa,t),t.o=0)}function ti(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=wn(Ct(t.Aa,t),oi(t,t.o)),t.o++,0))}function ei(t){null!=t.s&&(_t.clearTimeout(t.s),t.s=null)}function ni(t){t.a=new xn(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=$n(t.la);er(e,"RID","rpc"),er(e,"SID",t.J),er(e,"CI",t.H?"0":"1"),er(e,"AID",t.P),Wr(t,e),er(e,"TYPE","xmlhttp"),t.i&&t.l&&Br(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nr($n(e)),n.j=null,n.I=!0,Ln(n,t)}function ri(t){null!=t.m&&(_t.clearTimeout(t.m),t.m=null)}function ii(t,e){var n=null;if(t.a==e){ri(t),ei(t),t.a=null;var r=2}else{if(!Tr(t.b,e))return;n=e.s,_r(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=Pt()-e.u;var i=t.u;qe(r=dn(),new mn(r,n,e,i)),Yr(t)}else Zr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Ir(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=wn(Ct(t.Ba,t,e),oi(t,t.u)),t.u++,0)))}(t,e)||2==r&&ti(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:si(t,5);break;case 4:si(t,10);break;case 3:si(t,6);break;default:si(t,2)}}function oi(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function si(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=Ct(t.Ya,t);n||(n=new Yn("//www.google.com/images/cleardot.gif"),_t.location&&"http"==_t.location.protocol||Wn(n,"https"),nr(n)),function(t,e){var n=new hn;if(_t.Image){var r=new Image;r.onload=Dt(Ar,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Dt(Ar,n,r,"TestLoadImage: error",!1,e),r.onabort=Dt(Ar,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Dt(Ar,n,r,"TestLoadImage: timeout",!1,e),_t.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else gn(2);t.v=0,t.f&&t.f.ra(e),ui(t),Jr(t)}function ui(t){t.v=0,t.I=-1,t.f&&(0==Or(t.b).length&&0==t.g.length||(t.b.c.length=0,Ft(t.g),t.g.length=0),t.f.qa())}function ai(t,e,n){var r=function(t){return t instanceof Yn?$n(t):new Yn(t,void 0)}(n);if(""!=r.c)e&&Qn(r,e+"."+r.c),Zn(r,r.h);else{var i=_t.location;r=function(t,e,n,r){var i=new Yn(null,void 0);return t&&Wn(i,t),e&&Qn(i,e),n&&Zn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&Xt(t.V,function(t,e){er(r,e,t)}),n=t.na,(e=t.A)&&n&&er(r,e,n),er(r,"VER",t.ha),Wr(t,r),r}function ci(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kr(t.Na)).F=t.C,e}function hi(){}function fi(){if(ne&&!(10<=Number(pe)))throw Error("Environmental error: no available transport.")}function li(t,e){Fe.call(this),this.a=new Gr(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!qt(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!qt(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new vi(this)}function pi(t){Sn.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function di(){Nn.call(this),this.status=1}function vi(t){this.a=t}(It=kr.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:On),this.a.onreadystatechange=Ct(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void Rr(this,o)}t=n||"";var i=new Hn(this.headers);r&&Gn(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Lr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=_t.FormData&&t instanceof _t.FormData,!(0<=Ut(Pr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fr(this),0<this.o&&((this.D=function(t){return ne&&le(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=Ct(this.xa,this)):this.m=nn(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Rr(this,o)}},It.xa=function(){void 0!==Et&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qe(this,"timeout"),this.abort(8))},It.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qe(this,"complete"),qe(this,"abort"),Vr(this))},It.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vr(this,!0)),kr.X.G.call(this)},It.za=function(){this.j||(this.A||this.l||this.g?Mr(this):this.Ua())},It.Ua=function(){Mr(this)},It.W=function(){try{return 2<qr(this)?this.a.status:-1}catch(te){return-1}},It.$=function(){try{return this.a?this.a.responseText:""}catch(te){return""}},It.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xr(e)}},It.ua=function(){return this.h},It.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(It=Gr.prototype).ha=8,It.v=1,It.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new xn(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Wt(r=Yt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Qr(this,n,e),er(i=$n(this.B),"RID",t),er(i,"CVER",22),this.A&&er(i,"X-HTTP-Session-Id",this.A),Wr(this,i),this.i&&r&&Br(i,this.i,r),Er(this.b,n),this.Ia&&er(i,"TYPE","init"),this.da?(er(i,"$req",e),er(i,"SID","null"),n.U=!0,Pn(n,i,null)):Pn(n,i,e),this.v=2}}else 3==this.v&&(t?$r(this,t):0==this.g.length||wr(this.b)||$r(this))},It.Aa=function(){if(this.j=null,ni(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=wn(Ct(this.Ta,this),t)}},It.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,gn(10),Kr(this),ni(this))},It.Sa=function(){null!=this.m&&(this.m=null,Kr(this),ti(this),gn(19))},It.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),gn(2)):(this.c.info("Failed to ping google.com"),gn(1))},(It=hi.prototype).ta=function(){},It.sa=function(){},It.ra=function(){},It.qa=function(){},It.Ja=function(){},fi.prototype.a=function(t,e){return new li(t,e)},Lt(li,Fe),li.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;gn(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ai(t,null,t.fa),Yr(t)},li.prototype.close=function(){Hr(this.a)},li.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Xr(this.a,e)}else this.l?((e={}).__data__=ze(t),Xr(this.a,e)):Xr(this.a,t)},li.prototype.G=function(){this.a.f=null,delete this.f,Hr(this.a),delete this.a,li.X.G.call(this)},Lt(pi,Sn),Lt(di,Nn),Lt(vi,hi),vi.prototype.ta=function(){qe(this.a,"a")},vi.prototype.sa=function(t){qe(this.a,new pi(t))},vi.prototype.ra=function(t){qe(this.a,new di(t))},vi.prototype.qa=function(){qe(this.a,"b")},fi.prototype.createWebChannel=fi.prototype.a,li.prototype.send=li.prototype.h,li.prototype.open=li.prototype.g,li.prototype.close=li.prototype.close,In.NO_ERROR=0,In.TIMEOUT=8,In.HTTP_ERROR=6,Tn.COMPLETE="complete",_n.EventType=jn,jn.OPEN="a",jn.CLOSE="b",jn.ERROR="c",jn.MESSAGE="d",Fe.prototype.listen=Fe.prototype.va,kr.prototype.listenOnce=kr.prototype.wa,kr.prototype.getLastError=kr.prototype.Qa,kr.prototype.getLastErrorCode=kr.prototype.ua,kr.prototype.getStatus=kr.prototype.W,kr.prototype.getResponseJson=kr.prototype.Pa,kr.prototype.getResponseText=kr.prototype.$,kr.prototype.send=kr.prototype.ba;var yi=In,bi=Tn,gi=ln,mi=_n,wi=kr,Ii=n("30Go"),Ti=new bt.b("@firebase/firestore");function Ei(){return Ti.logLevel}function _i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ti.logLevel<=bt.a.DEBUG){var r=e.map(Si);Ti.debug.apply(Ti,Object(Ii.g)(["Firestore (8.2.2): "+t],r))}}function Oi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ti.logLevel<=bt.a.ERROR){var r=e.map(Si);Ti.error.apply(Ti,Object(Ii.g)(["Firestore (8.2.2): "+t],r))}}function ji(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ti.logLevel<=bt.a.WARN){var r=e.map(Si);Ti.warn.apply(Ti,Object(Ii.g)(["Firestore (8.2.2): "+t],r))}}function Si(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(Rd){return t}}function Ni(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.2) INTERNAL ASSERTION FAILED: "+t;throw Oi(e),new Error(e)}function Ai(t,e){t||Ni()}function xi(t,e){return t}function ki(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Ci=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=ki(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Di(t,e){return t<e?-1:t>e?1:0}function Pi(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Li(t){return t+"\0"}var Ri=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.i)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return Di(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();Ri.h=new Ri("");var Ui={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Mi=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(Ii.c)(e,t),e}(Error),Vi=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(Ri.fromBase64String(e))}catch(e){throw new Mi(Ui.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Ri.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),Fi=function(t){this._=t};function qi(){if("undefined"==typeof Uint8Array)throw new Mi(Ui.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Bi(){if("undefined"==typeof atob)throw new Mi(Ui.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e.fromBase64String=function(t){return Bi(),new e(Vi.fromBase64String(t))},e.fromUint8Array=function(t){return qi(),new e(Vi.fromUint8Array(t))},e.prototype.toBase64=function(){return Bi(),this._.toBase64()},e.prototype.toUint8Array=function(){return qi(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Fi),Gi=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Hi=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Ki=function(){function t(t){this.uid=t}return t.prototype.A=function(){return null!=this.uid},t.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Ki.UNAUTHENTICATED=new Ki(null),Ki.P=new Ki("google-credentials-uid"),Ki.g=new Ki("first-party-uid");var Ji=function(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t},Xi=function(){function t(){this.p=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.v=function(){},t.prototype.S=function(t){this.p=t,t(Ki.UNAUTHENTICATED)},t.prototype.D=function(){this.p=null},t}(),Yi=function(){function t(t){var e=this;this.C=null,this.currentUser=Ki.UNAUTHENTICATED,this.N=!1,this.O=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.O++,e.currentUser=e.F(),e.N=!0,e.p&&e.p(e.currentUser)},this.O=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.O,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.O!==e?(_i("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Ai("string"==typeof n.accessToken),new Ji(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.v=function(){this.forceRefresh=!0},t.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},t.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},t.prototype.F=function(){var t=this.auth&&this.auth.getUid();return Ai(null===t||"string"==typeof t),new Ki(t)},t}(),$i=function(){function t(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Ki.g}return Object.defineProperty(t.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Wi=function(){function t(t,e){this.k=t,this.M=e}return t.prototype.getToken=function(){return Promise.resolve(new $i(this.k,this.M))},t.prototype.S=function(t){t(Ki.g)},t.prototype.D=function(){},t.prototype.v=function(){},t}(),Qi=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}return t.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},t}();Qi.U=-1;var Zi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Mi(Ui.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Mi(Ui.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Mi(Ui.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Mi(Ui.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.K=function(t){return this.seconds===t.seconds?Di(this.nanoseconds,t.nanoseconds):Di(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),to=function(){function t(t){this.timestamp=t}return t.j=function(e){return new t(e)},t.min=function(){return new t(new Zi(0,0))},t.prototype.u=function(t){return this.timestamp.K(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.G=function(){return this.timestamp},t}(),eo=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Ni(),void 0===n?n=t.length-e:n>t.length-e&&Ni(),this.segments=t,this.offset=e,this.H=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.J(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.Y(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.X=function(t){return this.Y(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},t.prototype.tt=function(){return this.segments[this.offset]},t.prototype.et=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.nt=function(){return 0===this.length},t.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},t.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),no=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.prototype.ot=function(){return this.rt().join("/")},e.prototype.toString=function(){return this.ot()},e.ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.at=function(){return new e([])},e}(eo),ro=/^[_a-zA-Z][_a-zA-Z0-9]*$/,io=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.ut=function(t){return ro.test(t)},e.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.ut(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.ot()},e.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},e.lt=function(){return new e(["__name__"])},e._t=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Mi(Ui.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Mi(Ui.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new Mi(Ui.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.at=function(){return new e([])},e}(eo),oo=function(){function t(t){this.path=t}return t.ft=function(e){return new t(no.ct(e))},t.dt=function(e){return new t(no.ct(e).X(5))},t.prototype.wt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===no.J(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.J=function(t,e){return no.J(t.path,e.path)},t.Et=function(t){return t.length%2==0},t.Tt=function(e){return new t(new no(e.slice()))},t}();function so(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function uo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ao(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var co=function(){function t(t){this.fields=t,t.sort(io.J)}return t.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},t.prototype.isEqual=function(t){return Pi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),ho=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fo(t){if(Ai(!!t),"string"==typeof t){var e=0,n=ho.exec(t);if(Ai(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:lo(t.seconds),nanos:lo(t.nanos)}}function lo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function po(t){return"string"==typeof t?Ri.fromBase64String(t):Ri.fromUint8Array(t)}function vo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function yo(t){var e=t.mapValue.fields.__previous_value__;return vo(e)?yo(e):e}function bo(t){var e=fo(t.mapValue.fields.__local_write_time__.timestampValue);return new Zi(e.seconds,e.nanos)}function go(t){return null==t}function mo(t){return 0===t&&1/t==-1/0}function wo(t){return"number"==typeof t&&Number.isInteger(t)&&!mo(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vo(t)?4:10:Ni()}function To(t,e){var n=Io(t);if(n!==Io(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bo(t).isEqual(bo(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=fo(t.timestampValue),r=fo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return po(t.bytesValue).isEqual(po(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return lo(t.geoPointValue.latitude)===lo(e.geoPointValue.latitude)&&lo(t.geoPointValue.longitude)===lo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return lo(t.integerValue)===lo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=lo(t.doubleValue),r=lo(e.doubleValue);return n===r?mo(n)===mo(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Pi(t.arrayValue.values||[],e.arrayValue.values||[],To);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(so(n)!==so(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!To(n[i],r[i])))return!1;return!0}(t,e);default:return Ni()}}function Eo(t,e){return void 0!==(t.values||[]).find(function(t){return To(t,e)})}function _o(t,e){var n=Io(t),r=Io(e);if(n!==r)return Di(n,r);switch(n){case 0:return 0;case 1:return Di(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=lo(t.integerValue||t.doubleValue),r=lo(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Oo(t.timestampValue,e.timestampValue);case 4:return Oo(bo(t),bo(e));case 5:return Di(t.stringValue,e.stringValue);case 6:return function(t,e){var n=po(t),r=po(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Di(n[i],r[i]);if(0!==o)return o}return Di(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Di(lo(t.latitude),lo(e.latitude));return 0!==n?n:Di(lo(t.longitude),lo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=_o(n[i],r[i]);if(o)return o}return Di(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Di(r[s],o[s]);if(0!==u)return u;var a=_o(n[r[s]],i[o[s]]);if(0!==a)return a}return Di(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ni()}}function Oo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Di(t,e);var n=fo(t),r=fo(e),i=Di(n.seconds,r.seconds);return 0!==i?i:Di(n.nanos,r.nanos)}function jo(t){return So(t)}function So(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=fo(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?po(t.bytesValue).toBase64():"referenceValue"in t?oo.dt(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=So(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+So(t.fields[o])}return e+"}"}(t.mapValue):Ni();var e}function No(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function Ao(t){return!!t&&"integerValue"in t}function xo(t){return!!t&&"arrayValue"in t}function ko(t){return!!t&&"nullValue"in t}function Co(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Do(t){return!!t&&"mapValue"in t}var Po=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Do(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},t.prototype.isEqual=function(t){return To(this.proto,t.proto)},t}(),Lo=function(){function t(t){void 0===t&&(t=Po.empty()),this.At=t,this.Rt=new Map}return t.prototype.set=function(t,e){return this.Pt(t,e),this},t.prototype.delete=function(t){return this.Pt(t,null),this},t.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Io(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.et(),e)},t.prototype.yt=function(){var t=this.gt(io.at(),this.Rt);return null!=t?new Po(t):this.At},t.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=Do(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.gt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function Ro(t){var e=[];return uo(t.fields||{},function(t,n){var r=new io([t]);if(Do(n)){var i=Ro(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new co(e)}var Uo=function(t,e){this.key=t,this.version=e},Mo=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Vt=r,o.bt=!!i.bt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(Ii.c)(e,t),e.prototype.field=function(t){return this.Vt.field(t)},e.prototype.data=function(){return this.Vt},e.prototype.vt=function(){return this.Vt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Uo),Vo=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(Ii.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Uo),Fo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Uo),qo=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function Bo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new qo(t,e,n,r,i,o,s)}function zo(t){var e=xi(t);if(null===e.St){var n=e.path.ot();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.ot()+t.op.toString()+jo(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.ot()+t.dir}(t)}).join(","),go(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ns(e.startAt)),e.endAt&&(n+="|ub:",n+=ns(e.endAt)),e.St=n}return e.St}function Go(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!is(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!To(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ss(t.startAt,e.startAt)&&ss(t.endAt,e.endAt)}function Ho(t){return oo.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ko=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(Ii.c)(e,t),e.create=function(t,n,r){return t.ht()?"in"===n||"not-in"===n?this.Dt(t,n,r):new Jo(t,n,r):"array-contains"===n?new Wo(t,r):"in"===n?new Qo(t,r):"not-in"===n?new Zo(t,r):"array-contains-any"===n?new ts(t,r):new e(t,n,r)},e.Dt=function(t,e,n){return"in"===e?new Xo(t,n):new Yo(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Ct(_o(e,this.value)):null!==e&&Io(this.value)===Io(e)&&this.Ct(_o(e,this.value))},e.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ni()}},e.prototype.xt=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Jo=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=oo.dt(r.referenceValue),i}return Object(Ii.c)(e,t),e.prototype.matches=function(t){var e=oo.J(t.key,this.key);return this.Ct(e)},e}(Ko),Xo=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=$o(0,n),r}return Object(Ii.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ko),Yo=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=$o(0,n),r}return Object(Ii.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ko);function $o(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return oo.dt(t.referenceValue)})}var Wo=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(Ii.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return xo(e)&&Eo(e.arrayValue,this.value)},e}(Ko),Qo=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(Ii.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Eo(this.value.arrayValue,e)},e}(Ko),Zo=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(Ii.c)(e,t),e.prototype.matches=function(t){if(Eo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Eo(this.value.arrayValue,e)},e}(Ko),ts=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(Ii.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!xo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Eo(e.value.arrayValue,t)})},e}(Ko),es=function(t,e){this.position=t,this.before=e};function ns(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return jo(t)}).join(",")}var rs=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function is(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function os(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ht()?oo.J(oo.dt(s.referenceValue),n.key):_o(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ss(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!To(t.position[n],e.position[n]))return!1;return!0}var us=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ot=null,this.Ft=null};function as(t,e,n,r,i,o,s,u){return new us(t,e,n,r,i,o,s,u)}function cs(t){return new us(t)}function hs(t){return!go(t.limit)&&"F"===t.limitType}function fs(t){return!go(t.limit)&&"L"===t.limitType}function ls(t){return t.Nt.length>0?t.Nt[0].field:null}function ps(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function ds(t){return null!==t.collectionGroup}function vs(t){var e=xi(t);if(null===e.Ot){e.Ot=[];var n=ps(e),r=ls(e);if(null!==n&&null===r)n.ht()||e.Ot.push(new rs(n)),e.Ot.push(new rs(io.lt(),"asc"));else{for(var i=!1,o=0,s=e.Nt;o<s.length;o++){var u=s[o];e.Ot.push(u),u.field.ht()&&(i=!0)}if(!i){var a=e.Nt.length>0?e.Nt[e.Nt.length-1].dir:"asc";e.Ot.push(new rs(io.lt(),a))}}}return e.Ot}function ys(t){var e=xi(t);if(!e.Ft)if("F"===e.limitType)e.Ft=Bo(e.path,e.collectionGroup,vs(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=vs(e);r<i.length;r++){var o=i[r];n.push(new rs(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new es(e.endAt.position,!e.endAt.before):null,u=e.startAt?new es(e.startAt.position,!e.startAt.before):null;e.Ft=Bo(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.Ft}function bs(t,e,n){return new us(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function gs(t,e){return Go(ys(t),ys(e))&&t.limitType===e.limitType}function ms(t){return zo(ys(t))+"|lt:"+t.limitType}function ws(t){return"Query(target="+function(t){var e=t.path.ot();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.ot()+" "+e.op+" "+jo(e.value);var e}).join(", ")+"]"),go(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.ot()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ns(t.startAt)),t.endAt&&(e+=", endAt: "+ns(t.endAt)),"Target("+e+")"}(ys(t))+"; limitType="+t.limitType+")"}function Is(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.wt(t.collectionGroup)&&t.path.st(n):oo.Et(t.path)?t.path.isEqual(n):t.path.it(n)}(t,e)&&function(t,e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!os(t.startAt,vs(t),e)||t.endAt&&os(t.endAt,vs(t),e))}(t,e)}function Ts(t){return function(e,n){for(var r=!1,i=0,o=vs(t);i<o.length;i++){var s=o[i],u=Es(s,e,n);if(0!==u)return u;r=r||s.field.ht()}return 0}}function Es(t,e,n){var r=t.field.ht()?oo.J(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?_o(r,i):Ni()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ni()}}var _s=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=to.min()),void 0===o&&(o=to.min()),void 0===s&&(s=Ri.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.kt,e,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.$t=function(e,n){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Bt=function(e){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,e,this.resumeToken)},t}();function Os(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mo(e)?"-0":e}}function js(t){return{integerValue:""+t}}function Ss(t,e){return wo(e)?js(e):Os(t,e)}var Ns=function(){this.Ut=void 0};function As(t,e,n){return t instanceof Cs?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ds?Ps(t,e):t instanceof Ls?Rs(t,e):function(t,e){var n=ks(t,e),r=Ms(n)+Ms(t.Qt);return Ao(n)&&Ao(t.Qt)?js(r):Os(t.Kt,r)}(t,e)}function xs(t,e,n){return t instanceof Ds?Ps(t,e):t instanceof Ls?Rs(t,e):n}function ks(t,e){return t instanceof Us?Ao(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Cs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e}(Ns),Ds=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Ii.c)(e,t),e}(Ns);function Ps(t,e){for(var n=Vs(e),r=function(t){n.some(function(e){return To(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ls=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Ii.c)(e,t),e}(Ns);function Rs(t,e){for(var n=Vs(e),r=function(t){n=n.filter(function(e){return!To(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Us=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kt=e,r.Qt=n,r}return Object(Ii.c)(e,t),e}(Ns);function Ms(t){return lo(t.integerValue||t.doubleValue)}function Vs(t){return xo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Fs=function(t,e){this.field=t,this.transform=e},qs=function(t,e){this.version=t,this.transformResults=e},Bs=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.jt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function zs(t,e){return void 0!==t.updateTime?e instanceof Mo&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Mo}var Gs=function(){};function Hs(t,e,n){return t instanceof $s?function(t,e,n){var r=t.value;if(n.transformResults){var i=Zs(t.fieldTransforms,e,n.transformResults);r=eu(t.fieldTransforms,r,i)}return new Mo(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ws?function(t,e,n){if(!zs(t.Gt,e))return new Fo(t.key,n.version);var r=Qs(t,e,n.transformResults?Zs(t.fieldTransforms,e,n.transformResults):[]);return new Mo(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Vo(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Ks(t,e,n,r){return t instanceof $s?function(t,e,n,r){if(!zs(t.Gt,e))return e;var i=t.value,o=tu(t.fieldTransforms,n,e);i=eu(t.fieldTransforms,i,o);var s=Ys(e);return new Mo(t.key,s,i,{bt:!0})}(t,e,r):t instanceof Ws?function(t,e,n,r){if(!zs(t.Gt,e))return e;var i=Ys(e),o=Qs(t,e,tu(t.fieldTransforms,n,e));return new Mo(t.key,i,o,{bt:!0})}(t,e,r):function(t,e){return zs(t.Gt,e)?new Vo(t.key,to.min()):e}(t,e)}function Js(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Mo?e.field(o.field):void 0,u=ks(o.transform,s||null);null!=u&&(n=null==n?(new Lo).set(o.field,u):n.set(o.field,u))}return n?n.yt():null}(t.fieldTransforms,e)}function Xs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Pi(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ds&&e instanceof Ds||t instanceof Ls&&e instanceof Ls?Pi(t.elements,e.elements,To):t instanceof Us&&e instanceof Us?To(t.Qt,e.Qt):t instanceof Cs&&e instanceof Cs}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt))}function Ys(t){return t instanceof Mo?t.version:to.min()}var $s=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Gt=r,o.fieldTransforms=i,o.type=0,o}return Object(Ii.c)(e,t),e}(Gs),Ws=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.zt=r,s.Gt=i,s.fieldTransforms=o,s.type=1,s}return Object(Ii.c)(e,t),e}(Gs);function Qs(t,e,n){var r;return r=function(t,e){var n=new Lo(e);return t.zt.fields.forEach(function(e){if(!e.nt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.yt()}(t,r=e instanceof Mo?e.data():Po.empty()),eu(t.fieldTransforms,r,n)}function Zs(t,e,n){var r=[];Ai(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Mo&&(u=e.field(o.field)),r.push(xs(s,u,n[i]))}return r}function tu(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Mo&&(c=n.field(u.field)),i.push(As(a,c,e))}return i}function eu(t,e,n){for(var r=new Lo(e),i=0;i<t.length;i++)r.set(t[i].field,n[i]);return r.yt()}var nu,ru,iu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=2,r.fieldTransforms=[],r}return Object(Ii.c)(e,t),e}(Gs),ou=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=3,r.fieldTransforms=[],r}return Object(Ii.c)(e,t),e}(Gs),su=function(t){this.count=t};function uu(t){switch(t){case Ui.OK:return Ni();case Ui.CANCELLED:case Ui.UNKNOWN:case Ui.DEADLINE_EXCEEDED:case Ui.RESOURCE_EXHAUSTED:case Ui.INTERNAL:case Ui.UNAVAILABLE:case Ui.UNAUTHENTICATED:return!1;case Ui.INVALID_ARGUMENT:case Ui.NOT_FOUND:case Ui.ALREADY_EXISTS:case Ui.PERMISSION_DENIED:case Ui.FAILED_PRECONDITION:case Ui.ABORTED:case Ui.OUT_OF_RANGE:case Ui.UNIMPLEMENTED:case Ui.DATA_LOSS:return!0;default:return Ni()}}function au(t){if(void 0===t)return Oi("GRPC error has no .code"),Ui.UNKNOWN;switch(t){case nu.OK:return Ui.OK;case nu.CANCELLED:return Ui.CANCELLED;case nu.UNKNOWN:return Ui.UNKNOWN;case nu.DEADLINE_EXCEEDED:return Ui.DEADLINE_EXCEEDED;case nu.RESOURCE_EXHAUSTED:return Ui.RESOURCE_EXHAUSTED;case nu.INTERNAL:return Ui.INTERNAL;case nu.UNAVAILABLE:return Ui.UNAVAILABLE;case nu.UNAUTHENTICATED:return Ui.UNAUTHENTICATED;case nu.INVALID_ARGUMENT:return Ui.INVALID_ARGUMENT;case nu.NOT_FOUND:return Ui.NOT_FOUND;case nu.ALREADY_EXISTS:return Ui.ALREADY_EXISTS;case nu.PERMISSION_DENIED:return Ui.PERMISSION_DENIED;case nu.FAILED_PRECONDITION:return Ui.FAILED_PRECONDITION;case nu.ABORTED:return Ui.ABORTED;case nu.OUT_OF_RANGE:return Ui.OUT_OF_RANGE;case nu.UNIMPLEMENTED:return Ui.UNIMPLEMENTED;case nu.DATA_LOSS:return Ui.DATA_LOSS;default:return Ni()}}(ru=nu||(nu={}))[ru.OK=0]="OK",ru[ru.CANCELLED=1]="CANCELLED",ru[ru.UNKNOWN=2]="UNKNOWN",ru[ru.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ru[ru.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ru[ru.NOT_FOUND=5]="NOT_FOUND",ru[ru.ALREADY_EXISTS=6]="ALREADY_EXISTS",ru[ru.PERMISSION_DENIED=7]="PERMISSION_DENIED",ru[ru.UNAUTHENTICATED=16]="UNAUTHENTICATED",ru[ru.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ru[ru.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ru[ru.ABORTED=10]="ABORTED",ru[ru.OUT_OF_RANGE=11]="OUT_OF_RANGE",ru[ru.UNIMPLEMENTED=12]="UNIMPLEMENTED",ru[ru.INTERNAL=13]="INTERNAL",ru[ru.UNAVAILABLE=14]="UNAVAILABLE",ru[ru.DATA_LOSS=15]="DATA_LOSS";var cu=function(){function t(t,e){this.J=t,this.root=e||fu.EMPTY}return t.prototype.Ht=function(e,n){return new t(this.J,this.root.Ht(e,n,this.J).copy(null,null,fu.Jt,null,null))},t.prototype.remove=function(e){return new t(this.J,this.root.remove(e,this.J).copy(null,null,fu.Jt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.nt=function(){return this.root.nt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(){return this.root.Xt()},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.forEach=function(t){this.Zt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Zt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.te=function(t){return this.root.te(t)},t.prototype.ee=function(){return new hu(this.root,null,this.J,!1)},t.prototype.ne=function(t){return new hu(this.root,t,this.J,!1)},t.prototype.se=function(){return new hu(this.root,null,this.J,!0)},t.prototype.ie=function(t){return new hu(this.root,t,this.J,!0)},t}(),hu=function(){function t(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}return t.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},t.prototype.ae=function(){return this.oe.length>0},t.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},t}(),fu=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.nt=function(){return!1},t.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},t.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},t.prototype.min=function(){return this.left.nt()?this:this.left.min()},t.prototype.Yt=function(){return this.min().key},t.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},t.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},t.prototype.le=function(){if(this.left.nt())return t.EMPTY;var e=this;return e.left._e()||e.left.left._e()||(e=e.fe()),(e=e.copy(null,null,null,e.left.le(),null)).he()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.nt()||i.left._e()||i.left.left._e()||(i=i.fe()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left._e()&&(i=i.de()),i.right.nt()||i.right._e()||i.right.left._e()||(i=i.we()),0===n(e,i.key)){if(i.right.nt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.le())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.he()},t.prototype._e=function(){return this.color},t.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},t.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},t.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},t.prototype.Ee=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.de=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},t.prototype.me=function(){if(this._e()&&this.left._e())throw Ni();if(this.right._e())throw Ni();var t=this.left.me();if(t!==this.right.me())throw Ni();return t+(this._e()?0:1)},t}();fu.EMPTY=null,fu.RED=!0,fu.Jt=!1,fu.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Ni()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Ni()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Ni()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Ni()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Ni()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ht=function(t,e,n){return new fu(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.nt=function(){return!0},t.prototype.Zt=function(t){return!1},t.prototype.te=function(t){return!1},t.prototype.Yt=function(){return null},t.prototype.Xt=function(){return null},t.prototype._e=function(){return!1},t.prototype.Ie=function(){return!0},t.prototype.me=function(){return 0},t}());var lu=function(){function t(t){this.J=t,this.data=new cu(this.J)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Yt()},t.prototype.last=function(){return this.data.Xt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Zt(function(e,n){return t(e),!1})},t.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(this.J(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Re=function(t,e){var n;for(n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},t.prototype.Pe=function(t){var e=this.data.ne(t);return e.ae()?e.ce().key:null},t.prototype.ee=function(){return new pu(this.data.ee())},t.prototype.ne=function(t){return new pu(this.data.ne(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.nt=function(){return this.data.nt()},t.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ee(),r=e.data.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(0!==this.J(i,o))return!1}return!0},t.prototype.rt=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.J);return n.data=e,n},t}(),pu=function(){function t(t){this.ge=t}return t.prototype.ce=function(){return this.ge.ce().key},t.prototype.ae=function(){return this.ge.ae()},t}(),du=new cu(oo.J);function vu(){return du}function yu(){return vu()}var bu=new cu(oo.J);function gu(){return bu}var mu=new cu(oo.J);function wu(){return mu}var Iu=new lu(oo.J);function Tu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Iu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Eu=new lu(Di);function _u(){return Eu}var Ou=function(){function t(t){this.J=t?function(e,n){return t(e,n)||oo.J(e.key,n.key)}:function(t,e){return oo.J(t.key,e.key)},this.Ve=gu(),this.pe=new cu(this.J)}return t.be=function(e){return new t(e.J)},t.prototype.has=function(t){return null!=this.Ve.get(t)},t.prototype.get=function(t){return this.Ve.get(t)},t.prototype.first=function(){return this.pe.Yt()},t.prototype.last=function(){return this.pe.Xt()},t.prototype.nt=function(){return this.pe.nt()},t.prototype.indexOf=function(t){var e=this.Ve.get(t);return e?this.pe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.pe.Zt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pe.ee(),r=e.pe.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.J=this.J,r.Ve=e,r.pe=n,r},t}(),ju=function(){function t(){this.ve=new cu(oo.J)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);n?0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):Ni():this.ve=this.ve.Ht(e,t)},t.prototype.Se=function(){var t=[];return this.ve.Zt(function(e,n){t.push(n)}),t},t}(),Su=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}return t.Oe=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Ou.be(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&gs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Nu=function(){function t(t,e,n,r,i){this.Mt=t,this.Fe=e,this.ke=n,this.Me=r,this.Le=i}return t.$e=function(e,n){var r=new Map;return r.set(e,Au.Be(e,n)),new t(to.min(),r,_u(),vu(),Tu())},t}(),Au=function(){function t(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}return t.Be=function(e,n){return new t(Ri.h,n,Tu(),Tu(),Tu())},t}(),xu=function(t,e,n,r){this.je=t,this.removedTargetIds=e,this.key=n,this.We=r},ku=function(t,e){this.targetId=t,this.Ge=e},Cu=function(t,e,n,r){void 0===n&&(n=Ri.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Du=function(){function t(){this.ze=0,this.He=Ru(),this.Je=Ri.h,this.Ye=!1,this.Xe=!0}return Object.defineProperty(t.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),t.prototype.en=function(t){t.o()>0&&(this.Xe=!0,this.Je=t)},t.prototype.nn=function(){var t=Tu(),e=Tu(),n=Tu();return this.He.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Ni()}}),new Au(this.Je,this.Ye,t,e,n)},t.prototype.sn=function(){this.Xe=!1,this.He=Ru()},t.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},t.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},t.prototype.cn=function(){this.ze+=1},t.prototype.an=function(){this.ze-=1},t.prototype.un=function(){this.Xe=!0,this.Ye=!0},t}(),Pu=function(){function t(t){this.hn=t,this.ln=new Map,this._n=vu(),this.fn=Lu(),this.dn=new lu(Di)}return t.prototype.wn=function(t){for(var e=0,n=t.je;e<n.length;e++){var r=n[e];t.We instanceof Mo?this.En(r,t.We):t.We instanceof Vo&&this.Tn(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Tn(r=o[i],t.key,t.We)},t.prototype.In=function(t){var e=this;this.mn(t,function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:Ni()}})},t.prototype.mn=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ln.forEach(function(t,r){n.Rn(r)&&e(r)})},t.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,r=this.gn(e);if(r){var i=r.target;if(Ho(i))if(0===n){var o=new oo(i.path);this.Tn(e,o,new Vo(o,to.min()))}else Ai(1===n);else this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e))}},t.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach(function(r,i){var o=e.gn(i);if(o){if(r.qe&&Ho(o.target)){var s=new oo(o.target.path);null!==e._n.get(s)||e.bn(i,s)||e.Tn(i,s,new Vo(s,t))}r.tn&&(n.set(i,r.nn()),r.sn())}});var r=Tu();this.fn.forEach(function(t,n){var i=!0;n.Re(function(t){var n=e.gn(t);return!n||2===n.kt||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Nu(t,n,this.dn,this._n,r);return this._n=vu(),this.fn=Lu(),this.dn=new lu(Di),i},t.prototype.En=function(t,e){if(this.Rn(t)){var n=this.bn(t,e.key)?2:0;this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t))}},t.prototype.Tn=function(t,e,n){if(this.Rn(t)){var r=this.An(t);this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n))}},t.prototype.removeTarget=function(t){this.ln.delete(t)},t.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},t.prototype.cn=function(t){this.An(t).cn()},t.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new Du,this.ln.set(t,e)),e},t.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new lu(Di),this.fn=this.fn.Ht(t,e)),e},t.prototype.Rn=function(t){var e=null!==this.gn(t);return e||_i("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},t.prototype.Pn=function(t){var e=this;this.ln.set(t,new Du),this.hn.Sn(t).forEach(function(n){e.Tn(t,n,null)})},t.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},t}();function Lu(){return new cu(oo.J)}function Ru(){return new cu(oo.J)}var Uu={asc:"ASCENDING",desc:"DESCENDING"},Mu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Vu=function(t,e){this.T=t,this.qt=e};function Fu(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function qu(t,e){return t.qt?e.toBase64():e.toUint8Array()}function Bu(t,e){return Fu(t,e.G())}function zu(t){return Ai(!!t),to.j(function(t){var e=fo(t);return new Zi(e.seconds,e.nanos)}(t))}function Gu(t,e){return function(t){return new no(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).ot()}function Hu(t){var e=no.ct(t);return Ai(va(e)),e}function Ku(t,e){return Gu(t.T,e.path)}function Ju(t,e){var n=Hu(e);if(n.get(1)!==t.T.projectId)throw new Mi(Ui.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.T.projectId);if(n.get(3)!==t.T.database)throw new Mi(Ui.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.T.database);return new oo(Wu(n))}function Xu(t,e){return Gu(t.T,e)}function Yu(t){var e=Hu(t);return 4===e.length?no.at():Wu(e)}function $u(t){return new no(["projects",t.T.projectId,"databases",t.T.database]).ot()}function Wu(t){return Ai(t.length>4&&"documents"===t.get(4)),t.X(5)}function Qu(t,e,n){return{name:Ku(t,e),fields:n.proto.mapValue.fields}}function Zu(t,e,n){var r=Ju(t,e.name),i=zu(e.updateTime),o=new Po({mapValue:{fields:e.fields}});return new Mo(r,i,o,{hasCommittedMutations:!!n})}function ta(t,e){var n;if(e instanceof $s)n={update:Qu(t,e.key,e.value)};else if(e instanceof iu)n={delete:Ku(t,e.key)};else if(e instanceof Ws)n={update:Qu(t,e.key,e.data),updateMask:da(e.zt)};else{if(!(e instanceof ou))return Ni();n={verify:Ku(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Cs)return{fieldPath:e.field.ot(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ds)return{fieldPath:e.field.ot(),appendMissingElements:{values:n.elements}};if(n instanceof Ls)return{fieldPath:e.field.ot(),removeAllFromArray:{values:n.elements}};if(n instanceof Us)return{fieldPath:e.field.ot(),increment:n.Qt};throw Ni()}(0,t)})),e.Gt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Bu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ni()}(t,e.Gt)),n}function ea(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Bs.updateTime(zu(t.updateTime)):void 0!==t.exists?Bs.exists(t.exists):Bs.jt()}(e.currentDocument):Bs.jt(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(Ai("REQUEST_TIME"===e.setToServerValue),n=new Cs):"appendMissingElements"in e?n=new Ds(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Ls(e.removeAllFromArray.values||[]):"increment"in e?n=new Us(t,e.increment):Ni();var r=io._t(e.fieldPath);return new Fs(r,n)}(t,e)}):[];if(e.update){var i=Ju(t,e.update.name),o=new Po({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new co((t.fieldPaths||[]).map(function(t){return io._t(t)}))}(e.updateMask);return new Ws(i,o,s,n,r)}return new $s(i,o,n,r)}if(e.delete){var u=Ju(t,e.delete);return new iu(u,n)}if(e.verify){var a=Ju(t,e.verify);return new ou(a,n)}return Ni()}function na(t,e){return{documents:[Xu(t,e.path)]}}function ra(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Xu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Xu(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Co(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NAN"}};if(ko(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Co(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NOT_NAN"}};if(ko(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ha(t.field),op:ca(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:ha(t.field),direction:aa(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.qt||go(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=sa(e.startAt)),e.endAt&&(n.structuredQuery.endAt=sa(e.endAt)),n}function ia(t){var e=Yu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Ai(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=oa(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new rs(fa(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return go(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=ua(n.startAt));var h=null;return n.endAt&&(h=ua(n.endAt)),as(e,i,u,s,a,"F",c,h)}function oa(t){return t?void 0!==t.unaryFilter?[pa(t)]:void 0!==t.fieldFilter?[la(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return oa(t)}).reduce(function(t,e){return t.concat(e)}):Ni():[]}function sa(t){return{before:t.before,values:t.position}}function ua(t){return new es(t.values||[],!!t.before)}function aa(t){return Uu[t]}function ca(t){return Mu[t]}function ha(t){return{fieldPath:t.ot()}}function fa(t){return io._t(t.fieldPath)}function la(t){return Ko.create(fa(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Ni()}}(t.fieldFilter.op),t.fieldFilter.value)}function pa(t){switch(t.unaryFilter.op){case"IS_NAN":var e=fa(t.unaryFilter.field);return Ko.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=fa(t.unaryFilter.field);return Ko.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=fa(t.unaryFilter.field);return Ko.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=fa(t.unaryFilter.field);return Ko.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Ni()}}function da(t){var e=[];return t.fields.forEach(function(t){return e.push(t.ot())}),{fieldPaths:e}}function va(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var ya=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},ba=function(){function t(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.On=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.On&&Ni(),this.On=!0,this.Nn?this.error?this.Fn(n,this.error):this.kn(e,this.result):new t(function(t,i){r.Cn=function(n){r.kn(e,n).next(t,i)},r.xn=function(e){r.Fn(n,e).next(t,i)}})},t.prototype.Mn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Ln=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.kn=function(e,n){return e?this.Ln(function(){return e(n)}):t.resolve(n)},t.prototype.Fn=function(e,n){return e?this.Ln(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.$n=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Bn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.$n(r)},t}(),ga=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new ya,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new Ia(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){var r=ja(e.target.error);n.qn.reject(new Ia(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Ia(n,e)}},Object.defineProperty(t.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(_i("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ea(e)},t}(),ma=function(){function t(e,n,r){this.name=e,this.version=n,this.Qn=r,12.2===t.Kn(Object(gt.g)())&&Oi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return _i("SimpleDb","Removing database:",t),_a(window.indexedDB.deleteDatabase(t)).Mn()},t.jn=function(){if("undefined"==typeof indexedDB)return!1;if(t.Wn())return!0;var e=Object(gt.g)(),n=t.Kn(e),r=0<n&&n<10,i=t.Gn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},t.Hn=function(t,e){return t.store(e)},t.Kn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Gn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Jn=function(t){return Object(Ii.b)(this,void 0,void 0,function(){var e,n=this;return Object(Ii.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(_i("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Ia(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Mi(Ui.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Ia(t,n))},i.onupgradeneeded=function(t){_i("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Qn.Yn(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){_i("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}})})},t.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(Ii.b)(this,void 0,void 0,function(){var i,o,s,u,a;return Object(Ii.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object(Ii.d)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Jn(t)];case 2:return u.db=f.sent(),e=ga.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),ba.reject(t)}).Mn(),a={},s.catch(function(){}),[4,e.Un];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return _i("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),wa=function(){function t(t){this.ts=t,this.es=!1,this.ns=null}return Object.defineProperty(t.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.es=!0},t.prototype.rs=function(t){this.ns=t},t.prototype.delete=function(){return _a(this.ts.delete())},t}(),Ia=function(t){function e(e,n){var r=this;return(r=t.call(this,Ui.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(Ii.c)(e,t),e}(Mi);function Ta(t){return"IndexedDbTransactionError"===t.name}var Ea=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(_i("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(_i("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),_a(n)},t.prototype.add=function(t){return _i("SimpleDb","ADD",this.store.name,t,t),_a(this.store.add(t))},t.prototype.get=function(t){var e=this;return _a(this.store.get(t)).next(function(n){return void 0===n&&(n=null),_i("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return _i("SimpleDb","DELETE",this.store.name,t),_a(this.store.delete(t))},t.prototype.count=function(){return _i("SimpleDb","COUNT",this.store.name),_a(this.store.count())},t.prototype.os=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.cs(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.us=function(t,e){_i("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.hs=!1;var r=this.cursor(n);return this.cs(r,function(t,e,n){return n.delete()})},t.prototype.ls=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.cs(r,e)},t.prototype._s=function(t){var e=this.cursor({});return new ba(function(n,r){e.onerror=function(t){var e=ja(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.cs=function(t,e){var n=[];return new ba(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new wa(i),s=e(i.primaryKey,i.value,o);if(s instanceof ba){var u=s.catch(function(t){return o.done(),ba.reject(t)});n.push(u)}o.Nn?r():null===o.ss?i.continue():i.continue(o.ss)}else r()}}).next(function(){return ba.$n(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function _a(t){return new ba(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=ja(t.target.error);n(e)}})}var Oa=!1;function ja(t){var e=ma.Kn(Object(gt.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Mi("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Oa||(Oa=!0,setTimeout(function(){throw r},0)),r}}return t}var Sa=function(){function t(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new ya,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}return t.Is=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},t.prototype.Ps=function(){return this.Rs()},t.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new Mi(Ui.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Rs=function(){var t=this;this.fs.ys(function(){return null!==t.As?(t.clearTimeout(),t.op().then(function(e){return t.Ts.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},t}();function Na(t,e){if(Oi("AsyncQueue",e+": "+t),Ta(t))return new Mi(Ui.UNAVAILABLE,e+": "+t);throw t}var Aa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",xa=function(){function t(){this.gs=[]}return t.prototype.Vs=function(t){this.gs.push(t)},t.prototype.ps=function(){this.gs.forEach(function(t){return t()})},t}();function ka(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Da(e)),e=Ca(t.get(n),e);return Da(e)}function Ca(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Da(t){return t+"\x01\x01"}function Pa(t){var e=t.length;if(Ai(e>=2),2===e)return Ai("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),no.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&Ni(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Ni()}o=s+2}return new no(r)}var La=function(t,e){this.seconds=t,this.nanoseconds=e},Ra=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ra.store="owner",Ra.key="owner";var Ua=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ua.store="mutationQueues",Ua.keyPath="userId";var Ma=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ma.store="mutations",Ma.keyPath="batchId",Ma.userMutationsIndex="userMutationsIndex",Ma.userMutationsKeyPath=["userId","batchId"];var Va=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ka(e)]},t.key=function(t,e,n){return[t,ka(e),n]},t}();Va.store="documentMutations",Va.PLACEHOLDER=new Va;var Fa=function(t,e){this.path=t,this.readTime=e},qa=function(t,e){this.path=t,this.version=e},Ba=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ba.store="remoteDocuments",Ba.readTimeIndex="readTimeIndex",Ba.readTimeIndexPath="readTime",Ba.collectionReadTimeIndex="collectionReadTimeIndex",Ba.collectionReadTimeIndexPath=["parentPath","readTime"];var za=function(t){this.byteSize=t};za.store="remoteDocumentGlobal",za.key="remoteDocumentGlobalKey";var Ga=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ga.store="targets",Ga.keyPath="targetId",Ga.queryTargetsIndexName="queryTargetsIndex",Ga.queryTargetsKeyPath=["canonicalId","targetId"];var Ha=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ha.store="targetDocuments",Ha.keyPath=["targetId","path"],Ha.documentTargetsIndex="documentTargetsIndex",Ha.documentTargetsKeyPath=["path","targetId"];var Ka=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ka.key="targetGlobalKey",Ka.store="targetGlobal";var Ja=function(t,e){this.collectionId=t,this.parent=e};Ja.store="collectionParents",Ja.keyPath=["collectionId","parent"];var Xa=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Xa.store="clientMetadata",Xa.keyPath="clientId";var Ya=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Ya.store="bundles",Ya.keyPath="bundleId";var $a=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};$a.store="namedQueries",$a.keyPath="name";var Wa=Object(Ii.g)(Object(Ii.g)(Object(Ii.g)(Object(Ii.g)([Ua.store,Ma.store,Va.store,Ba.store,Ga.store,Ra.store,Ka.store,Ha.store],[Xa.store]),[za.store]),[Ja.store]),[Ya.store,$a.store]),Qa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).bs=e,r.vs=n,r}return Object(Ii.c)(e,t),e}(xa);function Za(t,e){var n=xi(t);return ma.Hn(n.bs,e)}var tc=function(){function t(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ds=function(t,e,n){for(var r=n.Cs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Hs(o,e,r[i]))}return e},t.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=Ks(s,e,0,this.Ss));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=Ks(s,e,0,this.Ss))}return e},t.prototype.Ns=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.xs(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Tu())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Pi(this.mutations,t.mutations,function(t,e){return Xs(t,e)})&&Pi(this.baseMutations,t.baseMutations,function(t,e){return Xs(t,e)})},t}(),ec=function(){function t(t,e,n,r){this.batch=t,this.Os=e,this.Cs=n,this.Fs=r}return t.from=function(e,n,r){Ai(e.mutations.length===r.length);for(var i=wu(),o=e.mutations,s=0;s<o.length;s++)i=i.Ht(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),nc=function(t){this.ks=t};function rc(t,e){if(e.document)return Zu(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=oo.Tt(e.noDocument.path),r=ac(e.noDocument.readTime);return new Vo(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=oo.Tt(e.unknownDocument.path);return r=ac(e.unknownDocument.version),new Fo(i,r)}return Ni()}function ic(t,e,n){var r=oc(n),i=e.key.path.Z().rt();if(e instanceof Mo){var o=function(t,e){return{name:Ku(t,e.key),fields:e.vt().mapValue.fields,updateTime:Fu(t,e.version.G())}}(t.ks,e),s=e.hasCommittedMutations;return new Ba(null,null,o,s,r,i)}if(e instanceof Vo){var u=e.key.path.rt(),a=uc(e.version);return s=e.hasCommittedMutations,new Ba(null,new Fa(u,a),null,s,r,i)}if(e instanceof Fo){var c=e.key.path.rt(),h=uc(e.version);return new Ba(new qa(c,h),null,null,!0,r,i)}return Ni()}function oc(t){var e=t.G();return[e.seconds,e.nanoseconds]}function sc(t){var e=new Zi(t[0],t[1]);return to.j(e)}function uc(t){var e=t.G();return new La(e.seconds,e.nanoseconds)}function ac(t){var e=new Zi(t.seconds,t.nanoseconds);return to.j(e)}function cc(t,e){for(var n=(e.baseMutations||[]).map(function(e){return ea(t.ks,e)}),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map(function(e){return ea(t.ks,e)}),s=Zi.fromMillis(e.localWriteTimeMs);return new tc(e.batchId,s,n,o)}function hc(t){var e,n,r=ac(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ac(t.lastLimboFreeSnapshotVersion):to.min();return void 0!==t.query.documents?(Ai(1===(n=t.query).documents.length),e=ys(cs(Yu(n.documents[0])))):e=function(t){return ys(ia(t))}(t.query),new _s(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Ri.fromBase64String(t.resumeToken))}function fc(t,e){var n,r=uc(e.Mt),i=uc(e.lastLimboFreeSnapshotVersion);n=Ho(e.target)?na(t.ks,e.target):ra(t.ks,e.target);var o=e.resumeToken.toBase64();return new Ga(e.targetId,zo(e.target),r,o,e.sequenceNumber,i,n)}function lc(t){var e=ia({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?bs(e,e.limit,"L"):e}var pc=function(){function t(){}return t.prototype.Ms=function(t,e){return dc(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:ac(e.createTime),version:e.version};var e})},t.prototype.Ls=function(t,e){return dc(t).put({bundleId:(n=e).id,createTime:uc(zu(n.createTime)),version:n.version});var n},t.prototype.$s=function(t,e){return vc(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:lc(e.bundledQuery),readTime:ac(e.readTime)};var e})},t.prototype.Bs=function(t,e){return vc(t).put(function(t){return{name:t.name,readTime:uc(zu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function dc(t){return Za(t,Ya.store)}function vc(t){return Za(t,$a.store)}var yc=function(){function t(){this.qs=new bc}return t.prototype.Us=function(t,e){return this.qs.add(e),ba.resolve()},t.prototype.Qs=function(t,e){return ba.resolve(this.qs.getEntries(e))},t}(),bc=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new lu(no.J),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.et(),n=t.Z(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new lu(no.J)).rt()},t}(),gc=function(){function t(){this.Ks=new bc}return t.prototype.Us=function(t,e){var n=this;if(!this.Ks.has(e)){var r=e.et(),i=e.Z();t.Vs(function(){n.Ks.add(e)});var o={collectionId:r,parent:ka(i)};return mc(t).put(o)}return ba.resolve()},t.prototype.Qs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Li(e),""],!1,!0);return mc(t).os(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Pa(o.parent))}return n})},t}();function mc(t){return Za(t,Ja.store)}var wc={js:!1,Ws:0,Gs:0,zs:0},Ic=function(){function t(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}return t.Xs=function(e){return new t(e,t.Zs,t.ti)},t}();function Tc(t){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(e){if(t.code!==Ui.FAILED_PRECONDITION||t.message!==Aa)throw t;return _i("LocalStore","Unexpectedly lost primary lease"),[2]})})}Ic.Zs=10,Ic.ti=1e3,Ic.ei=new Ic(41943040,Ic.Zs,Ic.ti),Ic.ni=new Ic(-1,0,0);var Ec=function(){function t(t,e){this.si=t,this.ii=e,this.ri={}}return t.prototype.get=function(t){var e=this.si(t),n=this.ri[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.ii(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){uo(this.ri,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.nt=function(){return ao(this.ri)},t}(),_c=function(){function t(){this.oi=new Ec(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}return t.prototype.ai=function(t){var e=this.oi.get(t);return e?e.readTime:to.min()},t.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},t.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},t.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?ba.resolve(n.li):this.di(t,e)},t.prototype.getEntries=function(t,e){return this.wi(t,e)},t.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},t.prototype.hi=function(){},t}();function Oc(t,e,n){var r=t.store(Ma.store),i=t.store(Va.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ls({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Ai(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Va.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return ba.$n(o).next(function(){return c})}function jc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ni();e=t.noDocument}return JSON.stringify(e).length}var Sc=function(){function t(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}return t.Ai=function(e,n,r,i){return Ai(""!==e.uid),new t(e.A()?e.uid:"",n,r,i)},t.prototype.Ri=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ac(t).ls({index:Ma.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Pi=function(t,e,n,r){var i=this,o=xc(t),s=Ac(t);return s.add({}).next(function(u){Ai("number"==typeof u);for(var a=new tc(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return ta(t.ks,e)}),i=n.mutations.map(function(e){return ta(t.ks,e)});return new Ma(e,n.batchId,n.Ss.toMillis(),r,i)}(i.Kt,i.userId,a),h=[],f=new lu(function(t,e){return Di(t.ot(),e.ot())}),l=0,p=r;l<p.length;l++){var d=p[l],v=Va.key(i.userId,d.key.path,u);f=f.add(d.key.path.Z()),h.push(s.put(c)),h.push(o.put(v,Va.PLACEHOLDER))}return f.forEach(function(e){h.push(i.Ti.Us(t,e))}),t.Vs(function(){i.mi[u]=a.keys()}),ba.$n(h).next(function(){return a})})},t.prototype.yi=function(t,e){var n=this;return Ac(t).get(e).next(function(t){return t?(Ai(t.userId===n.userId),cc(n.Kt,t)):null})},t.prototype.gi=function(t,e){var n=this;return this.mi[e]?ba.resolve(this.mi[e]):this.yi(t,e).next(function(t){if(t){var r=t.keys();return n.mi[e]=r,r}return null})},t.prototype.Vi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ac(t).ls({index:Ma.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Ai(e.batchId>=r),o=cc(n.Kt,e)),i.done()}).next(function(){return o})},t.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ac(t).ls({index:Ma.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ac(t).os(Ma.userMutationsIndex,n).next(function(t){return t.map(function(t){return cc(e.Kt,t)})})},t.prototype.vi=function(t,e){var n=this,r=Va.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return xc(t).ls({range:i},function(r,i,s){var u=r[0],a=r[2],c=Pa(r[1]);if(u===n.userId&&e.path.isEqual(c))return Ac(t).get(a).next(function(t){if(!t)throw Ni();Ai(t.userId===n.userId),o.push(cc(n.Kt,t))});s.done()}).next(function(){return o})},t.prototype.Si=function(t,e){var n=this,r=new lu(Di),i=[];return e.forEach(function(e){var o=Va.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=xc(t).ls({range:s},function(t,i,o){var s=t[0],u=t[2],a=Pa(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()});i.push(u)}),ba.$n(i).next(function(){return n.Di(t,r)})},t.prototype.Ci=function(t,e){var n=this,r=e.path,i=r.length+1,o=Va.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new lu(Di);return xc(t).ls({range:s},function(t,e,o){var s=t[0],a=t[2],c=Pa(t[1]);s===n.userId&&r.st(c)?c.length===i&&(u=u.add(a)):o.done()}).next(function(){return n.Di(t,u)})},t.prototype.Di=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Ac(t).get(e).next(function(t){if(null===t)throw Ni();Ai(t.userId===n.userId),r.push(cc(n.Kt,t))}))}),ba.$n(i).next(function(){return r})},t.prototype.xi=function(t,e){var n=this;return Oc(t.bs,this.userId,e).next(function(r){return t.Vs(function(){n.Ni(e.batchId)}),ba.forEach(r,function(e){return n.Ii.Oi(t,e)})})},t.prototype.Ni=function(t){delete this.mi[t]},t.prototype.Fi=function(t){var e=this;return this.Ri(t).next(function(n){if(!n)return ba.resolve();var r=IDBKeyRange.lowerBound(Va.prefixForUser(e.userId)),i=[];return xc(t).ls({range:r},function(t,n,r){if(t[0]===e.userId){var o=Pa(t[1]);i.push(o)}else r.done()}).next(function(){Ai(0===i.length)})})},t.prototype.ki=function(t,e){return Nc(t,this.userId,e)},t.prototype.Mi=function(t){var e=this;return kc(t).get(this.userId).next(function(t){return t||new Ua(e.userId,-1,"")})},t}();function Nc(t,e,n){var r=Va.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return xc(t).ls({range:o,hs:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function Ac(t){return Za(t,Ma.store)}function xc(t){return Za(t,Va.store)}function kc(t){return Za(t,Ua.store)}var Cc=function(){function t(t){this.Li=t}return t.prototype.next=function(){return this.Li+=2,this.Li},t.$i=function(){return new t(0)},t.Bi=function(){return new t(-1)},t}(),Dc=function(){function t(t,e){this.Ii=t,this.Kt=e}return t.prototype.qi=function(t){var e=this;return this.Ui(t).next(function(n){var r=new Cc(n.highestTargetId);return n.highestTargetId=r.next(),e.Qi(t,n).next(function(){return n.highestTargetId})})},t.prototype.Ki=function(t){return this.Ui(t).next(function(t){return to.j(new Zi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.ji=function(t){return this.Ui(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.Wi=function(t,e,n){var r=this;return this.Ui(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Qi(t,i)})},t.prototype.Gi=function(t,e){var n=this;return this.zi(t,e).next(function(){return n.Ui(t).next(function(r){return r.targetCount+=1,n.Hi(e,r),n.Qi(t,r)})})},t.prototype.Ji=function(t,e){return this.zi(t,e)},t.prototype.Yi=function(t,e){var n=this;return this.Xi(t,e.targetId).next(function(){return Pc(t).delete(e.targetId)}).next(function(){return n.Ui(t)}).next(function(e){return Ai(e.targetCount>0),e.targetCount-=1,n.Qi(t,e)})},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return Pc(t).ls(function(s,u){var a=hc(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Yi(t,a)))}).next(function(){return ba.$n(o)}).next(function(){return i})},t.prototype.mn=function(t,e){return Pc(t).ls(function(t,n){var r=hc(n);e(r)})},t.prototype.Ui=function(t){return Lc(t).get(Ka.key).next(function(t){return Ai(null!==t),t})},t.prototype.Qi=function(t,e){return Lc(t).put(Ka.key,e)},t.prototype.zi=function(t,e){return Pc(t).put(fc(this.Kt,e))},t.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.tr=function(t){return this.Ui(t).next(function(t){return t.targetCount})},t.prototype.er=function(t,e){var n=zo(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Pc(t).ls({range:r,index:Ga.queryTargetsIndexName},function(t,n,r){var o=hc(n);Go(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.nr=function(t,e,n){var r=this,i=[],o=Rc(t);return e.forEach(function(e){var s=ka(e.path);i.push(o.put(new Ha(n,s))),i.push(r.Ii.sr(t,n,e))}),ba.$n(i)},t.prototype.ir=function(t,e,n){var r=this,i=Rc(t);return ba.forEach(e,function(e){var o=ka(e.path);return ba.$n([i.delete([n,o]),r.Ii.rr(t,n,e)])})},t.prototype.Xi=function(t,e){var n=Rc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.cr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Rc(t),i=Tu();return r.ls({range:n,hs:!0},function(t,e,n){var r=Pa(t[1]),o=new oo(r);i=i.add(o)}).next(function(){return i})},t.prototype.ki=function(t,e){var n=ka(e.path),r=IDBKeyRange.bound([n],[Li(n)],!1,!0),i=0;return Rc(t).ls({index:Ha.documentTargetsIndex,hs:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Dn=function(t,e){return Pc(t).get(e).next(function(t){return t?hc(t):null})},t}();function Pc(t){return Za(t,Ga.store)}function Lc(t){return Za(t,Ka.store)}function Rc(t){return Za(t,Ha.store)}function Uc(t,e){var n=t[1],r=e[1],i=Di(t[0],e[0]);return 0===i?Di(n,r):i}var Mc=function(){function t(t){this.ar=t,this.buffer=new lu(Uc),this.ur=0}return t.prototype.hr=function(){return++this.ur},t.prototype.lr=function(t){var e=[t,this.hr()];if(this.buffer.size<this.ar)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Uc(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Vc=function(){function t(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}return t.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},t.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(t.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),t.prototype.Er=function(t){var e=this,n=this.dr?3e5:6e4;_i("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",n,function(){return Object(Ii.b)(e,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(n){switch(n.label){case 0:this.wr=null,this.dr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mr(this._r)];case 2:return n.sent(),[3,7];case 3:return Ta(e=n.sent())?(_i("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Tc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Er(t)];case 8:return n.sent(),[2]}})})})},t}(),Fc=function(){function t(t,e){this.Ar=t,this.params=e}return t.prototype.Rr=function(t,e){return this.Ar.Pr(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.yr=function(t,e){var n=this;if(0===e)return ba.resolve(Qi.U);var r=new Mc(e);return this.Ar.mn(t,function(t){return r.lr(t.sequenceNumber)}).next(function(){return n.Ar.gr(t,function(t){return r.lr(t)})}).next(function(){return r.maxValue})},t.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},t.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},t.prototype.pr=function(t,e){var n=this;return-1===this.params.Hs?(_i("LruGarbageCollector","Garbage collection skipped; disabled"),ba.resolve(wc)):this.br(t).next(function(r){return r<n.params.Hs?(_i("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Hs),wc):n.vr(t,e)})},t.prototype.br=function(t){return this.Ar.br(t)},t.prototype.vr=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.Rr(t,this.params.Js).next(function(e){return e>c.params.Ys?(_i("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Ys+" from "+e),r=c.params.Ys):r=e,o=Date.now(),c.yr(t,r)}).next(function(r){return n=r,s=Date.now(),c.Zi(t,n,e)}).next(function(e){return i=e,u=Date.now(),c.Vr(t,n)}).next(function(t){return a=Date.now(),Ei()<=bt.a.DEBUG&&_i("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),ba.resolve({js:!0,Ws:r,Gs:i,zs:t})})},t}(),qc=function(){function t(t,e){this.db=t,this._r=function(t,e){return new Fc(t,e)}(this,e)}return t.prototype.Pr=function(t){var e=this.Sr(t);return this.db.Dr().tr(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Sr=function(t){var e=0;return this.gr(t,function(t){e++}).next(function(){return e})},t.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},t.prototype.gr=function(t,e){return this.Cr(t,function(t,n){return e(n)})},t.prototype.sr=function(t,e,n){return Bc(t,n)},t.prototype.rr=function(t,e,n){return Bc(t,n)},t.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},t.prototype.Oi=function(t,e){return Bc(t,e)},t.prototype.Nr=function(t,e){return function(t,e){var n=!1;return kc(t)._s(function(r){return Nc(t,r,e).next(function(t){return t&&(n=!0),ba.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Vr=function(t,e){var n=this,r=this.db.Fr().Or(),i=[],o=0;return this.Cr(t,function(s,u){if(u<=e){var a=n.Nr(t,s).next(function(e){if(!e)return o++,r.fi(t,s).next(function(){return r._i(s),Rc(t).delete([0,ka(s.path)])})});i.push(a)}}).next(function(){return ba.$n(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.Lt(t.vs);return this.db.Dr().Ji(t,n)},t.prototype.kr=function(t,e){return Bc(t,e)},t.prototype.Cr=function(t,e){var n,r=Rc(t),i=Qi.U;return r.ls({index:Ha.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Qi.U&&e(new oo(Pa(n)),i),i=s,n=o):i=Qi.U}).next(function(){i!==Qi.U&&e(new oo(Pa(n)),i)})},t.prototype.br=function(t){return this.db.Fr().Mr(t)},t}();function Bc(t,e){return Rc(t).put(function(t,e){return new Ha(0,ka(t.path),e)}(e,t.vs))}var zc=function(){function t(t,e){this.Kt=t,this.Ti=e}return t.prototype.ui=function(t,e,n){return Kc(t).put(Jc(e),n)},t.prototype._i=function(t,e){var n=Kc(t),r=Jc(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Lr(t,r)})},t.prototype.fi=function(t,e){var n=this;return Kc(t).get(Jc(e)).next(function(t){return n.$r(t)})},t.prototype.Br=function(t,e){var n=this;return Kc(t).get(Jc(e)).next(function(t){var e=n.$r(t);return e?{li:e,size:jc(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=yu();return this.qr(t,e,function(t,e){var i=n.$r(e);r=r.Ht(t,i)}).next(function(){return r})},t.prototype.Ur=function(t,e){var n=this,r=yu(),i=new cu(oo.J);return this.qr(t,e,function(t,e){var o=n.$r(e);o?(r=r.Ht(t,o),i=i.Ht(t,jc(e))):(r=r.Ht(t,null),i=i.Ht(t,0))}).next(function(){return{Qr:r,Kr:i}})},t.prototype.qr=function(t,e,n){if(e.nt())return ba.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return Kc(t).ls({range:r},function(t,e,r){for(var s=oo.Tt(t);o&&oo.J(o,s)<0;)n(o,null),o=i.ce();o&&o.isEqual(s)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()}).next(function(){for(;o;)n(o,null),o=i.ae()?i.ce():null})},t.prototype.jr=function(t,e,n){var r=this,i=gu(),o=e.path.length+1,s={};if(n.isEqual(to.min())){var u=e.path.rt();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.rt(),c=oc(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Ba.collectionReadTimeIndex}return Kc(t).ls(s,function(t,n,s){if(t.length===o){var u=rc(r.Kt,n);e.path.st(u.key.path)?u instanceof Mo&&Is(e,u)&&(i=i.Ht(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Or=function(t){return new Gc(this,!!t&&t.Wr)},t.prototype.Mr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Hc(t).get(za.key).next(function(t){return Ai(!!t),t})},t.prototype.Lr=function(t,e){return Hc(t).put(za.key,e)},t.prototype.$r=function(t){if(t){var e=rc(this.Kt,t);return e instanceof Vo&&e.version.isEqual(to.min())?null:e}return null},t}(),Gc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Gr=e,r.Wr=n,r.zr=new Ec(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(Ii.c)(e,t),e.prototype.Ei=function(t){var e=this,n=[],r=0,i=new lu(function(t,e){return Di(t.ot(),e.ot())});return this.oi.forEach(function(o,s){var u=e.zr.get(o);if(s.li){var a=ic(e.Gr.Kt,s.li,e.ai(o));i=i.add(o.path.Z());var c=jc(a);r+=c-u,n.push(e.Gr.ui(t,o,a))}else if(r-=u,e.Wr){var h=ic(e.Gr.Kt,new Vo(o,to.min()),e.ai(o));n.push(e.Gr.ui(t,o,h))}else n.push(e.Gr._i(t,o))}),i.forEach(function(r){n.push(e.Gr.Ti.Us(t,r))}),n.push(this.Gr.updateMetadata(t,r)),ba.$n(n)},e.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next(function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)})},e.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next(function(t){var e=t.Qr;return t.Kr.forEach(function(t,e){n.zr.set(t,e)}),e})},e}(_c);function Hc(t){return Za(t,za.store)}function Kc(t){return Za(t,Ba.store)}function Jc(t){return t.path.rt()}var Xc=function(){function t(t){this.Kt=t}return t.prototype.Yn=function(t,e,n,r){var i=this;Ai(n<r&&n>=0&&r<=11);var o=new ga("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Ra.store)}(t),function(t){t.createObjectStore(Ua.store,{keyPath:Ua.keyPath}),t.createObjectStore(Ma.store,{keyPath:Ma.keyPath,autoIncrement:!0}).createIndex(Ma.userMutationsIndex,Ma.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Va.store)}(t),Yc(t),function(t){t.createObjectStore(Ba.store)}(t));var s=ba.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ha.store),t.deleteObjectStore(Ga.store),t.deleteObjectStore(Ka.store)}(t),Yc(t)),s=s.next(function(){return function(t){var e=t.store(Ka.store),n=new Ka(0,0,to.min().G(),0);return e.put(Ka.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Ma.store).os().next(function(n){t.deleteObjectStore(Ma.store),t.createObjectStore(Ma.store,{keyPath:Ma.keyPath,autoIncrement:!0}).createIndex(Ma.userMutationsIndex,Ma.userMutationsKeyPath,{unique:!0});var r=e.store(Ma.store),i=n.map(function(t){return r.put(t)});return ba.$n(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Xa.store,{keyPath:Xa.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Hr(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(za.store)}(t),i.Jr(o)})),n<7&&r>=7&&(s=s.next(function(){return i.Yr(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Xr(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ba.store);e.createIndex(Ba.readTimeIndex,Ba.readTimeIndexPath,{unique:!1}),e.createIndex(Ba.collectionReadTimeIndex,Ba.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Zr(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(Ya.store,{keyPath:Ya.keyPath})}(t),function(t){t.createObjectStore($a.store,{keyPath:$a.keyPath})}(t)})),s},t.prototype.Jr=function(t){var e=0;return t.store(Ba.store).ls(function(t,n){e+=jc(n)}).next(function(){var n=new za(e);return t.store(za.store).put(za.key,n)})},t.prototype.Hr=function(t){var e=this,n=t.store(Ua.store),r=t.store(Ma.store);return n.os().next(function(n){return ba.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(Ma.userMutationsIndex,i).next(function(r){return ba.forEach(r,function(r){Ai(r.userId===n.userId);var i=cc(e.Kt,r);return Oc(t,n.userId,i).next(function(){})})})})})},t.prototype.Yr=function(t){var e=t.store(Ha.store),n=t.store(Ba.store);return t.store(Ka.store).get(Ka.key).next(function(t){var r=[];return n.ls(function(n,i){var o=new no(n),s=function(t){return[0,ka(t)]}(o);r.push(e.get(s).next(function(n){return n?ba.resolve():function(n){return e.put(new Ha(0,ka(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return ba.$n(r)})})},t.prototype.Xr=function(t,e){t.createObjectStore(Ja.store,{keyPath:Ja.keyPath});var n=e.store(Ja.store),r=new bc,i=function(t){if(r.add(t)){var e=t.et(),i=t.Z();return n.put({collectionId:e,parent:ka(i)})}};return e.store(Ba.store).ls({hs:!0},function(t,e){var n=new no(t);return i(n.Z())}).next(function(){return e.store(Va.store).ls({hs:!0},function(t,e){var n=Pa(t[1]);return i(n.Z())})})},t.prototype.Zr=function(t){var e=this,n=t.store(Ga.store);return n.ls(function(t,r){var i=hc(r),o=fc(e.Kt,i);return n.put(o)})},t}();function Yc(t){t.createObjectStore(Ha.store,{keyPath:Ha.keyPath}).createIndex(Ha.documentTargetsIndex,Ha.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ga.store,{keyPath:Ga.keyPath}).createIndex(Ga.queryTargetsIndexName,Ga.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ka.store)}var $c="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Wc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.eo=o,this.window=s,this.document=u,this.no=c,this.so=h,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!t.jn())throw new Mi(Ui.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new qc(this,i),this.lo=n+"main",this.Kt=new nc(a),this._o=new ma(this.lo,11,new Xc(this.Kt)),this.fo=new Dc(this.Ii,this.Kt),this.Ti=new gc,this.wo=function(t,e){return new zc(t,e)}(this.Kt,this.Ti),this.Eo=new pc,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===h&&Oi("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.Io().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Mi(Ui.FAILED_PRECONDITION,$c);return t.mo(),t.Ao(),t.Ro(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.fo.ji(e)})}).then(function(e){t.io=new Qi(e,t.no)}).then(function(){t.ro=!0}).catch(function(e){return t._o&&t._o.close(),Promise.reject(e)})},t.prototype.Po=function(t){var e=this;return this.ho=function(n){return Object(Ii.b)(e,void 0,void 0,function(){return Object(Ii.d)(this,function(e){return this.Tr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.yo=function(t){var e=this;this._o.Zn(function(n){return Object(Ii.b)(e,void 0,void 0,function(){return Object(Ii.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys(function(){return Object(Ii.b)(e,void 0,void 0,function(){return Object(Ii.d)(this,function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Io=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Zc(e).put(new Xa(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.po(e).next(function(e){e||(t.isPrimary=!1,t.eo.bo(function(){return t.ho(!1)}))})}).next(function(){return t.vo(e)}).next(function(n){return t.isPrimary&&!n?t.So(e).next(function(){return!1}):!!n&&t.Do(e).next(function(){return!0})})}).catch(function(e){if(Ta(e))return _i("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return _i("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.eo.bo(function(){return t.ho(e)}),t.isPrimary=e})},t.prototype.po=function(t){var e=this;return Qc(t).get(Ra.key).next(function(t){return ba.resolve(e.Co(t))})},t.prototype.xo=function(t){return Zc(t).delete(this.clientId)},t.prototype.No=function(){return Object(Ii.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(Ii.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.Oo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=Za(t,Xa.store);return e.os().next(function(t){var n=r.Fo(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return ba.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.To)for(e=0,n=t;e<n.length;e++)this.To.removeItem(this.ko(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,function(){return t.Io().then(function(){return t.No()}).then(function(){return t.Ro()})})},t.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.vo=function(t){var e=this;return this.so?ba.resolve(!0):Qc(t).get(Ra.key).next(function(n){if(null!==n&&e.Oo(n.leaseTimestampMs,5e3)&&!e.Mo(n.ownerId)){if(e.Co(n)&&e.networkEnabled)return!0;if(!e.Co(n)){if(!n.allowTabSynchronization)throw new Mi(Ui.FAILED_PRECONDITION,$c);return!1}}return!(!e.networkEnabled||!e.inForeground)||Zc(t).os().next(function(t){return void 0===e.Fo(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&_i("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.Lo=function(){return Object(Ii.b)(this,void 0,void 0,function(){var t=this;return Object(Ii.d)(this,function(e){switch(e.label){case 0:return this.ro=!1,this.$o(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[Ra.store,Xa.store],function(e){var n=new Qa(e,Qi.U);return t.So(n).next(function(){return t.xo(n)})})];case 1:return e.sent(),this._o.close(),this.Uo(),[2]}})})},t.prototype.Fo=function(t,e){var n=this;return t.filter(function(t){return n.Oo(t.updateTimeMs,e)&&!n.Mo(t.clientId)})},t.prototype.Qo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return Zc(e).os().next(function(e){return t.Fo(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.Ko=function(t){return Sc.Ai(t,this.Kt,this.Ti,this.Ii)},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.jo=function(){return this.Ti},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r,i=this;return _i("IndexedDbPersistence","Starting transaction:",t),this._o.runTransaction(t,"readonly"===e?"readonly":"readwrite",Wa,function(o){return r=new Qa(o,i.io?i.io.next():Qi.U),"readwrite-primary"===e?i.po(r).next(function(t){return!!t||i.vo(r)}).next(function(e){if(!e)throw Oi("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.eo.bo(function(){return i.ho(!1)}),new Mi(Ui.FAILED_PRECONDITION,Aa);return n(r)}).next(function(t){return i.Do(r).next(function(){return t})}):i.Go(r).next(function(){return n(r)})}).then(function(t){return r.ps(),t})},t.prototype.Go=function(t){var e=this;return Qc(t).get(Ra.key).next(function(t){if(null!==t&&e.Oo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Mi(Ui.FAILED_PRECONDITION,$c)})},t.prototype.Do=function(t){var e=new Ra(this.clientId,this.allowTabSynchronization,Date.now());return Qc(t).put(Ra.key,e)},t.jn=function(){return ma.jn()},t.prototype.So=function(t){var e=this,n=Qc(t);return n.get(Ra.key).next(function(t){return e.Co(t)?(_i("IndexedDbPersistence","Releasing primary lease."),n.delete(Ra.key)):ba.resolve()})},t.prototype.Oo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Oi("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()})},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},t.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.$o(),e.eo.ys(function(){return e.Lo()})},this.window.addEventListener("unload",this.oo))},t.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},t.prototype.Mo=function(t){var e;try{var n=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return _i("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Oi("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.$o=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){Oi("Failed to set zombie client id.",t)}},t.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},t.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Qc(t){return Za(t,Ra.store)}function Zc(t){return Za(t,Xa.store)}function th(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var eh=function(t,e){this.progress=t,this.zo=e},nh=function(){function t(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}return t.prototype.Jo=function(t,e){var n=this;return this.Ho.vi(t,e).next(function(r){return n.Yo(t,e,r)})},t.prototype.Yo=function(t,e,n){return this.wo.fi(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].xs(e,t);return t})},t.prototype.Xo=function(t,e,n){var r=yu();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].xs(t,e);r=r.Ht(t,e)}),r},t.prototype.Zo=function(t,e){var n=this;return this.wo.getEntries(t,e).next(function(e){return n.tc(t,e)})},t.prototype.tc=function(t,e){var n=this;return this.Ho.Si(t,e).next(function(r){var i=n.Xo(t,e,r),o=vu();return i.forEach(function(t,e){e||(e=new Vo(t,to.min())),o=o.Ht(t,e)}),o})},t.prototype.jr=function(t,e,n){return function(t){return oo.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ec(t,e.path):ds(e)?this.nc(t,e,n):this.sc(t,e,n)},t.prototype.ec=function(t,e){return this.Jo(t,new oo(e)).next(function(t){var e=gu();return t instanceof Mo&&(e=e.Ht(t.key,t)),e})},t.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=gu();return this.Ti.Qs(t,i).next(function(s){return ba.forEach(s,function(s){var u=function(t,e){return new us(e,null,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.sc(t,u,n).next(function(t){t.forEach(function(t,e){o=o.Ht(t,e)})})}).next(function(){return o})})},t.prototype.sc=function(t,e,n){var r,i,o=this;return this.wo.jr(t,e,n).next(function(n){return r=n,o.Ho.Ci(t,e)}).next(function(e){return o.ic(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=Ks(a,r.get(c),0,o.Ss);r=h instanceof Mo?r.Ht(c,h):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){Is(e,n)||(r=r.remove(t))}),r})},t.prototype.ic=function(t,e,n){for(var r=Tu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ws&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Mo&&(c=c.Ht(t,e))}),c})},t}(),rh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}return t.cc=function(e,n){for(var r=Tu(),i=Tu(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),ih=function(){function t(){}return t.prototype.ac=function(t){this.uc=t},t.prototype.jr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Nt.length||1===t.Nt.length&&t.Nt[0].field.ht())}(e)||n.isEqual(to.min())?this.hc(t,e):this.uc.Zo(t,r).next(function(o){var s=i.lc(e,o);return(hs(e)||fs(e))&&i._c(e.limitType,s,r,n)?i.hc(t,e):(Ei()<=bt.a.DEBUG&&_i("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),ws(e)),i.uc.jr(t,e,n).next(function(t){return s.forEach(function(e){t=t.Ht(e.key,e)}),t}))})},t.prototype.lc=function(t,e){var n=new lu(Ts(t));return e.forEach(function(e,r){r instanceof Mo&&Is(t,r)&&(n=n.add(r))}),n},t.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.hc=function(t,e){return Ei()<=bt.a.DEBUG&&_i("QueryEngine","Using full collection scan to execute query:",ws(e)),this.uc.jr(t,e,to.min())},t}(),oh=function(){function t(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new cu(Di),this.wc=new Ec(function(t){return zo(t)},Go),this.Ec=to.min(),this.Ho=t.Ko(n),this.Tc=t.Fr(),this.fo=t.Dr(),this.Ic=new nh(this.Tc,this.Ho,this.persistence.jo()),this.Eo=t.Wo(),this.fc.ac(this.Ic)}return t.prototype.mr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.pr(n,e.dc)})},t}();function sh(t,e,n,r){return new oh(t,e,n,r)}function uh(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Ii.d)(this,function(s){switch(s.label){case 0:return n=xi(t),r=n.Ho,i=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.Ho.bi(t).next(function(s){return o=s,r=n.persistence.Ko(e),i=new nh(n.Tc,r,n.persistence.jo()),r.bi(t)}).next(function(e){for(var n=[],r=[],s=Tu(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)s=s.add(y[v].key)}return i.Zo(t,s).next(function(t){return{mc:t,Ac:n,Rc:r}})})})];case 1:return o=s.sent(),[2,(n.Ho=r,n.Ic=i,n.fc.ac(n.Ic),o)]}})})}function ah(t,e){var n=xi(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Tc.Or({Wr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=ba.resolve();return o.forEach(function(t){s=s.next(function(){return r.fi(e,t)}).next(function(e){var o=e,s=n.Fs.get(t);Ai(null!==s),(!o||o.version.u(s)<0)&&(o=i.Ds(t,o,n))&&r.ui(o,n.Os)})}),s.next(function(){return t.Ho.xi(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.Ho.Fi(t)}).next(function(){return n.Ic.Zo(t,r)})})}function ch(t){var e=xi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function hh(t,e){var n=xi(t),r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Tc.Or({Wr:!0});i=n.dc;var s=[];e.Fe.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.fo.ir(t,e.Ke,o).next(function(){return n.fo.nr(t,e.Ue,o)}));var a=e.resumeToken;if(a.o()>0){var c=u.$t(a,r).Lt(t.vs);i=i.Ht(o,c),function(t,e,n){return Ai(e.resumeToken.o()>0),0===t.resumeToken.o()||e.Mt.W()-t.Mt.W()>=3e8||n.Ue.size+n.Qe.size+n.Ke.size>0}(u,c,e)&&s.push(n.fo.Ji(t,c))}}});var u=vu();if(e.Me.forEach(function(r,i){e.Le.has(r)&&s.push(n.persistence.Ii.kr(t,r))}),s.push(fh(t,o,e.Me,r,void 0).next(function(t){u=t})),!r.isEqual(to.min())){var a=n.fo.Ki(t).next(function(e){return n.fo.Wi(t,t.vs,r)});s.push(a)}return ba.$n(s).next(function(){return o.apply(t)}).next(function(){return n.Ic.tc(t,u)})}).then(function(t){return n.dc=i,t})}function fh(t,e,n,r,i){var o=Tu();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=vu();return n.forEach(function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof Vo&&s.version.isEqual(to.min())?(e._i(n,a),o=o.Ht(n,s)):null==u||s.version.u(u.version)>0||0===s.version.u(u.version)&&u.hasPendingWrites?(e.ui(s,a),o=o.Ht(n,s)):_i("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)}),o})}function lh(t,e){var n=xi(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Ho.Vi(t,e)})}function ph(t,e){var n=xi(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.fo.er(t,e).next(function(i){return i?ba.resolve(r=i):n.fo.qi(t).next(function(i){return r=new _s(e,i,0,t.vs),n.fo.Gi(t,r).next(function(){return r})})})}).then(function(t){var r=n.dc.get(t.targetId);return(null===r||t.Mt.u(r.Mt)>0)&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t})}function dh(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Ii.d)(this,function(u){switch(u.label){case 0:r=xi(t),i=r.dc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Ii.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!Ta(s=u.sent()))throw s;return _i("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(i.target),[2]}})})}function vh(t,e,n){var r=xi(t),i=to.min(),o=Tu();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=xi(t),i=r.wc.get(n);return void 0!==i?ba.resolve(r.dc.get(i)):r.fo.er(e,n)}(r,t,ys(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.fo.cr(t,e.targetId).next(function(t){o=t})}).next(function(){return r.fc.jr(t,e,n?i:to.min(),n?o:Tu())}).next(function(t){return{documents:t,Pc:o}})})}function yh(t,e){var n=xi(t),r=xi(n.fo),i=n.dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function bh(t){var e=xi(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=xi(t),i=vu(),o=oc(n),s=Kc(e),u=IDBKeyRange.lowerBound(o,!0);return s.ls({index:Ba.readTimeIndex,range:u},function(t,e){var n=rc(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{zo:i,readTime:sc(o)}})}(e.Tc,t,e.Ec)}).then(function(t){var n=t.zo;return e.Ec=t.readTime,n})}function gh(t){return Object(Ii.b)(this,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(n){return[2,(e=xi(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Kc(t),n=to.min();return e.ls({index:Ba.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=sc(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.Ec=t})]})})}function mh(t,e,n,r){return Object(Ii.b)(this,void 0,void 0,function(){var i,o,s,u,a,c,h,f,l,p;return Object(Ii.d)(this,function(d){switch(d.label){case 0:for(i=xi(t),o=Tu(),s=vu(),u=wu(),a=0,c=n;a<c.length;a++)f=e.yc((h=c[a]).metadata.name),h.document&&(o=o.add(f)),s=s.Ht(f,e.gc(h)),u=u.Ht(f,e.Vc(h.metadata.readTime));return l=i.Tc.Or({Wr:!0}),[4,ph(i,function(t){return ys(cs(no.ct("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return fh(t,l,s,to.min(),u).next(function(e){return l.apply(t),e}).next(function(e){return i.fo.Xi(t,p.targetId).next(function(){return i.fo.nr(t,o,p.targetId)}).next(function(){return i.Ic.tc(t,e)})})})]}})})}function wh(t,e,n){return void 0===n&&(n=Tu()),Object(Ii.b)(this,void 0,void 0,function(){var r,i;return Object(Ii.d)(this,function(o){switch(o.label){case 0:return[4,ph(t,ys(lc(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=xi(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=zu(e.readTime);if(r.Mt.u(o)>=0)return i.Eo.Bs(t,e);var s=r.$t(Ri.h,o);return i.dc=i.dc.Ht(s.targetId,s),i.fo.Ji(t,s).next(function(){return i.fo.Xi(t,r.targetId)}).next(function(){return i.fo.nr(t,n,r.targetId)}).next(function(){return i.Eo.Bs(t,e)})})]}})})}var Ih=function(){function t(t){this.Kt=t,this.bc=new Map,this.vc=new Map}return t.prototype.Ms=function(t,e){return ba.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){var n;return this.bc.set(e.id,{id:(n=e).id,version:n.version,createTime:zu(n.createTime)}),ba.resolve()},t.prototype.$s=function(t,e){return ba.resolve(this.vc.get(e))},t.prototype.Bs=function(t,e){return this.vc.set(e.name,function(t){return{name:t.name,query:lc(t.bundledQuery),readTime:zu(t.readTime)}}(e)),ba.resolve()},t}(),Th=function(){function t(){this.Sc=new lu(Eh.Dc),this.Cc=new lu(Eh.xc)}return t.prototype.nt=function(){return this.Sc.nt()},t.prototype.sr=function(t,e){var n=new Eh(t,e);this.Sc=this.Sc.add(n),this.Cc=this.Cc.add(n)},t.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},t.prototype.rr=function(t,e){this.Oc(new Eh(t,e))},t.prototype.Fc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},t.prototype.kc=function(t){var e=this,n=new oo(new no([])),r=new Eh(n,t),i=new Eh(n,t+1),o=[];return this.Cc.Ae([r,i],function(t){e.Oc(t),o.push(t.key)}),o},t.prototype.Mc=function(){var t=this;this.Sc.forEach(function(e){return t.Oc(e)})},t.prototype.Oc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},t.prototype.Lc=function(t){var e=new oo(new no([])),n=new Eh(e,t),r=new Eh(e,t+1),i=Tu();return this.Cc.Ae([n,r],function(t){i=i.add(t.key)}),i},t.prototype.ki=function(t){var e=new Eh(t,0),n=this.Sc.Pe(e);return null!==n&&t.isEqual(n.key)},t}(),Eh=function(){function t(t,e){this.key=t,this.$c=e}return t.Dc=function(t,e){return oo.J(t.key,e.key)||Di(t.$c,e.$c)},t.xc=function(t,e){return Di(t.$c,e.$c)||oo.J(t.key,e.key)},t}(),_h=function(){function t(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new lu(Eh.Dc)}return t.prototype.Ri=function(t){return ba.resolve(0===this.Ho.length)},t.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++;var o=new tc(i,e,n,r);this.Ho.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.qc=this.qc.add(new Eh(a.key,i)),this.Ti.Us(t,a.key.path.Z())}return ba.resolve(o)},t.prototype.yi=function(t,e){return ba.resolve(this.Uc(e))},t.prototype.Vi=function(t,e){var n=this.Qc(e+1),r=n<0?0:n;return ba.resolve(this.Ho.length>r?this.Ho[r]:null)},t.prototype.pi=function(){return ba.resolve(0===this.Ho.length?-1:this.Bc-1)},t.prototype.bi=function(t){return ba.resolve(this.Ho.slice())},t.prototype.vi=function(t,e){var n=this,r=new Eh(e,0),i=new Eh(e,Number.POSITIVE_INFINITY),o=[];return this.qc.Ae([r,i],function(t){var e=n.Uc(t.$c);o.push(e)}),ba.resolve(o)},t.prototype.Si=function(t,e){var n=this,r=new lu(Di);return e.forEach(function(t){var e=new Eh(t,0),i=new Eh(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,i],function(t){r=r.add(t.$c)})}),ba.resolve(this.Kc(r))},t.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,i=n;oo.Et(i)||(i=i.child(""));var o=new Eh(new oo(i),0),s=new lu(Di);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(s=s.add(t.$c)),!0)},o),ba.resolve(this.Kc(s))},t.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Uc(t);null!==r&&n.push(r)}),n},t.prototype.xi=function(t,e){var n=this;Ai(0===this.jc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return ba.forEach(e.mutations,function(i){var o=new Eh(i.key,e.batchId);return r=r.delete(o),n.Ii.Oi(t,i.key)}).next(function(){n.qc=r})},t.prototype.Ni=function(t){},t.prototype.ki=function(t,e){var n=new Eh(e,0),r=this.qc.Pe(n);return ba.resolve(e.isEqual(r&&r.key))},t.prototype.Fi=function(t){return ba.resolve()},t.prototype.jc=function(t,e){return this.Qc(t)},t.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},t.prototype.Uc=function(t){var e=this.Qc(t);return e<0||e>=this.Ho.length?null:this.Ho[e]},t}(),Oh=function(){function t(t,e){this.Ti=t,this.Wc=e,this.docs=new cu(oo.J),this.size=0}return t.prototype.ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Wc(e);return this.docs=this.docs.Ht(r,{li:e,size:s,readTime:n}),this.size+=s-o,this.Ti.Us(t,r.path.Z())},t.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.fi=function(t,e){var n=this.docs.get(e);return ba.resolve(n?n.li:null)},t.prototype.getEntries=function(t,e){var n=this,r=yu();return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),ba.resolve(r)},t.prototype.jr=function(t,e,n){for(var r=gu(),i=new oo(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.value,a=u.li,c=u.readTime;if(!e.path.st(s.key.path))break;c.u(n)<=0||a instanceof Mo&&Is(e,a)&&(r=r.Ht(a.key,a))}return ba.resolve(r)},t.prototype.Gc=function(t,e){return ba.forEach(this.docs,function(t){return e(t)})},t.prototype.Or=function(t){return new jh(this)},t.prototype.Mr=function(t){return ba.resolve(this.size)},t}(),jh=function(t){function e(e){var n=this;return(n=t.call(this)||this).Gr=e,n}return Object(Ii.c)(e,t),e.prototype.Ei=function(t){var e=this,n=[];return this.oi.forEach(function(r,i){i&&i.li?n.push(e.Gr.ui(t,i.li,e.ai(r))):e.Gr._i(r)}),ba.$n(n)},e.prototype.di=function(t,e){return this.Gr.fi(t,e)},e.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},e}(_c),Sh=function(){function t(t){this.persistence=t,this.zc=new Ec(function(t){return zo(t)},Go),this.lastRemoteSnapshotVersion=to.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new Th,this.targetCount=0,this.Yc=Cc.$i()}return t.prototype.mn=function(t,e){return this.zc.forEach(function(t,n){return e(n)}),ba.resolve()},t.prototype.Ki=function(t){return ba.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ji=function(t){return ba.resolve(this.Hc)},t.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),ba.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),ba.resolve()},t.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new Cc(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},t.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,ba.resolve()},t.prototype.Ji=function(t,e){return this.zi(e),ba.resolve()},t.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),this.targetCount-=1,ba.resolve()},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.zc.delete(s),o.push(r.Xi(t,u.targetId)),i++)}),ba.$n(o).next(function(){return i})},t.prototype.tr=function(t){return ba.resolve(this.targetCount)},t.prototype.er=function(t,e){var n=this.zc.get(e)||null;return ba.resolve(n)},t.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),ba.resolve()},t.prototype.ir=function(t,e,n){this.Jc.Fc(e,n);var r=this.persistence.Ii,i=[];return r&&e.forEach(function(e){i.push(r.Oi(t,e))}),ba.$n(i)},t.prototype.Xi=function(t,e){return this.Jc.kc(e),ba.resolve()},t.prototype.cr=function(t,e){var n=this.Jc.Lc(e);return ba.resolve(n)},t.prototype.ki=function(t,e){return ba.resolve(this.Jc.ki(e))},t}(),Nh=function(){function t(t,e){var n=this;this.Xc={},this.io=new Qi(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new Sh(this),this.Ti=new yc,this.wo=function(t,e){return new Oh(t,function(t){return n.Ii.Zc(t)})}(this.Ti),this.Kt=new nc(e),this.Eo=new Ih(this.Kt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Lo=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.yo=function(){},t.prototype.Vo=function(){},t.prototype.jo=function(){return this.Ti},t.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new _h(this.Ti,this.Ii),this.Xc[t.R()]=e),e},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r=this;_i("MemoryPersistence","Starting transaction:",t);var i=new Ah(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},t.prototype.na=function(t,e){return ba.Bn(Object.values(this.Xc).map(function(n){return function(){return n.ki(t,e)}}))},t}(),Ah=function(t){function e(e){var n=this;return(n=t.call(this)||this).vs=e,n}return Object(Ii.c)(e,t),e}(xa),xh=function(){function t(t){this.persistence=t,this.sa=new Th,this.ia=null}return t.ra=function(e){return new t(e)},Object.defineProperty(t.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw Ni()},enumerable:!1,configurable:!0}),t.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),ba.resolve()},t.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),ba.resolve()},t.prototype.Oi=function(t,e){return this.oa.add(e.toString()),ba.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},t.prototype.ta=function(){this.ia=new Set},t.prototype.ea=function(t){var e=this,n=this.persistence.Fr().Or();return ba.forEach(this.oa,function(r){var i=oo.ft(r);return e.ca(t,i).next(function(t){t||n._i(i)})}).next(function(){return e.ia=null,n.apply(t)})},t.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},t.prototype.Zc=function(t){return 0},t.prototype.ca=function(t,e){var n=this;return ba.Bn([function(){return ba.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},t}();function kh(t,e){return"firestore_clients_"+t+"_"+e}function Ch(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.A()&&(r+="_"+e.uid),r}function Dh(t,e){return"firestore_targets_"+t+"_"+e}var Ph=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.aa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new Mi(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(Oi("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Lh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.aa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Mi(r.error.code,r.error.message)),i?new t(e,r.state,o):(Oi("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Rh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.aa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=_u(),s=0;i&&s<r.activeTargetIds.length;++s)i=wo(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Oi("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Uh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.aa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Oi("SharedClientState","Failed to parse online state: "+e),null)},t}(),Mh=function(){function t(){this.activeTargetIds=_u()}return t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Vh=function(){function t(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new cu(Di),this.Tr=!1,this.Ia=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=kh(this.persistenceKey,this._a),this.Aa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ta=this.Ta.Ht(this._a,new Mh),this.Ra=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ga=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Va=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wa)}return t.jn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(Ii.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object(Ii.d)(this,function(f){switch(f.label){case 0:return[4,this.fa.Qo()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(kh(this.persistenceKey,r)))&&(o=Rh.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(u=this.ba(s))&&this.va(u),a=0,c=this.Ia;a<c.length;a++)this.Ea(c[a]);return this.Ia=[],this.window.addEventListener("unload",function(){return h.Lo()}),this.Tr=!0,[2]}})})},t.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},t.prototype.Sa=function(){return this.Da(this.Ta)},t.prototype.Ca=function(t){var e=!1;return this.Ta.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.xa=function(t){this.Na(t,"pending")},t.prototype.Oa=function(t,e,n){this.Na(t,e,n),this.Fa(t)},t.prototype.ka=function(t){var e="not-current";if(this.Ca(t)){var n=this.storage.getItem(Dh(this.persistenceKey,t));if(n){var r=Lh.aa(t,n);r&&(e=r.state)}}return this.Ma.ha(t),this.pa(),e},t.prototype.La=function(t){this.Ma.la(t),this.pa()},t.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},t.prototype.Ba=function(t){this.removeItem(Dh(this.persistenceKey,t))},t.prototype.qa=function(t,e,n){this.Ua(t,e,n)},t.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Fa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},t.prototype.Ka=function(t){this.ja(t)},t.prototype.Wa=function(){this.Ga()},t.prototype.Lo=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return _i("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){_i("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){_i("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(_i("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void Oi("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.eo.bo(function(){return Object(Ii.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(Ii.d)(this,function(u){if(this.Tr){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(e=this.Ja(n.key,n.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Ya(n.key,n.newValue)))return[2,this.Xa(r)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(i=this.Za(n.key,n.newValue)))return[2,this.tu(i)]}else if(n.key===this.ga){if(null!==n.newValue&&(o=this.ba(n.newValue)))return[2,this.va(o)]}else if(n.key===this.Aa)(s=function(t){var e=Qi.U;if(null!=t)try{var n=JSON.parse(t);Ai("number"==typeof n),e=n}catch(t){Oi("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Qi.U&&this.L(s);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),t.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},t.prototype.Na=function(t,e,n){var r=new Ph(this.currentUser,t,e,n),i=Ch(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ua())},t.prototype.Fa=function(t){var e=Ch(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.ja=function(t){this.storage.setItem(this.ga,JSON.stringify({clientId:this._a,onlineState:t}))},t.prototype.Ua=function(t,e,n){var r=Dh(this.persistenceKey,t),i=new Lh(t,e,n);this.setItem(r,i.ua())},t.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},t.prototype.za=function(t){var e=this.Ra.exec(t);return e?e[1]:null},t.prototype.Ja=function(t,e){var n=this.za(t);return Rh.aa(n,e)},t.prototype.Ya=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return Ph.aa(new Ki(void 0!==n[2]?n[2]:null),r,e)},t.prototype.Za=function(t,e){var n=this.ya.exec(t),r=Number(n[1]);return Lh.aa(r,e)},t.prototype.ba=function(t){return Uh.aa(t)},t.prototype.Xa=function(t){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(_i("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},t.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fa.iu(s,u).then(function(){n.Ta=r})},t.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},t.prototype.Da=function(t){var e=_u();return t.forEach(function(t,n){e=e.ye(n.activeTargetIds)}),e},t}(),Fh=function(){function t(){this.ru=new Mh,this.ou={},this.da=null,this.L=null}return t.prototype.xa=function(t){},t.prototype.Oa=function(t,e,n){},t.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},t.prototype.qa=function(t,e,n){this.ou[t]=e},t.prototype.La=function(t){this.ru.la(t)},t.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.Ba=function(t){delete this.ou[t]},t.prototype.Sa=function(){return this.ru.activeTargetIds},t.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.start=function(){return this.ru=new Mh,Promise.resolve()},t.prototype.Qa=function(t,e,n){},t.prototype.Ka=function(t){},t.prototype.Lo=function(){},t.prototype.q=function(t){},t.prototype.Wa=function(){},t}(),qh=function(){function t(){}return t.prototype.cu=function(t){},t.prototype.Lo=function(){},t}(),Bh=function(){function t(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}return t.prototype.cu=function(t){this._u.push(t)},t.prototype.Lo=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},t.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},t.prototype.uu=function(){_i("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},t.prototype.lu=function(){_i("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},t.jn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),zh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Gh=function(){function t(t){this.du=t.du,this.wu=t.wu}return t.prototype.Eu=function(t){this.Tu=t},t.prototype.Iu=function(t){this.mu=t},t.prototype.onMessage=function(t){this.Au=t},t.prototype.close=function(){this.wu()},t.prototype.send=function(t){this.du(t)},t.prototype.Ru=function(){this.Tu()},t.prototype.Pu=function(t){this.mu(t)},t.prototype.yu=function(t){this.Au(t)},t}(),Hh=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.I=e.I,n}return Object(Ii.c)(e,t),e.prototype.Du=function(t,e,n,r){return new Promise(function(i,o){var s=new wi;s.listenOnce(bi.COMPLETE,function(){try{switch(s.getLastErrorCode()){case yi.NO_ERROR:var e=s.getResponseJson();_i("Connection","XHR received:",JSON.stringify(e)),i(e);break;case yi.TIMEOUT:_i("Connection",'RPC "'+t+'" timed out'),o(new Mi(Ui.DEADLINE_EXCEEDED,"Request time out"));break;case yi.HTTP_ERROR:var n=s.getStatus();if(_i("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Ui).indexOf(e)>=0?e:Ui.UNKNOWN}(r.status);o(new Mi(u,r.message))}else o(new Mi(Ui.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Mi(Ui.UNAVAILABLE,"Connection failed."));break;default:Ni()}}finally{_i("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.xu=function(t,e){var n=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new fi,i=dn(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(o.initMessageHeaders,e),Object(gt.l)()||Object(gt.n)()||Object(gt.j)()||Object(gt.k)()||Object(gt.o)()||Object(gt.i)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");_i("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new Gh({du:function(t){c?_i("Connection","Not sending because WebChannel is closed:",t):(a||(_i("Connection","Opening WebChannel transport."),u.open(),a=!0),_i("Connection","WebChannel sending:",t),u.send(t))},wu:function(){return u.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,mi.EventType.OPEN,function(){c||_i("Connection","WebChannel transport opened.")}),f(u,mi.EventType.CLOSE,function(){c||(c=!0,_i("Connection","WebChannel transport closed"),h.Pu())}),f(u,mi.EventType.ERROR,function(t){c||(c=!0,ji("Connection","WebChannel transport errored:",t),h.Pu(new Mi(Ui.UNAVAILABLE,"The operation could not be completed")))}),f(u,mi.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];Ai(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){_i("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=nu[t];if(void 0!==e)return au(e)}(i),s=r.message;void 0===o&&(o=Ui.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Pu(new Mi(o,s)),u.close()}else _i("Connection","WebChannel received:",n),h.yu(n)}}),f(i,gi.STAT_EVENT,function(t){10===t.stat?_i("Connection","Detected buffering proxy"):11===t.stat&&_i("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Ru()},0),h},e}(function(){function t(t){this.gu=t,this.T=t.T,this.Vu=(t.ssl?"https":"http")+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}return t.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);_i("RestConnection","Sending: ",i,n);var o={};return this.Su(o,r),this.Du(t,i,o,n).then(function(t){return _i("RestConnection","Received: ",t),t},function(e){throw ji("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},t.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.2",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},t.prototype.vu=function(t,e){return this.Vu+"/v1/"+e+":"+zh[t]},t}());function Kh(){return"undefined"!=typeof window?window:null}function Jh(){return"undefined"!=typeof document?document:null}function Xh(t){return new Vu(t,!0)}var Yh=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Ou=r,this.Fu=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}return t.prototype.reset=function(){this.ku=0},t.prototype.$u=function(){this.ku=this.Fu},t.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);i>0&&_i("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,function(){return e.Lu=Date.now(),t()}),this.ku*=this.Ou,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Fu&&(this.ku=this.Fu)},t.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},t.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},t.prototype.qu=function(){return(Math.random()-.5)*this.ku},t}(),$h=function(){function t(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.ju=i,this.listener=o,this.state=0,this.Wu=0,this.Gu=null,this.stream=null,this.zu=new Yh(t,e)}return t.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ju=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Yu()},t.prototype.stop=function(){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Xu=function(){this.state=0,this.zu.reset()},t.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,function(){return t.th()}))},t.prototype.eh=function(t){this.nh(),this.stream.send(t)},t.prototype.th=function(){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},t.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},t.prototype.close=function(t,e){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.Wu++,3!==t?this.zu.reset():e&&e.code===Ui.RESOURCE_EXHAUSTED?(Oi(e.toString()),Oi("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===Ui.UNAUTHENTICATED&&this.ju.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}})})},t.prototype.sh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.Wu),n=this.Wu;this.ju.getToken().then(function(e){t.Wu===n&&t.rh(e)},function(n){e(function(){var e=new Mi(Ui.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)})})},t.prototype.rh=function(t){var e=this,n=this.ih(this.Wu);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return Object(Ii.b)(t,void 0,void 0,function(){return Object(Ii.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.oh=function(t){return _i("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ih=function(t){var e=this;return function(n){e.eo.ys(function(){return e.Wu===t?n():(_i("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Wh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Kt=i,s}return Object(Ii.c)(e,t),e.prototype.ah=function(t){return this.Ku.xu("Listen",t)},e.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ni()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.qt?(Ai(void 0===e||"string"==typeof e),Ri.fromBase64String(e||"")):(Ai(void 0===e||e instanceof Uint8Array),Ri.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?Ui.UNKNOWN:au(t.code);return new Mi(e,t.message||"")}(u);n=new Cu(r,i,o,s||null)}else if("documentChange"in e){i=Ju(t,(r=e.documentChange).document.name),o=zu(r.document.updateTime);var u=new Po({mapValue:{fields:r.document.fields}}),a=(s=new Mo(i,o,u,{}),r.targetIds||[]);n=new xu(a,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=Ju(t,(r=e.documentDelete).document),o=r.readTime?zu(r.readTime):to.min(),u=new Vo(i,o),n=new xu([],s=r.removedTargetIds||[],u.key,u);else if("documentRemove"in e)i=Ju(t,(r=e.documentRemove).document),n=new xu([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return Ni();var c=e.filter;i=new su(r=c.count||0),n=new ku(o=c.targetId,i)}return n}(this.Kt,t),n=function(t){if(!("targetChange"in t))return to.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?to.min():e.readTime?zu(e.readTime):to.min()}(t);return this.listener.uh(e,n)},e.prototype.hh=function(t){var e={};e.database=$u(this.Kt),e.addTarget=function(t,e){var n,r=e.target;return(n=Ho(r)?{documents:na(t,r)}:{query:ra(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=qu(t,e.resumeToken):e.Mt.u(to.min())>0&&(n.readTime=Fu(t,e.Mt.G())),n}(this.Kt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ni()}}(0,e.kt);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.eh(e)},e.prototype.lh=function(t){var e={};e.database=$u(this.Kt),e.removeTarget=t,this.eh(e)},e}($h),Qh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Kt=i,s._h=!1,s}return Object(Ii.c)(e,t),Object.defineProperty(e.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.sh=function(){this._h&&this.dh([])},e.prototype.ah=function(t){return this.Ku.xu("Write",t)},e.prototype.onMessage=function(t){if(Ai(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=function(t,e){return t&&t.length>0?(Ai(void 0!==e),t.map(function(t){return function(t,e){var n=zu(t.updateTime?t.updateTime:e);n.isEqual(to.min())&&(n=zu(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new qs(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=zu(t.commitTime);return this.listener.wh(n,e)}return Ai(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},e.prototype.Th=function(){var t={};t.database=$u(this.Kt),this.eh(t)},e.prototype.dh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return ta(e.Kt,t)})};this.eh(n)},e}($h),Zh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ku=n,i.Kt=r,i.Ih=!1,i}return Object(Ii.c)(e,t),e.prototype.mh=function(){if(this.Ih)throw new Mi(Ui.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.bu(t,e,n,i)}).catch(function(t){throw t.code===Ui.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.Cu(t,e,n,i)}).catch(function(t){throw t.code===Ui.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.terminate=function(){this.Ih=!1},e}(function(){}),tf=function(){function t(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}return t.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},t.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,this.Ah>=1&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},t.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},t.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},t.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(Oi(e),this.Ph=!1):_i("OnlineStateTracker",e)},t.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},t}(),ef=function(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Oh=new Set,this.Fh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return Object(Ii.b)(o,void 0,void 0,function(){return Object(Ii.d)(this,function(t){switch(t.label){case 0:return ff(this)?(_i("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(Ii.b)(this,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(n){switch(n.label){case 0:return(e=xi(t)).Oh.add(4),[4,rf(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Oh.delete(4),[4,nf(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new tf(n,r)};function nf(t){return Object(Ii.b)(this,void 0,void 0,function(){var e,n;return Object(Ii.d)(this,function(r){switch(r.label){case 0:if(!ff(t))return[3,4];e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function rf(t){return Object(Ii.b)(this,void 0,void 0,function(){var e,n;return Object(Ii.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function of(t,e){var n=xi(t);n.Nh.has(e.targetId)||(n.Nh.set(e.targetId,e),hf(n)?cf(n):jf(n).Ju()&&uf(n,e))}function sf(t,e){var n=xi(t),r=jf(n);n.Nh.delete(e),r.Ju()&&af(n,e),0===n.Nh.size&&(r.Ju()?r.Zu():ff(n)&&n.Mh.set("Unknown"))}function uf(t,e){t.Lh.cn(e.targetId),jf(t).hh(e)}function af(t,e){t.Lh.cn(e),jf(t).lh(e)}function cf(t){t.Lh=new Pu({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),jf(t).start(),t.Mh.yh()}function hf(t){return ff(t)&&!jf(t).Hu()&&t.Nh.size>0}function ff(t){return 0===xi(t).Oh.size}function lf(t){t.Lh=void 0}function pf(t){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(e){return t.Nh.forEach(function(e,n){uf(t,e)}),[2]})})}function df(t,e){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(n){return lf(t),hf(t)?(t.Mh.ph(e),cf(t)):t.Mh.set("Unknown"),[2]})})}function vf(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var r,i,o;return Object(Ii.d)(this,function(s){switch(s.label){case 0:if(t.Mh.set("Online"),!(e instanceof Cu&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Ii.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Nh.has(o=i[r])?[4,t.Ch.$h(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Nh.delete(o),t.Lh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),_i("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,yf(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof xu?t.Lh.wn(e):e instanceof ku?t.Lh.yn(e):t.Lh.In(e),n.isEqual(to.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,ch(t.Sh)];case 8:return i=s.sent(),n.u(i)>=0?[4,function(t,e){var n=t.Lh.pn(e);return n.Fe.forEach(function(n,r){if(n.resumeToken.o()>0){var i=t.Nh.get(r);i&&t.Nh.set(r,i.$t(n.resumeToken,e))}}),n.ke.forEach(function(e){var n=t.Nh.get(e);if(n){t.Nh.set(e,n.$t(Ri.h,n.Mt)),af(t,e);var r=new _s(n.target,e,1,n.sequenceNumber);uf(t,r)}}),t.Ch.Bh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return _i("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,yf(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function yf(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var r=this;return Object(Ii.d)(this,function(i){switch(i.label){case 0:if(!Ta(e))throw e;return t.Oh.add(1),[4,rf(t)];case 1:return i.sent(),t.Mh.set("Offline"),n||(n=function(){return ch(t.Sh)}),t.fs.bo(function(){return Object(Ii.b)(r,void 0,void 0,function(){return Object(Ii.d)(this,function(e){switch(e.label){case 0:return _i("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Oh.delete(1),[4,nf(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function bf(t,e){return e().catch(function(n){return yf(t,n,e)})}function gf(t){return Object(Ii.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(Ii.d)(this,function(s){switch(s.label){case 0:e=xi(t),n=Sf(e),r=e.xh.length>0?e.xh[e.xh.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return ff(t)&&t.xh.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,lh(e.Sh,r)];case 3:return null===(i=s.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=i.batchId,function(t,e){t.xh.push(e);var n=Sf(t);n.Ju()&&n.fh&&n.dh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,yf(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return mf(e)&&wf(e),[2]}})})}function mf(t){return ff(t)&&!Sf(t).Hu()&&t.xh.length>0}function wf(t){Sf(t).start()}function If(t){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(e){return Sf(t).Th(),[2]})})}function Tf(t){return Object(Ii.b)(this,void 0,void 0,function(){var e,n,r;return Object(Ii.d)(this,function(i){for(e=Sf(t),n=0,r=t.xh;n<r.length;n++)e.dh(r[n].mutations);return[2]})})}function Ef(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var r,i;return Object(Ii.d)(this,function(o){switch(o.label){case 0:return r=t.xh.shift(),i=ec.from(r,e,n),[4,bf(t,function(){return t.Ch.qh(i)})];case 1:return o.sent(),[4,gf(t)];case 2:return o.sent(),[2]}})})}function _f(t,e){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(n){switch(n.label){case 0:return e&&Sf(t).fh?[4,function(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r;return Object(Ii.d)(this,function(i){switch(i.label){case 0:return uu(r=e.code)&&r!==Ui.ABORTED?(n=t.xh.shift(),Sf(t).Xu(),[4,bf(t,function(){return t.Ch.Uh(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,gf(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return mf(t)&&wf(t),[2]}})})}function Of(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n;return Object(Ii.d)(this,function(r){switch(r.label){case 0:return n=xi(t),e?(n.Oh.delete(2),[4,nf(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Oh.add(2),[4,rf(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function jf(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=xi(t);return r.mh(),new Wh(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:pf.bind(null,t),Iu:df.bind(null,t),uh:vf.bind(null,t)}),t.Fh.push(function(n){return Object(Ii.b)(e,void 0,void 0,function(){return Object(Ii.d)(this,function(e){switch(e.label){case 0:return n?(t.Qh.Xu(),hf(t)?cf(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:e.sent(),lf(t),e.label=3;case 3:return[2]}})})})),t.Qh}function Sf(t){var e=this;return t.Kh||(t.Kh=function(t,e,n){var r=xi(t);return r.mh(),new Qh(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:If.bind(null,t),Iu:_f.bind(null,t),Eh:Tf.bind(null,t),wh:Ef.bind(null,t)}),t.Fh.push(function(n){return Object(Ii.b)(e,void 0,void 0,function(){return Object(Ii.d)(this,function(e){switch(e.label){case 0:return n?(t.Kh.Xu(),[4,gf(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:e.sent(),t.xh.length>0&&(_i("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),e.label=4;case 4:return[2]}})})})),t.Kh}var Nf=function(){this.jh=void 0,this.listeners=[]},Af=function(){this.queries=new Ec(function(t){return ms(t)},gs),this.onlineState="Unknown",this.Wh=new Set};function xf(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(Ii.d)(this,function(c){switch(c.label){case 0:if(n=xi(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Nf),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Gh(r)];case 2:return s.jh=c.sent(),[3,4];case 3:return u=c.sent(),a=Na(u,"Initialization of query '"+ws(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zh(n.onlineState),o.jh&&e.Hh(o.jh)&&Pf(n),[2]}})})}function kf(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Ii.d)(this,function(u){return n=xi(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Jh(r))]:[2]})})}function Cf(t,e){for(var n=xi(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.jh=s}}r&&Pf(n)}function Df(t,e,n){var r=xi(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Pf(t){t.Wh.forEach(function(t){t.next()})}var Lf=function(){function t(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Su(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},t.prototype.onError=function(t){this.Yh.error(t)},t.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},t.prototype.el=function(t,e){return!t.fromCache||!(this.options.sl&&"Offline"!==e||t.docs.nt()&&"Offline"!==e)},t.prototype.tl=function(t){return t.docChanges.length>0||!!(t.xe||this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.nl=function(t){t=Su.Oe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},t}(),Rf=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.il=function(){return"metadata"in this.payload},t}(),Uf=function(){function t(t){this.Kt=t}return t.prototype.yc=function(t){return Ju(this.Kt,t)},t.prototype.gc=function(t){return t.metadata.exists?Zu(this.Kt,t.document,!1):new Vo(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},t.prototype.Vc=function(t){return zu(t)},t}();!function(){function t(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.cl=function(t){for(var e=new Map,n=new Uf(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Tu()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(Ii.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(Ii.d)(this,function(o){switch(o.label){case 0:return[4,mh(this.Sh,new Uf(this.Kt),this.documents,this.rl.id)];case 1:t=o.sent(),e=this.cl(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,wh(this.Sh,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new eh(Object.assign({},this.progress),t))]}})})}}();var Mf=function(t){this.key=t},Vf=function(t){this.key=t},Ff=function(){function t(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=Tu(),this.Ce=Tu(),this.ll=Ts(t),this._l=new Ou(this.ll)}return Object.defineProperty(t.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),t.prototype.dl=function(t,e){var n=this,r=e?e.wl:new ju,i=e?e._l:this._l,o=e?e.Ce:this.Ce,s=i,u=!1,a=hs(this.query)&&i.size===this.query.limit?i.last():null,c=fs(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt(function(t,e){var h=i.get(t),f=e instanceof Mo?e:null;f&&(f=Is(n.query,f)?f:null);var l=!!h&&n.Ce.has(h.key),p=!!f&&(f.bt||n.Ce.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.El(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.ll(f,a)>0||c&&n.ll(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),hs(this.query)||fs(this.query))for(;s.size>this.query.limit;){var h=hs(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{_l:s,wl:r,_c:u,Ce:o}},t.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},t.prototype.Ei=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ni()}};return n(t)-n(e)}(t.type,e.type)||r.ll(t.doc,e.doc)}),this.Tl(n);var s=e?this.Il():[],u=0===this.hl.size&&this.qe?1:0,a=u!==this.ul;return this.ul=u,0!==o.length||a?{snapshot:new Su(this.query,t._l,i,o,t.Ce,0===u,a,!1),ml:s}:{ml:s}},t.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new ju,Ce:this.Ce,_c:!1},!1)):{ml:[]}},t.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},t.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},t.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=Tu(),this._l.forEach(function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))});var n=[];return e.forEach(function(e){t.hl.has(e)||n.push(new Vf(e))}),this.hl.forEach(function(t){e.has(t)||n.push(new Mf(t))}),n},t.prototype.Rl=function(t){this.al=t.Pc,this.hl=Tu();var e=this.dl(t.documents);return this.Ei(e,!0)},t.prototype.Pl=function(){return Su.Oe(this.query,this._l,this.Ce,0===this.ul)},t}(),qf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Bf=function(t){this.key=t,this.yl=!1},zf=function(){function t(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new Ec(function(t){return ms(t)},gs),this.Dl=new Map,this.Cl=[],this.xl=new cu(oo.J),this.Nl=new Map,this.Ol=new Th,this.Fl={},this.kl=new Map,this.Ml=Cc.Bi(),this.onlineState="Unknown",this.Ll=void 0}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),t}();function Gf(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Ii.d)(this,function(u){switch(u.label){case 0:return n=ml(t),(i=n.Sl.get(e))?(n.pl.ka(i.targetId),r=i.view.Pl(),[3,4]):[3,1];case 1:return[4,ph(n.Sh,ys(e))];case 2:return o=u.sent(),s=n.pl.ka(o.targetId),[4,Hf(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.$l&&of(n.gl,o),u.label=4;case 4:return[2,r]}})})}function Hf(t,e,n,r){return Object(Ii.b)(this,void 0,void 0,function(){var i,o,s,u,a,c;return Object(Ii.d)(this,function(h){switch(h.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return Object(Ii.b)(this,void 0,void 0,function(){var i,o,s;return Object(Ii.d)(this,function(u){switch(u.label){case 0:return(i=e.view.dl(n))._c?[4,vh(t.Sh,e.query,!1).then(function(t){return e.view.dl(t.documents,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.Fe.get(e.targetId),s=e.view.Ei(i,t.$l,o),[2,(il(t,e.targetId,s.ml),s.snapshot)]}})})}(t,e,n,r)},[4,vh(t.Sh,e,!0)];case 1:return i=h.sent(),o=new Ff(e,i.Pc),s=o.dl(i.documents),u=Au.Be(n,r&&"Offline"!==t.onlineState),a=o.Ei(s,t.$l,u),il(t,n,a.ml),c=new qf(e,n,o),[2,(t.Sl.set(e,c),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),a.snapshot)]}})})}function Kf(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i;return Object(Ii.d)(this,function(o){switch(o.label){case 0:return n=xi(t),r=n.Sl.get(e),(i=n.Dl.get(r.targetId)).length>1?[2,(n.Dl.set(r.targetId,i.filter(function(t){return!gs(t,e)})),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,dh(n.Sh,r.targetId,!1).then(function(){n.pl.Ba(r.targetId),sf(n.gl,r.targetId),nl(n,r.targetId)}).catch(Tc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return nl(n,r.targetId),[4,dh(n.Sh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Jf(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Ii.d)(this,function(u){switch(u.label){case 0:r=wl(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=xi(t),i=Zi.now(),o=e.reduce(function(t,e){return t.add(e.key)},Tu());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Ic.Zo(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=Js(c,n.get(c.key));null!=h&&s.push(new Ws(c.key,h,Ro(h.proto.mapValue),Bs.exists(!0)))}return r.Ho.Pi(t,i,s,e)})}).then(function(t){var e=t.Ns(n);return{batchId:t.batchId,oi:e}})}(r.Sh,e)];case 2:return i=u.sent(),r.pl.xa(i.batchId),function(t,e,n){var r=t.Fl[t.currentUser.R()];r||(r=new cu(Di)),r=r.Ht(e,n),t.Fl[t.currentUser.R()]=r}(r,i.batchId,n),[4,ul(r,i.oi)];case 3:return u.sent(),[4,gf(r.gl)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=Na(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Xf(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r;return Object(Ii.d)(this,function(i){switch(i.label){case 0:n=xi(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,hh(n.Sh,e)];case 2:return r=i.sent(),e.Fe.forEach(function(t,e){var r=n.Nl.get(e);r&&(Ai(t.Ue.size+t.Qe.size+t.Ke.size<=1),t.Ue.size>0?r.yl=!0:t.Qe.size>0?Ai(r.yl):t.Ke.size>0&&(Ai(r.yl),r.yl=!1))}),[4,ul(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Tc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Yf(t,e,n){var r=xi(t);if(r.$l&&0===n||!r.$l&&1===n){var i=[];r.Sl.forEach(function(t,n){var r=n.view.zh(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=xi(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zh(e)&&(r=!0)}),r&&Pf(n)}(r.Vl,e),i.length&&r.vl.uh(i),r.onlineState=e,r.$l&&r.pl.Ka(e)}}function $f(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(Ii.d)(this,function(c){switch(c.label){case 0:return(r=xi(t)).pl.qa(e,"rejected",n),i=r.Nl.get(e),(o=i&&i.key)?(s=(s=new cu(oo.J)).Ht(o,new Vo(o,to.min())),u=Tu().add(o),a=new Nu(to.min(),new Map,new lu(Di),s,u),[4,Xf(r,a)]):[3,2];case 1:return c.sent(),r.xl=r.xl.remove(o),r.Nl.delete(e),sl(r),[3,4];case 2:return[4,dh(r.Sh,e,!1).then(function(){return nl(r,e,n)}).catch(Tc)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Wf(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i;return Object(Ii.d)(this,function(o){switch(o.label){case 0:n=xi(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,ah(n.Sh,e)];case 2:return i=o.sent(),el(n,r,null),tl(n,r),n.pl.Oa(r,"acknowledged"),[4,ul(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Tc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Qf(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var r,i;return Object(Ii.d)(this,function(o){switch(o.label){case 0:r=xi(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=xi(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.Ho.yi(t,e).next(function(e){return Ai(null!==e),r=e.keys(),n.Ho.xi(t,e)}).next(function(){return n.Ho.Fi(t)}).next(function(){return n.Ic.Zo(t,r)})})}(r.Sh,e)];case 2:return i=o.sent(),el(r,e,n),tl(r,e),r.pl.Oa(e,"rejected",n),[4,ul(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Tc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Zf(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Ii.d)(this,function(u){switch(u.label){case 0:ff((n=xi(t)).gl)||_i("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=xi(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})}(n.Sh)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.kl.get(r)||[]).push(e),n.kl.set(r,i),[3,4]);case 3:return o=u.sent(),s=Na(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function tl(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function el(t,e,n){var r=xi(t),i=r.Fl[r.currentUser.R()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Fl[r.currentUser.R()]=i}}function nl(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Ol.kc(e).forEach(function(e){t.Ol.ki(e)||rl(t,e)})}function rl(t,e){var n=t.xl.get(e);null!==n&&(sf(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),sl(t))}function il(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Mf?(t.Ol.sr(o.key,e),ol(t,o)):o instanceof Vf?(_i("SyncEngine","Document no longer in limbo: "+o.key),t.Ol.rr(o.key,e),t.Ol.ki(o.key)||rl(t,o.key)):Ni()}}function ol(t,e){var n=e.key;t.xl.get(n)||(_i("SyncEngine","New document in limbo: "+n),t.Cl.push(n),sl(t))}function sl(t){for(;t.Cl.length>0&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Bf(e)),t.xl=t.xl.Ht(e,n),of(t.gl,new _s(ys(cs(e.path)),n,2,Qi.U))}}function ul(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Ii.d)(this,function(u){switch(u.label){case 0:return r=xi(t),i=[],o=[],s=[],r.Sl.nt()?[3,3]:(r.Sl.forEach(function(t,u){s.push(r.Bl(u,e,n).then(function(t){if(t){r.$l&&r.pl.qa(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=rh.cc(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.vl.uh(i),[4,function(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return Object(Ii.d)(this,function(h){switch(h.label){case 0:n=xi(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return ba.forEach(e,function(e){return ba.forEach(e.rc,function(r){return n.persistence.Ii.sr(t,e.targetId,r)}).next(function(){return ba.forEach(e.oc,function(r){return n.persistence.Ii.rr(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Ta(r=h.sent()))throw r;return _i("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.dc.get(u),c=a.Bt(a.Mt),n.dc=n.dc.Ht(u,c));return[2]}})})}(r.Sh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function al(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r;return Object(Ii.d)(this,function(i){switch(i.label){case 0:return(n=xi(t)).currentUser.isEqual(e)?[3,3]:(_i("SyncEngine","User change. New user:",e.R()),[4,uh(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.kl.forEach(function(t){t.forEach(function(t){t.reject(new Mi(Ui.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.kl.clear()}(n),n.pl.Qa(e,r.Ac,r.Rc),[4,ul(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function cl(t,e){var n=xi(t),r=n.Nl.get(e);if(r&&r.yl)return Tu().add(r.key);var i=Tu(),o=n.Dl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Sl.get(u[s]);i=i.ye(a.view.fl)}return i}function hl(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i;return Object(Ii.d)(this,function(o){switch(o.label){case 0:return[4,vh((n=xi(t)).Sh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Rl(r),[2,(n.$l&&il(n,e.targetId,i.ml),i)]}})})}function fl(t){return Object(Ii.b)(this,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(n){return[2,bh((e=xi(t)).Sh).then(function(t){return ul(e,t)})]})})}function ll(t,e,n,r){return Object(Ii.b)(this,void 0,void 0,function(){var i,o;return Object(Ii.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=xi(t),r=xi(n.Ho);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.gi(t,e).next(function(e){return e?n.Ic.Zo(t,e):ba.resolve(null)})})}((i=xi(t)).Sh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,gf(i.gl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(el(i,e,r||null),tl(i,e),function(t,e){xi(xi(t).Ho).Ni(e)}(i.Sh,e)):Ni(),s.label=4;case 4:return[4,ul(i,o)];case 5:return s.sent(),[3,7];case 6:_i("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function pl(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(Ii.d)(this,function(c){switch(c.label){case 0:return ml(n=xi(t)),wl(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,dl(n,r.rt())]);case 1:return i=c.sent(),n.Ll=!0,[4,Of(n.gl,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)of(n.gl,s[o]);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(u=[],a=Promise.resolve(),n.Dl.forEach(function(t,e){n.pl.$a(e)?u.push(e):a=a.then(function(){return nl(n,e),dh(n.Sh,e,!0)}),sf(n.gl,e)}),[4,a]);case 4:return c.sent(),[4,dl(n,u)];case 5:return c.sent(),function(t){var e=xi(t);e.Nl.forEach(function(t,n){sf(e.gl,n)}),e.Ol.Mc(),e.Nl=new Map,e.xl=new cu(oo.J)}(n),n.Ll=!1,[4,Of(n.gl,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function dl(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,f,l,p,d;return Object(Ii.d)(this,function(v){switch(v.label){case 0:n=xi(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.Dl.get(u=s[o]))&&0!==c.length?[4,ph(n.Sh,ys(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.Sl.get(f[h]),[4,hl(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,yh(n.Sh,u)];case 8:return d=v.sent(),[4,ph(n.Sh,d)];case 9:return a=v.sent(),[4,Hf(n,vl(d),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vl.uh(i),r)]}})})}function vl(t){return as(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function yl(t){var e=xi(t);return xi(xi(e.Sh).persistence).Qo()}function bl(t,e,n,r){return Object(Ii.b)(this,void 0,void 0,function(){var i,o,s;return Object(Ii.d)(this,function(u){switch(u.label){case 0:return(i=xi(t)).Ll?(_i("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,bh(i.Sh)];case 3:return o=u.sent(),s=Nu.$e(e,"current"===n),[4,ul(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,dh(i.Sh,e,!0)];case 6:return u.sent(),nl(i,e,r),[3,8];case 7:Ni(),u.label=8;case 8:return[2]}})})}function gl(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f;return Object(Ii.d)(this,function(l){switch(l.label){case 0:if(!(r=ml(t)).Ll)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.Dl.has(s=o[i])?(_i("SyncEngine","Adding an already active target "+s),[3,5]):[4,yh(r.Sh,s)]:[3,6];case 2:return u=l.sent(),[4,ph(r.Sh,u)];case 3:return a=l.sent(),[4,Hf(r,vl(u),a.targetId,!1)];case 4:l.sent(),of(r.gl,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(Ii.d)(this,function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,dh(r.Sh,t,!1).then(function(){sf(r.gl,t),nl(r,t)}).catch(Tc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function ml(t){var e=xi(t);return e.gl.Ch.Bh=Xf.bind(null,e),e.gl.Ch.Sn=cl.bind(null,e),e.gl.Ch.$h=$f.bind(null,e),e.vl.uh=Cf.bind(null,e.Vl),e.vl.ql=Df.bind(null,e.Vl),e}function wl(t){var e=xi(t);return e.gl.Ch.qh=Wf.bind(null,e),e.gl.Ch.Uh=Qf.bind(null,e),e}var Il=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(e){switch(e.label){case 0:return this.Kt=Xh(t.gu.T),this.pl=this.Wl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return sh(this.persistence,new ih,t.Yl,this.Kt)},t.prototype.Gl=function(t){return new Nh(xh.ra,this.Kt)},t.prototype.Wl=function(t){return new Fh},t.prototype.terminate=function(){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.Lo()];case 1:return t.sent(),[4,this.persistence.Lo()];case 2:return t.sent(),[2]}})})},t}(),Tl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(Ii.c)(e,t),e.prototype.initialize=function(e){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,gh(this.Sh)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,wl(this.Xl.fa)];case 4:return n.sent(),[4,gf(this.Xl.gl)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return sh(this.persistence,new ih,t.Yl,this.Kt)},e.prototype.Hl=function(t){return new Vc(this.persistence.Ii._r,t.fs)},e.prototype.Gl=function(t){var e=th(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?Ic.Xs(this.cacheSizeBytes):Ic.ei;return new Wc(this.synchronizeTabs,e,t.clientId,n,t.fs,Kh(),Jh(),this.Kt,this.pl,!!this.forceOwnership)},e.prototype.Wl=function(t){return new Fh},e}(Il),El=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(Ii.c)(e,t),e.prototype.initialize=function(e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r=this;return Object(Ii.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.fa,this.pl instanceof Vh?(this.pl.fa={nu:ll.bind(null,n),su:bl.bind(null,n),iu:gl.bind(null,n),Qo:yl.bind(null,n),eu:fl.bind(null,n)},[4,this.pl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Po(function(t){return Object(Ii.b)(r,void 0,void 0,function(){return Object(Ii.d)(this,function(e){switch(e.label){case 0:return[4,pl(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Tr?this.zl.start(this.Sh):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Wl=function(t){var e=Kh();if(!Vh.jn(e))throw new Mi(Ui.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=th(t.gu.T,t.gu.persistenceKey);return new Vh(e,t.fs,n,t.clientId,t.Yl)},e}(Tl),_l=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n=this;return Object(Ii.d)(this,function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return Yf(n.fa,t,1)},this.gl.Ch.s_=al.bind(null,this.fa),[4,Of(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new Af},t.prototype.Zl=function(t){var e=Xh(t.gu.T),n=new Hh(t.gu);return function(t,e,n){return new Zh(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Sh,n=this.Dh,r=t.fs,i=function(t){return Yf(s.fa,t,0)},o=Bh.jn()?new Bh:new qh,new ef(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new zf(t,e,n,r,i,o);return s&&(u.Ll=!0),u}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},t.prototype.terminate=function(){return function(t){return Object(Ii.b)(this,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(n){switch(n.label){case 0:return e=xi(t),_i("RemoteStore","RemoteStore shutting down."),e.Oh.add(5),[4,rf(e)];case 1:return n.sent(),e.kh.Lo(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},t}(),Ol=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),jl=(function(){function t(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new ya,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.o_.cancel()},t.prototype.getMetadata=function(){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Kl=function(){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},t.prototype.a_=function(){return Object(Ii.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(Ii.d)(this,function(i){switch(i.label){case 0:return[4,this.u_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.c_.decode(t),n=Number(e),isNaN(n)&&this.h_("length string ("+e+") is not valid number"),[4,this.l_(n)]);case 2:return r=i.sent(),[2,new Rf(JSON.parse(r),t.length+n)]}})})},t.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.u_=function(){return Object(Ii.b)(this,void 0,void 0,function(){var t,e;return Object(Ii.d)(this,function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.l_=function(t){return Object(Ii.b)(this,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.f_=function(){return Object(Ii.b)(this,void 0,void 0,function(){var t,e;return Object(Ii.d)(this,function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new io(t)}return t.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},t}()),Sl=function(t){this._methodName=t};function Nl(t,e,n){if(!n)throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Al(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function xl(t,e,n,r){if(!0===e&&!0===r)throw new Mi(Ui.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function kl(t){if(!oo.Et(t))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Cl(t){if(oo.Et(t))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Dl(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Ni()}function Pl(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new Mi(Ui.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Dl(t);throw new Mi(Ui.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Ll(t,e){if(e<=0)throw new Mi(Ui.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Rl=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Mi(Ui.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Mi(Ui.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,xl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Ul=new Map,Ml=function(){function t(t,e){this.w_="(lite)",this.E_=new Rl({}),this.T_=!1,t instanceof Hi?(this.I_=t,this.m_=new Xi):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Mi(Ui.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hi(t.options.projectId)}(t),this.m_=new Yi(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new Mi(Ui.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new Mi(Ui.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Rl(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Xi;switch(t.type){case"gapi":var e=t.client;return Ai(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Wi(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Mi(Ui.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.b_=function(){return(t=Ul.get(this))&&(_i("ComponentProvider","Removing Datastore"),Ul.delete(this),t.terminate()),Promise.resolve();var t},t}(),Vl=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ql(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),Fl=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),ql=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,cs(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Object(Ii.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new Vl(this.firestore,null,new oo(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(Fl);function Bl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Fi&&(t=t._),Nl("collection","path",e),t instanceof Ml)return Cl(n=no.ct.apply(no,Object(Ii.g)([e],r))),new ql(t,null,n);if(!(t instanceof Vl||t instanceof ql))throw new Mi(Ui.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Cl(n=no.ct.apply(no,Object(Ii.g)([t.path],r)).child(no.ct(e))),new ql(t.firestore,null,n)}function zl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Fi&&(t=t._),1===arguments.length&&(e=Ci.t()),Nl("doc","path",e),t instanceof Ml)return kl(n=no.ct.apply(no,Object(Ii.g)([e],r))),new Vl(t,null,new oo(n));if(!(t instanceof Vl||t instanceof ql))throw new Mi(Ui.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return kl(n=t.D_.child(no.ct.apply(no,Object(Ii.g)([e],r)))),new Vl(t.firestore,t instanceof ql?t.v_:null,new oo(n))}function Gl(t,e){return t instanceof Fi&&(t=t._),e instanceof Fi&&(e=e._),(t instanceof Vl||t instanceof ql)&&(e instanceof Vl||e instanceof ql)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Hl(t,e){return t instanceof Fi&&(t=t._),e instanceof Fi&&(e=e._),t instanceof Fl&&e instanceof Fl&&t.firestore===e.firestore&&gs(t.C_,e.C_)&&t.v_===e.v_}var Kl=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Mi(Ui.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Mi(Ui.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.K=function(t){return Di(this.x_,t.x_)||Di(this.N_,t.N_)},t}(),Jl=/^__.*__$/,Xl=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return null!==this.zt?new Ws(t,this.data,this.zt,e,this.fieldTransforms):new $s(t,this.data,e,this.fieldTransforms)},t}(),Yl=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return new Ws(t,this.data,this.zt,e,this.fieldTransforms)},t}();function $l(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ni()}}var Wl=function(){function t(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.F_(),this.fieldTransforms=i||[],this.zt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.F_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return bp(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.W_)},t.prototype.contains=function(t){return void 0!==this.zt.find(function(e){return t.st(e)})||void 0!==this.fieldTransforms.find(function(e){return t.st(e.field)})},t.prototype.F_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if($l(this.k_)&&Jl.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),Ql=function(){function t(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||Xh(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Wl({k_:t,methodName:e,W_:n,path:io.at(),B_:!1,j_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},t}();function Zl(t){var e=t.p_(),n=Xh(t.I_);return new Ql(t.I_,!!e.ignoreUndefinedProperties,n)}function tp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);pp("Data must be an object, but it was:",s,r);var u,a,c=fp(r,s);if(o.merge)u=new co(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=dp(e,l[f],n);if(!s.contains(p))throw new Mi(Ui.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");gp(h,p)||h.push(p)}u=new co(h),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new Xl(new Po(c),u,a)}var ep=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw t.K_(1===t.k_?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Sl);function np(t,e,n){return new Wl({k_:3,W_:e.settings.W_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var rp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e.prototype.z_=function(t){return new Fs(t.path,new Cs)},e.prototype.isEqual=function(t){return t instanceof e},e}(Sl),ip=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(Ii.c)(e,t),e.prototype.z_=function(t){var e=np(this,t,!0),n=this.H_.map(function(t){return hp(t,e)}),r=new Ds(n);return new Fs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Sl),op=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(Ii.c)(e,t),e.prototype.z_=function(t){var e=np(this,t,!0),n=this.H_.map(function(t){return hp(t,e)}),r=new Ls(n);return new Fs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Sl),sp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Object(Ii.c)(e,t),e.prototype.z_=function(t){var e=new Us(t.Kt,Ss(t.Kt,this.J_));return new Fs(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Sl);function up(t,e,n,r){var i=t.G_(1,e,n);pp("Data must be an object, but it was:",i,r);var o=[],s=new Lo;uo(r,function(t,r){var u=yp(e,t,n);r instanceof Fi&&(r=r._);var a=i.U_(u);if(r instanceof ep)o.push(u);else{var c=hp(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new co(o);return new Yl(s.yt(),u,i.fieldTransforms)}function ap(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[dp(e,r,n)],a=[i];if(o.length%2!=0)throw new Mi(Ui.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(dp(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Lo,l=u.length-1;l>=0;--l)if(!gp(h,u[l])){var p=u[l],d=a[l];d instanceof Fi&&(d=d._);var v=s.U_(p);if(d instanceof ep)h.push(p);else{var y=hp(d,v);null!=y&&(h.push(p),f.set(p,y))}}var b=new co(h);return new Yl(f.yt(),b,s.fieldTransforms)}function cp(t,e,n,r){return void 0===r&&(r=!1),hp(n,t.G_(r?4:3,e))}function hp(t,e){if(t instanceof Fi&&(t=t._),lp(t))return pp("Unsupported field value:",e,t),fp(t,e);if(t instanceof Sl)return function(t,e){if(!$l(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=hp(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Fi&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ss(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Zi.fromDate(t);return{timestampValue:Fu(e.Kt,n)}}if(t instanceof Zi)return n=new Zi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Fu(e.Kt,n)};if(t instanceof Kl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Vi)return{bytesValue:qu(e.Kt,t.l)};if(t instanceof Vl){var r=t.firestore.I_;if(!r.isEqual(n=e.T))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Gu(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Dl(t))}(t,e)}function fp(t,e){var n={};return ao(t)?e.path&&e.path.length>0&&e.zt.push(e.path):uo(t,function(t,r){var i=hp(r,e.L_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function lp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Zi||t instanceof Kl||t instanceof Vi||t instanceof Vl||t instanceof Sl)}function pp(t,e,n){if(!lp(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Dl(n);throw e.K_("an object"===r?t+" a custom object":t+" "+r)}}function dp(t,e,n){if(e instanceof Fi&&(e=e._),e instanceof jl)return e.d_;if("string"==typeof e)return yp(t,e);throw bp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var vp=new RegExp("[~\\*/\\[\\]]");function yp(t,e,n){if(e.search(vp)>=0)throw bp("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(jl.bind.apply(jl,Object(Ii.g)([void 0],e.split("."))))).d_}catch(r){throw bp("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function bp(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Mi(Ui.INVALID_ARGUMENT,(u+=". ")+t+a)}function gp(t,e){return t.some(function(t){return t.isEqual(e)})}var mp=function(){function t(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Object(Ii.b)(this,void 0,void 0,function(){var e,n=this;return Object(Ii.d)(this,function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new Mi(Ui.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i,o,s,u;return Object(Ii.d)(this,function(a){switch(a.label){case 0:return n=xi(t),r=$u(n.Kt)+"/documents",i={documents:e.map(function(t){return Ku(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Ai(!!e.found);var n=Ju(t,e.found.name),r=zu(e.found.updateTime),i=new Po({mapValue:{fields:e.found.fields}});return new Mo(n,r,i,{})}(t,e):"missing"in e?function(t,e){Ai(!!e.missing),Ai(!!e.readTime);var n=Ju(t,e.missing),r=zu(e.readTime);return new Vo(n,r)}(t,e):Ni()}(n.Kt,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Ai(!!e),u.push(e)}),u)]}})})}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof Vo||t instanceof Mo?n.sf(t):Ni()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.O_(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.O_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new iu(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Object(Ii.b)(this,void 0,void 0,function(){var t,e=this;return Object(Ii.d)(this,function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=oo.ft(n);e.mutations.push(new ou(r,e.Gt(r)))}),[4,function(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i;return Object(Ii.d)(this,function(o){switch(o.label){case 0:return n=xi(t),r=$u(n.Kt)+"/documents",i={writes:e.map(function(t){return ta(n.Kt,t)})},[4,n.bu("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}})})},t.prototype.sf=function(t){var e;if(t instanceof Mo)e=t.version;else{if(!(t instanceof Vo))throw Ni();e=to.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Mi(Ui.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Bs.updateTime(e):Bs.jt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(to.min()))throw new Mi(Ui.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Bs.updateTime(e)}return Bs.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),wp=function(){function t(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new Yh(this.fs,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.zu.Bu(function(){return Object(Ii.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(Ii.d)(this,function(r){return t=new mp(this.Dh),(e=this.uf(t))&&e.then(function(e){n.fs.ys(function(){return t.commit().then(function(){n.Ts.resolve(e)}).catch(function(t){n.hf(t)})})}).catch(function(t){n.hf(t)}),[2]})})})},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!go(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!uu(e)}return!1},t}(),Ip=function(){function t(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=Ki.UNAUTHENTICATED,this.clientId=Ci.t(),this._f=function(){},this.N=new ya,this.credentials.S(function(t){_i("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}return t.prototype.getConfiguration=function(){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},t.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},t.prototype.df=function(){if(this.fs.wf)throw new Mi(Ui.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new ya;return this.fs.Tf(function(){return Object(Ii.b)(t,void 0,void 0,function(){var t,n;return Object(Ii.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Na(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function Tp(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(Ii.d)(this,function(o){switch(o.label){case 0:return t.fs.Af(),_i("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Yl,t.ff(function(n){r.isEqual(n)||(r=n,t.fs.bo(function(){return Object(Ii.b)(i,void 0,void 0,function(){return Object(Ii.d)(this,function(t){switch(t.label){case 0:return[4,uh(e.Sh,n)];case 1:return t.sent(),[2]}})})}))}),e.persistence.yo(function(){return t.terminate()}),t.mf=e,[2]}})})}function Ep(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r;return Object(Ii.d)(this,function(i){switch(i.label){case 0:return t.fs.Af(),[4,_p(t)];case 1:return n=i.sent(),_i("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff(function(n){return t.fs.bo(function(){return function(t,e){return Object(Ii.b)(this,void 0,void 0,function(){var n,r;return Object(Ii.d)(this,function(i){switch(i.label){case 0:return(n=xi(t)).fs.Af(),_i("RemoteStore","RemoteStore received new credentials"),r=ff(n),n.Oh.add(3),[4,rf(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Oh.delete(3),[4,nf(n)];case 3:return i.sent(),[2]}})})}(e.gl,n)})}),t.If=e,[2]}})})}function _p(t){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(e){switch(e.label){case 0:return t.mf?[3,2]:(_i("FirestoreClient","Using default OfflineComponentProvider"),[4,Tp(t,new Il)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}})})}function Op(t){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(e){switch(e.label){case 0:return t.If?[3,2]:(_i("FirestoreClient","Using default OnlineComponentProvider"),[4,Ep(t,new _l)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}})})}function jp(t){return _p(t).then(function(t){return t.persistence})}function Sp(t){return _p(t).then(function(t){return t.Sh})}function Np(t){return Op(t).then(function(t){return t.gl})}function Ap(t){return Op(t).then(function(t){return t.fa})}function xp(t){return Object(Ii.b)(this,void 0,void 0,function(){var e,n;return Object(Ii.d)(this,function(r){switch(r.label){case 0:return[4,Op(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=Gf.bind(null,e.fa),n.Jh=Kf.bind(null,e.fa),n)]}})})}function kp(t,e,n){var r=this;void 0===n&&(n={});var i=new ya;return t.fs.ys(function(){return Object(Ii.b)(r,void 0,void 0,function(){var r;return Object(Ii.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Ol({next:function(o){e.ys(function(){return kf(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Mi(Ui.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Mi(Ui.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Lf(cs(n.path),o,{includeMetadataChanges:!0,sl:!0});return xf(t,s)},[4,xp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}function Cp(t,e,n){var r=this;void 0===n&&(n={});var i=new ya;return t.fs.ys(function(){return Object(Ii.b)(r,void 0,void 0,function(){var r;return Object(Ii.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Ol({next:function(n){e.ys(function(){return kf(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Mi(Ui.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Lf(n,o,{includeMetadataChanges:!0,sl:!0});return xf(t,s)},[4,xp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}var Dp=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new Yh(this,"async_queue_retry"),this.vf=function(){var e=Jh();e&&_i("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=Jh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.ys=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Jh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},t.prototype.bo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},t.prototype.Cf=function(){return Object(Ii.b)(this,void 0,void 0,function(){var t,e=this;return Object(Ii.d)(this,function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!Ta(t=n.sent()))throw t;return _i("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.zu.Bu(function(){return e.Cf()}),n.label=5;case 5:return[2]}})})},t.prototype.Df=function(t){var e=this,n=this.Rf.then(function(){return e.pf=!0,t().catch(function(t){throw e.Vf=t,e.pf=!1,Oi("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.pf=!1,t})});return this.Rf=n,n},t.prototype.Ir=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=Sa.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&Ni()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Object(Ii.b)(this,void 0,void 0,function(){var t;return Object(Ii.d)(this,function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Of=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},t.prototype.Ff=function(t){var e=this;return this.Nf().then(function(){e.gf.sort(function(t,e){return t.ws-e.ws});for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()})},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),Pp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new Dp,r.w_="name"in e?e.name:"[DEFAULT]",r}return Object(Ii.c)(e,t),e.prototype.b_=function(){return this.Lf||Rp(this),this.Lf.terminate()},e}(Ml);function Lp(t){return t.Lf||Rp(t),t.Lf.df(),t.Lf}function Rp(t){var e=t.p_(),n=function(t,e,n){return new Gi(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.Lf=new Ip(t.m_,t.Mf,n)}function Up(t,e,n){var r=this,i=new ya;return t.fs.enqueue(function(){return Object(Ii.b)(r,void 0,void 0,function(){var r;return Object(Ii.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Tp(t,n)];case 1:return o.sent(),[4,Ep(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Ui.FAILED_PRECONDITION||t.code===Ui.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Mp(t){if(t.R_||t.P_)throw new Mi(Ui.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Vp=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),Io(t)){case 0:return null;case 1:return t.booleanValue;case 2:return lo(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(po(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.jf(t.arrayValue,e);case 10:return this.Wf(t.mapValue,e);default:throw Ni()}},t.prototype.Wf=function(t,e){var n=this,r={};return uo(t.fields||{},function(t,i){r[t]=n.$f(i,e)}),r},t.prototype.Kf=function(t){return new Kl(lo(t.latitude),lo(t.longitude))},t.prototype.jf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},t.prototype.qf=function(t,e){switch(e){case"previous":var n=yo(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(bo(t));default:return null}},t.prototype.Bf=function(t){var e=fo(t);return new Zi(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=no.ct(t);Ai(va(n));var r=new Hi(n.get(1),n.get(3)),i=new oo(n.X(5));return r.isEqual(e)||Oi("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Fp=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Vl(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new qp(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field(Bp("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),qp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Fp);function Bp(t,e){return"string"==typeof e?yp(t,e):e instanceof Fi?e._.d_:e.d_}function zp(t){if(fs(t)&&0===t.Nt.length)throw new Mi(Ui.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Gp=function(){};function Hp(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.Yf(t)}return t}var Kp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return Object(Ii.c)(e,t),e.prototype.Yf=function(t){var e=Zl(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.ht()){if("array-contains"===o||"array-contains-any"===o)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Zp(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(Qp(r,t,h[c]));u={arrayValue:{values:a}}}else u=Qp(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Zp(s,o),u=cp(n,"where",s,"in"===o||"not-in"===o);var f=Ko.create(i,o,u);return function(t,e){if(e.xt()){var n=ps(t);if(null!==n&&!n.isEqual(e.field))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=ls(t);null!==r&&td(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Mi(Ui.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.C_,0,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new Fl(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new us(t.path,t.collectionGroup,t.Nt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Gp),Jp=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return Object(Ii.c)(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new rs(e,n);return function(t,e){if(null===ls(t)){var n=ps(t);null!==n&&td(0,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new Fl(t.firestore,t.v_,function(t,e){var n=t.Nt.concat([e]);return new us(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Gp),Xp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return Object(Ii.c)(e,t),e.prototype.Yf=function(t){return new Fl(t.firestore,t.v_,bs(t.C_,this.nd,this.sd))},e}(Gp),Yp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(Ii.c)(e,t),e.prototype.Yf=function(t){var e=Wp(t,this.type,this.rd,this.od);return new Fl(t.firestore,t.v_,function(t,e){return new us(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Gp),$p=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(Ii.c)(e,t),e.prototype.Yf=function(t){var e=Wp(t,this.type,this.rd,this.od);return new Fl(t.firestore,t.v_,function(t,e){return new us(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Gp);function Wp(t,e,n,r){if(n[0]instanceof Fi&&(n[0]=n[0]._),n[0]instanceof Fp)return function(t,e,n,r,i){if(!r)throw new Mi(Ui.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=vs(t);s<u.length;s++){var a=u[s];if(a.field.ht())o.push(No(e,r.key));else{var c=r.field(a.field);if(vo(c))throw new Mi(Ui.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.ot();throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new es(o,i)}(t.C_,t.firestore.I_,e,n[0].Jf,r);var i=Zl(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new Mi(Ui.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ds(t)&&-1!==c.indexOf("/"))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(no.ct(c));if(!oo.Et(h))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new oo(h);u.push(No(e,f))}else{var l=cp(n,r,c);u.push(l)}}return new es(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Qp(t,e,n){if(n instanceof Fi&&(n=n._),"string"==typeof n){if(""===n)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ds(e)&&-1!==n.indexOf("/"))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(no.ct(n));if(!oo.Et(r))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return No(t,new oo(r))}if(n instanceof Vl)return No(t,n.S_);throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Dl(n)+".")}function Zp(t,e){if(!Array.isArray(t)||0===t.length)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function td(t,e,n){if(!n.isEqual(e))throw new Mi(Ui.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ed(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}function nd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var rd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Ii.c)(e,t),e.prototype.Uf=function(t){return new Vi(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Vl(this.firestore,null,e)},e}(Vp),id=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),od=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).zf=e,u.ad=e,u.metadata=o,u}return Object(Ii.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new sd(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field(Bp("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(Fp),sd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(od),ud=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new id(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach(function(r){t.call(e,new sd(n.zf,n.Hf,r.key,r,new id(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.Ne)throw new Mi(Ui.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map(function(e){return{type:"added",doc:new sd(t.zf,t.Hf,e.doc.key,e.doc,new id(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),oldIndex:-1,newIndex:n++}})}var r=t.ud.De;return t.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new sd(t.zf,t.Hf,e.doc.key,e.doc,new id(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:ad(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.ld=e),this.hd},t}();function ad(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ni()}}function cd(t,e){return t instanceof od&&e instanceof od?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof ud&&e instanceof ud&&t.zf===e.zf&&Hl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var hd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Ii.c)(e,t),e.prototype.Uf=function(t){return new Vi(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Vl(this.firestore,null,e)},e}(Vp);function fd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Pl(t,Vl);var o=Pl(t.firestore,Pp),s=Zl(o);return e instanceof Fi&&(e=e._),pd(o,[("string"==typeof e||e instanceof jl?ap(s,"updateDoc",t.S_,e,n,r):up(s,"updateDoc",t.S_,e)).O_(t.S_,Bs.exists(!0))])}function ld(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof Fi&&(t=t._);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||ed(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(ed(i[u])){var l=i[u];i[u]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[u+1]=null===(n=l.error)||void 0===n?void 0:n.bind(l),i[u+2]=null===(r=l.complete)||void 0===r?void 0:r.bind(l)}if(t instanceof Vl)c=Pl(t.firestore,Pp),h=cs(t.S_.path),a={next:function(e){i[u]&&i[u](dd(c,t,e))},error:i[u+1],complete:i[u+2]};else{var p=Pl(t,Fl);c=Pl(p.firestore,Pp),h=p.C_;var d=new hd(c);a={next:function(t){i[u]&&i[u](new ud(c,d,p,t))},error:i[u+1],complete:i[u+2]},zp(t.C_)}return function(t,e,n,r){var i=this,o=new Ol(r),s=new Lf(e,o,n);return t.fs.ys(function(){return Object(Ii.b)(i,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(n){switch(n.label){case 0:return e=xf,[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.r_(),t.fs.ys(function(){return Object(Ii.b)(i,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(n){switch(n.label){case 0:return e=kf,[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(Lp(c),h,f,a)}function pd(t,e){return function(t,e){var n=this,r=new ya;return t.fs.ys(function(){return Object(Ii.b)(n,void 0,void 0,function(){var n;return Object(Ii.d)(this,function(i){switch(i.label){case 0:return n=Jf,[4,Ap(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(Lp(t),e)}function dd(t,e,n){var r=n.docs.get(e.S_),i=new hd(t);return new od(t,i,e.S_,r,new id(n.hasPendingWrites,n.fromCache),e.v_)}var vd=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=Zl(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=yd(t,this.zf),i=nd(r.v_,e,n),o=tp(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.O_(r.S_,Bs.jt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,s=yd(t,this.zf);return e instanceof Fi&&(e=e._),o="string"==typeof e||e instanceof jl?ap(this.wd,"WriteBatch.update",s.S_,e,n,r):up(this.wd,"WriteBatch.update",s.S_,e),this.fd.push(o.O_(s.S_,Bs.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=yd(t,this.zf);return this.fd=this.fd.concat(new iu(e.S_,Bs.jt())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new Mi(Ui.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function yd(t,e){if(t instanceof Fi&&(t=t._),t.firestore!==e)throw new Mi(Ui.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var bd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return Object(Ii.c)(e,t),e.prototype.get=function(e){var n=this,r=yd(e,this.zf),i=new hd(this.zf);return t.prototype.get.call(this,e).then(function(t){return new od(n.zf,i,r.S_,t.Jf,new id(!1,!1),r.v_)})},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=Zl(t)}return t.prototype.get=function(t){var e=this,n=yd(t,this.zf),r=new rd(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Ni();var i=t[0];if(i instanceof Vo)return new Fp(e.zf,r,n.S_,null,n.v_);if(i instanceof Mo)return new Fp(e.zf,r,i.key,i,n.v_);throw Ni()})},t.prototype.set=function(t,e,n){var r=yd(t,this.zf),i=nd(r.v_,e,n),o=tp(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=yd(t,this.zf);return e instanceof Fi&&(e=e._),o="string"==typeof e||e instanceof jl?ap(this.wd,"Transaction.update",s.S_,e,n,r):up(this.wd,"Transaction.update",s.S_,e),this.Td.update(s.S_,o),this},t.prototype.delete=function(t){var e=yd(t,this.zf);return this.Td.delete(e.S_),this},t}()),gd=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Mp(t=Pl(t,Pp));var n=Lp(t),r=t.p_(),i=new _l;return Up(n,i,new Tl(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Mp(t=Pl(t,Pp));var e=Lp(t),n=t.p_(),r=new _l;return Up(e,r,new El(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new Mi(Ui.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new ya;return t.Mf.Tf(function(){return Object(Ii.b)(e,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(Ii.b)(this,void 0,void 0,function(){return Object(Ii.d)(this,function(e){switch(e.label){case 0:return ma.jn()?[4,ma.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(th(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._)},t}(),md=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Hi||(i.md=e),i}return Object(Ii.c)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=Pl(t,Ml)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&ji("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this._,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(Ii.b)(e,void 0,void 0,function(){var e,n;return Object(Ii.d)(this,function(r){switch(r.label){case 0:return[4,jp(t)];case 1:return e=r.sent(),[4,Np(t)];case 2:return n=r.sent(),[2,(e.Vo(!0),function(t){var e=xi(t);return e.Oh.delete(0),nf(e)}(n))]}})})})}(Lp(Pl(this._,Pp)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(Ii.b)(e,void 0,void 0,function(){var e,n;return Object(Ii.d)(this,function(r){switch(r.label){case 0:return[4,jp(t)];case 1:return e=r.sent(),[4,Np(t)];case 2:return n=r.sent(),[2,(e.Vo(!1),function(t){return Object(Ii.b)(this,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(n){switch(n.label){case 0:return(e=xi(t)).Oh.add(0),[4,rf(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(Lp(Pl(this._,Pp)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&xl("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new ya;return t.fs.ys(function(){return Object(Ii.b)(e,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(r){switch(r.label){case 0:return e=Zf,[4,Ap(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Lp(Pl(this._,Pp)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Ol(e);return t.fs.ys(function(){return Object(Ii.b)(n,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){xi(t).Wh.add(e),e.next()},[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.r_(),t.fs.ys(function(){return Object(Ii.b)(n,void 0,void 0,function(){var e;return Object(Ii.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){xi(t).Wh.delete(e)},[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(Lp(t=Pl(t,Pp)),ed(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new Mi(Ui.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Cd(this,Bl(this._,t))}catch(t){throw _d(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new Ed(this,zl(this._,t))}catch(t){throw _d(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Ad(this,function(t,e){if(t=Pl(t,Ml),Nl("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Fl(t,null,function(t){return new us(no.at(),t)}(e))}(this._,t))}catch(t){throw _d(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new ya;return t.fs.ys(function(){return Object(Ii.b)(n,void 0,void 0,function(){var n;return Object(Ii.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Op(t).then(function(t){return t.Dh})}(t)];case 1:return n=i.sent(),new wp(t.fs,n,e,r).run(),[2]}})})}),r.promise}(Lp(t),function(n){return e(new bd(t,n))})}(this._,function(n){return t(new Id(e,n))})},e.prototype.batch=function(){var t=this;return Lp(this._),new Td(new vd(this._,function(e){return pd(t._,e)}))},e.prototype.loadBundle=function(t){throw new Mi(Ui.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new Mi(Ui.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(Fi),wd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Ii.c)(e,t),e.prototype.Uf=function(t){return new zi(new Vi(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return Ed.Ad(e,this.firestore,null)},e}(Vp),Id=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r.Hf=new wd(e),r}return Object(Ii.c)(e,t),e.prototype.get=function(t){var e=this,n=Dd(t);return this._.get(n).then(function(t){return new Sd(e.zf,new od(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))})},e.prototype.set=function(t,e,n){var r=Dd(t);return n?(Al("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Dd(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(Ii.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Dd(t);return this._.delete(e),this},e}(Fi),Td=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e.prototype.set=function(t,e,n){var r=Dd(t);return n?(Al("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Dd(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(Ii.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Dd(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(Fi),Ed=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new wd(e),r}return Object(Ii.c)(e,t),e.Rd=function(t,n,r){if(t.length%2!=0)throw new Mi(Ui.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new e(n,new Vl(n._,r,new oo(t)))},e.Ad=function(t,n,r){return new e(n,new Vl(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Cd(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Cd(this.firestore,Bl(this._,t))}catch(t){throw _d(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Fi&&(t=t._),t instanceof Vl&&Gl(this._,t)},e.prototype.set=function(t,e){e=Al("DocumentReference.set",e);try{return function(t,e,n){t=Pl(t,Vl);var r=Pl(t.firestore,Pp),i=nd(t.v_,e,n);return pd(r,[tp(Zl(r),"setDoc",t.S_,i,null!==t.v_,n).O_(t.S_,Bs.jt())])}(this._,t,e)}catch(t){throw _d(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?fd(this._,t):fd.apply(void 0,Object(Ii.g)([this._,t,e],n))}catch(t){throw _d(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return pd(Pl((t=this._).firestore,Pp),[new iu(t.S_,Bs.jt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Od(e),i=jd(e,function(e){return new Sd(t.firestore,new od(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))});return ld(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Pl(t,Vl);var e=Pl(t.firestore,Pp),n=Lp(e),r=new hd(e);return function(t,e){var n=this,r=new ya;return t.fs.ys(function(){return Object(Ii.b)(n,void 0,void 0,function(){var n;return Object(Ii.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var r,i;return Object(Ii.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=xi(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)})}(t,e)];case 1:return(i=o.sent())instanceof Mo?n.resolve(i):i instanceof Vo?n.resolve(null):n.reject(new Mi(Ui.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Na(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Sp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.S_).then(function(n){return new od(e,r,t.S_,n,new id(n instanceof Mo&&n.bt,!0),t.v_)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Pl(t,Vl);var e=Pl(t.firestore,Pp);return kp(Lp(e),t.S_,{source:"server"}).then(function(n){return dd(e,t,n)})}(this._):function(t){t=Pl(t,Vl);var e=Pl(t.firestore,Pp);return kp(Lp(e),t.S_).then(function(n){return dd(e,t,n)})}(this._)).then(function(t){return new Sd(e.firestore,new od(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Fi);function _d(t,e,n){return t.message=t.message.replace(e,n),t}function Od(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!ed(r))return r}return{}}function jd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=ed(t[0])?t[0]:ed(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Sd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(Ii.c)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new Ed(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return cd(this._,t._)},e}(Fi),Nd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e.prototype.data=function(t){return this._.data(t)},e}(Sd),Ad=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new wd(e),r}return Object(Ii.c)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Hp(this._,function(t,e,n){var r=e,i=Bp("where",t);return new Kp(i,r,n)}(t,n,r)))}catch(t){throw _d(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Hp(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=Bp("orderBy",t);return new Jp(r,n)}(t,n)))}catch(t){throw _d(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Hp(this._,function(t){return Ll("limit",t),new Xp("limit",t,"F")}(t)))}catch(t){throw _d(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Hp(this._,function(t){return Ll("limitToLast",t),new Xp("limitToLast",t,"L")}(t)))}catch(t){throw _d(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Hp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yp("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw _d(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Hp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yp("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw _d(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Hp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $p("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw _d(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Hp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $p("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw _d(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Hl(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Pl(t,Fl);var e=Pl(t.firestore,Pp),n=Lp(e),r=new hd(e);return function(t,e){var n=this,r=new ya;return t.fs.ys(function(){return Object(Ii.b)(n,void 0,void 0,function(){var n;return Object(Ii.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Ii.b)(this,void 0,void 0,function(){var r,i,o,s,u;return Object(Ii.d)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,vh(t,e,!0)];case 1:return u=a.sent(),r=new Ff(e,u.Pc),i=r.dl(u.documents),o=r.Ei(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=Na(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}})})},[4,Sp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.C_).then(function(n){return new ud(e,r,t,n)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Pl(t,Fl);var e=Pl(t.firestore,Pp),n=Lp(e),r=new hd(e);return Cp(n,t.C_,{source:"server"}).then(function(n){return new ud(e,r,t,n)})}(this._):function(t){t=Pl(t,Fl);var e=Pl(t.firestore,Pp),n=Lp(e),r=new hd(e);return zp(t.C_),Cp(n,t.C_).then(function(n){return new ud(e,r,t,n)})}(this._)).then(function(t){return new kd(e.firestore,new ud(e.firestore._,e.Hf,e._,t.ud))})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Od(e),i=jd(e,function(e){return new kd(t.firestore,new ud(t.firestore._,t.Hf,t._,e.ud))});return ld(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Fi),xd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(Ii.c)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new Nd(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(Fi),kd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(Ii.c)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Ad(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map(function(e){return new Nd(t.zf,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new xd(e.zf,t)})},e.prototype.forEach=function(t,e){var n=this;this._.forEach(function(r){t.call(e,new Nd(n.zf,r))})},e.prototype.isEqual=function(t){return cd(this._,t._)},e}(Fi),Cd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return Object(Ii.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new Ed(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Ed(this.firestore,void 0===t?zl(this._):zl(this._,t))}catch(t){throw _d(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Pl(t.firestore,Pp),r=zl(t),i=nd(t.v_,e);return pd(n,[tp(Zl(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).O_(r.S_,Bs.exists(!1))]).then(function(){return r})}(this._,t).then(function(t){return new Ed(e.firestore,t)})},e.prototype.isEqual=function(t){return Gl(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Ad);function Dd(t){return t instanceof Fi&&(t=t._),Pl(t,Vl)}var Pd=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(jl.bind.apply(jl,Object(Ii.g)([void 0],e))))||this}return Object(Ii.c)(e,t),e.documentId=function(){return new e(io.lt().ot())},e.prototype.isEqual=function(t){return t instanceof Fi&&(t=t._),t instanceof jl&&this._.d_.isEqual(t.d_)},e}(Fi),Ld=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ii.c)(e,t),e.serverTimestamp=function(){var t=new rp("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new ep("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ip("arrayUnion",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new op("arrayRemove",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new sp("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(Fi);!function(){function t(){this.Pd={},this.yd=new ya,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.yd.promise.catch(t)},t.prototype.then=function(t,e){return this.yd.promise.then(t,e)},t.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},t.prototype.jl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},t.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)}}();var Rd,Ud=n("/6Yf"),Md={Firestore:md,GeoPoint:Kl,Timestamp:Zi,Blob:zi,Transaction:Id,WriteBatch:Td,DocumentReference:Ed,DocumentSnapshot:Sd,Query:Ad,QueryDocumentSnapshot:Nd,QuerySnapshot:kd,CollectionReference:Cd,FieldPath:Pd,FieldValue:Ld,setLogLevel:function(t){Ti.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Ud.a("firestore",function(t){return function(t,e){return new md(t,new Pp(t,e),new gd)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Md)))})(Rd=yt.a),Rd.registerVersion("@firebase/firestore","2.1.2");let Vd=(()=>{class t{constructor(){this.db=vt.a.firestore(),this.availableExers=this.db.collection("health").doc("availableExers"),this.availableExerList=this.availableExers.collection("list")}upsertExercises(t){const e=this.db.batch();return t.forEach(t=>{const n=this.availableExerList.doc(t.name);e.set(n,t)}),e.update(this.availableExers,{lastUpdated:(new Date).getTime()}),e.commit()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=h.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Fd=n("dNgK");let qd=(()=>{class t{constructor(t){this._snackBar=t,this.horizontalPosition="start",this.verticalPosition="bottom"}openSnackBar(t,e=3e3){this._snackBar.open(t,"Close",{duration:e,horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition})}}return t.\u0275fac=function(e){return new(e||t)(h.Yb(Fd.a))},t.\u0275prov=h.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Bd=[(()=>{class t{constructor(t,e,n){this.actions$=t,this.as=e,this.sbs=n,this.saveExercises$=Object(o.c)(()=>this.actions$.pipe(Object(o.d)(b),Object(pt.a)(t=>this.as.upsertExercises(t.exers).then(e=>(this.sbs.openSnackBar("Successfully saved "+t.exers.length+" exercises"),g()),t=>{this.sbs.openSnackBar("Error occured!",6e3);const e=dt.a(t);return console.log(t),m({errMsg:e})}))))}}return t.\u0275fac=function(e){return new(e||t)(h.Yb(o.a),h.Yb(Vd),h.Yb(qd))},t.\u0275prov=h.Kb({token:t,factory:t.\u0275fac}),t})()],zd=Object(s.p)({currentActionPage:null,loading:!1},Object(s.r)(l,(t,{page:e})=>Object.assign(Object.assign({},t),{currentActionPage:e})),Object(s.r)(p,(t,{exerUnitType:e})=>Object.assign(Object.assign({},t),{newExerType:{name:e}})),Object(s.r)(d,(t,{timeStamp:e})=>Object.assign(Object.assign({},t),{saveNewExerBtnClickTimeStamp:e})),Object(s.r)(v,(t,{status:e})=>Object.assign(Object.assign({},t),{formValidState:e})),Object(s.r)(y,t=>Object.assign(Object.assign({},t),{saveNewExerBtnClickTimeStamp:void 0,newExerType:void 0,formValidState:!0})),Object(s.r)(b,(t,{exers:e})=>Object.assign(Object.assign({},t),{exersBeingAdded:[...e],loading:!0})),Object(s.r)(g,t=>Object.assign(Object.assign({},t),{loading:!1,errMsg:void 0,error:!1})),Object(s.r)(m,(t,{errMsg:e})=>Object.assign(Object.assign({},t),{loading:!1,errMsg:e,error:!0})));let Gd=(()=>{class t{}return t.\u0275mod=h.Mb({type:t}),t.\u0275inj=h.Lb({factory:function(e){return new(e||t)},providers:[],imports:[[lt,u.a,r.c,i.q,i.j,s.j.forFeature("admin",zd),o.b.forFeature(Bd),a.a]]}),t})()}}]);