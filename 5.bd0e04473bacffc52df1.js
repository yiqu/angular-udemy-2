(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return Dv});var r=n("ofXK"),i=n("3Pt+"),o=n("9jGm"),s=n("l7P3"),u=n("UmVK"),a=n("37S3"),c=n("fXoL");let h=(()=>{class t{}return t.\u0275mod=c.Mb({type:t}),t.\u0275inj=c.Lb({factory:function(e){return new(e||t)},providers:[],imports:[[u.a,r.c,i.k,i.r,a.a]]}),t})();var f=n("tyNb"),l=n("pLZG"),p=n("IzEk"),d=n("0IaG"),v=n("ooqH"),y=n("XiUz"),b=n("kmnG"),m=n("qFsG"),g=n("d3UM"),w=n("1jcm"),I=n("bTqV"),T=n("FKr1"),O=n("Q7j5");function E(t,e){1&t&&(c.Ub(0,"mat-error"),c.Dc(1," Name is required. "),c.Tb())}function _(t,e){if(1&t&&(c.Ub(0,"mat-option",14),c.Dc(1),c.Tb()),2&t){const t=e.$implicit;c.mc("value",t),c.Cb(1),c.Fc(" ",t," ")}}function S(t,e){if(1&t&&(c.Ub(0,"mat-option",14),c.Dc(1),c.Tb()),2&t){const t=e.$implicit;c.mc("value",t),c.Cb(1),c.Fc(" ",t," ")}}function j(t,e){if(1&t&&(c.Ub(0,"mat-form-field",3),c.Ub(1,"mat-label"),c.Dc(2,"Time Per Set (in seconds)"),c.Tb(),c.Ub(3,"mat-select",6),c.Bc(4,S,2,2,"mat-option",7),c.Tb(),c.Tb()),2&t){const t=c.gc();c.Cb(3),c.mc("formControlName","countPerSet"),c.Cb(1),c.mc("ngForOf",t.timeOptions)}}function x(t,e){if(1&t&&(c.Ub(0,"mat-option",14),c.Dc(1),c.Tb()),2&t){const t=e.$implicit;c.mc("value",t),c.Cb(1),c.Fc(" ",t," ")}}function N(t,e){if(1&t&&(c.Ub(0,"mat-form-field",3),c.Ub(1,"mat-label"),c.Dc(2,"Reps Per Set"),c.Tb(),c.Ub(3,"mat-select",6),c.Bc(4,x,2,2,"mat-option",7),c.Tb(),c.Tb()),2&t){const t=c.gc();c.Cb(3),c.mc("formControlName","countPerSet"),c.Cb(1),c.mc("ngForOf",t.timeOptions)}}let A=(()=>{class t{constructor(t,e,n){this.dialogRef=t,this.data=e,this.fb=n,this.exerFg=new i.h({}),this.setOptions=[3,5,7,10],this.timeOptions=[10,20,30,40,50,60],this.exerFg=this.fb.group({name:Object(v.a)(this.data.name,!1,[i.s.required]),sets:Object(v.a)(this.data.sets,!1),countPerSet:Object(v.a)(this.data.countPerSet,!1),setUnitTypeIsTime:Object(v.a)(this.data.setUnitTypeIsTime,!1)})}ngOnInit(){}onNoClick(){this.dialogRef.close(!1)}onYesClick(){this.dialogRef.close(Object.assign(Object.assign({},this.exerFg.value),{id:this.data.id}))}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(d.f),c.Ob(d.a),c.Ob(i.e))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-shared-dialog-exer"]],decls:27,vars:13,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","10px",3,"formGroup"],[1,""],["type","text","matInput","","placeholder","Exercises name",3,"formControlName"],[4,"ngIf"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],["color","primary",1,"",3,"formControlName"],[3,"ngSwitch"],["class","",4,"ngSwitchCase"],["mat-dialog-actions",""],["mat-flat-button","","cdkFocusInitial","","color","accent",3,"click"],["mat-flat-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(t,e){1&t&&(c.Ub(0,"h1",0),c.Dc(1),c.hc(2,"capitalizeFirstLetter"),c.Tb(),c.Pb(3,"hr"),c.Ub(4,"div",1),c.Ub(5,"div"),c.Ub(6,"div",2),c.Ub(7,"mat-form-field",3),c.Ub(8,"mat-label"),c.Dc(9,"Exercises Name"),c.Tb(),c.Pb(10,"input",4),c.Bc(11,E,2,0,"mat-error",5),c.Tb(),c.Ub(12,"mat-form-field",3),c.Ub(13,"mat-label"),c.Dc(14,"Total Sets"),c.Tb(),c.Ub(15,"mat-select",6),c.Bc(16,_,2,2,"mat-option",7),c.Tb(),c.Tb(),c.Ub(17,"mat-slide-toggle",8),c.Dc(18,"Use time"),c.Tb(),c.Sb(19,9),c.Bc(20,j,5,2,"mat-form-field",10),c.Bc(21,N,5,2,"mat-form-field",10),c.Rb(),c.Tb(),c.Tb(),c.Tb(),c.Ub(22,"div",11),c.Ub(23,"button",12),c.cc("click",function(){return e.onNoClick()}),c.Dc(24,"Cancel"),c.Tb(),c.Ub(25,"button",13),c.cc("click",function(){return e.onYesClick()}),c.Dc(26,"Save"),c.Tb(),c.Tb()),2&t&&(c.Cb(1),c.Fc("Edit ",c.ic(2,11,e.data.name),""),c.Cb(5),c.mc("formGroup",e.exerFg),c.Cb(4),c.mc("formControlName","name"),c.Cb(1),c.mc("ngIf",e.exerFg.controls.name.errors),c.Cb(4),c.mc("formControlName","sets"),c.Cb(1),c.mc("ngForOf",e.setOptions),c.Cb(1),c.mc("formControlName","setUnitTypeIsTime"),c.Cb(2),c.mc("ngSwitch",e.exerFg.controls.setUnitTypeIsTime.value),c.Cb(1),c.mc("ngSwitchCase",!0),c.Cb(1),c.mc("ngSwitchCase",!1),c.Cb(4),c.mc("disabled",e.exerFg.invalid))},directives:[d.g,d.d,y.c,y.b,y.d,i.p,i.i,b.c,b.g,m.b,i.c,i.o,i.g,r.k,g.a,r.j,w.a,r.m,r.n,d.c,I.a,b.b,T.n],pipes:[O.a],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   .exer[_ngcontent-%COMP%]{border:1px solid #eee;border-radius:35px;padding:20px}"]}),t})();const C=Object(s.n)("[Admin/UI] Admin page navigation",Object(s.s)()),D=Object(s.n)("[Admin/UI] Add a new exer select click",Object(s.s)()),k=Object(s.n)("[Admin/UI] Save exer button click",Object(s.s)()),P=Object(s.n)("[Admin/UI] Set form valid status",Object(s.s)()),L=Object(s.n)("[Admin/UI] Reset all options in new exer"),U=Object(s.n)("[Admin/API] Save all exer start",Object(s.s)()),R=Object(s.n)("[Admin/API] Save all exer success"),M=Object(s.n)("[Admin/API] Save all exer failed",Object(s.s)()),V=Object(s.n)("[Admin/API] Get all exer start"),F=Object(s.n)("[Admin/API] Get all exer success",Object(s.s)()),q=Object(s.n)("[Admin/API] Get all exer failed",Object(s.s)()),B=Object(s.o)("admin"),z=Object(s.q)(B,t=>t.currentActionPage),G=Object(s.q)(z,t=>{const e=[];return"new"===t?(e.push({btnName:"Add another",btnMenu:!0,btnMenuItems:["Time Based","Rep Based"]}),e.push({btnName:"Save"})):"edit"===t&&e.push({btnName:"Delete all"}),e}),H=Object(s.q)(B,t=>t.newExerType),K=Object(s.q)(B,t=>t.saveNewExerBtnClickTimeStamp),J=Object(s.q)(B,z,(t,e)=>"new"!==e||null==t.formValidState||t.formValidState),$=Object(s.q)(B,t=>t.loading),Y=Object(s.q)(B,t=>t.allExers);let X=(()=>{class t{constructor(t,e){this.store=t,this.dialog=e,this.currentSelectedPage$=this.store.select(z),this.adminPanelButtons$=this.store.select(G),this.newlyAddedExerType$=this.store.select(H),this.onNewExerSaveClick$=this.store.select(K),this.exerFormStatus$=this.store.select(J).pipe(Object(l.a)(t=>null!=t)),this.isLoading$=this.store.select($),this.allExers$=this.store.select(Y)}setCurrentPageState(t){this.store.dispatch(C({page:t}))}addNewExer(t){this.store.dispatch(D({exerUnitType:t}))}onNewExerSaveClick(){const t=(new Date).getTime();this.store.dispatch(k({timeStamp:t}))}onSetFormValidStatus(t){this.store.dispatch(P({status:t}))}resetNewExer(){this.store.dispatch(L())}onSaveExers(t){this.store.dispatch(U({exers:t}))}getAllExers(){this.store.dispatch(V())}editExercise(t){return this.dialog.open(A,{minWidth:"30rem",data:t}).afterClosed().pipe(Object(p.a)(1))}}return t.\u0275fac=function(e){return new(e||t)(c.Yb(s.h),c.Yb(d.b))},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var W=n("STbY"),Q=n("znSr"),Z=n("NFeN"),tt=n("mrSG"),et=n("oC0T"),nt=n.n(et);let rt=(()=>{class t{transform(t){let e="done";switch(null==t?void 0:t.trim().toLowerCase()){case"add another":e="add";break;case"save":e="save";break;case"delete all":e="delete"}return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=c.Nb({name:"iconDisplay",type:t,pure:!0}),t})();function it(t,e){1&t&&(c.Sb(0),c.Ub(1,"span",7),c.Dc(2,"Please fix the errors before saving*"),c.Tb(),c.Rb())}function ot(t,e){if(1&t){const t=c.Vb();c.Ub(0,"button",11),c.cc("click",function(){c.tc(t);const e=c.gc().$implicit;return c.gc(2).onPanelBtnClick(e)}),c.Ub(1,"span",12),c.Dc(2),c.Tb(),c.Ub(3,"mat-icon",13),c.Dc(4),c.hc(5,"iconDisplay"),c.Tb(),c.Tb()}if(2&t){const t=c.gc().$implicit;c.Cb(2),c.Ec(t.btnName),c.Cb(2),c.Ec(c.ic(5,2,t.btnName))}}const st=function(t){return{menuItems:t}};function ut(t,e){if(1&t){const t=c.Vb();c.Ub(0,"button",14),c.cc("click",function(){c.tc(t);const e=c.gc().$implicit;return c.gc(2).onPanelBtnClick(e)}),c.Ub(1,"div",15),c.Ub(2,"div"),c.Dc(3),c.Tb(),c.Ub(4,"div",16),c.Ub(5,"mat-icon"),c.Dc(6,"keyboard_arrow_down"),c.Tb(),c.Tb(),c.Tb(),c.Ub(7,"mat-icon",13),c.Dc(8),c.hc(9,"iconDisplay"),c.Tb(),c.Tb()}if(2&t){const t=c.gc().$implicit;c.gc(2);const e=c.rc(13);c.mc("matMenuTriggerData",c.oc(6,st,t.btnMenuItems))("matMenuTriggerFor",e),c.Cb(3),c.Ec(t.btnName),c.Cb(5),c.Ec(c.ic(9,4,t.btnName))}}function at(t,e){if(1&t&&(c.Sb(0),c.Bc(1,ot,6,4,"button",9),c.Bc(2,ut,10,8,"button",10),c.Rb()),2&t){const t=e.$implicit;c.Cb(1),c.mc("ngIf",!t.btnMenu),c.Cb(1),c.mc("ngIf",t.btnMenu)}}function ct(t,e){if(1&t&&(c.Sb(0),c.Bc(1,at,3,2,"ng-container",8),c.Rb()),2&t){const t=e.ngIf;c.Cb(1),c.mc("ngForOf",t)}}function ht(t,e){if(1&t){const t=c.Vb();c.Ub(0,"button",18),c.cc("click",function(){c.tc(t);const n=e.$implicit;return c.gc(2).onPanelMenuClick(n)}),c.Dc(1),c.Tb()}if(2&t){const t=e.$implicit;c.Cb(1),c.Ec(t)}}function ft(t,e){1&t&&c.Bc(0,ht,2,1,"button",17),2&t&&c.mc("ngForOf",e.menuItems)}const lt=function(){return["/","admin"]};let pt=(()=>{class t{constructor(t){this.as=t}ngOnInit(){}onPanelBtnClick(t){"Save"===t.btnName&&this.as.onNewExerSaveClick()}onPanelMenuClick(t){this.as.addNewExer(t)}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(X))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-admin"]],decls:15,vars:8,consts:[["fxLayout","column","fxLayoutGap","10px",1,"container","pb-3"],[1,"sticky-topp"],["fxLayout","row","fxLayoutAlign","space-between center",1,"title","mat-elevation-z0"],[3,"routerLink"],[4,"ngIf"],["menu","matMenu"],["matMenuContent",""],[1,"status-msg","ml-3"],[4,"ngFor","ngForOf"],["mat-button","","ngClass.lt-md","mat-icon-button","class","mr-3","ngClass.gt-sm","mat-flat-button","color","primary","type","button",3,"click",4,"ngIf"],["mat-button","","ngClass.lt-md","mat-icon-button","class","mr-3","ngClass.gt-sm","mat-flat-button","color","primary","type","button",3,"matMenuTriggerData","matMenuTriggerFor","click",4,"ngIf"],["mat-button","","ngClass.lt-md","mat-icon-button","ngClass.gt-sm","mat-flat-button","color","primary","type","button",1,"mr-3",3,"click"],["fxHide","","fxShow.gt-sm",""],["fxHide","","fxShow.lt-sm",""],["mat-button","","ngClass.lt-md","mat-icon-button","ngClass.gt-sm","mat-flat-button","color","primary","type","button",1,"mr-3",3,"matMenuTriggerData","matMenuTriggerFor","click"],["fxHide","","fxShow.gt-sm","","fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","5px"],["fxLayout","row","fxLayoutAlign","center center"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"]],template:function(t,e){1&t&&(c.Ub(0,"div",0),c.Ub(1,"div",1),c.Ub(2,"div",2),c.Ub(3,"div"),c.Ub(4,"a",3),c.Dc(5," Admin Panel "),c.Tb(),c.Bc(6,it,3,0,"ng-container",4),c.hc(7,"async"),c.Tb(),c.Ub(8,"div"),c.Bc(9,ct,2,1,"ng-container",4),c.hc(10,"async"),c.Tb(),c.Tb(),c.Tb(),c.Pb(11,"router-outlet"),c.Tb(),c.Ub(12,"mat-menu",null,5),c.Bc(14,ft,1,1,"ng-template",6),c.Tb()),2&t&&(c.Cb(4),c.mc("routerLink",c.nc(7,lt)),c.Cb(2),c.mc("ngIf",!c.ic(7,3,e.as.exerFormStatus$)),c.Cb(3),c.mc("ngIf",c.ic(10,5,e.as.adminPanelButtons$)))},directives:[y.c,y.d,y.b,f.e,r.k,f.g,W.a,W.b,r.j,I.a,Q.a,Q.b,Z.a,W.e,W.c],pipes:[r.b,rt],styles:[".title[_ngcontent-%COMP%]{font-size:19px;font-weight:700}.sticky-topp[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-left:0;height:4rem;border-bottom:1px solid #ccc}.sticky-topp[_ngcontent-%COMP%]   .status-msg[_ngcontent-%COMP%]{font-size:14px;color:#c45757}.loading-bar[_ngcontent-%COMP%]{margin:0;height:7px}"]}),t})(),dt=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}ngOnInit(){}onNoClick(){this.dialogRef.close(!1)}onYesClick(){this.dialogRef.close(!0)}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(d.f),c.Ob(d.a))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-shared-dialog"]],decls:10,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",3,"click"],["mat-button","",3,"click"]],template:function(t,e){1&t&&(c.Ub(0,"h1",0),c.Dc(1,"Confirmation"),c.Tb(),c.Ub(2,"div",1),c.Ub(3,"p"),c.Dc(4),c.Tb(),c.Tb(),c.Ub(5,"div",2),c.Ub(6,"button",3),c.cc("click",function(){return e.onNoClick()}),c.Dc(7,"No"),c.Tb(),c.Ub(8,"button",4),c.cc("click",function(){return e.onYesClick()}),c.Dc(9,"Yes"),c.Tb(),c.Tb()),2&t&&(c.Cb(4),c.Fc("Are you sure you want to ",null==e.data?null:e.data.actionName,""))},directives:[d.g,d.d,d.c,I.a],styles:[""]}),t})(),vt=(()=>{class t{constructor(t){this.dialog=t}openConfirmDialog(t){return this.dialog.open(dt,{minWidth:"300px",data:{actionName:t+" this exercise?"}}).afterClosed().pipe(Object(p.a)(1))}}return t.\u0275fac=function(e){return new(e||t)(c.Yb(d.b))},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var yt=n("Xa2L"),bt=n("M9IT"),mt=n("Dh3D"),gt=n("+0xr"),wt=n("B6IJ");let It=(()=>{class t{transform(t){let e=t;switch(t){case"name":e="Exercise Name";break;case"id":e="Exercise ID";break;case"sets":e="Sets";break;case"countPerSet":e="Rep / Time (Per Set)";break;case"setUnitTypeIsTime":e="Time Based";break;case"options":e="Actions"}return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=c.Nb({name:"tableColumnDisplay",type:t,pure:!0}),Object(tt.a)([nt()()],t.prototype,"transform",null),t})(),Tt=(()=>{class t{constructor(t){this.dp=t}transform(t,e,n){let r=t;switch(e){case"countPerSet":r=n?r+" seconds":r+" reps";break;case"setUnitTypeIsTime":r=r?"Yes":"No"}return r}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(wt.a))},t.\u0275pipe=c.Nb({name:"tableDataDisplay",type:t,pure:!0}),t})();function Ot(t,e){if(1&t&&(c.Ub(0,"th",14),c.Dc(1),c.hc(2,"tableColumnDisplay"),c.Tb()),2&t){const t=c.gc().$implicit;c.Cb(1),c.Fc(" ",c.ic(2,1,t)," ")}}function Et(t,e){if(1&t&&(c.Sb(0),c.Dc(1),c.hc(2,"tableDataDisplay"),c.Rb()),2&t){const t=c.gc().$implicit,e=c.gc().$implicit;c.Cb(1),c.Fc(" ",c.jc(2,1,t[e],e,t.setUnitTypeIsTime)," ")}}function _t(t,e){if(1&t){const t=c.Vb();c.Ub(0,"button",18),c.cc("click",function(){c.tc(t);const n=e.$implicit,r=c.gc(2).$implicit;return c.gc(3).onActionBtnClick(n,r)}),c.Dc(1),c.hc(2,"capitalizeFirstLetter"),c.Tb()}if(2&t){const t=e.$implicit;c.mc("color","delete"===t?"warn":"primary"),c.Cb(1),c.Fc(" ",c.ic(2,2,t)," ")}}function St(t,e){if(1&t&&(c.Sb(0),c.Bc(1,_t,3,4,"button",17),c.Rb()),2&t){const t=c.gc(4);c.Cb(1),c.mc("ngForOf",t.optionButtons)}}function jt(t,e){if(1&t&&(c.Ub(0,"td",15),c.Bc(1,Et,3,5,"ng-container",16),c.Bc(2,St,2,1,"ng-container",16),c.Tb()),2&t){const t=c.gc().$implicit;c.Cb(1),c.mc("ngIf","options"!==t),c.Cb(1),c.mc("ngIf","options"===t)}}function xt(t,e){if(1&t&&(c.Sb(0),c.Sb(1,11),c.Bc(2,Ot,3,3,"th",12),c.Bc(3,jt,3,2,"td",13),c.Rb(),c.Rb()),2&t){const t=e.$implicit;c.Cb(1),c.mc("matColumnDef",t)}}function Nt(t,e){1&t&&c.Pb(0,"tr",19)}const At=function(t){return{"table-row-bg":t}};function Ct(t,e){1&t&&c.Pb(0,"tr",20),2&t&&c.mc("ngClass",c.oc(1,At,e.even))}function Dt(t,e){if(1&t&&(c.Ub(0,"tr",21),c.Ub(1,"td",22),c.Dc(2),c.Tb(),c.Tb()),2&t){c.gc();const t=c.rc(5);c.Cb(2),c.Fc('No data matching the filter "',t.value,'"')}}const kt=function(t){return{border:t}},Pt=function(){return[1,30,60,100]};function Lt(t,e){if(1&t){const t=c.Vb();c.Ub(0,"div",1),c.Ub(1,"mat-form-field"),c.Ub(2,"mat-label"),c.Dc(3,"Filter exercises ..."),c.Tb(),c.Ub(4,"input",2,3),c.cc("keyup",function(e){return c.tc(t),c.gc().applyFilter(e)}),c.Tb(),c.Tb(),c.Ub(6,"div",4),c.Ub(7,"table",5),c.Bc(8,xt,4,1,"ng-container",6),c.Bc(9,Nt,1,0,"tr",7),c.Bc(10,Ct,1,3,"tr",8),c.Bc(11,Dt,3,1,"tr",9),c.Tb(),c.Pb(12,"mat-paginator",10),c.Tb(),c.Tb()}if(2&t){const t=c.gc();c.mc("ngClass",c.oc(6,kt,t.displayBorder)),c.Cb(7),c.mc("dataSource",t.dataSource),c.Cb(1),c.mc("ngForOf",t.cols),c.Cb(1),c.mc("matHeaderRowDef",t.cols),c.Cb(1),c.mc("matRowDefColumns",t.cols),c.Cb(2),c.mc("pageSizeOptions",c.nc(8,Pt))}}let Ut=(()=>{class t{constructor(t){this.cs=t,this.columns=[],this.columnsData=[],this.optionButtons=[],this.actionBtnClick=new c.o,this.paginator=null,this.sort=null,this.cols=[],this.dataSource=new gt.l(this.columnsData)}ngOnInit(){}ngOnChanges(){this.cols=[...this.columns],this.hasOptions&&(this.cols=this.addOptionsColumn(this.cols)),this.dataSource=new gt.l(this.columnsData),console.log(this.cols,this.columnsData)}ngAfterViewInit(){this.dataSource&&(this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}addOptionsColumn(t){return[...t,"options"]}onActionBtnClick(t,e){this.actionBtnClick.emit({btnAction:t,data:e})}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(vt))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-shared-table"]],viewQuery:function(t,e){if(1&t&&(c.Gc(bt.a,!0),c.Gc(mt.a,!0)),2&t){let t;c.qc(t=c.dc())&&(e.paginator=t.first),c.qc(t=c.dc())&&(e.sort=t.first)}},inputs:{columns:"columns",columnsData:"columnsData",displayBorder:"displayBorder",hasOptions:"hasOptions",optionButtons:"optionButtons"},outputs:{actionBtnClick:"actionBtnClick"},features:[c.Ab],decls:1,vars:1,consts:[["class","table-parent",3,"ngClass",4,"ngIf"],[1,"table-parent",3,"ngClass"],["matInput","","placeholder","Start typing...",3,"keyup"],["input",""],[1,"mat-elevation-z0"],["mat-table","","matSort","",3,"dataSource"],[4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["pageSize","30","showFirstLastButtons","",1,"mt-3",3,"pageSizeOptions"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[4,"ngIf"],["mat-stroked-button","","class","mr-2",3,"color","click",4,"ngFor","ngForOf"],["mat-stroked-button","",1,"mr-2",3,"color","click"],["mat-header-row",""],["mat-row","",3,"ngClass"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,e){1&t&&c.Bc(0,Lt,13,9,"div",0),2&t&&c.mc("ngIf",e.cols&&e.cols.length>0&&e.columnsData&&e.columnsData.length>0)},directives:[r.k,Q.a,r.i,b.c,b.g,m.b,gt.k,mt.a,r.j,gt.g,gt.j,gt.h,bt.a,gt.c,gt.e,gt.b,gt.d,mt.b,gt.a,I.a,gt.f,gt.i],pipes:[It,Tt,O.a],styles:["table[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{width:25rem}.table-parent[_ngcontent-%COMP%]{overflow:auto}.table-row-bg[_ngcontent-%COMP%]{background-color:hsla(0,0%,80%,.16862745098039217)}.border[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:15px;padding:10px}"]}),t})();function Rt(t,e){1&t&&(c.Sb(0),c.Ub(1,"div",3),c.Pb(2,"mat-spinner",4),c.Tb(),c.Rb())}function Mt(t,e){if(1&t){const t=c.Vb();c.Ub(0,"div",5),c.Ub(1,"div",6),c.Ub(2,"app-shared-table",7),c.cc("actionBtnClick",function(e){return c.tc(t),c.gc().onActionBtnClick(e)}),c.hc(3,"async"),c.Tb(),c.Tb(),c.Tb()}if(2&t){const t=c.gc();c.Cb(2),c.mc("columns",t.columns)("columnsData",c.ic(3,4,t.as.allExers$))("hasOptions",!0)("optionButtons",t.optionBtns)}}let Vt=(()=>{class t{constructor(t,e){this.as=t,this.cs=e,this.columns=["name","sets","countPerSet","setUnitTypeIsTime"],this.optionBtns=["edit","delete"],this.as.setCurrentPageState("edit")}ngOnInit(){this.as.getAllExers()}onActionBtnClick(t){"edit"===t.btnAction?this.as.editExercise(t.data).subscribe(t=>{t&&console.log("save it",t)}):"delete"===t.btnAction&&this.cs.openConfirmDialog("delete").subscribe(e=>{e&&console.log("delete",t.data)})}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(X),c.Ob(vt))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-admin-edit"]],decls:5,vars:4,consts:[[1,""],[4,"ngIf","ngIfElse"],["tableData",""],["fxLayout","row","fxLayoutAlign","center center",1,"mt-3"],["mode","indeterminate"],[1,"row","mb-3"],[1,"col"],[3,"columns","columnsData","hasOptions","optionButtons","actionBtnClick"]],template:function(t,e){if(1&t&&(c.Ub(0,"div",0),c.Bc(1,Rt,3,0,"ng-container",1),c.hc(2,"async"),c.Bc(3,Mt,4,6,"ng-template",null,2,c.Cc),c.Tb()),2&t){const t=c.rc(4);c.Cb(1),c.mc("ngIf",c.ic(2,2,e.as.isLoading$))("ngIfElse",t)}},directives:[r.k,y.c,y.b,yt.b,Ut],pipes:[r.b],styles:[".table-parent[_ngcontent-%COMP%]{width:100%}",".title[_ngcontent-%COMP%]{font-size:19px;font-weight:700}.sticky-topp[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-left:0;height:4rem;border-bottom:1px solid #ccc}.sticky-topp[_ngcontent-%COMP%]   .status-msg[_ngcontent-%COMP%]{font-size:14px;color:#c45757}.loading-bar[_ngcontent-%COMP%]{margin:0;height:7px}"]}),t})(),Ft=(()=>{class t{constructor(t,e,n,r){this.fb=t,this.router=e,this.route=n,this.as=r,this.as.setCurrentPageState(null)}ngOnInit(){}onActionClick(t){"add"===t?this.router.navigate(["../","new-exer"],{relativeTo:this.route}):"edit"===t&&this.router.navigate(["../","edit-exer"],{relativeTo:this.route})}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(i.e),c.Ob(f.c),c.Ob(f.a),c.Ob(X))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-admin-landing"]],decls:18,vars:0,consts:[[1,"row","mb-3","justify-content-center"],[1,"col-12","text-center"],[1,"row","justify-content-center"],["ngClass.lt-md","mb-3",1,"col-12","col-lg-2"],["fxLayout","column","fxLayoutAlign","center center"],["mat-fab","","color","primary",1,"mat-elevation-z0",3,"click"],[1,"col-12","col-lg-2"],["mat-fab","","color","accent",1,"mat-elevation-z0",3,"click"]],template:function(t,e){1&t&&(c.Ub(0,"div",0),c.Ub(1,"p",1),c.Dc(2,"Welcome to the admin panel. You can add, edit or delete exercises."),c.Tb(),c.Tb(),c.Ub(3,"div",2),c.Ub(4,"div",3),c.Ub(5,"div",4),c.Ub(6,"button",5),c.cc("click",function(){return e.onActionClick("add")}),c.Ub(7,"mat-icon"),c.Dc(8,"add"),c.Tb(),c.Tb(),c.Ub(9,"div"),c.Dc(10," New Exercise "),c.Tb(),c.Tb(),c.Tb(),c.Ub(11,"div",6),c.Ub(12,"div",4),c.Ub(13,"button",7),c.cc("click",function(){return e.onActionClick("edit")}),c.Ub(14,"mat-icon"),c.Dc(15,"edit"),c.Tb(),c.Tb(),c.Ub(16,"div"),c.Dc(17," Edit Exercises "),c.Tb(),c.Tb(),c.Tb(),c.Tb())},directives:[Q.a,y.c,y.b,I.a,Z.a],styles:[""]}),t})();var qt=n("XNiG"),Bt=n("1G5W");function zt(t,e){1&t&&(c.Ub(0,"mat-error"),c.Dc(1," Name is required. "),c.Tb())}function Gt(t,e){if(1&t&&(c.Ub(0,"mat-option",15),c.Dc(1),c.Tb()),2&t){const t=e.$implicit;c.mc("value",t),c.Cb(1),c.Fc(" ",t," ")}}function Ht(t,e){if(1&t&&(c.Ub(0,"mat-option",15),c.Dc(1),c.Tb()),2&t){const t=e.$implicit;c.mc("value",t),c.Cb(1),c.Fc(" ",t," ")}}function Kt(t,e){if(1&t&&(c.Ub(0,"mat-form-field",8),c.Ub(1,"mat-label"),c.Dc(2,"Time Per Set (in seconds)"),c.Tb(),c.Ub(3,"mat-select",10),c.Bc(4,Ht,2,2,"mat-option",11),c.Tb(),c.Tb()),2&t){const t=c.gc(3);c.Cb(3),c.mc("formControlName","countPerSet"),c.Cb(1),c.mc("ngForOf",t.timeOptions)}}function Jt(t,e){if(1&t&&(c.Ub(0,"mat-option",15),c.Dc(1),c.Tb()),2&t){const t=e.$implicit;c.mc("value",t),c.Cb(1),c.Fc(" ",t," ")}}function $t(t,e){if(1&t&&(c.Ub(0,"mat-form-field",8),c.Ub(1,"mat-label"),c.Dc(2,"Reps Per Set"),c.Tb(),c.Ub(3,"mat-select",10),c.Bc(4,Jt,2,2,"mat-option",11),c.Tb(),c.Tb()),2&t){const t=c.gc(3);c.Cb(3),c.mc("formControlName","countPerSet"),c.Cb(1),c.mc("ngForOf",t.timeOptions)}}function Yt(t,e){if(1&t&&(c.Ub(0,"div",5),c.Ub(1,"div",6),c.Dc(2),c.Tb(),c.Ub(3,"div",7),c.Ub(4,"mat-form-field",8),c.Ub(5,"mat-label"),c.Dc(6,"Exercises Name"),c.Tb(),c.Pb(7,"input",9),c.Bc(8,zt,2,0,"mat-error",1),c.Tb(),c.Ub(9,"mat-form-field",8),c.Ub(10,"mat-label"),c.Dc(11,"Total Sets"),c.Tb(),c.Ub(12,"mat-select",10),c.Bc(13,Gt,2,2,"mat-option",11),c.Tb(),c.Tb(),c.Ub(14,"mat-slide-toggle",12),c.Dc(15,"Use time"),c.Tb(),c.Sb(16,13),c.Bc(17,Kt,5,2,"mat-form-field",14),c.Bc(18,$t,5,2,"mat-form-field",14),c.Rb(),c.Tb(),c.Tb()),2&t){const t=e.index,n=c.gc(2);c.Cb(2),c.Fc(" Exercise #",t+1," "),c.Cb(1),c.mc("formGroupName",t),c.Cb(4),c.mc("formControlName","name"),c.Cb(1),c.mc("ngIf",n.exercisesFaAny.controls[t].controls.name.errors&&n.exercisesFaAny.controls[t].controls.name.errors.required),c.Cb(4),c.mc("formControlName","sets"),c.Cb(1),c.mc("ngForOf",n.setOptions),c.Cb(1),c.mc("formControlName","setUnitTypeIsTime"),c.Cb(2),c.mc("ngSwitch",n.exercisesFaAny.controls[t].controls.setUnitTypeIsTime.value),c.Cb(1),c.mc("ngSwitchCase",!0),c.Cb(1),c.mc("ngSwitchCase",!1)}}const Xt=function(){return{width:"100%"}};function Wt(t,e){if(1&t){const t=c.Vb();c.Sb(0),c.Ub(1,"form",2),c.cc("ngSubmit",function(){return c.tc(t),c.gc().onFormSubmit()}),c.Ub(2,"div",3),c.Bc(3,Yt,19,10,"div",4),c.Tb(),c.Tb(),c.Rb()}if(2&t){const t=c.gc();c.Cb(1),c.mc("formGroup",t.mainFg)("ngStyle.lt-md",c.nc(3,Xt)),c.Cb(2),c.mc("ngForOf",t.exercisesFa.controls)}}const Qt=[{path:"",component:pt,children:[{path:"",redirectTo:"landing",pathMatch:"full"},{path:"landing",component:Ft},{path:"new-exer",component:(()=>{class t{constructor(t,e){this.fb=t,this.as=e,this.setOptions=[3,5,7,10],this.timeOptions=[10,20,30,40,50,60],this.compDest$=new qt.a,this.mainFg=this.createMainFg(),this.as.setCurrentPageState("new")}get exercisesFa(){return this.mainFg.get("exercises")}get exercisesFaAny(){return this.mainFg.get("exercises")}ngOnInit(){this.mainFg.valueChanges.pipe(Object(Bt.a)(this.compDest$)).subscribe(t=>{}),this.as.newlyAddedExerType$.pipe(Object(Bt.a)(this.compDest$)).subscribe(t=>{t&&t.name&&this.exercisesFa.push(this.createExerciseFg(t.name))}),this.as.onNewExerSaveClick$.pipe(Object(l.a)(t=>!!t),Object(Bt.a)(this.compDest$)).subscribe(t=>{this.onFormSubmit()})}createMainFg(){return this.fb.group({exercises:this.fb.array([this.createExerciseFg("Time Based")])})}createExerciseFg(t){const e="Time Based"===t;return this.fb.group({name:Object(v.a)(null,!1,[i.s.required]),sets:Object(v.a)(3,!1),countPerSet:Object(v.a)(30,!1),setUnitTypeIsTime:Object(v.a)(e,!1)})}onAddAnother(){this.exercisesFa.push(this.createExerciseFg())}onFormSubmit(){this.checkFormValid(this.mainFg.valid),console.log(this.mainFg.value),this.mainFg.valid&&this.as.onSaveExers(this.mainFg.value.exercises)}checkFormValid(t){this.as.onSetFormValidStatus(t)}ngOnDestroy(){this.as.resetNewExer(),this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(i.e),c.Ob(X))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-admin-new"]],decls:2,vars:1,consts:[["fxLayout","column","fxLayoutAlign","center center"],[4,"ngIf"],["fxLayoutGap","10px",3,"formGroup","ngStyle.lt-md","ngSubmit"],["formArrayName","exercises"],["class","exer mb-3",4,"ngFor","ngForOf"],[1,"exer","mb-3"],["ngClass.gt-xs","arr-count text-center"],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","10px",3,"formGroupName"],[1,""],["type","text","matInput","","placeholder","Exercises name",3,"formControlName"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],["color","primary",1,"",3,"formControlName"],[3,"ngSwitch"],["class","",4,"ngSwitchCase"],[3,"value"]],template:function(t,e){1&t&&(c.Ub(0,"div",0),c.Bc(1,Wt,4,4,"ng-container",1),c.Tb()),2&t&&(c.Cb(1),c.mc("ngIf",e.mainFg))},directives:[y.c,y.b,r.k,i.t,i.p,y.d,i.i,Q.c,i.d,r.j,Q.a,i.j,b.c,b.g,m.b,i.c,i.o,i.g,g.a,w.a,r.m,r.n,b.b,T.n],styles:[".arr-count[_ngcontent-%COMP%]{width:35rem;background-color:#eee;border-radius:15px;padding:10px}mat-form-field[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   .exer[_ngcontent-%COMP%]{border:1px solid #eee;border-radius:35px;padding:20px}",".title[_ngcontent-%COMP%]{font-size:19px;font-weight:700}.sticky-topp[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-left:0;height:4rem;border-bottom:1px solid #ccc}.sticky-topp[_ngcontent-%COMP%]   .status-msg[_ngcontent-%COMP%]{font-size:14px;color:#c45757}.loading-bar[_ngcontent-%COMP%]{margin:0;height:7px}"]}),t})()},{path:"edit-exer",component:Vt}]}];let Zt=(()=>{class t{}return t.\u0275mod=c.Mb({type:t}),t.\u0275inj=c.Lb({factory:function(e){return new(e||t)},imports:[[f.f.forChild(Qt)],f.f]}),t})();var te=n("bOdf"),ee=n("eIep"),ne=n("Kojo"),re=n("Jgta"),ie=n("zIRd"),oe=n("q/0M"),se=n("qOnz"),ue=function(t,e){return(ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function ae(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var ce,he="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},fe=fe||{},le=he||self;function pe(){}function de(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function ve(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ye="closure_uid_"+(1e9*Math.random()>>>0),be=0;function me(t,e,n){return t.call.apply(t.bind,arguments)}function ge(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function we(t,e,n){return(we=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?me:ge).apply(null,arguments)}function Ie(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Te(){return Date.now()}function Oe(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Ee(){this.j=this.j,this.i=this.i}Ee.prototype.j=!1,Ee.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,ye)&&t[ye]||(t[ye]=++be)}(this)},Ee.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var _e=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Se=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function je(t){return Array.prototype.concat.apply([],arguments)}function xe(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Ne(t){return/^[\s\xa0]*$/.test(t)}var Ae,Ce=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function De(t,e){return-1!=t.indexOf(e)}function ke(t,e){return t<e?-1:t>e?1:0}t:{var Pe=le.navigator;if(Pe){var Le=Pe.userAgent;if(Le){Ae=Le;break t}}Ae=""}function Ue(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Re(t){var e={};for(var n in t)e[n]=t[n];return e}var Me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ve(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Me.length;o++)n=Me[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Fe(t){return Fe[" "](t),t}Fe[" "]=pe;var qe,Be,ze=De(Ae,"Opera"),Ge=De(Ae,"Trident")||De(Ae,"MSIE"),He=De(Ae,"Edge"),Ke=He||Ge,Je=De(Ae,"Gecko")&&!(De(Ae.toLowerCase(),"webkit")&&!De(Ae,"Edge"))&&!(De(Ae,"Trident")||De(Ae,"MSIE"))&&!De(Ae,"Edge"),$e=De(Ae.toLowerCase(),"webkit")&&!De(Ae,"Edge");function Ye(){var t=le.document;return t?t.documentMode:void 0}t:{var Xe="",We=(Be=Ae,Je?/rv:([^\);]+)(\)|;)/.exec(Be):He?/Edge\/([\d\.]+)/.exec(Be):Ge?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Be):$e?/WebKit\/(\S+)/.exec(Be):ze?/(?:Version)[ \/]?(\S+)/.exec(Be):void 0);if(We&&(Xe=We?We[1]:""),Ge){var Qe=Ye();if(null!=Qe&&Qe>parseFloat(Xe)){qe=String(Qe);break t}}qe=Xe}var Ze={};function tn(t){return function(t,e){var n=Ze;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=Ce(String(qe)).split("."),r=Ce(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=ke(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||ke(0==s[2].length,0==u[2].length)||ke(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}var en=le.document&&Ge&&(Ye()||parseInt(qe,10))||void 0,nn=!Ge||9<=Number(en),rn=Ge&&!tn("9"),on=function(){if(!le.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{le.addEventListener("test",pe,e),le.removeEventListener("test",pe,e)}catch(n){}return t}();function sn(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function un(t,e){if(sn.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Je){t:{try{Fe(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:an[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}sn.prototype.b=function(){this.defaultPrevented=!0},Oe(un,sn);var an={2:"touch",3:"pen",4:"mouse"};un.prototype.b=function(){un.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,rn)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var cn="closure_listenable_"+(1e6*Math.random()|0),hn=0;function fn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++hn,this.Y=this.Z=!1}function ln(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function pn(t){this.src=t,this.a={},this.b=0}function dn(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=_e(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ln(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function vn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}pn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=vn(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new fn(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var yn="closure_lm_"+(1e6*Math.random()|0),bn={};function mn(t,e,n,r,i){if(r&&r.once)return wn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)mn(t,e[o],n,r,i);return null}return n=xn(n),t&&t[cn]?t.va(e,n,ve(r)?!!r.capture:!!r,i):gn(t,e,n,!1,r,i)}function gn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=ve(i)?!!i.capture:!!i;if(s&&!nn)return null;var u=Sn(t);if(u||(t[yn]=u=new pn(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=_n,e=nn?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)on||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(On(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function wn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)wn(t,e[o],n,r,i);return null}return n=xn(n),t&&t[cn]?t.wa(e,n,ve(r)?!!r.capture:!!r,i):gn(t,e,n,!0,r,i)}function In(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)In(t,e[o],n,r,i);else r=ve(r)?!!r.capture:!!r,n=xn(n),t&&t[cn]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=vn(o=t.a[e],n,r,i))&&(ln(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Sn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=vn(e,n,r,i)),(n=-1<t?e[t]:null)&&Tn(n))}function Tn(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[cn])dn(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(On(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Sn(e))?(dn(n,t),0==n.b&&(n.src=null,e[yn]=null)):ln(t)}}}function On(t){return t in bn?bn[t]:bn[t]="on"+t}function En(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Tn(t),n.call(r,e)}function _n(t,e){if(t.Y)return!0;if(!nn){if(!e)t:{e=["window","event"];for(var n=le,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return En(t,e=new un(e,this))}return En(t,new un(e,this))}function Sn(t){return(t=t[yn])instanceof pn?t:null}var jn="__closure_events_fn_"+(1e9*Math.random()>>>0);function xn(t){return"function"==typeof t?t:(t[jn]||(t[jn]=function(e){return t.handleEvent(e)}),t[jn])}function Nn(){Ee.call(this),this.c=new pn(this),this.J=this,this.C=null}function An(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new sn(e,t);else if(e instanceof sn)e.target=e.target||t;else{var i=e;Ve(e=new sn(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Cn(s,r,!0,e)&&i}if(i=Cn(s=e.a=t,r,!0,e)&&i,i=Cn(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Cn(s=e.a=n[o],r,!1,e)&&i}function Cn(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&dn(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}Oe(Nn,Ee),Nn.prototype[cn]=!0,(ce=Nn.prototype).addEventListener=function(t,e,n,r){mn(this,t,e,n,r)},ce.removeEventListener=function(t,e,n,r){In(this,t,e,n,r)},ce.G=function(){if(Nn.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ln(n[r]);delete e.a[t],e.b--}}this.C=null},ce.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ce.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Dn=le.JSON.stringify;function kn(){this.b=this.a=null}var Pn,Ln=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new Rn},function(t){t.reset()});function Un(){var t=qn,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Rn(){this.next=this.b=this.a=null}function Mn(t){le.setTimeout(function(){throw t},0)}function Vn(t,e){Pn||function(){var t=le.Promise.resolve(void 0);Pn=function(){t.then(Bn)}}(),Fn||(Pn(),Fn=!0),qn.add(t,e)}kn.prototype.add=function(t,e){var n=Ln.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Rn.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Rn.prototype.reset=function(){this.next=this.b=this.a=null};var Fn=!1,qn=new kn;function Bn(){for(var t;t=Un();){try{t.a.call(t.b)}catch(n){Mn(n)}var e=Ln;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Fn=!1}function zn(t,e){Nn.call(this),this.b=t||1,this.a=e||le,this.f=we(this.Za,this),this.g=Te()}function Gn(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Hn(t,e,n){if("function"==typeof t)n&&(t=we(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=we(t.handleEvent,t)}return 2147483647<Number(e)?-1:le.setTimeout(t,e||0)}function Kn(t){t.a=Hn(function(){t.a=null,t.c&&(t.c=!1,Kn(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}Oe(zn,Nn),(ce=zn.prototype).aa=!1,ce.M=null,ce.Za=function(){if(this.aa){var t=Te()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),An(this,"tick"),this.aa&&(Gn(this),this.start()))}},ce.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=Te())},ce.G=function(){zn.X.G.call(this),Gn(this),delete this.a};var Jn=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}ue(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Kn(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(le.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(Ee);function $n(t){Ee.call(this),this.b=t,this.a={}}Oe($n,Ee);var Yn=[];function Xn(t,e,n,r){Array.isArray(n)||(n&&(Yn[0]=n.toString()),n=Yn);for(var i=0;i<n.length;i++){var o=mn(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Wn(t){Ue(t.a,function(t,e){this.a.hasOwnProperty(e)&&Tn(t)},t),t.a={}}function Qn(){this.a=!0}function Zn(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Dn(n)}catch(u){return e}}(t,n)+(r?" "+r:"")})}$n.prototype.G=function(){$n.X.G.call(this),Wn(this)},$n.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Qn.prototype.info=function(){};var tr={},er=null;function nr(){return er=er||new Nn}function rr(t){sn.call(this,tr.Fa,t)}function ir(t){var e=nr();An(e,new rr(e,t))}function or(t,e){sn.call(this,tr.STAT_EVENT,t),this.stat=e}function sr(t){var e=nr();An(e,new or(e,t))}function ur(t){sn.call(this,tr.Ga,t)}function ar(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return le.setTimeout(function(){t()},e)}tr.Fa="serverreachability",Oe(rr,sn),tr.STAT_EVENT="statevent",Oe(or,sn),tr.Ga="timingevent",Oe(ur,sn);var cr={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},hr={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function fr(){}function lr(){}fr.prototype.a=null;var pr,dr={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function vr(){sn.call(this,"d")}function yr(){sn.call(this,"c")}function br(){}function mr(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new $n(this),this.P=gr,this.R=new zn(t=Ke?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}Oe(vr,sn),Oe(yr,sn),Oe(br,fr),pr=new br;var gr=45e3,wr={},Ir={};function Tr(t,e,n){t.H=1,t.i=Gr(Mr(e)),t.j=n,t.I=!0,Or(t,null)}function Or(t,e){t.u=Te(),Sr(t),t.l=Mr(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),ri(n.b,"t",r),t.D=0,t.a=Wi(t.g,t.g.C?e:null),0<t.O&&(t.F=new Jn(we(t.Ca,t,t.a),t.O)),Xn(t.J,t.a,"readystatechange",t.Xa),e=t.B?Re(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ir(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function Er(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=_r(t,n);if(i==Ir){4==e&&(t.h=4,sr(14),r=!1),Zn(t.c,t.f,null,"[Incomplete Response]");break}if(i==wr){t.h=4,sr(15),Zn(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Zn(t.c,t.f,i,null),Cr(t,i)}4==e&&0==n.length&&(t.h=1,sr(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),zi(e),e.F=!0,sr(11))):(Zn(t.c,t.f,n,"[Invalid Chunked Response]"),Ar(t),Nr(t))}function _r(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Ir:(n=Number(e.substring(n,r)),isNaN(n)?wr:(r+=1)+n>e.length?Ir:(e=e.substr(r,n),t.D=r+n,e))}function Sr(t){t.T=Te()+t.P,jr(t,t.P)}function jr(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ar(we(t.Va,t),e)}function xr(t){t.o&&(le.clearTimeout(t.o),t.o=null)}function Nr(t){0==t.g.v||t.A||Ki(t.g,t)}function Ar(t){xr(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Gn(t.R),Wn(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Cr(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||hi(n.b,t)))if(n.I=t.N,!t.C&&hi(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(Rd){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Hi(n),Pi(n)}Bi(n),sr(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=ar(we(n.Sa,n),6e3));if(1>=ci(n.b)&&n.ea){try{n.ea()}catch(Rd){}n.ea=void 0}}else $i(n,11)}else if((t.C||n.a==t)&&Hi(n),!Ne(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(De(h,"spdy")||De(h,"quic")||De(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(fi(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,zr(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=Te()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=Xi(a,a.C?a.ga:null,a.fa),p.C){li(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(xr(d),Sr(d)),a.a=p}else qi(a);0<n.g.length&&Ri(n)}else"stop"!=i[0]&&"close"!=i[0]||$i(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?$i(n,7):ki(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);ir(4)}catch(Rd){}}function Dr(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(de(t)||"string"==typeof t)Se(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(de(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(de(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function kr(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof kr)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Pr(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Lr(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Lr(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Lr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ce=mr.prototype).setTimeout=function(t){this.P=t},ce.Xa=function(t){t=t.target;var e=this.F;e&&3==Ni(t)?e.f():this.Ca(t)},ce.Ca=function(t){try{if(t==this.a)t:{var e=Ni(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!Ke&&!this.a.$())){this.A||4!=e||7==n||ir(8==n||0>=r?3:2),xr(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ne(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,sr(12),Ar(this),Nr(this);break t}Zn(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Cr(this,a)}this.I?(Er(this,e,o),Ke&&this.b&&3==e&&(Xn(this.J,this.R,"tick",this.Wa),this.R.start())):(Zn(this.c,this.f,o,null),Cr(this,o)),4==e&&Ar(this),this.b&&!this.A&&(4==e?Ki(this.g,this):(this.b=!1,Sr(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,sr(12)):(this.h=0,sr(13)),Ar(this),Nr(this)}}}catch(c){}},ce.Wa=function(){if(this.a){var t=Ni(this.a),e=this.a.$();this.D<e.length&&(xr(this),Er(this,t,e),this.b&&4!=t&&Sr(this))}},ce.cancel=function(){this.A=!0,Ar(this)},ce.Va=function(){this.o=null;var t=Te();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(ir(3),sr(17)),Ar(this),this.h=2,Nr(this)):jr(this,this.T-t)},(ce=kr.prototype).K=function(){Pr(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ce.L=function(){return Pr(this),this.a.concat()},ce.get=function(t,e){return Lr(this.b,t)?this.b[t]:e},ce.set=function(t,e){Lr(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ce.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ur=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Rr(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Rr){this.a=void 0!==e?e:t.a,Vr(this,t.f),this.j=t.j,Fr(this,t.c),qr(this,t.h),this.g=t.g,e=t.b;var n=new Zr;n.c=e.c,e.a&&(n.a=new kr(e.a),n.b=e.b),Br(this,n),this.i=t.i}else t&&(n=String(t).match(Ur))?(this.a=!!e,Vr(this,n[1]||"",!0),this.j=Hr(n[2]||""),Fr(this,n[3]||"",!0),qr(this,n[4]),this.g=Hr(n[5]||"",!0),Br(this,n[6]||"",!0),this.i=Hr(n[7]||"")):(this.a=!!e,this.b=new Zr(null,this.a))}function Mr(t){return new Rr(t)}function Vr(t,e,n){t.f=n?Hr(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Fr(t,e,n){t.c=n?Hr(e,!0):e}function qr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Br(t,e,n){e instanceof Zr?(t.b=e,function(t,e){e&&!t.f&&(ti(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ei(this,e),ri(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=Kr(e,Wr)),t.b=new Zr(e,t.a))}function zr(t,e,n){t.b.set(e,n)}function Gr(t){return zr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Te()).toString(36)),t}function Hr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Kr(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Jr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Jr(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Rr.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Kr(e,$r,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Kr(e,$r,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Kr(n,"/"==n.charAt(0)?Xr:Yr,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Kr(n,Qr)),t.join("")};var $r=/[#\/\?@]/g,Yr=/[#\?:]/g,Xr=/[#\?]/g,Wr=/[#\?@]/g,Qr=/#/g;function Zr(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ti(t){t.a||(t.a=new kr,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function ei(t,e){ti(t),e=ii(t,e),Lr(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Lr((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Pr(t)))}function ni(t,e){return ti(t),e=ii(t,e),Lr(t.a.b,e)}function ri(t,e,n){ei(t,e),0<n.length&&(t.c=null,t.a.set(ii(t,e),xe(n)),t.b+=n.length)}function ii(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ce=Zr.prototype).add=function(t,e){ti(this),this.c=null,t=ii(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ce.forEach=function(t,e){ti(this),this.a.forEach(function(n,r){Se(n,function(n){t.call(e,n,r,this)},this)},this)},ce.L=function(){ti(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ce.K=function(t){ti(this);var e=[];if("string"==typeof t)ni(this,t)&&(e=je(e,this.a.get(ii(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=je(e,t[n])}return e},ce.set=function(t,e){return ti(this),this.c=null,ni(this,t=ii(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ce.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ce.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var oi=function(){return function(t,e){this.b=t,this.a=e}}();function si(t){this.g=t||ui,t=le.PerformanceNavigationTiming?0<(t=le.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(le.ia&&le.ia.ya&&le.ia.ya()&&le.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var ui=10;function ai(t){return!!t.b||!!t.a&&t.a.size>=t.f}function ci(t){return t.b?1:t.a?t.a.size:0}function hi(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function fi(t,e){t.a?t.a.add(e):t.b=e}function li(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function pi(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=ae(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return xe(t.c)}function di(){}function vi(){this.a=new di}function yi(t,e,n){var r=n||"";try{Dr(t,function(t,n){var i=t;ve(t)&&(i=Dn(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(Ev){throw e.push(r+"type="+encodeURIComponent("_badmap")),Ev}}function bi(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}si.prototype.cancel=function(){var t,e;if(this.c=pi(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=ae(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},di.prototype.stringify=function(t){return le.JSON.stringify(t,void 0)},di.prototype.parse=function(t){return le.JSON.parse(t,void 0)};var mi=le.JSON.parse;function gi(t){Nn.call(this),this.headers=new kr,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=wi,this.D=this.F=!1}Oe(gi,Nn);var wi="",Ii=/^https?$/i,Ti=["POST","PUT"];function Oi(t){return"content-type"==t.toLowerCase()}function Ei(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,_i(t),ji(t)}function _i(t){t.u||(t.u=!0,An(t,"complete"),An(t,"error"))}function Si(t){if(t.b&&void 0!==fe&&(!t.s[1]||4!=Ni(t)||2!=t.W()))if(t.l&&4==Ni(t))Hn(t.za,0,t);else if(An(t,"readystatechange"),4==Ni(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Ur)[1]||null;if(!o&&le.self&&le.self.location){var s=le.self.location.protocol;o=s.substr(0,s.length-1)}i=!Ii.test(o?o.toLowerCase():"")}e=i}if(e)An(t,"complete"),An(t,"success");else{t.h=6;try{var u=2<Ni(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",_i(t)}}finally{ji(t)}}}function ji(t,e){if(t.a){xi(t);var n=t.a,r=t.s[0]?pe:null;t.a=null,t.s=null,e||An(t,"ready");try{n.onreadystatechange=r}catch(Ev){}}}function xi(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(le.clearTimeout(t.m),t.m=null)}function Ni(t){return t.a?t.a.readyState:0}function Ai(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Ue(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):zr(t,e,n))}function Ci(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Di(t){this.pa=0,this.g=[],this.c=new Qn,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Ci("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Ci("baseRetryDelayMs",5e3,t),this.Ra=Ci("retryDelaySeedMs",1e4,t),this.Ma=Ci("forwardChannelMaxRetries",2,t),this.ma=Ci("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new si(t&&t.concurrentRequestLimit),this.ka=new vi,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function ki(t){if(Li(t),3==t.v){var e=t.R++,n=Mr(t.B);zr(n,"SID",t.J),zr(n,"RID",e),zr(n,"TYPE","terminate"),Vi(t,n),(e=new mr(t,t.c,e,void 0)).H=2,e.i=Gr(Mr(n)),n=!1,le.navigator&&le.navigator.sendBeacon&&(n=le.navigator.sendBeacon(e.i.toString(),"")),!n&&le.Image&&((new Image).src=e.i,n=!0),n||(e.a=Wi(e.g,null),e.a.ba(e.i)),e.u=Te(),Sr(e)}Yi(t)}function Pi(t){t.a&&(zi(t),t.a.cancel(),t.a=null)}function Li(t){Pi(t),t.j&&(le.clearTimeout(t.j),t.j=null),Hi(t),t.b.cancel(),t.h&&("number"==typeof t.h&&le.clearTimeout(t.h),t.h=null)}function Ui(t,e){t.g.push(new oi(t.Oa++,e)),3==t.v&&Ri(t)}function Ri(t){ai(t.b)||t.h||(t.h=!0,Vn(t.Ba,t),t.u=0)}function Mi(t,e){var n;n=e?e.f:t.R++;var r=Mr(t.B);zr(r,"SID",t.J),zr(r,"RID",n),zr(r,"AID",t.P),Vi(t,r),t.i&&t.l&&Ai(r,t.i,t.l),n=new mr(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Fi(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),fi(t.b,n),Tr(n,r,e)}function Vi(t,e){t.f&&Dr({},function(t,n){zr(e,n,t)})}function Fi(t,e,n){n=Math.min(t.g.length,n);var r=t.f?we(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{yi(h,s,"req"+c+"_")}catch(Po){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function qi(t){t.a||t.j||(t.T=1,Vn(t.Aa,t),t.o=0)}function Bi(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=ar(we(t.Aa,t),Ji(t,t.o)),t.o++,0))}function zi(t){null!=t.s&&(le.clearTimeout(t.s),t.s=null)}function Gi(t){t.a=new mr(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Mr(t.la);zr(e,"RID","rpc"),zr(e,"SID",t.J),zr(e,"CI",t.H?"0":"1"),zr(e,"AID",t.P),Vi(t,e),zr(e,"TYPE","xmlhttp"),t.i&&t.l&&Ai(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Gr(Mr(e)),n.j=null,n.I=!0,Or(n,t)}function Hi(t){null!=t.m&&(le.clearTimeout(t.m),t.m=null)}function Ki(t,e){var n=null;if(t.a==e){Hi(t),zi(t),t.a=null;var r=2}else{if(!hi(t.b,e))return;n=e.s,li(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=Te()-e.u;var i=t.u;An(r=nr(),new ur(r,n,e,i)),Ri(t)}else qi(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(ci(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=ar(we(t.Ba,t,e),Ji(t,t.u)),t.u++,0)))}(t,e)||2==r&&Bi(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:$i(t,5);break;case 4:$i(t,10);break;case 3:$i(t,6);break;default:$i(t,2)}}function Ji(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function $i(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=we(t.Ya,t);n||(n=new Rr("//www.google.com/images/cleardot.gif"),le.location&&"http"==le.location.protocol||Vr(n,"https"),Gr(n)),function(t,e){var n=new Qn;if(le.Image){var r=new Image;r.onload=Ie(bi,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Ie(bi,n,r,"TestLoadImage: error",!1,e),r.onabort=Ie(bi,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ie(bi,n,r,"TestLoadImage: timeout",!1,e),le.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else sr(2);t.v=0,t.f&&t.f.ra(e),Yi(t),Li(t)}function Yi(t){t.v=0,t.I=-1,t.f&&(0==pi(t.b).length&&0==t.g.length||(t.b.c.length=0,xe(t.g),t.g.length=0),t.f.qa())}function Xi(t,e,n){var r=function(t){return t instanceof Rr?Mr(t):new Rr(t,void 0)}(n);if(""!=r.c)e&&Fr(r,e+"."+r.c),qr(r,r.h);else{var i=le.location;r=function(t,e,n,r){var i=new Rr(null,void 0);return t&&Vr(i,t),e&&Fr(i,e),n&&qr(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&Ue(t.V,function(t,e){zr(r,e,t)}),n=t.na,(e=t.A)&&n&&zr(r,e,n),zr(r,"VER",t.ha),Vi(t,r),r}function Wi(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new gi(t.Na)).F=t.C,e}function Qi(){}function Zi(){if(Ge&&!(10<=Number(en)))throw Error("Environmental error: no available transport.")}function to(t,e){Nn.call(this),this.a=new Di(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Ne(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ne(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new ro(this)}function eo(t){vr.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function no(){yr.call(this),this.status=1}function ro(t){this.a=t}(ce=gi.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:pr),this.a.onreadystatechange=we(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void Ei(this,o)}t=n||"";var i=new kr(this.headers);r&&Dr(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Oi,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=le.FormData&&t instanceof le.FormData,!(0<=_e(Ti,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xi(this),0<this.o&&((this.D=function(t){return Ge&&tn(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=we(this.xa,this)):this.m=Hn(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Ei(this,o)}},ce.xa=function(){void 0!==fe&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,An(this,"timeout"),this.abort(8))},ce.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,An(this,"complete"),An(this,"abort"),ji(this))},ce.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),ji(this,!0)),gi.X.G.call(this)},ce.za=function(){this.j||(this.A||this.l||this.g?Si(this):this.Ua())},ce.Ua=function(){Si(this)},ce.W=function(){try{return 2<Ni(this)?this.a.status:-1}catch(Be){return-1}},ce.$=function(){try{return this.a?this.a.responseText:""}catch(Be){return""}},ce.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),mi(e)}},ce.ua=function(){return this.h},ce.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ce=Di.prototype).ha=8,ce.v=1,ce.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new mr(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Ve(r=Re(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Fi(this,n,e),zr(i=Mr(this.B),"RID",t),zr(i,"CVER",22),this.A&&zr(i,"X-HTTP-Session-Id",this.A),Vi(this,i),this.i&&r&&Ai(i,this.i,r),fi(this.b,n),this.Ia&&zr(i,"TYPE","init"),this.da?(zr(i,"$req",e),zr(i,"SID","null"),n.U=!0,Tr(n,i,null)):Tr(n,i,e),this.v=2}}else 3==this.v&&(t?Mi(this,t):0==this.g.length||ai(this.b)||Mi(this))},ce.Aa=function(){if(this.j=null,Gi(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=ar(we(this.Ta,this),t)}},ce.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,sr(10),Pi(this),Gi(this))},ce.Sa=function(){null!=this.m&&(this.m=null,Pi(this),Bi(this),sr(19))},ce.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),sr(2)):(this.c.info("Failed to ping google.com"),sr(1))},(ce=Qi.prototype).ta=function(){},ce.sa=function(){},ce.ra=function(){},ce.qa=function(){},ce.Ja=function(){},Zi.prototype.a=function(t,e){return new to(t,e)},Oe(to,Nn),to.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;sr(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=Xi(t,null,t.fa),Ri(t)},to.prototype.close=function(){ki(this.a)},to.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Ui(this.a,e)}else this.l?((e={}).__data__=Dn(t),Ui(this.a,e)):Ui(this.a,t)},to.prototype.G=function(){this.a.f=null,delete this.f,ki(this.a),delete this.a,to.X.G.call(this)},Oe(eo,vr),Oe(no,yr),Oe(ro,Qi),ro.prototype.ta=function(){An(this.a,"a")},ro.prototype.sa=function(t){An(this.a,new eo(t))},ro.prototype.ra=function(t){An(this.a,new no(t))},ro.prototype.qa=function(){An(this.a,"b")},Zi.prototype.createWebChannel=Zi.prototype.a,to.prototype.send=to.prototype.h,to.prototype.open=to.prototype.g,to.prototype.close=to.prototype.close,cr.NO_ERROR=0,cr.TIMEOUT=8,cr.HTTP_ERROR=6,hr.COMPLETE="complete",lr.EventType=dr,dr.OPEN="a",dr.CLOSE="b",dr.ERROR="c",dr.MESSAGE="d",Nn.prototype.listen=Nn.prototype.va,gi.prototype.listenOnce=gi.prototype.wa,gi.prototype.getLastError=gi.prototype.Qa,gi.prototype.getLastErrorCode=gi.prototype.ua,gi.prototype.getStatus=gi.prototype.W,gi.prototype.getResponseJson=gi.prototype.Pa,gi.prototype.getResponseText=gi.prototype.$,gi.prototype.send=gi.prototype.ba;var io=cr,oo=hr,so=tr,uo=lr,ao=gi,co=n("30Go"),ho=new oe.b("@firebase/firestore");function fo(){return ho.logLevel}function lo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ho.logLevel<=oe.a.DEBUG){var r=e.map(yo);ho.debug.apply(ho,Object(co.g)(["Firestore (8.2.2): "+t],r))}}function po(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ho.logLevel<=oe.a.ERROR){var r=e.map(yo);ho.error.apply(ho,Object(co.g)(["Firestore (8.2.2): "+t],r))}}function vo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ho.logLevel<=oe.a.WARN){var r=e.map(yo);ho.warn.apply(ho,Object(co.g)(["Firestore (8.2.2): "+t],r))}}function yo(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(Ev){return t}}function bo(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.2) INTERNAL ASSERTION FAILED: "+t;throw po(e),new Error(e)}function mo(t,e){t||bo()}function go(t,e){return t}function wo(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Io=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=wo(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function To(t,e){return t<e?-1:t>e?1:0}function Oo(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Eo(t){return t+"\0"}var _o=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.i)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return To(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();_o.h=new _o("");var So={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},jo=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(co.c)(e,t),e}(Error),xo=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(_o.fromBase64String(e))}catch(e){throw new jo(So.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(_o.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),No=function(t){this._=t};function Ao(){if("undefined"==typeof Uint8Array)throw new jo(So.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Co(){if("undefined"==typeof atob)throw new jo(So.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Do=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e.fromBase64String=function(t){return Co(),new e(xo.fromBase64String(t))},e.fromUint8Array=function(t){return Ao(),new e(xo.fromUint8Array(t))},e.prototype.toBase64=function(){return Co(),this._.toBase64()},e.prototype.toUint8Array=function(){return Ao(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(No),ko=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Po=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Lo=function(){function t(t){this.uid=t}return t.prototype.A=function(){return null!=this.uid},t.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Lo.UNAUTHENTICATED=new Lo(null),Lo.P=new Lo("google-credentials-uid"),Lo.g=new Lo("first-party-uid");var Uo=function(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t},Ro=function(){function t(){this.p=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.v=function(){},t.prototype.S=function(t){this.p=t,t(Lo.UNAUTHENTICATED)},t.prototype.D=function(){this.p=null},t}(),Mo=function(){function t(t){var e=this;this.C=null,this.currentUser=Lo.UNAUTHENTICATED,this.N=!1,this.O=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.O++,e.currentUser=e.F(),e.N=!0,e.p&&e.p(e.currentUser)},this.O=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.O,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.O!==e?(lo("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(mo("string"==typeof n.accessToken),new Uo(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.v=function(){this.forceRefresh=!0},t.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},t.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},t.prototype.F=function(){var t=this.auth&&this.auth.getUid();return mo(null===t||"string"==typeof t),new Lo(t)},t}(),Vo=function(){function t(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Lo.g}return Object.defineProperty(t.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Fo=function(){function t(t,e){this.k=t,this.M=e}return t.prototype.getToken=function(){return Promise.resolve(new Vo(this.k,this.M))},t.prototype.S=function(t){t(Lo.g)},t.prototype.D=function(){},t.prototype.v=function(){},t}(),qo=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}return t.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},t}();qo.U=-1;var Bo=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new jo(So.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new jo(So.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new jo(So.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new jo(So.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.K=function(t){return this.seconds===t.seconds?To(this.nanoseconds,t.nanoseconds):To(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),zo=function(){function t(t){this.timestamp=t}return t.j=function(e){return new t(e)},t.min=function(){return new t(new Bo(0,0))},t.prototype.u=function(t){return this.timestamp.K(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.G=function(){return this.timestamp},t}(),Go=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&bo(),void 0===n?n=t.length-e:n>t.length-e&&bo(),this.segments=t,this.offset=e,this.H=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.J(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.Y(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.X=function(t){return this.Y(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},t.prototype.tt=function(){return this.segments[this.offset]},t.prototype.et=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.nt=function(){return 0===this.length},t.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},t.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Ho=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.prototype.ot=function(){return this.rt().join("/")},e.prototype.toString=function(){return this.ot()},e.ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new jo(So.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.at=function(){return new e([])},e}(Go),Ko=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Jo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.ut=function(t){return Ko.test(t)},e.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.ut(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.ot()},e.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},e.lt=function(){return new e(["__name__"])},e._t=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new jo(So.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new jo(So.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new jo(So.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new jo(So.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.at=function(){return new e([])},e}(Go),$o=function(){function t(t){this.path=t}return t.ft=function(e){return new t(Ho.ct(e))},t.dt=function(e){return new t(Ho.ct(e).X(5))},t.prototype.wt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Ho.J(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.J=function(t,e){return Ho.J(t.path,e.path)},t.Et=function(t){return t.length%2==0},t.Tt=function(e){return new t(new Ho(e.slice()))},t}();function Yo(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Xo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Wo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Qo=function(){function t(t){this.fields=t,t.sort(Jo.J)}return t.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},t.prototype.isEqual=function(t){return Oo(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),Zo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ts(t){if(mo(!!t),"string"==typeof t){var e=0,n=Zo.exec(t);if(mo(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:es(t.seconds),nanos:es(t.nanos)}}function es(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ns(t){return"string"==typeof t?_o.fromBase64String(t):_o.fromUint8Array(t)}function rs(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function is(t){var e=t.mapValue.fields.__previous_value__;return rs(e)?is(e):e}function os(t){var e=ts(t.mapValue.fields.__local_write_time__.timestampValue);return new Bo(e.seconds,e.nanos)}function ss(t){return null==t}function us(t){return 0===t&&1/t==-1/0}function as(t){return"number"==typeof t&&Number.isInteger(t)&&!us(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function cs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?rs(t)?4:10:bo()}function hs(t,e){var n=cs(t);if(n!==cs(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return os(t).isEqual(os(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ts(t.timestampValue),r=ts(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ns(t.bytesValue).isEqual(ns(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return es(t.geoPointValue.latitude)===es(e.geoPointValue.latitude)&&es(t.geoPointValue.longitude)===es(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return es(t.integerValue)===es(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=es(t.doubleValue),r=es(e.doubleValue);return n===r?us(n)===us(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Oo(t.arrayValue.values||[],e.arrayValue.values||[],hs);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Yo(n)!==Yo(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!hs(n[i],r[i])))return!1;return!0}(t,e);default:return bo()}}function fs(t,e){return void 0!==(t.values||[]).find(function(t){return hs(t,e)})}function ls(t,e){var n=cs(t),r=cs(e);if(n!==r)return To(n,r);switch(n){case 0:return 0;case 1:return To(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=es(t.integerValue||t.doubleValue),r=es(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ps(t.timestampValue,e.timestampValue);case 4:return ps(os(t),os(e));case 5:return To(t.stringValue,e.stringValue);case 6:return function(t,e){var n=ns(t),r=ns(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=To(n[i],r[i]);if(0!==o)return o}return To(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=To(es(t.latitude),es(e.latitude));return 0!==n?n:To(es(t.longitude),es(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ls(n[i],r[i]);if(o)return o}return To(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=To(r[s],o[s]);if(0!==u)return u;var a=ls(n[r[s]],i[o[s]]);if(0!==a)return a}return To(r.length,o.length)}(t.mapValue,e.mapValue);default:throw bo()}}function ps(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return To(t,e);var n=ts(t),r=ts(e),i=To(n.seconds,r.seconds);return 0!==i?i:To(n.nanos,r.nanos)}function ds(t){return vs(t)}function vs(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ts(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?ns(t.bytesValue).toBase64():"referenceValue"in t?$o.dt(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=vs(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+vs(t.fields[o])}return e+"}"}(t.mapValue):bo();var e}function ys(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function bs(t){return!!t&&"integerValue"in t}function ms(t){return!!t&&"arrayValue"in t}function gs(t){return!!t&&"nullValue"in t}function ws(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Is(t){return!!t&&"mapValue"in t}var Ts=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Is(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},t.prototype.isEqual=function(t){return hs(this.proto,t.proto)},t}(),Os=function(){function t(t){void 0===t&&(t=Ts.empty()),this.At=t,this.Rt=new Map}return t.prototype.set=function(t,e){return this.Pt(t,e),this},t.prototype.delete=function(t){return this.Pt(t,null),this},t.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===cs(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.et(),e)},t.prototype.yt=function(){var t=this.gt(Jo.at(),this.Rt);return null!=t?new Ts(t):this.At},t.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=Is(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.gt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function Es(t){var e=[];return Xo(t.fields||{},function(t,n){var r=new Jo([t]);if(Is(n)){var i=Es(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new Qo(e)}var _s=function(t,e){this.key=t,this.version=e},Ss=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Vt=r,o.bt=!!i.bt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(co.c)(e,t),e.prototype.field=function(t){return this.Vt.field(t)},e.prototype.data=function(){return this.Vt},e.prototype.vt=function(){return this.Vt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(_s),js=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(co.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(_s),xs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(_s),Ns=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function As(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ns(t,e,n,r,i,o,s)}function Cs(t){var e=go(t);if(null===e.St){var n=e.path.ot();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.ot()+t.op.toString()+ds(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.ot()+t.dir}(t)}).join(","),ss(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Gs(e.startAt)),e.endAt&&(n+="|ub:",n+=Gs(e.endAt)),e.St=n}return e.St}function Ds(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Ks(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!hs(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$s(t.startAt,e.startAt)&&$s(t.endAt,e.endAt)}function ks(t){return $o.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ps=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(co.c)(e,t),e.create=function(t,n,r){return t.ht()?"in"===n||"not-in"===n?this.Dt(t,n,r):new Ls(t,n,r):"array-contains"===n?new Vs(t,r):"in"===n?new Fs(t,r):"not-in"===n?new qs(t,r):"array-contains-any"===n?new Bs(t,r):new e(t,n,r)},e.Dt=function(t,e,n){return"in"===e?new Us(t,n):new Rs(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Ct(ls(e,this.value)):null!==e&&cs(this.value)===cs(e)&&this.Ct(ls(e,this.value))},e.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return bo()}},e.prototype.xt=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Ls=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=$o.dt(r.referenceValue),i}return Object(co.c)(e,t),e.prototype.matches=function(t){var e=$o.J(t.key,this.key);return this.Ct(e)},e}(Ps),Us=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Ms(0,n),r}return Object(co.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ps),Rs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Ms(0,n),r}return Object(co.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ps);function Ms(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return $o.dt(t.referenceValue)})}var Vs=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(co.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return ms(e)&&fs(e.arrayValue,this.value)},e}(Ps),Fs=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(co.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&fs(this.value.arrayValue,e)},e}(Ps),qs=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(co.c)(e,t),e.prototype.matches=function(t){if(fs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!fs(this.value.arrayValue,e)},e}(Ps),Bs=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(co.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ms(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return fs(e.value.arrayValue,t)})},e}(Ps),zs=function(t,e){this.position=t,this.before=e};function Gs(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return ds(t)}).join(",")}var Hs=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ks(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Js(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ht()?$o.J($o.dt(s.referenceValue),n.key):ls(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function $s(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!hs(t.position[n],e.position[n]))return!1;return!0}var Ys=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ot=null,this.Ft=null};function Xs(t,e,n,r,i,o,s,u){return new Ys(t,e,n,r,i,o,s,u)}function Ws(t){return new Ys(t)}function Qs(t){return!ss(t.limit)&&"F"===t.limitType}function Zs(t){return!ss(t.limit)&&"L"===t.limitType}function tu(t){return t.Nt.length>0?t.Nt[0].field:null}function eu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function nu(t){return null!==t.collectionGroup}function ru(t){var e=go(t);if(null===e.Ot){e.Ot=[];var n=eu(e),r=tu(e);if(null!==n&&null===r)n.ht()||e.Ot.push(new Hs(n)),e.Ot.push(new Hs(Jo.lt(),"asc"));else{for(var i=!1,o=0,s=e.Nt;o<s.length;o++){var u=s[o];e.Ot.push(u),u.field.ht()&&(i=!0)}if(!i){var a=e.Nt.length>0?e.Nt[e.Nt.length-1].dir:"asc";e.Ot.push(new Hs(Jo.lt(),a))}}}return e.Ot}function iu(t){var e=go(t);if(!e.Ft)if("F"===e.limitType)e.Ft=As(e.path,e.collectionGroup,ru(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ru(e);r<i.length;r++){var o=i[r];n.push(new Hs(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new zs(e.endAt.position,!e.endAt.before):null,u=e.startAt?new zs(e.startAt.position,!e.startAt.before):null;e.Ft=As(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.Ft}function ou(t,e,n){return new Ys(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function su(t,e){return Ds(iu(t),iu(e))&&t.limitType===e.limitType}function uu(t){return Cs(iu(t))+"|lt:"+t.limitType}function au(t){return"Query(target="+function(t){var e=t.path.ot();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.ot()+" "+e.op+" "+ds(e.value);var e}).join(", ")+"]"),ss(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.ot()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Gs(t.startAt)),t.endAt&&(e+=", endAt: "+Gs(t.endAt)),"Target("+e+")"}(iu(t))+"; limitType="+t.limitType+")"}function cu(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.wt(t.collectionGroup)&&t.path.st(n):$o.Et(t.path)?t.path.isEqual(n):t.path.it(n)}(t,e)&&function(t,e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Js(t.startAt,ru(t),e)||t.endAt&&Js(t.endAt,ru(t),e))}(t,e)}function hu(t){return function(e,n){for(var r=!1,i=0,o=ru(t);i<o.length;i++){var s=o[i],u=fu(s,e,n);if(0!==u)return u;r=r||s.field.ht()}return 0}}function fu(t,e,n){var r=t.field.ht()?$o.J(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?ls(r,i):bo()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return bo()}}var lu=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=zo.min()),void 0===o&&(o=zo.min()),void 0===s&&(s=_o.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.kt,e,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.$t=function(e,n){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Bt=function(e){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,e,this.resumeToken)},t}();function pu(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:us(e)?"-0":e}}function du(t){return{integerValue:""+t}}function vu(t,e){return as(e)?du(e):pu(t,e)}var yu=function(){this.Ut=void 0};function bu(t,e,n){return t instanceof wu?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Iu?Tu(t,e):t instanceof Ou?Eu(t,e):function(t,e){var n=gu(t,e),r=Su(n)+Su(t.Qt);return bs(n)&&bs(t.Qt)?du(r):pu(t.Kt,r)}(t,e)}function mu(t,e,n){return t instanceof Iu?Tu(t,e):t instanceof Ou?Eu(t,e):n}function gu(t,e){return t instanceof _u?bs(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var wu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e}(yu),Iu=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(co.c)(e,t),e}(yu);function Tu(t,e){for(var n=ju(e),r=function(t){n.some(function(e){return hs(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ou=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(co.c)(e,t),e}(yu);function Eu(t,e){for(var n=ju(e),r=function(t){n=n.filter(function(e){return!hs(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var _u=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kt=e,r.Qt=n,r}return Object(co.c)(e,t),e}(yu);function Su(t){return es(t.integerValue||t.doubleValue)}function ju(t){return ms(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var xu=function(t,e){this.field=t,this.transform=e},Nu=function(t,e){this.version=t,this.transformResults=e},Au=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.jt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Cu(t,e){return void 0!==t.updateTime?e instanceof Ss&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ss}var Du=function(){};function ku(t,e,n){return t instanceof Mu?function(t,e,n){var r=t.value;if(n.transformResults){var i=qu(t.fieldTransforms,e,n.transformResults);r=zu(t.fieldTransforms,r,i)}return new Ss(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Vu?function(t,e,n){if(!Cu(t.Gt,e))return new xs(t.key,n.version);var r=Fu(t,e,n.transformResults?qu(t.fieldTransforms,e,n.transformResults):[]);return new Ss(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new js(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Pu(t,e,n,r){return t instanceof Mu?function(t,e,n,r){if(!Cu(t.Gt,e))return e;var i=t.value,o=Bu(t.fieldTransforms,n,e);i=zu(t.fieldTransforms,i,o);var s=Ru(e);return new Ss(t.key,s,i,{bt:!0})}(t,e,r):t instanceof Vu?function(t,e,n,r){if(!Cu(t.Gt,e))return e;var i=Ru(e),o=Fu(t,e,Bu(t.fieldTransforms,n,e));return new Ss(t.key,i,o,{bt:!0})}(t,e,r):function(t,e){return Cu(t.Gt,e)?new js(t.key,zo.min()):e}(t,e)}function Lu(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Ss?e.field(o.field):void 0,u=gu(o.transform,s||null);null!=u&&(n=null==n?(new Os).set(o.field,u):n.set(o.field,u))}return n?n.yt():null}(t.fieldTransforms,e)}function Uu(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Oo(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Iu&&e instanceof Iu||t instanceof Ou&&e instanceof Ou?Oo(t.elements,e.elements,hs):t instanceof _u&&e instanceof _u?hs(t.Qt,e.Qt):t instanceof wu&&e instanceof wu}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt))}function Ru(t){return t instanceof Ss?t.version:zo.min()}var Mu=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Gt=r,o.fieldTransforms=i,o.type=0,o}return Object(co.c)(e,t),e}(Du),Vu=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.zt=r,s.Gt=i,s.fieldTransforms=o,s.type=1,s}return Object(co.c)(e,t),e}(Du);function Fu(t,e,n){var r;return r=function(t,e){var n=new Os(e);return t.zt.fields.forEach(function(e){if(!e.nt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.yt()}(t,r=e instanceof Ss?e.data():Ts.empty()),zu(t.fieldTransforms,r,n)}function qu(t,e,n){var r=[];mo(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Ss&&(u=e.field(o.field)),r.push(mu(s,u,n[i]))}return r}function Bu(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Ss&&(c=n.field(u.field)),i.push(bu(a,c,e))}return i}function zu(t,e,n){for(var r=new Os(e),i=0;i<t.length;i++)r.set(t[i].field,n[i]);return r.yt()}var Gu,Hu,Ku=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=2,r.fieldTransforms=[],r}return Object(co.c)(e,t),e}(Du),Ju=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=3,r.fieldTransforms=[],r}return Object(co.c)(e,t),e}(Du),$u=function(t){this.count=t};function Yu(t){switch(t){case So.OK:return bo();case So.CANCELLED:case So.UNKNOWN:case So.DEADLINE_EXCEEDED:case So.RESOURCE_EXHAUSTED:case So.INTERNAL:case So.UNAVAILABLE:case So.UNAUTHENTICATED:return!1;case So.INVALID_ARGUMENT:case So.NOT_FOUND:case So.ALREADY_EXISTS:case So.PERMISSION_DENIED:case So.FAILED_PRECONDITION:case So.ABORTED:case So.OUT_OF_RANGE:case So.UNIMPLEMENTED:case So.DATA_LOSS:return!0;default:return bo()}}function Xu(t){if(void 0===t)return po("GRPC error has no .code"),So.UNKNOWN;switch(t){case Gu.OK:return So.OK;case Gu.CANCELLED:return So.CANCELLED;case Gu.UNKNOWN:return So.UNKNOWN;case Gu.DEADLINE_EXCEEDED:return So.DEADLINE_EXCEEDED;case Gu.RESOURCE_EXHAUSTED:return So.RESOURCE_EXHAUSTED;case Gu.INTERNAL:return So.INTERNAL;case Gu.UNAVAILABLE:return So.UNAVAILABLE;case Gu.UNAUTHENTICATED:return So.UNAUTHENTICATED;case Gu.INVALID_ARGUMENT:return So.INVALID_ARGUMENT;case Gu.NOT_FOUND:return So.NOT_FOUND;case Gu.ALREADY_EXISTS:return So.ALREADY_EXISTS;case Gu.PERMISSION_DENIED:return So.PERMISSION_DENIED;case Gu.FAILED_PRECONDITION:return So.FAILED_PRECONDITION;case Gu.ABORTED:return So.ABORTED;case Gu.OUT_OF_RANGE:return So.OUT_OF_RANGE;case Gu.UNIMPLEMENTED:return So.UNIMPLEMENTED;case Gu.DATA_LOSS:return So.DATA_LOSS;default:return bo()}}(Hu=Gu||(Gu={}))[Hu.OK=0]="OK",Hu[Hu.CANCELLED=1]="CANCELLED",Hu[Hu.UNKNOWN=2]="UNKNOWN",Hu[Hu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Hu[Hu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Hu[Hu.NOT_FOUND=5]="NOT_FOUND",Hu[Hu.ALREADY_EXISTS=6]="ALREADY_EXISTS",Hu[Hu.PERMISSION_DENIED=7]="PERMISSION_DENIED",Hu[Hu.UNAUTHENTICATED=16]="UNAUTHENTICATED",Hu[Hu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Hu[Hu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Hu[Hu.ABORTED=10]="ABORTED",Hu[Hu.OUT_OF_RANGE=11]="OUT_OF_RANGE",Hu[Hu.UNIMPLEMENTED=12]="UNIMPLEMENTED",Hu[Hu.INTERNAL=13]="INTERNAL",Hu[Hu.UNAVAILABLE=14]="UNAVAILABLE",Hu[Hu.DATA_LOSS=15]="DATA_LOSS";var Wu=function(){function t(t,e){this.J=t,this.root=e||Zu.EMPTY}return t.prototype.Ht=function(e,n){return new t(this.J,this.root.Ht(e,n,this.J).copy(null,null,Zu.Jt,null,null))},t.prototype.remove=function(e){return new t(this.J,this.root.remove(e,this.J).copy(null,null,Zu.Jt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.nt=function(){return this.root.nt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(){return this.root.Xt()},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.forEach=function(t){this.Zt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Zt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.te=function(t){return this.root.te(t)},t.prototype.ee=function(){return new Qu(this.root,null,this.J,!1)},t.prototype.ne=function(t){return new Qu(this.root,t,this.J,!1)},t.prototype.se=function(){return new Qu(this.root,null,this.J,!0)},t.prototype.ie=function(t){return new Qu(this.root,t,this.J,!0)},t}(),Qu=function(){function t(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}return t.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},t.prototype.ae=function(){return this.oe.length>0},t.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},t}(),Zu=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.nt=function(){return!1},t.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},t.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},t.prototype.min=function(){return this.left.nt()?this:this.left.min()},t.prototype.Yt=function(){return this.min().key},t.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},t.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},t.prototype.le=function(){if(this.left.nt())return t.EMPTY;var e=this;return e.left._e()||e.left.left._e()||(e=e.fe()),(e=e.copy(null,null,null,e.left.le(),null)).he()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.nt()||i.left._e()||i.left.left._e()||(i=i.fe()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left._e()&&(i=i.de()),i.right.nt()||i.right._e()||i.right.left._e()||(i=i.we()),0===n(e,i.key)){if(i.right.nt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.le())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.he()},t.prototype._e=function(){return this.color},t.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},t.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},t.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},t.prototype.Ee=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.de=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},t.prototype.me=function(){if(this._e()&&this.left._e())throw bo();if(this.right._e())throw bo();var t=this.left.me();if(t!==this.right.me())throw bo();return t+(this._e()?0:1)},t}();Zu.EMPTY=null,Zu.RED=!0,Zu.Jt=!1,Zu.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw bo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw bo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw bo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw bo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw bo()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ht=function(t,e,n){return new Zu(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.nt=function(){return!0},t.prototype.Zt=function(t){return!1},t.prototype.te=function(t){return!1},t.prototype.Yt=function(){return null},t.prototype.Xt=function(){return null},t.prototype._e=function(){return!1},t.prototype.Ie=function(){return!0},t.prototype.me=function(){return 0},t}());var ta=function(){function t(t){this.J=t,this.data=new Wu(this.J)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Yt()},t.prototype.last=function(){return this.data.Xt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Zt(function(e,n){return t(e),!1})},t.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(this.J(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Re=function(t,e){var n;for(n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},t.prototype.Pe=function(t){var e=this.data.ne(t);return e.ae()?e.ce().key:null},t.prototype.ee=function(){return new ea(this.data.ee())},t.prototype.ne=function(t){return new ea(this.data.ne(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.nt=function(){return this.data.nt()},t.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ee(),r=e.data.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(0!==this.J(i,o))return!1}return!0},t.prototype.rt=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.J);return n.data=e,n},t}(),ea=function(){function t(t){this.ge=t}return t.prototype.ce=function(){return this.ge.ce().key},t.prototype.ae=function(){return this.ge.ae()},t}(),na=new Wu($o.J);function ra(){return na}function ia(){return ra()}var oa=new Wu($o.J);function sa(){return oa}var ua=new Wu($o.J);function aa(){return ua}var ca=new ta($o.J);function ha(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ca,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var fa=new ta(To);function la(){return fa}var pa=function(){function t(t){this.J=t?function(e,n){return t(e,n)||$o.J(e.key,n.key)}:function(t,e){return $o.J(t.key,e.key)},this.Ve=sa(),this.pe=new Wu(this.J)}return t.be=function(e){return new t(e.J)},t.prototype.has=function(t){return null!=this.Ve.get(t)},t.prototype.get=function(t){return this.Ve.get(t)},t.prototype.first=function(){return this.pe.Yt()},t.prototype.last=function(){return this.pe.Xt()},t.prototype.nt=function(){return this.pe.nt()},t.prototype.indexOf=function(t){var e=this.Ve.get(t);return e?this.pe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.pe.Zt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pe.ee(),r=e.pe.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.J=this.J,r.Ve=e,r.pe=n,r},t}(),da=function(){function t(){this.ve=new Wu($o.J)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);n?0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):bo():this.ve=this.ve.Ht(e,t)},t.prototype.Se=function(){var t=[];return this.ve.Zt(function(e,n){t.push(n)}),t},t}(),va=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}return t.Oe=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,pa.be(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&su(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),ya=function(){function t(t,e,n,r,i){this.Mt=t,this.Fe=e,this.ke=n,this.Me=r,this.Le=i}return t.$e=function(e,n){var r=new Map;return r.set(e,ba.Be(e,n)),new t(zo.min(),r,la(),ra(),ha())},t}(),ba=function(){function t(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}return t.Be=function(e,n){return new t(_o.h,n,ha(),ha(),ha())},t}(),ma=function(t,e,n,r){this.je=t,this.removedTargetIds=e,this.key=n,this.We=r},ga=function(t,e){this.targetId=t,this.Ge=e},wa=function(t,e,n,r){void 0===n&&(n=_o.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ia=function(){function t(){this.ze=0,this.He=Ea(),this.Je=_o.h,this.Ye=!1,this.Xe=!0}return Object.defineProperty(t.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),t.prototype.en=function(t){t.o()>0&&(this.Xe=!0,this.Je=t)},t.prototype.nn=function(){var t=ha(),e=ha(),n=ha();return this.He.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:bo()}}),new ba(this.Je,this.Ye,t,e,n)},t.prototype.sn=function(){this.Xe=!1,this.He=Ea()},t.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},t.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},t.prototype.cn=function(){this.ze+=1},t.prototype.an=function(){this.ze-=1},t.prototype.un=function(){this.Xe=!0,this.Ye=!0},t}(),Ta=function(){function t(t){this.hn=t,this.ln=new Map,this._n=ra(),this.fn=Oa(),this.dn=new ta(To)}return t.prototype.wn=function(t){for(var e=0,n=t.je;e<n.length;e++){var r=n[e];t.We instanceof Ss?this.En(r,t.We):t.We instanceof js&&this.Tn(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Tn(r=o[i],t.key,t.We)},t.prototype.In=function(t){var e=this;this.mn(t,function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:bo()}})},t.prototype.mn=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ln.forEach(function(t,r){n.Rn(r)&&e(r)})},t.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,r=this.gn(e);if(r){var i=r.target;if(ks(i))if(0===n){var o=new $o(i.path);this.Tn(e,o,new js(o,zo.min()))}else mo(1===n);else this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e))}},t.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach(function(r,i){var o=e.gn(i);if(o){if(r.qe&&ks(o.target)){var s=new $o(o.target.path);null!==e._n.get(s)||e.bn(i,s)||e.Tn(i,s,new js(s,t))}r.tn&&(n.set(i,r.nn()),r.sn())}});var r=ha();this.fn.forEach(function(t,n){var i=!0;n.Re(function(t){var n=e.gn(t);return!n||2===n.kt||(i=!1,!1)}),i&&(r=r.add(t))});var i=new ya(t,n,this.dn,this._n,r);return this._n=ra(),this.fn=Oa(),this.dn=new ta(To),i},t.prototype.En=function(t,e){if(this.Rn(t)){var n=this.bn(t,e.key)?2:0;this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t))}},t.prototype.Tn=function(t,e,n){if(this.Rn(t)){var r=this.An(t);this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n))}},t.prototype.removeTarget=function(t){this.ln.delete(t)},t.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},t.prototype.cn=function(t){this.An(t).cn()},t.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new Ia,this.ln.set(t,e)),e},t.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new ta(To),this.fn=this.fn.Ht(t,e)),e},t.prototype.Rn=function(t){var e=null!==this.gn(t);return e||lo("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},t.prototype.Pn=function(t){var e=this;this.ln.set(t,new Ia),this.hn.Sn(t).forEach(function(n){e.Tn(t,n,null)})},t.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},t}();function Oa(){return new Wu($o.J)}function Ea(){return new Wu($o.J)}var _a={asc:"ASCENDING",desc:"DESCENDING"},Sa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ja=function(t,e){this.T=t,this.qt=e};function xa(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Na(t,e){return t.qt?e.toBase64():e.toUint8Array()}function Aa(t,e){return xa(t,e.G())}function Ca(t){return mo(!!t),zo.j(function(t){var e=ts(t);return new Bo(e.seconds,e.nanos)}(t))}function Da(t,e){return function(t){return new Ho(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).ot()}function ka(t){var e=Ho.ct(t);return mo(rc(e)),e}function Pa(t,e){return Da(t.T,e.path)}function La(t,e){var n=ka(e);if(n.get(1)!==t.T.projectId)throw new jo(So.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.T.projectId);if(n.get(3)!==t.T.database)throw new jo(So.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.T.database);return new $o(Va(n))}function Ua(t,e){return Da(t.T,e)}function Ra(t){var e=ka(t);return 4===e.length?Ho.at():Va(e)}function Ma(t){return new Ho(["projects",t.T.projectId,"databases",t.T.database]).ot()}function Va(t){return mo(t.length>4&&"documents"===t.get(4)),t.X(5)}function Fa(t,e,n){return{name:Pa(t,e),fields:n.proto.mapValue.fields}}function qa(t,e,n){var r=La(t,e.name),i=Ca(e.updateTime),o=new Ts({mapValue:{fields:e.fields}});return new Ss(r,i,o,{hasCommittedMutations:!!n})}function Ba(t,e){var n;if(e instanceof Mu)n={update:Fa(t,e.key,e.value)};else if(e instanceof Ku)n={delete:Pa(t,e.key)};else if(e instanceof Vu)n={update:Fa(t,e.key,e.data),updateMask:nc(e.zt)};else{if(!(e instanceof Ju))return bo();n={verify:Pa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof wu)return{fieldPath:e.field.ot(),setToServerValue:"REQUEST_TIME"};if(n instanceof Iu)return{fieldPath:e.field.ot(),appendMissingElements:{values:n.elements}};if(n instanceof Ou)return{fieldPath:e.field.ot(),removeAllFromArray:{values:n.elements}};if(n instanceof _u)return{fieldPath:e.field.ot(),increment:n.Qt};throw bo()}(0,t)})),e.Gt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Aa(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:bo()}(t,e.Gt)),n}function za(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Au.updateTime(Ca(t.updateTime)):void 0!==t.exists?Au.exists(t.exists):Au.jt()}(e.currentDocument):Au.jt(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(mo("REQUEST_TIME"===e.setToServerValue),n=new wu):"appendMissingElements"in e?n=new Iu(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Ou(e.removeAllFromArray.values||[]):"increment"in e?n=new _u(t,e.increment):bo();var r=Jo._t(e.fieldPath);return new xu(r,n)}(t,e)}):[];if(e.update){var i=La(t,e.update.name),o=new Ts({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new Qo((t.fieldPaths||[]).map(function(t){return Jo._t(t)}))}(e.updateMask);return new Vu(i,o,s,n,r)}return new Mu(i,o,n,r)}if(e.delete){var u=La(t,e.delete);return new Ku(u,n)}if(e.verify){var a=La(t,e.verify);return new Ju(a,n)}return bo()}function Ga(t,e){return{documents:[Ua(t,e.path)]}}function Ha(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ua(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ua(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(ws(t.value))return{unaryFilter:{field:Qa(t.field),op:"IS_NAN"}};if(gs(t.value))return{unaryFilter:{field:Qa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ws(t.value))return{unaryFilter:{field:Qa(t.field),op:"IS_NOT_NAN"}};if(gs(t.value))return{unaryFilter:{field:Qa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qa(t.field),op:Wa(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:Qa(t.field),direction:Xa(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.qt||ss(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=$a(e.startAt)),e.endAt&&(n.structuredQuery.endAt=$a(e.endAt)),n}function Ka(t){var e=Ra(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){mo(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Ja(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new Hs(Za(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return ss(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Ya(n.startAt));var h=null;return n.endAt&&(h=Ya(n.endAt)),Xs(e,i,u,s,a,"F",c,h)}function Ja(t){return t?void 0!==t.unaryFilter?[ec(t)]:void 0!==t.fieldFilter?[tc(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return Ja(t)}).reduce(function(t,e){return t.concat(e)}):bo():[]}function $a(t){return{before:t.before,values:t.position}}function Ya(t){return new zs(t.values||[],!!t.before)}function Xa(t){return _a[t]}function Wa(t){return Sa[t]}function Qa(t){return{fieldPath:t.ot()}}function Za(t){return Jo._t(t.fieldPath)}function tc(t){return Ps.create(Za(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return bo()}}(t.fieldFilter.op),t.fieldFilter.value)}function ec(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Za(t.unaryFilter.field);return Ps.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Za(t.unaryFilter.field);return Ps.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Za(t.unaryFilter.field);return Ps.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Za(t.unaryFilter.field);return Ps.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return bo()}}function nc(t){var e=[];return t.fields.forEach(function(t){return e.push(t.ot())}),{fieldPaths:e}}function rc(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var ic=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},oc=function(){function t(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.On=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.On&&bo(),this.On=!0,this.Nn?this.error?this.Fn(n,this.error):this.kn(e,this.result):new t(function(t,i){r.Cn=function(n){r.kn(e,n).next(t,i)},r.xn=function(e){r.Fn(n,e).next(t,i)}})},t.prototype.Mn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Ln=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.kn=function(e,n){return e?this.Ln(function(){return e(n)}):t.resolve(n)},t.prototype.Fn=function(e,n){return e?this.Ln(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.$n=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Bn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.$n(r)},t}(),sc=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new ic,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new cc(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){var r=dc(e.target.error);n.qn.reject(new cc(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new cc(n,e)}},Object.defineProperty(t.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(lo("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new fc(e)},t}(),uc=function(){function t(e,n,r){this.name=e,this.version=n,this.Qn=r,12.2===t.Kn(Object(se.g)())&&po("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return lo("SimpleDb","Removing database:",t),lc(window.indexedDB.deleteDatabase(t)).Mn()},t.jn=function(){if("undefined"==typeof indexedDB)return!1;if(t.Wn())return!0;var e=Object(se.g)(),n=t.Kn(e),r=0<n&&n<10,i=t.Gn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},t.Hn=function(t,e){return t.store(e)},t.Kn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Gn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Jn=function(t){return Object(co.b)(this,void 0,void 0,function(){var e,n=this;return Object(co.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(lo("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new cc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new jo(So.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new cc(t,n))},i.onupgradeneeded=function(t){lo("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Qn.Yn(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){lo("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}})})},t.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(co.b)(this,void 0,void 0,function(){var i,o,s,u,a;return Object(co.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object(co.d)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Jn(t)];case 2:return u.db=f.sent(),e=sc.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),oc.reject(t)}).Mn(),a={},s.catch(function(){}),[4,e.Un];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return lo("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),ac=function(){function t(t){this.ts=t,this.es=!1,this.ns=null}return Object.defineProperty(t.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.es=!0},t.prototype.rs=function(t){this.ns=t},t.prototype.delete=function(){return lc(this.ts.delete())},t}(),cc=function(t){function e(e,n){var r=this;return(r=t.call(this,So.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(co.c)(e,t),e}(jo);function hc(t){return"IndexedDbTransactionError"===t.name}var fc=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(lo("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(lo("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),lc(n)},t.prototype.add=function(t){return lo("SimpleDb","ADD",this.store.name,t,t),lc(this.store.add(t))},t.prototype.get=function(t){var e=this;return lc(this.store.get(t)).next(function(n){return void 0===n&&(n=null),lo("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return lo("SimpleDb","DELETE",this.store.name,t),lc(this.store.delete(t))},t.prototype.count=function(){return lo("SimpleDb","COUNT",this.store.name),lc(this.store.count())},t.prototype.os=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.cs(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.us=function(t,e){lo("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.hs=!1;var r=this.cursor(n);return this.cs(r,function(t,e,n){return n.delete()})},t.prototype.ls=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.cs(r,e)},t.prototype._s=function(t){var e=this.cursor({});return new oc(function(n,r){e.onerror=function(t){var e=dc(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.cs=function(t,e){var n=[];return new oc(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ac(i),s=e(i.primaryKey,i.value,o);if(s instanceof oc){var u=s.catch(function(t){return o.done(),oc.reject(t)});n.push(u)}o.Nn?r():null===o.ss?i.continue():i.continue(o.ss)}else r()}}).next(function(){return oc.$n(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function lc(t){return new oc(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=dc(t.target.error);n(e)}})}var pc=!1;function dc(t){var e=uc.Kn(Object(se.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new jo("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return pc||(pc=!0,setTimeout(function(){throw r},0)),r}}return t}var vc=function(){function t(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new ic,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}return t.Is=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},t.prototype.Ps=function(){return this.Rs()},t.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new jo(So.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Rs=function(){var t=this;this.fs.ys(function(){return null!==t.As?(t.clearTimeout(),t.op().then(function(e){return t.Ts.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},t}();function yc(t,e){if(po("AsyncQueue",e+": "+t),hc(t))return new jo(So.UNAVAILABLE,e+": "+t);throw t}var bc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",mc=function(){function t(){this.gs=[]}return t.prototype.Vs=function(t){this.gs.push(t)},t.prototype.ps=function(){this.gs.forEach(function(t){return t()})},t}();function gc(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Ic(e)),e=wc(t.get(n),e);return Ic(e)}function wc(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Ic(t){return t+"\x01\x01"}function Tc(t){var e=t.length;if(mo(e>=2),2===e)return mo("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Ho.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&bo(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:bo()}o=s+2}return new Ho(r)}var Oc=function(t,e){this.seconds=t,this.nanoseconds=e},Ec=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ec.store="owner",Ec.key="owner";var _c=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};_c.store="mutationQueues",_c.keyPath="userId";var Sc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Sc.store="mutations",Sc.keyPath="batchId",Sc.userMutationsIndex="userMutationsIndex",Sc.userMutationsKeyPath=["userId","batchId"];var jc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,gc(e)]},t.key=function(t,e,n){return[t,gc(e),n]},t}();jc.store="documentMutations",jc.PLACEHOLDER=new jc;var xc=function(t,e){this.path=t,this.readTime=e},Nc=function(t,e){this.path=t,this.version=e},Ac=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ac.store="remoteDocuments",Ac.readTimeIndex="readTimeIndex",Ac.readTimeIndexPath="readTime",Ac.collectionReadTimeIndex="collectionReadTimeIndex",Ac.collectionReadTimeIndexPath=["parentPath","readTime"];var Cc=function(t){this.byteSize=t};Cc.store="remoteDocumentGlobal",Cc.key="remoteDocumentGlobalKey";var Dc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Dc.store="targets",Dc.keyPath="targetId",Dc.queryTargetsIndexName="queryTargetsIndex",Dc.queryTargetsKeyPath=["canonicalId","targetId"];var kc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};kc.store="targetDocuments",kc.keyPath=["targetId","path"],kc.documentTargetsIndex="documentTargetsIndex",kc.documentTargetsKeyPath=["path","targetId"];var Pc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Pc.key="targetGlobalKey",Pc.store="targetGlobal";var Lc=function(t,e){this.collectionId=t,this.parent=e};Lc.store="collectionParents",Lc.keyPath=["collectionId","parent"];var Uc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Uc.store="clientMetadata",Uc.keyPath="clientId";var Rc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Rc.store="bundles",Rc.keyPath="bundleId";var Mc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Mc.store="namedQueries",Mc.keyPath="name";var Vc=Object(co.g)(Object(co.g)(Object(co.g)(Object(co.g)([_c.store,Sc.store,jc.store,Ac.store,Dc.store,Ec.store,Pc.store,kc.store],[Uc.store]),[Cc.store]),[Lc.store]),[Rc.store,Mc.store]),Fc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).bs=e,r.vs=n,r}return Object(co.c)(e,t),e}(mc);function qc(t,e){var n=go(t);return uc.Hn(n.bs,e)}var Bc=function(){function t(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ds=function(t,e,n){for(var r=n.Cs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ku(o,e,r[i]))}return e},t.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=Pu(s,e,0,this.Ss));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=Pu(s,e,0,this.Ss))}return e},t.prototype.Ns=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.xs(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ha())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Oo(this.mutations,t.mutations,function(t,e){return Uu(t,e)})&&Oo(this.baseMutations,t.baseMutations,function(t,e){return Uu(t,e)})},t}(),zc=function(){function t(t,e,n,r){this.batch=t,this.Os=e,this.Cs=n,this.Fs=r}return t.from=function(e,n,r){mo(e.mutations.length===r.length);for(var i=aa(),o=e.mutations,s=0;s<o.length;s++)i=i.Ht(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Gc=function(t){this.ks=t};function Hc(t,e){if(e.document)return qa(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=$o.Tt(e.noDocument.path),r=Xc(e.noDocument.readTime);return new js(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=$o.Tt(e.unknownDocument.path);return r=Xc(e.unknownDocument.version),new xs(i,r)}return bo()}function Kc(t,e,n){var r=Jc(n),i=e.key.path.Z().rt();if(e instanceof Ss){var o=function(t,e){return{name:Pa(t,e.key),fields:e.vt().mapValue.fields,updateTime:xa(t,e.version.G())}}(t.ks,e),s=e.hasCommittedMutations;return new Ac(null,null,o,s,r,i)}if(e instanceof js){var u=e.key.path.rt(),a=Yc(e.version);return s=e.hasCommittedMutations,new Ac(null,new xc(u,a),null,s,r,i)}if(e instanceof xs){var c=e.key.path.rt(),h=Yc(e.version);return new Ac(new Nc(c,h),null,null,!0,r,i)}return bo()}function Jc(t){var e=t.G();return[e.seconds,e.nanoseconds]}function $c(t){var e=new Bo(t[0],t[1]);return zo.j(e)}function Yc(t){var e=t.G();return new Oc(e.seconds,e.nanoseconds)}function Xc(t){var e=new Bo(t.seconds,t.nanoseconds);return zo.j(e)}function Wc(t,e){for(var n=(e.baseMutations||[]).map(function(e){return za(t.ks,e)}),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map(function(e){return za(t.ks,e)}),s=Bo.fromMillis(e.localWriteTimeMs);return new Bc(e.batchId,s,n,o)}function Qc(t){var e,n,r=Xc(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Xc(t.lastLimboFreeSnapshotVersion):zo.min();return void 0!==t.query.documents?(mo(1===(n=t.query).documents.length),e=iu(Ws(Ra(n.documents[0])))):e=function(t){return iu(Ka(t))}(t.query),new lu(e,t.targetId,0,t.lastListenSequenceNumber,r,i,_o.fromBase64String(t.resumeToken))}function Zc(t,e){var n,r=Yc(e.Mt),i=Yc(e.lastLimboFreeSnapshotVersion);n=ks(e.target)?Ga(t.ks,e.target):Ha(t.ks,e.target);var o=e.resumeToken.toBase64();return new Dc(e.targetId,Cs(e.target),r,o,e.sequenceNumber,i,n)}function th(t){var e=Ka({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ou(e,e.limit,"L"):e}var eh=function(){function t(){}return t.prototype.Ms=function(t,e){return nh(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:Xc(e.createTime),version:e.version};var e})},t.prototype.Ls=function(t,e){return nh(t).put({bundleId:(n=e).id,createTime:Yc(Ca(n.createTime)),version:n.version});var n},t.prototype.$s=function(t,e){return rh(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:th(e.bundledQuery),readTime:Xc(e.readTime)};var e})},t.prototype.Bs=function(t,e){return rh(t).put(function(t){return{name:t.name,readTime:Yc(Ca(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function nh(t){return qc(t,Rc.store)}function rh(t){return qc(t,Mc.store)}var ih=function(){function t(){this.qs=new oh}return t.prototype.Us=function(t,e){return this.qs.add(e),oc.resolve()},t.prototype.Qs=function(t,e){return oc.resolve(this.qs.getEntries(e))},t}(),oh=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new ta(Ho.J),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.et(),n=t.Z(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new ta(Ho.J)).rt()},t}(),sh=function(){function t(){this.Ks=new oh}return t.prototype.Us=function(t,e){var n=this;if(!this.Ks.has(e)){var r=e.et(),i=e.Z();t.Vs(function(){n.Ks.add(e)});var o={collectionId:r,parent:gc(i)};return uh(t).put(o)}return oc.resolve()},t.prototype.Qs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Eo(e),""],!1,!0);return uh(t).os(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Tc(o.parent))}return n})},t}();function uh(t){return qc(t,Lc.store)}var ah={js:!1,Ws:0,Gs:0,zs:0},ch=function(){function t(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}return t.Xs=function(e){return new t(e,t.Zs,t.ti)},t}();function hh(t){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(e){if(t.code!==So.FAILED_PRECONDITION||t.message!==bc)throw t;return lo("LocalStore","Unexpectedly lost primary lease"),[2]})})}ch.Zs=10,ch.ti=1e3,ch.ei=new ch(41943040,ch.Zs,ch.ti),ch.ni=new ch(-1,0,0);var fh=function(){function t(t,e){this.si=t,this.ii=e,this.ri={}}return t.prototype.get=function(t){var e=this.si(t),n=this.ri[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.ii(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Xo(this.ri,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.nt=function(){return Wo(this.ri)},t}(),lh=function(){function t(){this.oi=new fh(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}return t.prototype.ai=function(t){var e=this.oi.get(t);return e?e.readTime:zo.min()},t.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},t.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},t.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?oc.resolve(n.li):this.di(t,e)},t.prototype.getEntries=function(t,e){return this.wi(t,e)},t.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},t.prototype.hi=function(){},t}();function ph(t,e,n){var r=t.store(Sc.store),i=t.store(jc.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ls({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){mo(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=jc.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return oc.$n(o).next(function(){return c})}function dh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw bo();e=t.noDocument}return JSON.stringify(e).length}var vh=function(){function t(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}return t.Ai=function(e,n,r,i){return mo(""!==e.uid),new t(e.A()?e.uid:"",n,r,i)},t.prototype.Ri=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bh(t).ls({index:Sc.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Pi=function(t,e,n,r){var i=this,o=mh(t),s=bh(t);return s.add({}).next(function(u){mo("number"==typeof u);for(var a=new Bc(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Ba(t.ks,e)}),i=n.mutations.map(function(e){return Ba(t.ks,e)});return new Sc(e,n.batchId,n.Ss.toMillis(),r,i)}(i.Kt,i.userId,a),h=[],f=new ta(function(t,e){return To(t.ot(),e.ot())}),l=0,p=r;l<p.length;l++){var d=p[l],v=jc.key(i.userId,d.key.path,u);f=f.add(d.key.path.Z()),h.push(s.put(c)),h.push(o.put(v,jc.PLACEHOLDER))}return f.forEach(function(e){h.push(i.Ti.Us(t,e))}),t.Vs(function(){i.mi[u]=a.keys()}),oc.$n(h).next(function(){return a})})},t.prototype.yi=function(t,e){var n=this;return bh(t).get(e).next(function(t){return t?(mo(t.userId===n.userId),Wc(n.Kt,t)):null})},t.prototype.gi=function(t,e){var n=this;return this.mi[e]?oc.resolve(this.mi[e]):this.yi(t,e).next(function(t){if(t){var r=t.keys();return n.mi[e]=r,r}return null})},t.prototype.Vi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return bh(t).ls({index:Sc.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(mo(e.batchId>=r),o=Wc(n.Kt,e)),i.done()}).next(function(){return o})},t.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return bh(t).ls({index:Sc.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return bh(t).os(Sc.userMutationsIndex,n).next(function(t){return t.map(function(t){return Wc(e.Kt,t)})})},t.prototype.vi=function(t,e){var n=this,r=jc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return mh(t).ls({range:i},function(r,i,s){var u=r[0],a=r[2],c=Tc(r[1]);if(u===n.userId&&e.path.isEqual(c))return bh(t).get(a).next(function(t){if(!t)throw bo();mo(t.userId===n.userId),o.push(Wc(n.Kt,t))});s.done()}).next(function(){return o})},t.prototype.Si=function(t,e){var n=this,r=new ta(To),i=[];return e.forEach(function(e){var o=jc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=mh(t).ls({range:s},function(t,i,o){var s=t[0],u=t[2],a=Tc(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()});i.push(u)}),oc.$n(i).next(function(){return n.Di(t,r)})},t.prototype.Ci=function(t,e){var n=this,r=e.path,i=r.length+1,o=jc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new ta(To);return mh(t).ls({range:s},function(t,e,o){var s=t[0],a=t[2],c=Tc(t[1]);s===n.userId&&r.st(c)?c.length===i&&(u=u.add(a)):o.done()}).next(function(){return n.Di(t,u)})},t.prototype.Di=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(bh(t).get(e).next(function(t){if(null===t)throw bo();mo(t.userId===n.userId),r.push(Wc(n.Kt,t))}))}),oc.$n(i).next(function(){return r})},t.prototype.xi=function(t,e){var n=this;return ph(t.bs,this.userId,e).next(function(r){return t.Vs(function(){n.Ni(e.batchId)}),oc.forEach(r,function(e){return n.Ii.Oi(t,e)})})},t.prototype.Ni=function(t){delete this.mi[t]},t.prototype.Fi=function(t){var e=this;return this.Ri(t).next(function(n){if(!n)return oc.resolve();var r=IDBKeyRange.lowerBound(jc.prefixForUser(e.userId)),i=[];return mh(t).ls({range:r},function(t,n,r){if(t[0]===e.userId){var o=Tc(t[1]);i.push(o)}else r.done()}).next(function(){mo(0===i.length)})})},t.prototype.ki=function(t,e){return yh(t,this.userId,e)},t.prototype.Mi=function(t){var e=this;return gh(t).get(this.userId).next(function(t){return t||new _c(e.userId,-1,"")})},t}();function yh(t,e,n){var r=jc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return mh(t).ls({range:o,hs:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function bh(t){return qc(t,Sc.store)}function mh(t){return qc(t,jc.store)}function gh(t){return qc(t,_c.store)}var wh=function(){function t(t){this.Li=t}return t.prototype.next=function(){return this.Li+=2,this.Li},t.$i=function(){return new t(0)},t.Bi=function(){return new t(-1)},t}(),Ih=function(){function t(t,e){this.Ii=t,this.Kt=e}return t.prototype.qi=function(t){var e=this;return this.Ui(t).next(function(n){var r=new wh(n.highestTargetId);return n.highestTargetId=r.next(),e.Qi(t,n).next(function(){return n.highestTargetId})})},t.prototype.Ki=function(t){return this.Ui(t).next(function(t){return zo.j(new Bo(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.ji=function(t){return this.Ui(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.Wi=function(t,e,n){var r=this;return this.Ui(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Qi(t,i)})},t.prototype.Gi=function(t,e){var n=this;return this.zi(t,e).next(function(){return n.Ui(t).next(function(r){return r.targetCount+=1,n.Hi(e,r),n.Qi(t,r)})})},t.prototype.Ji=function(t,e){return this.zi(t,e)},t.prototype.Yi=function(t,e){var n=this;return this.Xi(t,e.targetId).next(function(){return Th(t).delete(e.targetId)}).next(function(){return n.Ui(t)}).next(function(e){return mo(e.targetCount>0),e.targetCount-=1,n.Qi(t,e)})},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return Th(t).ls(function(s,u){var a=Qc(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Yi(t,a)))}).next(function(){return oc.$n(o)}).next(function(){return i})},t.prototype.mn=function(t,e){return Th(t).ls(function(t,n){var r=Qc(n);e(r)})},t.prototype.Ui=function(t){return Oh(t).get(Pc.key).next(function(t){return mo(null!==t),t})},t.prototype.Qi=function(t,e){return Oh(t).put(Pc.key,e)},t.prototype.zi=function(t,e){return Th(t).put(Zc(this.Kt,e))},t.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.tr=function(t){return this.Ui(t).next(function(t){return t.targetCount})},t.prototype.er=function(t,e){var n=Cs(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Th(t).ls({range:r,index:Dc.queryTargetsIndexName},function(t,n,r){var o=Qc(n);Ds(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.nr=function(t,e,n){var r=this,i=[],o=Eh(t);return e.forEach(function(e){var s=gc(e.path);i.push(o.put(new kc(n,s))),i.push(r.Ii.sr(t,n,e))}),oc.$n(i)},t.prototype.ir=function(t,e,n){var r=this,i=Eh(t);return oc.forEach(e,function(e){var o=gc(e.path);return oc.$n([i.delete([n,o]),r.Ii.rr(t,n,e)])})},t.prototype.Xi=function(t,e){var n=Eh(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.cr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Eh(t),i=ha();return r.ls({range:n,hs:!0},function(t,e,n){var r=Tc(t[1]),o=new $o(r);i=i.add(o)}).next(function(){return i})},t.prototype.ki=function(t,e){var n=gc(e.path),r=IDBKeyRange.bound([n],[Eo(n)],!1,!0),i=0;return Eh(t).ls({index:kc.documentTargetsIndex,hs:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Dn=function(t,e){return Th(t).get(e).next(function(t){return t?Qc(t):null})},t}();function Th(t){return qc(t,Dc.store)}function Oh(t){return qc(t,Pc.store)}function Eh(t){return qc(t,kc.store)}function _h(t,e){var n=t[1],r=e[1],i=To(t[0],e[0]);return 0===i?To(n,r):i}var Sh=function(){function t(t){this.ar=t,this.buffer=new ta(_h),this.ur=0}return t.prototype.hr=function(){return++this.ur},t.prototype.lr=function(t){var e=[t,this.hr()];if(this.buffer.size<this.ar)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();_h(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),jh=function(){function t(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}return t.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},t.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(t.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),t.prototype.Er=function(t){var e=this,n=this.dr?3e5:6e4;lo("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",n,function(){return Object(co.b)(e,void 0,void 0,function(){var e;return Object(co.d)(this,function(n){switch(n.label){case 0:this.wr=null,this.dr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mr(this._r)];case 2:return n.sent(),[3,7];case 3:return hc(e=n.sent())?(lo("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,hh(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Er(t)];case 8:return n.sent(),[2]}})})})},t}(),xh=function(){function t(t,e){this.Ar=t,this.params=e}return t.prototype.Rr=function(t,e){return this.Ar.Pr(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.yr=function(t,e){var n=this;if(0===e)return oc.resolve(qo.U);var r=new Sh(e);return this.Ar.mn(t,function(t){return r.lr(t.sequenceNumber)}).next(function(){return n.Ar.gr(t,function(t){return r.lr(t)})}).next(function(){return r.maxValue})},t.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},t.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},t.prototype.pr=function(t,e){var n=this;return-1===this.params.Hs?(lo("LruGarbageCollector","Garbage collection skipped; disabled"),oc.resolve(ah)):this.br(t).next(function(r){return r<n.params.Hs?(lo("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Hs),ah):n.vr(t,e)})},t.prototype.br=function(t){return this.Ar.br(t)},t.prototype.vr=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.Rr(t,this.params.Js).next(function(e){return e>c.params.Ys?(lo("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Ys+" from "+e),r=c.params.Ys):r=e,o=Date.now(),c.yr(t,r)}).next(function(r){return n=r,s=Date.now(),c.Zi(t,n,e)}).next(function(e){return i=e,u=Date.now(),c.Vr(t,n)}).next(function(t){return a=Date.now(),fo()<=oe.a.DEBUG&&lo("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),oc.resolve({js:!0,Ws:r,Gs:i,zs:t})})},t}(),Nh=function(){function t(t,e){this.db=t,this._r=function(t,e){return new xh(t,e)}(this,e)}return t.prototype.Pr=function(t){var e=this.Sr(t);return this.db.Dr().tr(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Sr=function(t){var e=0;return this.gr(t,function(t){e++}).next(function(){return e})},t.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},t.prototype.gr=function(t,e){return this.Cr(t,function(t,n){return e(n)})},t.prototype.sr=function(t,e,n){return Ah(t,n)},t.prototype.rr=function(t,e,n){return Ah(t,n)},t.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},t.prototype.Oi=function(t,e){return Ah(t,e)},t.prototype.Nr=function(t,e){return function(t,e){var n=!1;return gh(t)._s(function(r){return yh(t,r,e).next(function(t){return t&&(n=!0),oc.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Vr=function(t,e){var n=this,r=this.db.Fr().Or(),i=[],o=0;return this.Cr(t,function(s,u){if(u<=e){var a=n.Nr(t,s).next(function(e){if(!e)return o++,r.fi(t,s).next(function(){return r._i(s),Eh(t).delete([0,gc(s.path)])})});i.push(a)}}).next(function(){return oc.$n(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.Lt(t.vs);return this.db.Dr().Ji(t,n)},t.prototype.kr=function(t,e){return Ah(t,e)},t.prototype.Cr=function(t,e){var n,r=Eh(t),i=qo.U;return r.ls({index:kc.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==qo.U&&e(new $o(Tc(n)),i),i=s,n=o):i=qo.U}).next(function(){i!==qo.U&&e(new $o(Tc(n)),i)})},t.prototype.br=function(t){return this.db.Fr().Mr(t)},t}();function Ah(t,e){return Eh(t).put(function(t,e){return new kc(0,gc(t.path),e)}(e,t.vs))}var Ch=function(){function t(t,e){this.Kt=t,this.Ti=e}return t.prototype.ui=function(t,e,n){return Ph(t).put(Lh(e),n)},t.prototype._i=function(t,e){var n=Ph(t),r=Lh(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Lr(t,r)})},t.prototype.fi=function(t,e){var n=this;return Ph(t).get(Lh(e)).next(function(t){return n.$r(t)})},t.prototype.Br=function(t,e){var n=this;return Ph(t).get(Lh(e)).next(function(t){var e=n.$r(t);return e?{li:e,size:dh(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=ia();return this.qr(t,e,function(t,e){var i=n.$r(e);r=r.Ht(t,i)}).next(function(){return r})},t.prototype.Ur=function(t,e){var n=this,r=ia(),i=new Wu($o.J);return this.qr(t,e,function(t,e){var o=n.$r(e);o?(r=r.Ht(t,o),i=i.Ht(t,dh(e))):(r=r.Ht(t,null),i=i.Ht(t,0))}).next(function(){return{Qr:r,Kr:i}})},t.prototype.qr=function(t,e,n){if(e.nt())return oc.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return Ph(t).ls({range:r},function(t,e,r){for(var s=$o.Tt(t);o&&$o.J(o,s)<0;)n(o,null),o=i.ce();o&&o.isEqual(s)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()}).next(function(){for(;o;)n(o,null),o=i.ae()?i.ce():null})},t.prototype.jr=function(t,e,n){var r=this,i=sa(),o=e.path.length+1,s={};if(n.isEqual(zo.min())){var u=e.path.rt();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.rt(),c=Jc(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Ac.collectionReadTimeIndex}return Ph(t).ls(s,function(t,n,s){if(t.length===o){var u=Hc(r.Kt,n);e.path.st(u.key.path)?u instanceof Ss&&cu(e,u)&&(i=i.Ht(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Or=function(t){return new Dh(this,!!t&&t.Wr)},t.prototype.Mr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return kh(t).get(Cc.key).next(function(t){return mo(!!t),t})},t.prototype.Lr=function(t,e){return kh(t).put(Cc.key,e)},t.prototype.$r=function(t){if(t){var e=Hc(this.Kt,t);return e instanceof js&&e.version.isEqual(zo.min())?null:e}return null},t}(),Dh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Gr=e,r.Wr=n,r.zr=new fh(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(co.c)(e,t),e.prototype.Ei=function(t){var e=this,n=[],r=0,i=new ta(function(t,e){return To(t.ot(),e.ot())});return this.oi.forEach(function(o,s){var u=e.zr.get(o);if(s.li){var a=Kc(e.Gr.Kt,s.li,e.ai(o));i=i.add(o.path.Z());var c=dh(a);r+=c-u,n.push(e.Gr.ui(t,o,a))}else if(r-=u,e.Wr){var h=Kc(e.Gr.Kt,new js(o,zo.min()),e.ai(o));n.push(e.Gr.ui(t,o,h))}else n.push(e.Gr._i(t,o))}),i.forEach(function(r){n.push(e.Gr.Ti.Us(t,r))}),n.push(this.Gr.updateMetadata(t,r)),oc.$n(n)},e.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next(function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)})},e.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next(function(t){var e=t.Qr;return t.Kr.forEach(function(t,e){n.zr.set(t,e)}),e})},e}(lh);function kh(t){return qc(t,Cc.store)}function Ph(t){return qc(t,Ac.store)}function Lh(t){return t.path.rt()}var Uh=function(){function t(t){this.Kt=t}return t.prototype.Yn=function(t,e,n,r){var i=this;mo(n<r&&n>=0&&r<=11);var o=new sc("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Ec.store)}(t),function(t){t.createObjectStore(_c.store,{keyPath:_c.keyPath}),t.createObjectStore(Sc.store,{keyPath:Sc.keyPath,autoIncrement:!0}).createIndex(Sc.userMutationsIndex,Sc.userMutationsKeyPath,{unique:!0}),t.createObjectStore(jc.store)}(t),Rh(t),function(t){t.createObjectStore(Ac.store)}(t));var s=oc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(kc.store),t.deleteObjectStore(Dc.store),t.deleteObjectStore(Pc.store)}(t),Rh(t)),s=s.next(function(){return function(t){var e=t.store(Pc.store),n=new Pc(0,0,zo.min().G(),0);return e.put(Pc.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Sc.store).os().next(function(n){t.deleteObjectStore(Sc.store),t.createObjectStore(Sc.store,{keyPath:Sc.keyPath,autoIncrement:!0}).createIndex(Sc.userMutationsIndex,Sc.userMutationsKeyPath,{unique:!0});var r=e.store(Sc.store),i=n.map(function(t){return r.put(t)});return oc.$n(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Uc.store,{keyPath:Uc.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Hr(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Cc.store)}(t),i.Jr(o)})),n<7&&r>=7&&(s=s.next(function(){return i.Yr(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Xr(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ac.store);e.createIndex(Ac.readTimeIndex,Ac.readTimeIndexPath,{unique:!1}),e.createIndex(Ac.collectionReadTimeIndex,Ac.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Zr(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(Rc.store,{keyPath:Rc.keyPath})}(t),function(t){t.createObjectStore(Mc.store,{keyPath:Mc.keyPath})}(t)})),s},t.prototype.Jr=function(t){var e=0;return t.store(Ac.store).ls(function(t,n){e+=dh(n)}).next(function(){var n=new Cc(e);return t.store(Cc.store).put(Cc.key,n)})},t.prototype.Hr=function(t){var e=this,n=t.store(_c.store),r=t.store(Sc.store);return n.os().next(function(n){return oc.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(Sc.userMutationsIndex,i).next(function(r){return oc.forEach(r,function(r){mo(r.userId===n.userId);var i=Wc(e.Kt,r);return ph(t,n.userId,i).next(function(){})})})})})},t.prototype.Yr=function(t){var e=t.store(kc.store),n=t.store(Ac.store);return t.store(Pc.store).get(Pc.key).next(function(t){var r=[];return n.ls(function(n,i){var o=new Ho(n),s=function(t){return[0,gc(t)]}(o);r.push(e.get(s).next(function(n){return n?oc.resolve():function(n){return e.put(new kc(0,gc(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return oc.$n(r)})})},t.prototype.Xr=function(t,e){t.createObjectStore(Lc.store,{keyPath:Lc.keyPath});var n=e.store(Lc.store),r=new oh,i=function(t){if(r.add(t)){var e=t.et(),i=t.Z();return n.put({collectionId:e,parent:gc(i)})}};return e.store(Ac.store).ls({hs:!0},function(t,e){var n=new Ho(t);return i(n.Z())}).next(function(){return e.store(jc.store).ls({hs:!0},function(t,e){var n=Tc(t[1]);return i(n.Z())})})},t.prototype.Zr=function(t){var e=this,n=t.store(Dc.store);return n.ls(function(t,r){var i=Qc(r),o=Zc(e.Kt,i);return n.put(o)})},t}();function Rh(t){t.createObjectStore(kc.store,{keyPath:kc.keyPath}).createIndex(kc.documentTargetsIndex,kc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Dc.store,{keyPath:Dc.keyPath}).createIndex(Dc.queryTargetsIndexName,Dc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Pc.store)}var Mh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Vh=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.eo=o,this.window=s,this.document=u,this.no=c,this.so=h,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!t.jn())throw new jo(So.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new Nh(this,i),this.lo=n+"main",this.Kt=new Gc(a),this._o=new uc(this.lo,11,new Uh(this.Kt)),this.fo=new Ih(this.Ii,this.Kt),this.Ti=new sh,this.wo=function(t,e){return new Ch(t,e)}(this.Kt,this.Ti),this.Eo=new eh,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===h&&po("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.Io().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new jo(So.FAILED_PRECONDITION,Mh);return t.mo(),t.Ao(),t.Ro(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.fo.ji(e)})}).then(function(e){t.io=new qo(e,t.no)}).then(function(){t.ro=!0}).catch(function(e){return t._o&&t._o.close(),Promise.reject(e)})},t.prototype.Po=function(t){var e=this;return this.ho=function(n){return Object(co.b)(e,void 0,void 0,function(){return Object(co.d)(this,function(e){return this.Tr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.yo=function(t){var e=this;this._o.Zn(function(n){return Object(co.b)(e,void 0,void 0,function(){return Object(co.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys(function(){return Object(co.b)(e,void 0,void 0,function(){return Object(co.d)(this,function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Io=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return qh(e).put(new Uc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.po(e).next(function(e){e||(t.isPrimary=!1,t.eo.bo(function(){return t.ho(!1)}))})}).next(function(){return t.vo(e)}).next(function(n){return t.isPrimary&&!n?t.So(e).next(function(){return!1}):!!n&&t.Do(e).next(function(){return!0})})}).catch(function(e){if(hc(e))return lo("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return lo("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.eo.bo(function(){return t.ho(e)}),t.isPrimary=e})},t.prototype.po=function(t){var e=this;return Fh(t).get(Ec.key).next(function(t){return oc.resolve(e.Co(t))})},t.prototype.xo=function(t){return qh(t).delete(this.clientId)},t.prototype.No=function(){return Object(co.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(co.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.Oo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=qc(t,Uc.store);return e.os().next(function(t){var n=r.Fo(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return oc.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.To)for(e=0,n=t;e<n.length;e++)this.To.removeItem(this.ko(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,function(){return t.Io().then(function(){return t.No()}).then(function(){return t.Ro()})})},t.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.vo=function(t){var e=this;return this.so?oc.resolve(!0):Fh(t).get(Ec.key).next(function(n){if(null!==n&&e.Oo(n.leaseTimestampMs,5e3)&&!e.Mo(n.ownerId)){if(e.Co(n)&&e.networkEnabled)return!0;if(!e.Co(n)){if(!n.allowTabSynchronization)throw new jo(So.FAILED_PRECONDITION,Mh);return!1}}return!(!e.networkEnabled||!e.inForeground)||qh(t).os().next(function(t){return void 0===e.Fo(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&lo("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.Lo=function(){return Object(co.b)(this,void 0,void 0,function(){var t=this;return Object(co.d)(this,function(e){switch(e.label){case 0:return this.ro=!1,this.$o(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[Ec.store,Uc.store],function(e){var n=new Fc(e,qo.U);return t.So(n).next(function(){return t.xo(n)})})];case 1:return e.sent(),this._o.close(),this.Uo(),[2]}})})},t.prototype.Fo=function(t,e){var n=this;return t.filter(function(t){return n.Oo(t.updateTimeMs,e)&&!n.Mo(t.clientId)})},t.prototype.Qo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return qh(e).os().next(function(e){return t.Fo(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.Ko=function(t){return vh.Ai(t,this.Kt,this.Ti,this.Ii)},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.jo=function(){return this.Ti},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r,i=this;return lo("IndexedDbPersistence","Starting transaction:",t),this._o.runTransaction(t,"readonly"===e?"readonly":"readwrite",Vc,function(o){return r=new Fc(o,i.io?i.io.next():qo.U),"readwrite-primary"===e?i.po(r).next(function(t){return!!t||i.vo(r)}).next(function(e){if(!e)throw po("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.eo.bo(function(){return i.ho(!1)}),new jo(So.FAILED_PRECONDITION,bc);return n(r)}).next(function(t){return i.Do(r).next(function(){return t})}):i.Go(r).next(function(){return n(r)})}).then(function(t){return r.ps(),t})},t.prototype.Go=function(t){var e=this;return Fh(t).get(Ec.key).next(function(t){if(null!==t&&e.Oo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new jo(So.FAILED_PRECONDITION,Mh)})},t.prototype.Do=function(t){var e=new Ec(this.clientId,this.allowTabSynchronization,Date.now());return Fh(t).put(Ec.key,e)},t.jn=function(){return uc.jn()},t.prototype.So=function(t){var e=this,n=Fh(t);return n.get(Ec.key).next(function(t){return e.Co(t)?(lo("IndexedDbPersistence","Releasing primary lease."),n.delete(Ec.key)):oc.resolve()})},t.prototype.Oo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(po("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()})},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},t.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.$o(),e.eo.ys(function(){return e.Lo()})},this.window.addEventListener("unload",this.oo))},t.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},t.prototype.Mo=function(t){var e;try{var n=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return lo("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return po("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.$o=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){po("Failed to set zombie client id.",t)}},t.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},t.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Fh(t){return qc(t,Ec.store)}function qh(t){return qc(t,Uc.store)}function Bh(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var zh=function(t,e){this.progress=t,this.zo=e},Gh=function(){function t(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}return t.prototype.Jo=function(t,e){var n=this;return this.Ho.vi(t,e).next(function(r){return n.Yo(t,e,r)})},t.prototype.Yo=function(t,e,n){return this.wo.fi(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].xs(e,t);return t})},t.prototype.Xo=function(t,e,n){var r=ia();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].xs(t,e);r=r.Ht(t,e)}),r},t.prototype.Zo=function(t,e){var n=this;return this.wo.getEntries(t,e).next(function(e){return n.tc(t,e)})},t.prototype.tc=function(t,e){var n=this;return this.Ho.Si(t,e).next(function(r){var i=n.Xo(t,e,r),o=ra();return i.forEach(function(t,e){e||(e=new js(t,zo.min())),o=o.Ht(t,e)}),o})},t.prototype.jr=function(t,e,n){return function(t){return $o.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ec(t,e.path):nu(e)?this.nc(t,e,n):this.sc(t,e,n)},t.prototype.ec=function(t,e){return this.Jo(t,new $o(e)).next(function(t){var e=sa();return t instanceof Ss&&(e=e.Ht(t.key,t)),e})},t.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=sa();return this.Ti.Qs(t,i).next(function(s){return oc.forEach(s,function(s){var u=function(t,e){return new Ys(e,null,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.sc(t,u,n).next(function(t){t.forEach(function(t,e){o=o.Ht(t,e)})})}).next(function(){return o})})},t.prototype.sc=function(t,e,n){var r,i,o=this;return this.wo.jr(t,e,n).next(function(n){return r=n,o.Ho.Ci(t,e)}).next(function(e){return o.ic(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=Pu(a,r.get(c),0,o.Ss);r=h instanceof Ss?r.Ht(c,h):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){cu(e,n)||(r=r.remove(t))}),r})},t.prototype.ic=function(t,e,n){for(var r=ha(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Vu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ss&&(c=c.Ht(t,e))}),c})},t}(),Hh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}return t.cc=function(e,n){for(var r=ha(),i=ha(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Kh=function(){function t(){}return t.prototype.ac=function(t){this.uc=t},t.prototype.jr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Nt.length||1===t.Nt.length&&t.Nt[0].field.ht())}(e)||n.isEqual(zo.min())?this.hc(t,e):this.uc.Zo(t,r).next(function(o){var s=i.lc(e,o);return(Qs(e)||Zs(e))&&i._c(e.limitType,s,r,n)?i.hc(t,e):(fo()<=oe.a.DEBUG&&lo("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),au(e)),i.uc.jr(t,e,n).next(function(t){return s.forEach(function(e){t=t.Ht(e.key,e)}),t}))})},t.prototype.lc=function(t,e){var n=new ta(hu(t));return e.forEach(function(e,r){r instanceof Ss&&cu(t,r)&&(n=n.add(r))}),n},t.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.hc=function(t,e){return fo()<=oe.a.DEBUG&&lo("QueryEngine","Using full collection scan to execute query:",au(e)),this.uc.jr(t,e,zo.min())},t}(),Jh=function(){function t(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new Wu(To),this.wc=new fh(function(t){return Cs(t)},Ds),this.Ec=zo.min(),this.Ho=t.Ko(n),this.Tc=t.Fr(),this.fo=t.Dr(),this.Ic=new Gh(this.Tc,this.Ho,this.persistence.jo()),this.Eo=t.Wo(),this.fc.ac(this.Ic)}return t.prototype.mr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.pr(n,e.dc)})},t}();function $h(t,e,n,r){return new Jh(t,e,n,r)}function Yh(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(co.d)(this,function(s){switch(s.label){case 0:return n=go(t),r=n.Ho,i=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.Ho.bi(t).next(function(s){return o=s,r=n.persistence.Ko(e),i=new Gh(n.Tc,r,n.persistence.jo()),r.bi(t)}).next(function(e){for(var n=[],r=[],s=ha(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)s=s.add(y[v].key)}return i.Zo(t,s).next(function(t){return{mc:t,Ac:n,Rc:r}})})})];case 1:return o=s.sent(),[2,(n.Ho=r,n.Ic=i,n.fc.ac(n.Ic),o)]}})})}function Xh(t,e){var n=go(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Tc.Or({Wr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=oc.resolve();return o.forEach(function(t){s=s.next(function(){return r.fi(e,t)}).next(function(e){var o=e,s=n.Fs.get(t);mo(null!==s),(!o||o.version.u(s)<0)&&(o=i.Ds(t,o,n))&&r.ui(o,n.Os)})}),s.next(function(){return t.Ho.xi(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.Ho.Fi(t)}).next(function(){return n.Ic.Zo(t,r)})})}function Wh(t){var e=go(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function Qh(t,e){var n=go(t),r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Tc.Or({Wr:!0});i=n.dc;var s=[];e.Fe.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.fo.ir(t,e.Ke,o).next(function(){return n.fo.nr(t,e.Ue,o)}));var a=e.resumeToken;if(a.o()>0){var c=u.$t(a,r).Lt(t.vs);i=i.Ht(o,c),function(t,e,n){return mo(e.resumeToken.o()>0),0===t.resumeToken.o()||e.Mt.W()-t.Mt.W()>=3e8||n.Ue.size+n.Qe.size+n.Ke.size>0}(u,c,e)&&s.push(n.fo.Ji(t,c))}}});var u=ra();if(e.Me.forEach(function(r,i){e.Le.has(r)&&s.push(n.persistence.Ii.kr(t,r))}),s.push(Zh(t,o,e.Me,r,void 0).next(function(t){u=t})),!r.isEqual(zo.min())){var a=n.fo.Ki(t).next(function(e){return n.fo.Wi(t,t.vs,r)});s.push(a)}return oc.$n(s).next(function(){return o.apply(t)}).next(function(){return n.Ic.tc(t,u)})}).then(function(t){return n.dc=i,t})}function Zh(t,e,n,r,i){var o=ha();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=ra();return n.forEach(function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof js&&s.version.isEqual(zo.min())?(e._i(n,a),o=o.Ht(n,s)):null==u||s.version.u(u.version)>0||0===s.version.u(u.version)&&u.hasPendingWrites?(e.ui(s,a),o=o.Ht(n,s)):lo("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)}),o})}function tf(t,e){var n=go(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Ho.Vi(t,e)})}function ef(t,e){var n=go(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.fo.er(t,e).next(function(i){return i?oc.resolve(r=i):n.fo.qi(t).next(function(i){return r=new lu(e,i,0,t.vs),n.fo.Gi(t,r).next(function(){return r})})})}).then(function(t){var r=n.dc.get(t.targetId);return(null===r||t.Mt.u(r.Mt)>0)&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t})}function nf(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(co.d)(this,function(u){switch(u.label){case 0:r=go(t),i=r.dc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Ii.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!hc(s=u.sent()))throw s;return lo("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(i.target),[2]}})})}function rf(t,e,n){var r=go(t),i=zo.min(),o=ha();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=go(t),i=r.wc.get(n);return void 0!==i?oc.resolve(r.dc.get(i)):r.fo.er(e,n)}(r,t,iu(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.fo.cr(t,e.targetId).next(function(t){o=t})}).next(function(){return r.fc.jr(t,e,n?i:zo.min(),n?o:ha())}).next(function(t){return{documents:t,Pc:o}})})}function of(t,e){var n=go(t),r=go(n.fo),i=n.dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function sf(t){var e=go(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=go(t),i=ra(),o=Jc(n),s=Ph(e),u=IDBKeyRange.lowerBound(o,!0);return s.ls({index:Ac.readTimeIndex,range:u},function(t,e){var n=Hc(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{zo:i,readTime:$c(o)}})}(e.Tc,t,e.Ec)}).then(function(t){var n=t.zo;return e.Ec=t.readTime,n})}function uf(t){return Object(co.b)(this,void 0,void 0,function(){var e;return Object(co.d)(this,function(n){return[2,(e=go(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Ph(t),n=zo.min();return e.ls({index:Ac.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=$c(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.Ec=t})]})})}function af(t,e,n,r){return Object(co.b)(this,void 0,void 0,function(){var i,o,s,u,a,c,h,f,l,p;return Object(co.d)(this,function(d){switch(d.label){case 0:for(i=go(t),o=ha(),s=ra(),u=aa(),a=0,c=n;a<c.length;a++)f=e.yc((h=c[a]).metadata.name),h.document&&(o=o.add(f)),s=s.Ht(f,e.gc(h)),u=u.Ht(f,e.Vc(h.metadata.readTime));return l=i.Tc.Or({Wr:!0}),[4,ef(i,function(t){return iu(Ws(Ho.ct("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return Zh(t,l,s,zo.min(),u).next(function(e){return l.apply(t),e}).next(function(e){return i.fo.Xi(t,p.targetId).next(function(){return i.fo.nr(t,o,p.targetId)}).next(function(){return i.Ic.tc(t,e)})})})]}})})}function cf(t,e,n){return void 0===n&&(n=ha()),Object(co.b)(this,void 0,void 0,function(){var r,i;return Object(co.d)(this,function(o){switch(o.label){case 0:return[4,ef(t,iu(th(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=go(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Ca(e.readTime);if(r.Mt.u(o)>=0)return i.Eo.Bs(t,e);var s=r.$t(_o.h,o);return i.dc=i.dc.Ht(s.targetId,s),i.fo.Ji(t,s).next(function(){return i.fo.Xi(t,r.targetId)}).next(function(){return i.fo.nr(t,n,r.targetId)}).next(function(){return i.Eo.Bs(t,e)})})]}})})}var hf=function(){function t(t){this.Kt=t,this.bc=new Map,this.vc=new Map}return t.prototype.Ms=function(t,e){return oc.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){var n;return this.bc.set(e.id,{id:(n=e).id,version:n.version,createTime:Ca(n.createTime)}),oc.resolve()},t.prototype.$s=function(t,e){return oc.resolve(this.vc.get(e))},t.prototype.Bs=function(t,e){return this.vc.set(e.name,function(t){return{name:t.name,query:th(t.bundledQuery),readTime:Ca(t.readTime)}}(e)),oc.resolve()},t}(),ff=function(){function t(){this.Sc=new ta(lf.Dc),this.Cc=new ta(lf.xc)}return t.prototype.nt=function(){return this.Sc.nt()},t.prototype.sr=function(t,e){var n=new lf(t,e);this.Sc=this.Sc.add(n),this.Cc=this.Cc.add(n)},t.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},t.prototype.rr=function(t,e){this.Oc(new lf(t,e))},t.prototype.Fc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},t.prototype.kc=function(t){var e=this,n=new $o(new Ho([])),r=new lf(n,t),i=new lf(n,t+1),o=[];return this.Cc.Ae([r,i],function(t){e.Oc(t),o.push(t.key)}),o},t.prototype.Mc=function(){var t=this;this.Sc.forEach(function(e){return t.Oc(e)})},t.prototype.Oc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},t.prototype.Lc=function(t){var e=new $o(new Ho([])),n=new lf(e,t),r=new lf(e,t+1),i=ha();return this.Cc.Ae([n,r],function(t){i=i.add(t.key)}),i},t.prototype.ki=function(t){var e=new lf(t,0),n=this.Sc.Pe(e);return null!==n&&t.isEqual(n.key)},t}(),lf=function(){function t(t,e){this.key=t,this.$c=e}return t.Dc=function(t,e){return $o.J(t.key,e.key)||To(t.$c,e.$c)},t.xc=function(t,e){return To(t.$c,e.$c)||$o.J(t.key,e.key)},t}(),pf=function(){function t(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new ta(lf.Dc)}return t.prototype.Ri=function(t){return oc.resolve(0===this.Ho.length)},t.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++;var o=new Bc(i,e,n,r);this.Ho.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.qc=this.qc.add(new lf(a.key,i)),this.Ti.Us(t,a.key.path.Z())}return oc.resolve(o)},t.prototype.yi=function(t,e){return oc.resolve(this.Uc(e))},t.prototype.Vi=function(t,e){var n=this.Qc(e+1),r=n<0?0:n;return oc.resolve(this.Ho.length>r?this.Ho[r]:null)},t.prototype.pi=function(){return oc.resolve(0===this.Ho.length?-1:this.Bc-1)},t.prototype.bi=function(t){return oc.resolve(this.Ho.slice())},t.prototype.vi=function(t,e){var n=this,r=new lf(e,0),i=new lf(e,Number.POSITIVE_INFINITY),o=[];return this.qc.Ae([r,i],function(t){var e=n.Uc(t.$c);o.push(e)}),oc.resolve(o)},t.prototype.Si=function(t,e){var n=this,r=new ta(To);return e.forEach(function(t){var e=new lf(t,0),i=new lf(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,i],function(t){r=r.add(t.$c)})}),oc.resolve(this.Kc(r))},t.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,i=n;$o.Et(i)||(i=i.child(""));var o=new lf(new $o(i),0),s=new ta(To);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(s=s.add(t.$c)),!0)},o),oc.resolve(this.Kc(s))},t.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Uc(t);null!==r&&n.push(r)}),n},t.prototype.xi=function(t,e){var n=this;mo(0===this.jc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return oc.forEach(e.mutations,function(i){var o=new lf(i.key,e.batchId);return r=r.delete(o),n.Ii.Oi(t,i.key)}).next(function(){n.qc=r})},t.prototype.Ni=function(t){},t.prototype.ki=function(t,e){var n=new lf(e,0),r=this.qc.Pe(n);return oc.resolve(e.isEqual(r&&r.key))},t.prototype.Fi=function(t){return oc.resolve()},t.prototype.jc=function(t,e){return this.Qc(t)},t.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},t.prototype.Uc=function(t){var e=this.Qc(t);return e<0||e>=this.Ho.length?null:this.Ho[e]},t}(),df=function(){function t(t,e){this.Ti=t,this.Wc=e,this.docs=new Wu($o.J),this.size=0}return t.prototype.ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Wc(e);return this.docs=this.docs.Ht(r,{li:e,size:s,readTime:n}),this.size+=s-o,this.Ti.Us(t,r.path.Z())},t.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.fi=function(t,e){var n=this.docs.get(e);return oc.resolve(n?n.li:null)},t.prototype.getEntries=function(t,e){var n=this,r=ia();return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),oc.resolve(r)},t.prototype.jr=function(t,e,n){for(var r=sa(),i=new $o(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.value,a=u.li,c=u.readTime;if(!e.path.st(s.key.path))break;c.u(n)<=0||a instanceof Ss&&cu(e,a)&&(r=r.Ht(a.key,a))}return oc.resolve(r)},t.prototype.Gc=function(t,e){return oc.forEach(this.docs,function(t){return e(t)})},t.prototype.Or=function(t){return new vf(this)},t.prototype.Mr=function(t){return oc.resolve(this.size)},t}(),vf=function(t){function e(e){var n=this;return(n=t.call(this)||this).Gr=e,n}return Object(co.c)(e,t),e.prototype.Ei=function(t){var e=this,n=[];return this.oi.forEach(function(r,i){i&&i.li?n.push(e.Gr.ui(t,i.li,e.ai(r))):e.Gr._i(r)}),oc.$n(n)},e.prototype.di=function(t,e){return this.Gr.fi(t,e)},e.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},e}(lh),yf=function(){function t(t){this.persistence=t,this.zc=new fh(function(t){return Cs(t)},Ds),this.lastRemoteSnapshotVersion=zo.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new ff,this.targetCount=0,this.Yc=wh.$i()}return t.prototype.mn=function(t,e){return this.zc.forEach(function(t,n){return e(n)}),oc.resolve()},t.prototype.Ki=function(t){return oc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ji=function(t){return oc.resolve(this.Hc)},t.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),oc.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),oc.resolve()},t.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new wh(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},t.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,oc.resolve()},t.prototype.Ji=function(t,e){return this.zi(e),oc.resolve()},t.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),this.targetCount-=1,oc.resolve()},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.zc.delete(s),o.push(r.Xi(t,u.targetId)),i++)}),oc.$n(o).next(function(){return i})},t.prototype.tr=function(t){return oc.resolve(this.targetCount)},t.prototype.er=function(t,e){var n=this.zc.get(e)||null;return oc.resolve(n)},t.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),oc.resolve()},t.prototype.ir=function(t,e,n){this.Jc.Fc(e,n);var r=this.persistence.Ii,i=[];return r&&e.forEach(function(e){i.push(r.Oi(t,e))}),oc.$n(i)},t.prototype.Xi=function(t,e){return this.Jc.kc(e),oc.resolve()},t.prototype.cr=function(t,e){var n=this.Jc.Lc(e);return oc.resolve(n)},t.prototype.ki=function(t,e){return oc.resolve(this.Jc.ki(e))},t}(),bf=function(){function t(t,e){var n=this;this.Xc={},this.io=new qo(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new yf(this),this.Ti=new ih,this.wo=function(t,e){return new df(t,function(t){return n.Ii.Zc(t)})}(this.Ti),this.Kt=new Gc(e),this.Eo=new hf(this.Kt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Lo=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.yo=function(){},t.prototype.Vo=function(){},t.prototype.jo=function(){return this.Ti},t.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new pf(this.Ti,this.Ii),this.Xc[t.R()]=e),e},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r=this;lo("MemoryPersistence","Starting transaction:",t);var i=new mf(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},t.prototype.na=function(t,e){return oc.Bn(Object.values(this.Xc).map(function(n){return function(){return n.ki(t,e)}}))},t}(),mf=function(t){function e(e){var n=this;return(n=t.call(this)||this).vs=e,n}return Object(co.c)(e,t),e}(mc),gf=function(){function t(t){this.persistence=t,this.sa=new ff,this.ia=null}return t.ra=function(e){return new t(e)},Object.defineProperty(t.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw bo()},enumerable:!1,configurable:!0}),t.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),oc.resolve()},t.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),oc.resolve()},t.prototype.Oi=function(t,e){return this.oa.add(e.toString()),oc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},t.prototype.ta=function(){this.ia=new Set},t.prototype.ea=function(t){var e=this,n=this.persistence.Fr().Or();return oc.forEach(this.oa,function(r){var i=$o.ft(r);return e.ca(t,i).next(function(t){t||n._i(i)})}).next(function(){return e.ia=null,n.apply(t)})},t.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},t.prototype.Zc=function(t){return 0},t.prototype.ca=function(t,e){var n=this;return oc.Bn([function(){return oc.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},t}();function wf(t,e){return"firestore_clients_"+t+"_"+e}function If(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.A()&&(r+="_"+e.uid),r}function Tf(t,e){return"firestore_targets_"+t+"_"+e}var Of=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.aa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new jo(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(po("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ef=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.aa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new jo(r.error.code,r.error.message)),i?new t(e,r.state,o):(po("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),_f=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.aa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=la(),s=0;i&&s<r.activeTargetIds.length;++s)i=as(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(po("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Sf=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.aa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(po("SharedClientState","Failed to parse online state: "+e),null)},t}(),jf=function(){function t(){this.activeTargetIds=la()}return t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),xf=function(){function t(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new Wu(To),this.Tr=!1,this.Ia=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=wf(this.persistenceKey,this._a),this.Aa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ta=this.Ta.Ht(this._a,new jf),this.Ra=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ga=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Va=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wa)}return t.jn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(co.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object(co.d)(this,function(f){switch(f.label){case 0:return[4,this.fa.Qo()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(wf(this.persistenceKey,r)))&&(o=_f.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(u=this.ba(s))&&this.va(u),a=0,c=this.Ia;a<c.length;a++)this.Ea(c[a]);return this.Ia=[],this.window.addEventListener("unload",function(){return h.Lo()}),this.Tr=!0,[2]}})})},t.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},t.prototype.Sa=function(){return this.Da(this.Ta)},t.prototype.Ca=function(t){var e=!1;return this.Ta.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.xa=function(t){this.Na(t,"pending")},t.prototype.Oa=function(t,e,n){this.Na(t,e,n),this.Fa(t)},t.prototype.ka=function(t){var e="not-current";if(this.Ca(t)){var n=this.storage.getItem(Tf(this.persistenceKey,t));if(n){var r=Ef.aa(t,n);r&&(e=r.state)}}return this.Ma.ha(t),this.pa(),e},t.prototype.La=function(t){this.Ma.la(t),this.pa()},t.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},t.prototype.Ba=function(t){this.removeItem(Tf(this.persistenceKey,t))},t.prototype.qa=function(t,e,n){this.Ua(t,e,n)},t.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Fa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},t.prototype.Ka=function(t){this.ja(t)},t.prototype.Wa=function(){this.Ga()},t.prototype.Lo=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return lo("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){lo("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){lo("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(lo("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void po("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.eo.bo(function(){return Object(co.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(co.d)(this,function(u){if(this.Tr){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(e=this.Ja(n.key,n.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Ya(n.key,n.newValue)))return[2,this.Xa(r)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(i=this.Za(n.key,n.newValue)))return[2,this.tu(i)]}else if(n.key===this.ga){if(null!==n.newValue&&(o=this.ba(n.newValue)))return[2,this.va(o)]}else if(n.key===this.Aa)(s=function(t){var e=qo.U;if(null!=t)try{var n=JSON.parse(t);mo("number"==typeof n),e=n}catch(t){po("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==qo.U&&this.L(s);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),t.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},t.prototype.Na=function(t,e,n){var r=new Of(this.currentUser,t,e,n),i=If(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ua())},t.prototype.Fa=function(t){var e=If(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.ja=function(t){this.storage.setItem(this.ga,JSON.stringify({clientId:this._a,onlineState:t}))},t.prototype.Ua=function(t,e,n){var r=Tf(this.persistenceKey,t),i=new Ef(t,e,n);this.setItem(r,i.ua())},t.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},t.prototype.za=function(t){var e=this.Ra.exec(t);return e?e[1]:null},t.prototype.Ja=function(t,e){var n=this.za(t);return _f.aa(n,e)},t.prototype.Ya=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return Of.aa(new Lo(void 0!==n[2]?n[2]:null),r,e)},t.prototype.Za=function(t,e){var n=this.ya.exec(t),r=Number(n[1]);return Ef.aa(r,e)},t.prototype.ba=function(t){return Sf.aa(t)},t.prototype.Xa=function(t){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(lo("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},t.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fa.iu(s,u).then(function(){n.Ta=r})},t.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},t.prototype.Da=function(t){var e=la();return t.forEach(function(t,n){e=e.ye(n.activeTargetIds)}),e},t}(),Nf=function(){function t(){this.ru=new jf,this.ou={},this.da=null,this.L=null}return t.prototype.xa=function(t){},t.prototype.Oa=function(t,e,n){},t.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},t.prototype.qa=function(t,e,n){this.ou[t]=e},t.prototype.La=function(t){this.ru.la(t)},t.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.Ba=function(t){delete this.ou[t]},t.prototype.Sa=function(){return this.ru.activeTargetIds},t.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.start=function(){return this.ru=new jf,Promise.resolve()},t.prototype.Qa=function(t,e,n){},t.prototype.Ka=function(t){},t.prototype.Lo=function(){},t.prototype.q=function(t){},t.prototype.Wa=function(){},t}(),Af=function(){function t(){}return t.prototype.cu=function(t){},t.prototype.Lo=function(){},t}(),Cf=function(){function t(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}return t.prototype.cu=function(t){this._u.push(t)},t.prototype.Lo=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},t.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},t.prototype.uu=function(){lo("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},t.prototype.lu=function(){lo("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},t.jn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Df={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},kf=function(){function t(t){this.du=t.du,this.wu=t.wu}return t.prototype.Eu=function(t){this.Tu=t},t.prototype.Iu=function(t){this.mu=t},t.prototype.onMessage=function(t){this.Au=t},t.prototype.close=function(){this.wu()},t.prototype.send=function(t){this.du(t)},t.prototype.Ru=function(){this.Tu()},t.prototype.Pu=function(t){this.mu(t)},t.prototype.yu=function(t){this.Au(t)},t}(),Pf=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.I=e.I,n}return Object(co.c)(e,t),e.prototype.Du=function(t,e,n,r){return new Promise(function(i,o){var s=new ao;s.listenOnce(oo.COMPLETE,function(){try{switch(s.getLastErrorCode()){case io.NO_ERROR:var e=s.getResponseJson();lo("Connection","XHR received:",JSON.stringify(e)),i(e);break;case io.TIMEOUT:lo("Connection",'RPC "'+t+'" timed out'),o(new jo(So.DEADLINE_EXCEEDED,"Request time out"));break;case io.HTTP_ERROR:var n=s.getStatus();if(lo("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(So).indexOf(e)>=0?e:So.UNKNOWN}(r.status);o(new jo(u,r.message))}else o(new jo(So.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new jo(So.UNAVAILABLE,"Connection failed."));break;default:bo()}}finally{lo("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.xu=function(t,e){var n=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Zi,i=nr(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(o.initMessageHeaders,e),Object(se.l)()||Object(se.n)()||Object(se.j)()||Object(se.k)()||Object(se.o)()||Object(se.i)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");lo("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new kf({du:function(t){c?lo("Connection","Not sending because WebChannel is closed:",t):(a||(lo("Connection","Opening WebChannel transport."),u.open(),a=!0),lo("Connection","WebChannel sending:",t),u.send(t))},wu:function(){return u.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,uo.EventType.OPEN,function(){c||lo("Connection","WebChannel transport opened.")}),f(u,uo.EventType.CLOSE,function(){c||(c=!0,lo("Connection","WebChannel transport closed"),h.Pu())}),f(u,uo.EventType.ERROR,function(t){c||(c=!0,vo("Connection","WebChannel transport errored:",t),h.Pu(new jo(So.UNAVAILABLE,"The operation could not be completed")))}),f(u,uo.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];mo(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){lo("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=Gu[t];if(void 0!==e)return Xu(e)}(i),s=r.message;void 0===o&&(o=So.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Pu(new jo(o,s)),u.close()}else lo("Connection","WebChannel received:",n),h.yu(n)}}),f(i,so.STAT_EVENT,function(t){10===t.stat?lo("Connection","Detected buffering proxy"):11===t.stat&&lo("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Ru()},0),h},e}(function(){function t(t){this.gu=t,this.T=t.T,this.Vu=(t.ssl?"https":"http")+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}return t.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);lo("RestConnection","Sending: ",i,n);var o={};return this.Su(o,r),this.Du(t,i,o,n).then(function(t){return lo("RestConnection","Received: ",t),t},function(e){throw vo("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},t.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.2",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},t.prototype.vu=function(t,e){return this.Vu+"/v1/"+e+":"+Df[t]},t}());function Lf(){return"undefined"!=typeof window?window:null}function Uf(){return"undefined"!=typeof document?document:null}function Rf(t){return new ja(t,!0)}var Mf=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Ou=r,this.Fu=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}return t.prototype.reset=function(){this.ku=0},t.prototype.$u=function(){this.ku=this.Fu},t.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);i>0&&lo("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,function(){return e.Lu=Date.now(),t()}),this.ku*=this.Ou,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Fu&&(this.ku=this.Fu)},t.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},t.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},t.prototype.qu=function(){return(Math.random()-.5)*this.ku},t}(),Vf=function(){function t(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.ju=i,this.listener=o,this.state=0,this.Wu=0,this.Gu=null,this.stream=null,this.zu=new Mf(t,e)}return t.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ju=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Yu()},t.prototype.stop=function(){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Xu=function(){this.state=0,this.zu.reset()},t.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,function(){return t.th()}))},t.prototype.eh=function(t){this.nh(),this.stream.send(t)},t.prototype.th=function(){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},t.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},t.prototype.close=function(t,e){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.Wu++,3!==t?this.zu.reset():e&&e.code===So.RESOURCE_EXHAUSTED?(po(e.toString()),po("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===So.UNAUTHENTICATED&&this.ju.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}})})},t.prototype.sh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.Wu),n=this.Wu;this.ju.getToken().then(function(e){t.Wu===n&&t.rh(e)},function(n){e(function(){var e=new jo(So.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)})})},t.prototype.rh=function(t){var e=this,n=this.ih(this.Wu);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return Object(co.b)(t,void 0,void 0,function(){return Object(co.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.oh=function(t){return lo("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ih=function(t){var e=this;return function(n){e.eo.ys(function(){return e.Wu===t?n():(lo("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Ff=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Kt=i,s}return Object(co.c)(e,t),e.prototype.ah=function(t){return this.Ku.xu("Listen",t)},e.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:bo()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.qt?(mo(void 0===e||"string"==typeof e),_o.fromBase64String(e||"")):(mo(void 0===e||e instanceof Uint8Array),_o.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?So.UNKNOWN:Xu(t.code);return new jo(e,t.message||"")}(u);n=new wa(r,i,o,s||null)}else if("documentChange"in e){i=La(t,(r=e.documentChange).document.name),o=Ca(r.document.updateTime);var u=new Ts({mapValue:{fields:r.document.fields}}),a=(s=new Ss(i,o,u,{}),r.targetIds||[]);n=new ma(a,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=La(t,(r=e.documentDelete).document),o=r.readTime?Ca(r.readTime):zo.min(),u=new js(i,o),n=new ma([],s=r.removedTargetIds||[],u.key,u);else if("documentRemove"in e)i=La(t,(r=e.documentRemove).document),n=new ma([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return bo();var c=e.filter;i=new $u(r=c.count||0),n=new ga(o=c.targetId,i)}return n}(this.Kt,t),n=function(t){if(!("targetChange"in t))return zo.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?zo.min():e.readTime?Ca(e.readTime):zo.min()}(t);return this.listener.uh(e,n)},e.prototype.hh=function(t){var e={};e.database=Ma(this.Kt),e.addTarget=function(t,e){var n,r=e.target;return(n=ks(r)?{documents:Ga(t,r)}:{query:Ha(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=Na(t,e.resumeToken):e.Mt.u(zo.min())>0&&(n.readTime=xa(t,e.Mt.G())),n}(this.Kt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return bo()}}(0,e.kt);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.eh(e)},e.prototype.lh=function(t){var e={};e.database=Ma(this.Kt),e.removeTarget=t,this.eh(e)},e}(Vf),qf=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Kt=i,s._h=!1,s}return Object(co.c)(e,t),Object.defineProperty(e.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.sh=function(){this._h&&this.dh([])},e.prototype.ah=function(t){return this.Ku.xu("Write",t)},e.prototype.onMessage=function(t){if(mo(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=function(t,e){return t&&t.length>0?(mo(void 0!==e),t.map(function(t){return function(t,e){var n=Ca(t.updateTime?t.updateTime:e);n.isEqual(zo.min())&&(n=Ca(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Nu(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=Ca(t.commitTime);return this.listener.wh(n,e)}return mo(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},e.prototype.Th=function(){var t={};t.database=Ma(this.Kt),this.eh(t)},e.prototype.dh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Ba(e.Kt,t)})};this.eh(n)},e}(Vf),Bf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ku=n,i.Kt=r,i.Ih=!1,i}return Object(co.c)(e,t),e.prototype.mh=function(){if(this.Ih)throw new jo(So.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.bu(t,e,n,i)}).catch(function(t){throw t.code===So.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.Cu(t,e,n,i)}).catch(function(t){throw t.code===So.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.terminate=function(){this.Ih=!1},e}(function(){}),zf=function(){function t(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}return t.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},t.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,this.Ah>=1&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},t.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},t.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},t.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(po(e),this.Ph=!1):lo("OnlineStateTracker",e)},t.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},t}(),Gf=function(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Oh=new Set,this.Fh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return Object(co.b)(o,void 0,void 0,function(){return Object(co.d)(this,function(t){switch(t.label){case 0:return Zf(this)?(lo("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(co.b)(this,void 0,void 0,function(){var e;return Object(co.d)(this,function(n){switch(n.label){case 0:return(e=go(t)).Oh.add(4),[4,Kf(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Oh.delete(4),[4,Hf(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new zf(n,r)};function Hf(t){return Object(co.b)(this,void 0,void 0,function(){var e,n;return Object(co.d)(this,function(r){switch(r.label){case 0:if(!Zf(t))return[3,4];e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Kf(t){return Object(co.b)(this,void 0,void 0,function(){var e,n;return Object(co.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Jf(t,e){var n=go(t);n.Nh.has(e.targetId)||(n.Nh.set(e.targetId,e),Qf(n)?Wf(n):dl(n).Ju()&&Yf(n,e))}function $f(t,e){var n=go(t),r=dl(n);n.Nh.delete(e),r.Ju()&&Xf(n,e),0===n.Nh.size&&(r.Ju()?r.Zu():Zf(n)&&n.Mh.set("Unknown"))}function Yf(t,e){t.Lh.cn(e.targetId),dl(t).hh(e)}function Xf(t,e){t.Lh.cn(e),dl(t).lh(e)}function Wf(t){t.Lh=new Ta({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),dl(t).start(),t.Mh.yh()}function Qf(t){return Zf(t)&&!dl(t).Hu()&&t.Nh.size>0}function Zf(t){return 0===go(t).Oh.size}function tl(t){t.Lh=void 0}function el(t){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(e){return t.Nh.forEach(function(e,n){Yf(t,e)}),[2]})})}function nl(t,e){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(n){return tl(t),Qf(t)?(t.Mh.ph(e),Wf(t)):t.Mh.set("Unknown"),[2]})})}function rl(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var r,i,o;return Object(co.d)(this,function(s){switch(s.label){case 0:if(t.Mh.set("Online"),!(e instanceof wa&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(co.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Nh.has(o=i[r])?[4,t.Ch.$h(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Nh.delete(o),t.Lh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),lo("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,il(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof ma?t.Lh.wn(e):e instanceof ga?t.Lh.yn(e):t.Lh.In(e),n.isEqual(zo.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Wh(t.Sh)];case 8:return i=s.sent(),n.u(i)>=0?[4,function(t,e){var n=t.Lh.pn(e);return n.Fe.forEach(function(n,r){if(n.resumeToken.o()>0){var i=t.Nh.get(r);i&&t.Nh.set(r,i.$t(n.resumeToken,e))}}),n.ke.forEach(function(e){var n=t.Nh.get(e);if(n){t.Nh.set(e,n.$t(_o.h,n.Mt)),Xf(t,e);var r=new lu(n.target,e,1,n.sequenceNumber);Yf(t,r)}}),t.Ch.Bh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return lo("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,il(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function il(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var r=this;return Object(co.d)(this,function(i){switch(i.label){case 0:if(!hc(e))throw e;return t.Oh.add(1),[4,Kf(t)];case 1:return i.sent(),t.Mh.set("Offline"),n||(n=function(){return Wh(t.Sh)}),t.fs.bo(function(){return Object(co.b)(r,void 0,void 0,function(){return Object(co.d)(this,function(e){switch(e.label){case 0:return lo("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Oh.delete(1),[4,Hf(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function ol(t,e){return e().catch(function(n){return il(t,n,e)})}function sl(t){return Object(co.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(co.d)(this,function(s){switch(s.label){case 0:e=go(t),n=vl(e),r=e.xh.length>0?e.xh[e.xh.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Zf(t)&&t.xh.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,tf(e.Sh,r)];case 3:return null===(i=s.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=i.batchId,function(t,e){t.xh.push(e);var n=vl(t);n.Ju()&&n.fh&&n.dh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,il(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return ul(e)&&al(e),[2]}})})}function ul(t){return Zf(t)&&!vl(t).Hu()&&t.xh.length>0}function al(t){vl(t).start()}function cl(t){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(e){return vl(t).Th(),[2]})})}function hl(t){return Object(co.b)(this,void 0,void 0,function(){var e,n,r;return Object(co.d)(this,function(i){for(e=vl(t),n=0,r=t.xh;n<r.length;n++)e.dh(r[n].mutations);return[2]})})}function fl(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var r,i;return Object(co.d)(this,function(o){switch(o.label){case 0:return r=t.xh.shift(),i=zc.from(r,e,n),[4,ol(t,function(){return t.Ch.qh(i)})];case 1:return o.sent(),[4,sl(t)];case 2:return o.sent(),[2]}})})}function ll(t,e){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(n){switch(n.label){case 0:return e&&vl(t).fh?[4,function(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r;return Object(co.d)(this,function(i){switch(i.label){case 0:return Yu(r=e.code)&&r!==So.ABORTED?(n=t.xh.shift(),vl(t).Xu(),[4,ol(t,function(){return t.Ch.Uh(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,sl(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return ul(t)&&al(t),[2]}})})}function pl(t,e){return Object(co.b)(this,void 0,void 0,function(){var n;return Object(co.d)(this,function(r){switch(r.label){case 0:return n=go(t),e?(n.Oh.delete(2),[4,Hf(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Oh.add(2),[4,Kf(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function dl(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=go(t);return r.mh(),new Ff(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:el.bind(null,t),Iu:nl.bind(null,t),uh:rl.bind(null,t)}),t.Fh.push(function(n){return Object(co.b)(e,void 0,void 0,function(){return Object(co.d)(this,function(e){switch(e.label){case 0:return n?(t.Qh.Xu(),Qf(t)?Wf(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:e.sent(),tl(t),e.label=3;case 3:return[2]}})})})),t.Qh}function vl(t){var e=this;return t.Kh||(t.Kh=function(t,e,n){var r=go(t);return r.mh(),new qf(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:cl.bind(null,t),Iu:ll.bind(null,t),Eh:hl.bind(null,t),wh:fl.bind(null,t)}),t.Fh.push(function(n){return Object(co.b)(e,void 0,void 0,function(){return Object(co.d)(this,function(e){switch(e.label){case 0:return n?(t.Kh.Xu(),[4,sl(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:e.sent(),t.xh.length>0&&(lo("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),e.label=4;case 4:return[2]}})})})),t.Kh}var yl=function(){this.jh=void 0,this.listeners=[]},bl=function(){this.queries=new fh(function(t){return uu(t)},su),this.onlineState="Unknown",this.Wh=new Set};function ml(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(co.d)(this,function(c){switch(c.label){case 0:if(n=go(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new yl),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Gh(r)];case 2:return s.jh=c.sent(),[3,4];case 3:return u=c.sent(),a=yc(u,"Initialization of query '"+au(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zh(n.onlineState),o.jh&&e.Hh(o.jh)&&Tl(n),[2]}})})}function gl(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(co.d)(this,function(u){return n=go(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Jh(r))]:[2]})})}function wl(t,e){for(var n=go(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.jh=s}}r&&Tl(n)}function Il(t,e,n){var r=go(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Tl(t){t.Wh.forEach(function(t){t.next()})}var Ol=function(){function t(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new va(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},t.prototype.onError=function(t){this.Yh.error(t)},t.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},t.prototype.el=function(t,e){return!t.fromCache||!(this.options.sl&&"Offline"!==e||t.docs.nt()&&"Offline"!==e)},t.prototype.tl=function(t){return t.docChanges.length>0||!!(t.xe||this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.nl=function(t){t=va.Oe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},t}(),El=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.il=function(){return"metadata"in this.payload},t}(),_l=function(){function t(t){this.Kt=t}return t.prototype.yc=function(t){return La(this.Kt,t)},t.prototype.gc=function(t){return t.metadata.exists?qa(this.Kt,t.document,!1):new js(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},t.prototype.Vc=function(t){return Ca(t)},t}();!function(){function t(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.cl=function(t){for(var e=new Map,n=new _l(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||ha()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(co.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(co.d)(this,function(o){switch(o.label){case 0:return[4,af(this.Sh,new _l(this.Kt),this.documents,this.rl.id)];case 1:t=o.sent(),e=this.cl(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,cf(this.Sh,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new zh(Object.assign({},this.progress),t))]}})})}}();var Sl=function(t){this.key=t},jl=function(t){this.key=t},xl=function(){function t(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=ha(),this.Ce=ha(),this.ll=hu(t),this._l=new pa(this.ll)}return Object.defineProperty(t.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),t.prototype.dl=function(t,e){var n=this,r=e?e.wl:new da,i=e?e._l:this._l,o=e?e.Ce:this.Ce,s=i,u=!1,a=Qs(this.query)&&i.size===this.query.limit?i.last():null,c=Zs(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt(function(t,e){var h=i.get(t),f=e instanceof Ss?e:null;f&&(f=cu(n.query,f)?f:null);var l=!!h&&n.Ce.has(h.key),p=!!f&&(f.bt||n.Ce.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.El(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.ll(f,a)>0||c&&n.ll(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),Qs(this.query)||Zs(this.query))for(;s.size>this.query.limit;){var h=Qs(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{_l:s,wl:r,_c:u,Ce:o}},t.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},t.prototype.Ei=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return bo()}};return n(t)-n(e)}(t.type,e.type)||r.ll(t.doc,e.doc)}),this.Tl(n);var s=e?this.Il():[],u=0===this.hl.size&&this.qe?1:0,a=u!==this.ul;return this.ul=u,0!==o.length||a?{snapshot:new va(this.query,t._l,i,o,t.Ce,0===u,a,!1),ml:s}:{ml:s}},t.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new da,Ce:this.Ce,_c:!1},!1)):{ml:[]}},t.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},t.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},t.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=ha(),this._l.forEach(function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))});var n=[];return e.forEach(function(e){t.hl.has(e)||n.push(new jl(e))}),this.hl.forEach(function(t){e.has(t)||n.push(new Sl(t))}),n},t.prototype.Rl=function(t){this.al=t.Pc,this.hl=ha();var e=this.dl(t.documents);return this.Ei(e,!0)},t.prototype.Pl=function(){return va.Oe(this.query,this._l,this.Ce,0===this.ul)},t}(),Nl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Al=function(t){this.key=t,this.yl=!1},Cl=function(){function t(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new fh(function(t){return uu(t)},su),this.Dl=new Map,this.Cl=[],this.xl=new Wu($o.J),this.Nl=new Map,this.Ol=new ff,this.Fl={},this.kl=new Map,this.Ml=wh.Bi(),this.onlineState="Unknown",this.Ll=void 0}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),t}();function Dl(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(co.d)(this,function(u){switch(u.label){case 0:return n=up(t),(i=n.Sl.get(e))?(n.pl.ka(i.targetId),r=i.view.Pl(),[3,4]):[3,1];case 1:return[4,ef(n.Sh,iu(e))];case 2:return o=u.sent(),s=n.pl.ka(o.targetId),[4,kl(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.$l&&Jf(n.gl,o),u.label=4;case 4:return[2,r]}})})}function kl(t,e,n,r){return Object(co.b)(this,void 0,void 0,function(){var i,o,s,u,a,c;return Object(co.d)(this,function(h){switch(h.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return Object(co.b)(this,void 0,void 0,function(){var i,o,s;return Object(co.d)(this,function(u){switch(u.label){case 0:return(i=e.view.dl(n))._c?[4,rf(t.Sh,e.query,!1).then(function(t){return e.view.dl(t.documents,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.Fe.get(e.targetId),s=e.view.Ei(i,t.$l,o),[2,(Kl(t,e.targetId,s.ml),s.snapshot)]}})})}(t,e,n,r)},[4,rf(t.Sh,e,!0)];case 1:return i=h.sent(),o=new xl(e,i.Pc),s=o.dl(i.documents),u=ba.Be(n,r&&"Offline"!==t.onlineState),a=o.Ei(s,t.$l,u),Kl(t,n,a.ml),c=new Nl(e,n,o),[2,(t.Sl.set(e,c),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),a.snapshot)]}})})}function Pl(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i;return Object(co.d)(this,function(o){switch(o.label){case 0:return n=go(t),r=n.Sl.get(e),(i=n.Dl.get(r.targetId)).length>1?[2,(n.Dl.set(r.targetId,i.filter(function(t){return!su(t,e)})),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,nf(n.Sh,r.targetId,!1).then(function(){n.pl.Ba(r.targetId),$f(n.gl,r.targetId),Gl(n,r.targetId)}).catch(hh)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Gl(n,r.targetId),[4,nf(n.Sh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Ll(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(co.d)(this,function(u){switch(u.label){case 0:r=ap(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=go(t),i=Bo.now(),o=e.reduce(function(t,e){return t.add(e.key)},ha());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Ic.Zo(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=Lu(c,n.get(c.key));null!=h&&s.push(new Vu(c.key,h,Es(h.proto.mapValue),Au.exists(!0)))}return r.Ho.Pi(t,i,s,e)})}).then(function(t){var e=t.Ns(n);return{batchId:t.batchId,oi:e}})}(r.Sh,e)];case 2:return i=u.sent(),r.pl.xa(i.batchId),function(t,e,n){var r=t.Fl[t.currentUser.R()];r||(r=new Wu(To)),r=r.Ht(e,n),t.Fl[t.currentUser.R()]=r}(r,i.batchId,n),[4,Yl(r,i.oi)];case 3:return u.sent(),[4,sl(r.gl)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=yc(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Ul(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r;return Object(co.d)(this,function(i){switch(i.label){case 0:n=go(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Qh(n.Sh,e)];case 2:return r=i.sent(),e.Fe.forEach(function(t,e){var r=n.Nl.get(e);r&&(mo(t.Ue.size+t.Qe.size+t.Ke.size<=1),t.Ue.size>0?r.yl=!0:t.Qe.size>0?mo(r.yl):t.Ke.size>0&&(mo(r.yl),r.yl=!1))}),[4,Yl(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,hh(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Rl(t,e,n){var r=go(t);if(r.$l&&0===n||!r.$l&&1===n){var i=[];r.Sl.forEach(function(t,n){var r=n.view.zh(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=go(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zh(e)&&(r=!0)}),r&&Tl(n)}(r.Vl,e),i.length&&r.vl.uh(i),r.onlineState=e,r.$l&&r.pl.Ka(e)}}function Ml(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(co.d)(this,function(c){switch(c.label){case 0:return(r=go(t)).pl.qa(e,"rejected",n),i=r.Nl.get(e),(o=i&&i.key)?(s=(s=new Wu($o.J)).Ht(o,new js(o,zo.min())),u=ha().add(o),a=new ya(zo.min(),new Map,new ta(To),s,u),[4,Ul(r,a)]):[3,2];case 1:return c.sent(),r.xl=r.xl.remove(o),r.Nl.delete(e),$l(r),[3,4];case 2:return[4,nf(r.Sh,e,!1).then(function(){return Gl(r,e,n)}).catch(hh)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Vl(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i;return Object(co.d)(this,function(o){switch(o.label){case 0:n=go(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Xh(n.Sh,e)];case 2:return i=o.sent(),zl(n,r,null),Bl(n,r),n.pl.Oa(r,"acknowledged"),[4,Yl(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,hh(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Fl(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var r,i;return Object(co.d)(this,function(o){switch(o.label){case 0:r=go(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=go(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.Ho.yi(t,e).next(function(e){return mo(null!==e),r=e.keys(),n.Ho.xi(t,e)}).next(function(){return n.Ho.Fi(t)}).next(function(){return n.Ic.Zo(t,r)})})}(r.Sh,e)];case 2:return i=o.sent(),zl(r,e,n),Bl(r,e),r.pl.Oa(e,"rejected",n),[4,Yl(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,hh(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function ql(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(co.d)(this,function(u){switch(u.label){case 0:Zf((n=go(t)).gl)||lo("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=go(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})}(n.Sh)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.kl.get(r)||[]).push(e),n.kl.set(r,i),[3,4]);case 3:return o=u.sent(),s=yc(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function Bl(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function zl(t,e,n){var r=go(t),i=r.Fl[r.currentUser.R()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Fl[r.currentUser.R()]=i}}function Gl(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Ol.kc(e).forEach(function(e){t.Ol.ki(e)||Hl(t,e)})}function Hl(t,e){var n=t.xl.get(e);null!==n&&($f(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),$l(t))}function Kl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Sl?(t.Ol.sr(o.key,e),Jl(t,o)):o instanceof jl?(lo("SyncEngine","Document no longer in limbo: "+o.key),t.Ol.rr(o.key,e),t.Ol.ki(o.key)||Hl(t,o.key)):bo()}}function Jl(t,e){var n=e.key;t.xl.get(n)||(lo("SyncEngine","New document in limbo: "+n),t.Cl.push(n),$l(t))}function $l(t){for(;t.Cl.length>0&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Al(e)),t.xl=t.xl.Ht(e,n),Jf(t.gl,new lu(iu(Ws(e.path)),n,2,qo.U))}}function Yl(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(co.d)(this,function(u){switch(u.label){case 0:return r=go(t),i=[],o=[],s=[],r.Sl.nt()?[3,3]:(r.Sl.forEach(function(t,u){s.push(r.Bl(u,e,n).then(function(t){if(t){r.$l&&r.pl.qa(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Hh.cc(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.vl.uh(i),[4,function(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return Object(co.d)(this,function(h){switch(h.label){case 0:n=go(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return oc.forEach(e,function(e){return oc.forEach(e.rc,function(r){return n.persistence.Ii.sr(t,e.targetId,r)}).next(function(){return oc.forEach(e.oc,function(r){return n.persistence.Ii.rr(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!hc(r=h.sent()))throw r;return lo("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.dc.get(u),c=a.Bt(a.Mt),n.dc=n.dc.Ht(u,c));return[2]}})})}(r.Sh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function Xl(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r;return Object(co.d)(this,function(i){switch(i.label){case 0:return(n=go(t)).currentUser.isEqual(e)?[3,3]:(lo("SyncEngine","User change. New user:",e.R()),[4,Yh(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.kl.forEach(function(t){t.forEach(function(t){t.reject(new jo(So.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.kl.clear()}(n),n.pl.Qa(e,r.Ac,r.Rc),[4,Yl(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function Wl(t,e){var n=go(t),r=n.Nl.get(e);if(r&&r.yl)return ha().add(r.key);var i=ha(),o=n.Dl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Sl.get(u[s]);i=i.ye(a.view.fl)}return i}function Ql(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i;return Object(co.d)(this,function(o){switch(o.label){case 0:return[4,rf((n=go(t)).Sh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Rl(r),[2,(n.$l&&Kl(n,e.targetId,i.ml),i)]}})})}function Zl(t){return Object(co.b)(this,void 0,void 0,function(){var e;return Object(co.d)(this,function(n){return[2,sf((e=go(t)).Sh).then(function(t){return Yl(e,t)})]})})}function tp(t,e,n,r){return Object(co.b)(this,void 0,void 0,function(){var i,o;return Object(co.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=go(t),r=go(n.Ho);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.gi(t,e).next(function(e){return e?n.Ic.Zo(t,e):oc.resolve(null)})})}((i=go(t)).Sh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,sl(i.gl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(zl(i,e,r||null),Bl(i,e),function(t,e){go(go(t).Ho).Ni(e)}(i.Sh,e)):bo(),s.label=4;case 4:return[4,Yl(i,o)];case 5:return s.sent(),[3,7];case 6:lo("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function ep(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(co.d)(this,function(c){switch(c.label){case 0:return up(n=go(t)),ap(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,np(n,r.rt())]);case 1:return i=c.sent(),n.Ll=!0,[4,pl(n.gl,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)Jf(n.gl,s[o]);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(u=[],a=Promise.resolve(),n.Dl.forEach(function(t,e){n.pl.$a(e)?u.push(e):a=a.then(function(){return Gl(n,e),nf(n.Sh,e,!0)}),$f(n.gl,e)}),[4,a]);case 4:return c.sent(),[4,np(n,u)];case 5:return c.sent(),function(t){var e=go(t);e.Nl.forEach(function(t,n){$f(e.gl,n)}),e.Ol.Mc(),e.Nl=new Map,e.xl=new Wu($o.J)}(n),n.Ll=!1,[4,pl(n.gl,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function np(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,f,l,p,d;return Object(co.d)(this,function(v){switch(v.label){case 0:n=go(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.Dl.get(u=s[o]))&&0!==c.length?[4,ef(n.Sh,iu(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.Sl.get(f[h]),[4,Ql(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,of(n.Sh,u)];case 8:return d=v.sent(),[4,ef(n.Sh,d)];case 9:return a=v.sent(),[4,kl(n,rp(d),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vl.uh(i),r)]}})})}function rp(t){return Xs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function ip(t){var e=go(t);return go(go(e.Sh).persistence).Qo()}function op(t,e,n,r){return Object(co.b)(this,void 0,void 0,function(){var i,o,s;return Object(co.d)(this,function(u){switch(u.label){case 0:return(i=go(t)).Ll?(lo("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,sf(i.Sh)];case 3:return o=u.sent(),s=ya.$e(e,"current"===n),[4,Yl(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,nf(i.Sh,e,!0)];case 6:return u.sent(),Gl(i,e,r),[3,8];case 7:bo(),u.label=8;case 8:return[2]}})})}function sp(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f;return Object(co.d)(this,function(l){switch(l.label){case 0:if(!(r=up(t)).Ll)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.Dl.has(s=o[i])?(lo("SyncEngine","Adding an already active target "+s),[3,5]):[4,of(r.Sh,s)]:[3,6];case 2:return u=l.sent(),[4,ef(r.Sh,u)];case 3:return a=l.sent(),[4,kl(r,rp(u),a.targetId,!1)];case 4:l.sent(),Jf(r.gl,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(co.d)(this,function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,nf(r.Sh,t,!1).then(function(){$f(r.gl,t),Gl(r,t)}).catch(hh)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function up(t){var e=go(t);return e.gl.Ch.Bh=Ul.bind(null,e),e.gl.Ch.Sn=Wl.bind(null,e),e.gl.Ch.$h=Ml.bind(null,e),e.vl.uh=wl.bind(null,e.Vl),e.vl.ql=Il.bind(null,e.Vl),e}function ap(t){var e=go(t);return e.gl.Ch.qh=Vl.bind(null,e),e.gl.Ch.Uh=Fl.bind(null,e),e}var cp=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(e){switch(e.label){case 0:return this.Kt=Rf(t.gu.T),this.pl=this.Wl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return $h(this.persistence,new Kh,t.Yl,this.Kt)},t.prototype.Gl=function(t){return new bf(gf.ra,this.Kt)},t.prototype.Wl=function(t){return new Nf},t.prototype.terminate=function(){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.Lo()];case 1:return t.sent(),[4,this.persistence.Lo()];case 2:return t.sent(),[2]}})})},t}(),hp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(co.c)(e,t),e.prototype.initialize=function(e){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,uf(this.Sh)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,ap(this.Xl.fa)];case 4:return n.sent(),[4,sl(this.Xl.gl)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return $h(this.persistence,new Kh,t.Yl,this.Kt)},e.prototype.Hl=function(t){return new jh(this.persistence.Ii._r,t.fs)},e.prototype.Gl=function(t){var e=Bh(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?ch.Xs(this.cacheSizeBytes):ch.ei;return new Vh(this.synchronizeTabs,e,t.clientId,n,t.fs,Lf(),Uf(),this.Kt,this.pl,!!this.forceOwnership)},e.prototype.Wl=function(t){return new Nf},e}(cp),fp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(co.c)(e,t),e.prototype.initialize=function(e){return Object(co.b)(this,void 0,void 0,function(){var n,r=this;return Object(co.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.fa,this.pl instanceof xf?(this.pl.fa={nu:tp.bind(null,n),su:op.bind(null,n),iu:sp.bind(null,n),Qo:ip.bind(null,n),eu:Zl.bind(null,n)},[4,this.pl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Po(function(t){return Object(co.b)(r,void 0,void 0,function(){return Object(co.d)(this,function(e){switch(e.label){case 0:return[4,ep(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Tr?this.zl.start(this.Sh):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Wl=function(t){var e=Lf();if(!xf.jn(e))throw new jo(So.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Bh(t.gu.T,t.gu.persistenceKey);return new xf(e,t.fs,n,t.clientId,t.Yl)},e}(hp),lp=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(co.b)(this,void 0,void 0,function(){var n=this;return Object(co.d)(this,function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return Rl(n.fa,t,1)},this.gl.Ch.s_=Xl.bind(null,this.fa),[4,pl(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new bl},t.prototype.Zl=function(t){var e=Rf(t.gu.T),n=new Pf(t.gu);return function(t,e,n){return new Bf(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Sh,n=this.Dh,r=t.fs,i=function(t){return Rl(s.fa,t,0)},o=Cf.jn()?new Cf:new Af,new Gf(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new Cl(t,e,n,r,i,o);return s&&(u.Ll=!0),u}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},t.prototype.terminate=function(){return function(t){return Object(co.b)(this,void 0,void 0,function(){var e;return Object(co.d)(this,function(n){switch(n.label){case 0:return e=go(t),lo("RemoteStore","RemoteStore shutting down."),e.Oh.add(5),[4,Kf(e)];case 1:return n.sent(),e.kh.Lo(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},t}(),pp=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),dp=(function(){function t(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new ic,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.o_.cancel()},t.prototype.getMetadata=function(){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Kl=function(){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},t.prototype.a_=function(){return Object(co.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(co.d)(this,function(i){switch(i.label){case 0:return[4,this.u_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.c_.decode(t),n=Number(e),isNaN(n)&&this.h_("length string ("+e+") is not valid number"),[4,this.l_(n)]);case 2:return r=i.sent(),[2,new El(JSON.parse(r),t.length+n)]}})})},t.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.u_=function(){return Object(co.b)(this,void 0,void 0,function(){var t,e;return Object(co.d)(this,function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.l_=function(t){return Object(co.b)(this,void 0,void 0,function(){var e;return Object(co.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.f_=function(){return Object(co.b)(this,void 0,void 0,function(){var t,e;return Object(co.d)(this,function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new jo(So.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new Jo(t)}return t.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},t}()),vp=function(t){this._methodName=t};function yp(t,e,n){if(!n)throw new jo(So.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function bp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new jo(So.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function mp(t,e,n,r){if(!0===e&&!0===r)throw new jo(So.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function gp(t){if(!$o.Et(t))throw new jo(So.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function wp(t){if($o.Et(t))throw new jo(So.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Ip(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":bo()}function Tp(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new jo(So.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Ip(t);throw new jo(So.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Op(t,e){if(e<=0)throw new jo(So.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Ep=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new jo(So.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new jo(So.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,mp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),_p=new Map,Sp=function(){function t(t,e){this.w_="(lite)",this.E_=new Ep({}),this.T_=!1,t instanceof Po?(this.I_=t,this.m_=new Ro):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new jo(So.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Po(t.options.projectId)}(t),this.m_=new Mo(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new jo(So.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new jo(So.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Ep(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Ro;switch(t.type){case"gapi":var e=t.client;return mo(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Fo(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new jo(So.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.b_=function(){return(t=_p.get(this))&&(lo("ComponentProvider","Removing Datastore"),_p.delete(this),t.terminate()),Promise.resolve();var t},t}(),jp=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Np(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),xp=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Np=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Ws(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Object(co.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new jp(this.firestore,null,new $o(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(xp);function Ap(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof No&&(t=t._),yp("collection","path",e),t instanceof Sp)return wp(n=Ho.ct.apply(Ho,Object(co.g)([e],r))),new Np(t,null,n);if(!(t instanceof jp||t instanceof Np))throw new jo(So.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return wp(n=Ho.ct.apply(Ho,Object(co.g)([t.path],r)).child(Ho.ct(e))),new Np(t.firestore,null,n)}function Cp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof No&&(t=t._),1===arguments.length&&(e=Io.t()),yp("doc","path",e),t instanceof Sp)return gp(n=Ho.ct.apply(Ho,Object(co.g)([e],r))),new jp(t,null,new $o(n));if(!(t instanceof jp||t instanceof Np))throw new jo(So.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return gp(n=t.D_.child(Ho.ct.apply(Ho,Object(co.g)([e],r)))),new jp(t.firestore,t instanceof Np?t.v_:null,new $o(n))}function Dp(t,e){return t instanceof No&&(t=t._),e instanceof No&&(e=e._),(t instanceof jp||t instanceof Np)&&(e instanceof jp||e instanceof Np)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function kp(t,e){return t instanceof No&&(t=t._),e instanceof No&&(e=e._),t instanceof xp&&e instanceof xp&&t.firestore===e.firestore&&su(t.C_,e.C_)&&t.v_===e.v_}var Pp=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new jo(So.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new jo(So.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.K=function(t){return To(this.x_,t.x_)||To(this.N_,t.N_)},t}(),Lp=/^__.*__$/,Up=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return null!==this.zt?new Vu(t,this.data,this.zt,e,this.fieldTransforms):new Mu(t,this.data,e,this.fieldTransforms)},t}(),Rp=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return new Vu(t,this.data,this.zt,e,this.fieldTransforms)},t}();function Mp(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw bo()}}var Vp=function(){function t(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.F_(),this.fieldTransforms=i||[],this.zt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.F_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return od(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.W_)},t.prototype.contains=function(t){return void 0!==this.zt.find(function(e){return t.st(e)})||void 0!==this.fieldTransforms.find(function(e){return t.st(e.field)})},t.prototype.F_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Mp(this.k_)&&Lp.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),Fp=function(){function t(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||Rf(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Vp({k_:t,methodName:e,W_:n,path:Jo.at(),B_:!1,j_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},t}();function qp(t){var e=t.p_(),n=Rf(t.I_);return new Fp(t.I_,!!e.ignoreUndefinedProperties,n)}function Bp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);ed("Data must be an object, but it was:",s,r);var u,a,c=Zp(r,s);if(o.merge)u=new Qo(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=nd(e,l[f],n);if(!s.contains(p))throw new jo(So.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");sd(h,p)||h.push(p)}u=new Qo(h),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new Up(new Ts(c),u,a)}var zp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw t.K_(1===t.k_?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(vp);function Gp(t,e,n){return new Vp({k_:3,W_:e.settings.W_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var Hp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e.prototype.z_=function(t){return new xu(t.path,new wu)},e.prototype.isEqual=function(t){return t instanceof e},e}(vp),Kp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(co.c)(e,t),e.prototype.z_=function(t){var e=Gp(this,t,!0),n=this.H_.map(function(t){return Qp(t,e)}),r=new Iu(n);return new xu(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(vp),Jp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(co.c)(e,t),e.prototype.z_=function(t){var e=Gp(this,t,!0),n=this.H_.map(function(t){return Qp(t,e)}),r=new Ou(n);return new xu(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(vp),$p=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Object(co.c)(e,t),e.prototype.z_=function(t){var e=new _u(t.Kt,vu(t.Kt,this.J_));return new xu(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(vp);function Yp(t,e,n,r){var i=t.G_(1,e,n);ed("Data must be an object, but it was:",i,r);var o=[],s=new Os;Xo(r,function(t,r){var u=id(e,t,n);r instanceof No&&(r=r._);var a=i.U_(u);if(r instanceof zp)o.push(u);else{var c=Qp(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new Qo(o);return new Rp(s.yt(),u,i.fieldTransforms)}function Xp(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[nd(e,r,n)],a=[i];if(o.length%2!=0)throw new jo(So.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(nd(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Os,l=u.length-1;l>=0;--l)if(!sd(h,u[l])){var p=u[l],d=a[l];d instanceof No&&(d=d._);var v=s.U_(p);if(d instanceof zp)h.push(p);else{var y=Qp(d,v);null!=y&&(h.push(p),f.set(p,y))}}var b=new Qo(h);return new Rp(f.yt(),b,s.fieldTransforms)}function Wp(t,e,n,r){return void 0===r&&(r=!1),Qp(n,t.G_(r?4:3,e))}function Qp(t,e){if(t instanceof No&&(t=t._),td(t))return ed("Unsupported field value:",e,t),Zp(t,e);if(t instanceof vp)return function(t,e){if(!Mp(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Qp(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof No&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return vu(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Bo.fromDate(t);return{timestampValue:xa(e.Kt,n)}}if(t instanceof Bo)return n=new Bo(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:xa(e.Kt,n)};if(t instanceof Pp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof xo)return{bytesValue:Na(e.Kt,t.l)};if(t instanceof jp){var r=t.firestore.I_;if(!r.isEqual(n=e.T))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Da(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Ip(t))}(t,e)}function Zp(t,e){var n={};return Wo(t)?e.path&&e.path.length>0&&e.zt.push(e.path):Xo(t,function(t,r){var i=Qp(r,e.L_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function td(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Bo||t instanceof Pp||t instanceof xo||t instanceof jp||t instanceof vp)}function ed(t,e,n){if(!td(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Ip(n);throw e.K_("an object"===r?t+" a custom object":t+" "+r)}}function nd(t,e,n){if(e instanceof No&&(e=e._),e instanceof dp)return e.d_;if("string"==typeof e)return id(t,e);throw od("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var rd=new RegExp("[~\\*/\\[\\]]");function id(t,e,n){if(e.search(rd)>=0)throw od("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(dp.bind.apply(dp,Object(co.g)([void 0],e.split("."))))).d_}catch(r){throw od("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function od(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new jo(So.INVALID_ARGUMENT,(u+=". ")+t+a)}function sd(t,e){return t.some(function(t){return t.isEqual(e)})}var ud=function(){function t(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Object(co.b)(this,void 0,void 0,function(){var e,n=this;return Object(co.d)(this,function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new jo(So.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i,o,s,u;return Object(co.d)(this,function(a){switch(a.label){case 0:return n=go(t),r=Ma(n.Kt)+"/documents",i={documents:e.map(function(t){return Pa(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){mo(!!e.found);var n=La(t,e.found.name),r=Ca(e.found.updateTime),i=new Ts({mapValue:{fields:e.found.fields}});return new Ss(n,r,i,{})}(t,e):"missing"in e?function(t,e){mo(!!e.missing),mo(!!e.readTime);var n=La(t,e.missing),r=Ca(e.readTime);return new js(n,r)}(t,e):bo()}(n.Kt,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());mo(!!e),u.push(e)}),u)]}})})}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof js||t instanceof Ss?n.sf(t):bo()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.O_(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.O_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new Ku(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Object(co.b)(this,void 0,void 0,function(){var t,e=this;return Object(co.d)(this,function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=$o.ft(n);e.mutations.push(new Ju(r,e.Gt(r)))}),[4,function(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i;return Object(co.d)(this,function(o){switch(o.label){case 0:return n=go(t),r=Ma(n.Kt)+"/documents",i={writes:e.map(function(t){return Ba(n.Kt,t)})},[4,n.bu("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}})})},t.prototype.sf=function(t){var e;if(t instanceof Ss)e=t.version;else{if(!(t instanceof js))throw bo();e=zo.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new jo(So.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Au.updateTime(e):Au.jt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(zo.min()))throw new jo(So.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Au.updateTime(e)}return Au.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),ad=function(){function t(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new Mf(this.fs,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.zu.Bu(function(){return Object(co.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(co.d)(this,function(r){return t=new ud(this.Dh),(e=this.uf(t))&&e.then(function(e){n.fs.ys(function(){return t.commit().then(function(){n.Ts.resolve(e)}).catch(function(t){n.hf(t)})})}).catch(function(t){n.hf(t)}),[2]})})})},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!ss(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Yu(e)}return!1},t}(),cd=function(){function t(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=Lo.UNAUTHENTICATED,this.clientId=Io.t(),this._f=function(){},this.N=new ic,this.credentials.S(function(t){lo("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}return t.prototype.getConfiguration=function(){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},t.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},t.prototype.df=function(){if(this.fs.wf)throw new jo(So.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new ic;return this.fs.Tf(function(){return Object(co.b)(t,void 0,void 0,function(){var t,n;return Object(co.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=r.sent(),n=yc(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function hd(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(co.d)(this,function(o){switch(o.label){case 0:return t.fs.Af(),lo("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Yl,t.ff(function(n){r.isEqual(n)||(r=n,t.fs.bo(function(){return Object(co.b)(i,void 0,void 0,function(){return Object(co.d)(this,function(t){switch(t.label){case 0:return[4,Yh(e.Sh,n)];case 1:return t.sent(),[2]}})})}))}),e.persistence.yo(function(){return t.terminate()}),t.mf=e,[2]}})})}function fd(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r;return Object(co.d)(this,function(i){switch(i.label){case 0:return t.fs.Af(),[4,ld(t)];case 1:return n=i.sent(),lo("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff(function(n){return t.fs.bo(function(){return function(t,e){return Object(co.b)(this,void 0,void 0,function(){var n,r;return Object(co.d)(this,function(i){switch(i.label){case 0:return(n=go(t)).fs.Af(),lo("RemoteStore","RemoteStore received new credentials"),r=Zf(n),n.Oh.add(3),[4,Kf(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Oh.delete(3),[4,Hf(n)];case 3:return i.sent(),[2]}})})}(e.gl,n)})}),t.If=e,[2]}})})}function ld(t){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(e){switch(e.label){case 0:return t.mf?[3,2]:(lo("FirestoreClient","Using default OfflineComponentProvider"),[4,hd(t,new cp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}})})}function pd(t){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(e){switch(e.label){case 0:return t.If?[3,2]:(lo("FirestoreClient","Using default OnlineComponentProvider"),[4,fd(t,new lp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}})})}function dd(t){return ld(t).then(function(t){return t.persistence})}function vd(t){return ld(t).then(function(t){return t.Sh})}function yd(t){return pd(t).then(function(t){return t.gl})}function bd(t){return pd(t).then(function(t){return t.fa})}function md(t){return Object(co.b)(this,void 0,void 0,function(){var e,n;return Object(co.d)(this,function(r){switch(r.label){case 0:return[4,pd(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=Dl.bind(null,e.fa),n.Jh=Pl.bind(null,e.fa),n)]}})})}function gd(t,e,n){var r=this;void 0===n&&(n={});var i=new ic;return t.fs.ys(function(){return Object(co.b)(r,void 0,void 0,function(){var r;return Object(co.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new pp({next:function(o){e.ys(function(){return gl(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new jo(So.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new jo(So.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Ol(Ws(n.path),o,{includeMetadataChanges:!0,sl:!0});return ml(t,s)},[4,md(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}function wd(t,e,n){var r=this;void 0===n&&(n={});var i=new ic;return t.fs.ys(function(){return Object(co.b)(r,void 0,void 0,function(){var r;return Object(co.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new pp({next:function(n){e.ys(function(){return gl(t,s)}),n.fromCache&&"server"===r.source?i.reject(new jo(So.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Ol(n,o,{includeMetadataChanges:!0,sl:!0});return ml(t,s)},[4,md(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}var Id=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new Mf(this,"async_queue_retry"),this.vf=function(){var e=Uf();e&&lo("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=Uf();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.ys=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Uf();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},t.prototype.bo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},t.prototype.Cf=function(){return Object(co.b)(this,void 0,void 0,function(){var t,e=this;return Object(co.d)(this,function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!hc(t=n.sent()))throw t;return lo("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.zu.Bu(function(){return e.Cf()}),n.label=5;case 5:return[2]}})})},t.prototype.Df=function(t){var e=this,n=this.Rf.then(function(){return e.pf=!0,t().catch(function(t){throw e.Vf=t,e.pf=!1,po("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.pf=!1,t})});return this.Rf=n,n},t.prototype.Ir=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=vc.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&bo()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Object(co.b)(this,void 0,void 0,function(){var t;return Object(co.d)(this,function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Of=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},t.prototype.Ff=function(t){var e=this;return this.Nf().then(function(){e.gf.sort(function(t,e){return t.ws-e.ws});for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()})},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),Td=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new Id,r.w_="name"in e?e.name:"[DEFAULT]",r}return Object(co.c)(e,t),e.prototype.b_=function(){return this.Lf||Ed(this),this.Lf.terminate()},e}(Sp);function Od(t){return t.Lf||Ed(t),t.Lf.df(),t.Lf}function Ed(t){var e=t.p_(),n=function(t,e,n){return new ko(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.Lf=new cd(t.m_,t.Mf,n)}function _d(t,e,n){var r=this,i=new ic;return t.fs.enqueue(function(){return Object(co.b)(r,void 0,void 0,function(){var r;return Object(co.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,hd(t,n)];case 1:return o.sent(),[4,fd(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===So.FAILED_PRECONDITION||t.code===So.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Sd(t){if(t.R_||t.P_)throw new jo(So.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var jd=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),cs(t)){case 0:return null;case 1:return t.booleanValue;case 2:return es(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(ns(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.jf(t.arrayValue,e);case 10:return this.Wf(t.mapValue,e);default:throw bo()}},t.prototype.Wf=function(t,e){var n=this,r={};return Xo(t.fields||{},function(t,i){r[t]=n.$f(i,e)}),r},t.prototype.Kf=function(t){return new Pp(es(t.latitude),es(t.longitude))},t.prototype.jf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},t.prototype.qf=function(t,e){switch(e){case"previous":var n=is(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(os(t));default:return null}},t.prototype.Bf=function(t){var e=ts(t);return new Bo(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=Ho.ct(t);mo(rc(n));var r=new Po(n.get(1),n.get(3)),i=new $o(n.X(5));return r.isEqual(e)||po("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),xd=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new jp(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Nd(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field(Ad("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),Nd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(xd);function Ad(t,e){return"string"==typeof e?id(t,e):e instanceof No?e._.d_:e.d_}function Cd(t){if(Zs(t)&&0===t.Nt.length)throw new jo(So.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Dd=function(){};function kd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.Yf(t)}return t}var Pd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return Object(co.c)(e,t),e.prototype.Yf=function(t){var e=qp(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.ht()){if("array-contains"===o||"array-contains-any"===o)throw new jo(So.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){qd(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(Fd(r,t,h[c]));u={arrayValue:{values:a}}}else u=Fd(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||qd(s,o),u=Wp(n,"where",s,"in"===o||"not-in"===o);var f=Ps.create(i,o,u);return function(t,e){if(e.xt()){var n=eu(t);if(null!==n&&!n.isEqual(e.field))throw new jo(So.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=tu(t);null!==r&&Bd(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new jo(So.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.C_,0,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new xp(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new Ys(t.path,t.collectionGroup,t.Nt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Dd),Ld=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return Object(co.c)(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new jo(So.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new jo(So.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Hs(e,n);return function(t,e){if(null===tu(t)){var n=eu(t);null!==n&&Bd(0,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new xp(t.firestore,t.v_,function(t,e){var n=t.Nt.concat([e]);return new Ys(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Dd),Ud=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return Object(co.c)(e,t),e.prototype.Yf=function(t){return new xp(t.firestore,t.v_,ou(t.C_,this.nd,this.sd))},e}(Dd),Rd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(co.c)(e,t),e.prototype.Yf=function(t){var e=Vd(t,this.type,this.rd,this.od);return new xp(t.firestore,t.v_,function(t,e){return new Ys(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Dd),Md=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(co.c)(e,t),e.prototype.Yf=function(t){var e=Vd(t,this.type,this.rd,this.od);return new xp(t.firestore,t.v_,function(t,e){return new Ys(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Dd);function Vd(t,e,n,r){if(n[0]instanceof No&&(n[0]=n[0]._),n[0]instanceof xd)return function(t,e,n,r,i){if(!r)throw new jo(So.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=ru(t);s<u.length;s++){var a=u[s];if(a.field.ht())o.push(ys(e,r.key));else{var c=r.field(a.field);if(rs(c))throw new jo(So.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.ot();throw new jo(So.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new zs(o,i)}(t.C_,t.firestore.I_,e,n[0].Jf,r);var i=qp(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new jo(So.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new jo(So.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!nu(t)&&-1!==c.indexOf("/"))throw new jo(So.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Ho.ct(c));if(!$o.Et(h))throw new jo(So.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new $o(h);u.push(ys(e,f))}else{var l=Wp(n,r,c);u.push(l)}}return new zs(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Fd(t,e,n){if(n instanceof No&&(n=n._),"string"==typeof n){if(""===n)throw new jo(So.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!nu(e)&&-1!==n.indexOf("/"))throw new jo(So.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Ho.ct(n));if(!$o.Et(r))throw new jo(So.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ys(t,new $o(r))}if(n instanceof jp)return ys(t,n.S_);throw new jo(So.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ip(n)+".")}function qd(t,e){if(!Array.isArray(t)||0===t.length)throw new jo(So.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new jo(So.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Bd(t,e,n){if(!n.isEqual(e))throw new jo(So.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function zd(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}function Gd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Hd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(co.c)(e,t),e.prototype.Uf=function(t){return new xo(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new jp(this.firestore,null,e)},e}(jd),Kd=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Jd=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).zf=e,u.ad=e,u.metadata=o,u}return Object(co.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new $d(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field(Ad("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(xd),$d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Jd),Yd=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new Kd(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach(function(r){t.call(e,new $d(n.zf,n.Hf,r.key,r,new Kd(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.Ne)throw new jo(So.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map(function(e){return{type:"added",doc:new $d(t.zf,t.Hf,e.doc.key,e.doc,new Kd(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),oldIndex:-1,newIndex:n++}})}var r=t.ud.De;return t.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new $d(t.zf,t.Hf,e.doc.key,e.doc,new Kd(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Xd(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.ld=e),this.hd},t}();function Xd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return bo()}}function Wd(t,e){return t instanceof Jd&&e instanceof Jd?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof Yd&&e instanceof Yd&&t.zf===e.zf&&kp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var Qd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(co.c)(e,t),e.prototype.Uf=function(t){return new xo(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new jp(this.firestore,null,e)},e}(jd);function Zd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Tp(t,jp);var o=Tp(t.firestore,Td),s=qp(o);return e instanceof No&&(e=e._),ev(o,[("string"==typeof e||e instanceof dp?Xp(s,"updateDoc",t.S_,e,n,r):Yp(s,"updateDoc",t.S_,e)).O_(t.S_,Au.exists(!0))])}function tv(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof No&&(t=t._);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||zd(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(zd(i[u])){var l=i[u];i[u]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[u+1]=null===(n=l.error)||void 0===n?void 0:n.bind(l),i[u+2]=null===(r=l.complete)||void 0===r?void 0:r.bind(l)}if(t instanceof jp)c=Tp(t.firestore,Td),h=Ws(t.S_.path),a={next:function(e){i[u]&&i[u](nv(c,t,e))},error:i[u+1],complete:i[u+2]};else{var p=Tp(t,xp);c=Tp(p.firestore,Td),h=p.C_;var d=new Qd(c);a={next:function(t){i[u]&&i[u](new Yd(c,d,p,t))},error:i[u+1],complete:i[u+2]},Cd(t.C_)}return function(t,e,n,r){var i=this,o=new pp(r),s=new Ol(e,o,n);return t.fs.ys(function(){return Object(co.b)(i,void 0,void 0,function(){var e;return Object(co.d)(this,function(n){switch(n.label){case 0:return e=ml,[4,md(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.r_(),t.fs.ys(function(){return Object(co.b)(i,void 0,void 0,function(){var e;return Object(co.d)(this,function(n){switch(n.label){case 0:return e=gl,[4,md(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(Od(c),h,f,a)}function ev(t,e){return function(t,e){var n=this,r=new ic;return t.fs.ys(function(){return Object(co.b)(n,void 0,void 0,function(){var n;return Object(co.d)(this,function(i){switch(i.label){case 0:return n=Ll,[4,bd(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(Od(t),e)}function nv(t,e,n){var r=n.docs.get(e.S_),i=new Qd(t);return new Jd(t,i,e.S_,r,new Kd(n.hasPendingWrites,n.fromCache),e.v_)}var rv=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=qp(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=iv(t,this.zf),i=Gd(r.v_,e,n),o=Bp(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.O_(r.S_,Au.jt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,s=iv(t,this.zf);return e instanceof No&&(e=e._),o="string"==typeof e||e instanceof dp?Xp(this.wd,"WriteBatch.update",s.S_,e,n,r):Yp(this.wd,"WriteBatch.update",s.S_,e),this.fd.push(o.O_(s.S_,Au.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=iv(t,this.zf);return this.fd=this.fd.concat(new Ku(e.S_,Au.jt())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new jo(So.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function iv(t,e){if(t instanceof No&&(t=t._),t.firestore!==e)throw new jo(So.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var ov=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return Object(co.c)(e,t),e.prototype.get=function(e){var n=this,r=iv(e,this.zf),i=new Qd(this.zf);return t.prototype.get.call(this,e).then(function(t){return new Jd(n.zf,i,r.S_,t.Jf,new Kd(!1,!1),r.v_)})},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=qp(t)}return t.prototype.get=function(t){var e=this,n=iv(t,this.zf),r=new Hd(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return bo();var i=t[0];if(i instanceof js)return new xd(e.zf,r,n.S_,null,n.v_);if(i instanceof Ss)return new xd(e.zf,r,i.key,i,n.v_);throw bo()})},t.prototype.set=function(t,e,n){var r=iv(t,this.zf),i=Gd(r.v_,e,n),o=Bp(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=iv(t,this.zf);return e instanceof No&&(e=e._),o="string"==typeof e||e instanceof dp?Xp(this.wd,"Transaction.update",s.S_,e,n,r):Yp(this.wd,"Transaction.update",s.S_,e),this.Td.update(s.S_,o),this},t.prototype.delete=function(t){var e=iv(t,this.zf);return this.Td.delete(e.S_),this},t}()),sv=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Sd(t=Tp(t,Td));var n=Od(t),r=t.p_(),i=new lp;return _d(n,i,new hp(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Sd(t=Tp(t,Td));var e=Od(t),n=t.p_(),r=new lp;return _d(e,r,new fp(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new jo(So.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new ic;return t.Mf.Tf(function(){return Object(co.b)(e,void 0,void 0,function(){var e;return Object(co.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(co.b)(this,void 0,void 0,function(){return Object(co.d)(this,function(e){switch(e.label){case 0:return uc.jn()?[4,uc.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(Bh(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._)},t}(),uv=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Po||(i.md=e),i}return Object(co.c)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=Tp(t,Sp)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&vo("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this._,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(co.b)(e,void 0,void 0,function(){var e,n;return Object(co.d)(this,function(r){switch(r.label){case 0:return[4,dd(t)];case 1:return e=r.sent(),[4,yd(t)];case 2:return n=r.sent(),[2,(e.Vo(!0),function(t){var e=go(t);return e.Oh.delete(0),Hf(e)}(n))]}})})})}(Od(Tp(this._,Td)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(co.b)(e,void 0,void 0,function(){var e,n;return Object(co.d)(this,function(r){switch(r.label){case 0:return[4,dd(t)];case 1:return e=r.sent(),[4,yd(t)];case 2:return n=r.sent(),[2,(e.Vo(!1),function(t){return Object(co.b)(this,void 0,void 0,function(){var e;return Object(co.d)(this,function(n){switch(n.label){case 0:return(e=go(t)).Oh.add(0),[4,Kf(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(Od(Tp(this._,Td)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&mp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new ic;return t.fs.ys(function(){return Object(co.b)(e,void 0,void 0,function(){var e;return Object(co.d)(this,function(r){switch(r.label){case 0:return e=ql,[4,bd(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Od(Tp(this._,Td)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new pp(e);return t.fs.ys(function(){return Object(co.b)(n,void 0,void 0,function(){var e;return Object(co.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){go(t).Wh.add(e),e.next()},[4,md(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.r_(),t.fs.ys(function(){return Object(co.b)(n,void 0,void 0,function(){var e;return Object(co.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){go(t).Wh.delete(e)},[4,md(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(Od(t=Tp(t,Td)),zd(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new jo(So.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new wv(this,Ap(this._,t))}catch(t){throw lv(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new fv(this,Cp(this._,t))}catch(t){throw lv(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new bv(this,function(t,e){if(t=Tp(t,Sp),yp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new jo(So.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new xp(t,null,function(t){return new Ys(Ho.at(),t)}(e))}(this._,t))}catch(t){throw lv(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new ic;return t.fs.ys(function(){return Object(co.b)(n,void 0,void 0,function(){var n;return Object(co.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return pd(t).then(function(t){return t.Dh})}(t)];case 1:return n=i.sent(),new ad(t.fs,n,e,r).run(),[2]}})})}),r.promise}(Od(t),function(n){return e(new ov(t,n))})}(this._,function(n){return t(new cv(e,n))})},e.prototype.batch=function(){var t=this;return Od(this._),new hv(new rv(this._,function(e){return ev(t._,e)}))},e.prototype.loadBundle=function(t){throw new jo(So.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new jo(So.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(No),av=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(co.c)(e,t),e.prototype.Uf=function(t){return new Do(new xo(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return fv.Ad(e,this.firestore,null)},e}(jd),cv=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r.Hf=new av(e),r}return Object(co.c)(e,t),e.prototype.get=function(t){var e=this,n=Iv(t);return this._.get(n).then(function(t){return new vv(e.zf,new Jd(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))})},e.prototype.set=function(t,e,n){var r=Iv(t);return n?(bp("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Iv(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(co.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Iv(t);return this._.delete(e),this},e}(No),hv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e.prototype.set=function(t,e,n){var r=Iv(t);return n?(bp("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Iv(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(co.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Iv(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(No),fv=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new av(e),r}return Object(co.c)(e,t),e.Rd=function(t,n,r){if(t.length%2!=0)throw new jo(So.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new e(n,new jp(n._,r,new $o(t)))},e.Ad=function(t,n,r){return new e(n,new jp(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new wv(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new wv(this.firestore,Ap(this._,t))}catch(t){throw lv(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof No&&(t=t._),t instanceof jp&&Dp(this._,t)},e.prototype.set=function(t,e){e=bp("DocumentReference.set",e);try{return function(t,e,n){t=Tp(t,jp);var r=Tp(t.firestore,Td),i=Gd(t.v_,e,n);return ev(r,[Bp(qp(r),"setDoc",t.S_,i,null!==t.v_,n).O_(t.S_,Au.jt())])}(this._,t,e)}catch(t){throw lv(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Zd(this._,t):Zd.apply(void 0,Object(co.g)([this._,t,e],n))}catch(t){throw lv(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return ev(Tp((t=this._).firestore,Td),[new Ku(t.S_,Au.jt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=pv(e),i=dv(e,function(e){return new vv(t.firestore,new Jd(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))});return tv(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Tp(t,jp);var e=Tp(t.firestore,Td),n=Od(e),r=new Qd(e);return function(t,e){var n=this,r=new ic;return t.fs.ys(function(){return Object(co.b)(n,void 0,void 0,function(){var n;return Object(co.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var r,i;return Object(co.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=go(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)})}(t,e)];case 1:return(i=o.sent())instanceof Ss?n.resolve(i):i instanceof js?n.resolve(null):n.reject(new jo(So.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=yc(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,vd(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.S_).then(function(n){return new Jd(e,r,t.S_,n,new Kd(n instanceof Ss&&n.bt,!0),t.v_)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Tp(t,jp);var e=Tp(t.firestore,Td);return gd(Od(e),t.S_,{source:"server"}).then(function(n){return nv(e,t,n)})}(this._):function(t){t=Tp(t,jp);var e=Tp(t.firestore,Td);return gd(Od(e),t.S_).then(function(n){return nv(e,t,n)})}(this._)).then(function(t){return new vv(e.firestore,new Jd(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(No);function lv(t,e,n){return t.message=t.message.replace(e,n),t}function pv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!zd(r))return r}return{}}function dv(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=zd(t[0])?t[0]:zd(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var vv=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(co.c)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new fv(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return Wd(this._,t._)},e}(No),yv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e.prototype.data=function(t){return this._.data(t)},e}(vv),bv=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new av(e),r}return Object(co.c)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,kd(this._,function(t,e,n){var r=e,i=Ad("where",t);return new Pd(i,r,n)}(t,n,r)))}catch(t){throw lv(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,kd(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=Ad("orderBy",t);return new Ld(r,n)}(t,n)))}catch(t){throw lv(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,kd(this._,function(t){return Op("limit",t),new Ud("limit",t,"F")}(t)))}catch(t){throw lv(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,kd(this._,function(t){return Op("limitToLast",t),new Ud("limitToLast",t,"L")}(t)))}catch(t){throw lv(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,kd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rd("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw lv(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,kd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rd("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw lv(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,kd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Md("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw lv(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,kd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Md("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw lv(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return kp(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Tp(t,xp);var e=Tp(t.firestore,Td),n=Od(e),r=new Qd(e);return function(t,e){var n=this,r=new ic;return t.fs.ys(function(){return Object(co.b)(n,void 0,void 0,function(){var n;return Object(co.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(co.b)(this,void 0,void 0,function(){var r,i,o,s,u;return Object(co.d)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,rf(t,e,!0)];case 1:return u=a.sent(),r=new xl(e,u.Pc),i=r.dl(u.documents),o=r.Ei(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=yc(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}})})},[4,vd(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.C_).then(function(n){return new Yd(e,r,t,n)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Tp(t,xp);var e=Tp(t.firestore,Td),n=Od(e),r=new Qd(e);return wd(n,t.C_,{source:"server"}).then(function(n){return new Yd(e,r,t,n)})}(this._):function(t){t=Tp(t,xp);var e=Tp(t.firestore,Td),n=Od(e),r=new Qd(e);return Cd(t.C_),wd(n,t.C_).then(function(n){return new Yd(e,r,t,n)})}(this._)).then(function(t){return new gv(e.firestore,new Yd(e.firestore._,e.Hf,e._,t.ud))})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=pv(e),i=dv(e,function(e){return new gv(t.firestore,new Yd(t.firestore._,t.Hf,t._,e.ud))});return tv(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(No),mv=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(co.c)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new yv(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(No),gv=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(co.c)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new bv(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map(function(e){return new yv(t.zf,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new mv(e.zf,t)})},e.prototype.forEach=function(t,e){var n=this;this._.forEach(function(r){t.call(e,new yv(n.zf,r))})},e.prototype.isEqual=function(t){return Wd(this._,t._)},e}(No),wv=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return Object(co.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new fv(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new fv(this.firestore,void 0===t?Cp(this._):Cp(this._,t))}catch(t){throw lv(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Tp(t.firestore,Td),r=Cp(t),i=Gd(t.v_,e);return ev(n,[Bp(qp(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).O_(r.S_,Au.exists(!1))]).then(function(){return r})}(this._,t).then(function(t){return new fv(e.firestore,t)})},e.prototype.isEqual=function(t){return Dp(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(bv);function Iv(t){return t instanceof No&&(t=t._),Tp(t,jp)}var Tv=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(dp.bind.apply(dp,Object(co.g)([void 0],e))))||this}return Object(co.c)(e,t),e.documentId=function(){return new e(Jo.lt().ot())},e.prototype.isEqual=function(t){return t instanceof No&&(t=t._),t instanceof dp&&this._.d_.isEqual(t.d_)},e}(No),Ov=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(co.c)(e,t),e.serverTimestamp=function(){var t=new Hp("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new zp("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Kp("arrayUnion",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jp("arrayRemove",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new $p("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(No);!function(){function t(){this.Pd={},this.yd=new ic,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.yd.promise.catch(t)},t.prototype.then=function(t,e){return this.yd.promise.then(t,e)},t.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},t.prototype.jl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},t.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)}}();var Ev,_v=n("/6Yf"),Sv={Firestore:uv,GeoPoint:Pp,Timestamp:Bo,Blob:Do,Transaction:cv,WriteBatch:hv,DocumentReference:fv,DocumentSnapshot:vv,Query:bv,QueryDocumentSnapshot:yv,QuerySnapshot:gv,CollectionReference:wv,FieldPath:Tv,FieldValue:Ov,setLogLevel:function(t){ho.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new _v.a("firestore",function(t){return function(t,e){return new uv(t,new Td(t,e),new sv)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Sv)))})(Ev=ie.a),Ev.registerVersion("@firebase/firestore","2.1.2");let jv=(()=>{class t{constructor(){this.db=re.a.firestore(),this.availableExers=this.db.collection("health").doc("availableExers"),this.availableExerList=this.availableExers.collection("list")}upsertExercises(t){const e=this.db.batch();return t.forEach(t=>{const n=this.availableExerList.doc(t.name);e.set(n,t)}),e.update(this.availableExers,{lastUpdated:(new Date).getTime()}),e.commit()}getExercises(){return this.availableExerList.get()}convertCollectionDocData(t){let e=[];return t&&t.size>0&&t.forEach(t=>{e.push(Object.assign(Object.assign({},t.data()),{id:t.id}))}),e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var xv=n("dNgK");let Nv=(()=>{class t{constructor(t){this._snackBar=t,this.horizontalPosition="start",this.verticalPosition="bottom"}openSnackBar(t,e=3e3){this._snackBar.open(t,"Close",{duration:e,horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition})}}return t.\u0275fac=function(e){return new(e||t)(c.Yb(xv.a))},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Av=[(()=>{class t{constructor(t,e,n){this.actions$=t,this.as=e,this.sbs=n,this.saveExercises$=Object(o.c)(()=>this.actions$.pipe(Object(o.d)(U),Object(te.a)(t=>this.as.upsertExercises(t.exers).then(e=>(this.sbs.openSnackBar("Successfully saved "+t.exers.length+" exercises"),R()),t=>{this.sbs.openSnackBar("Error occured!",6e3);const e=ne.a(t);return console.log(t),M({errMsg:e})})))),this.getAllExercises$=Object(o.c)(()=>this.actions$.pipe(Object(o.d)(V),Object(ee.a)(()=>this.as.getExercises().then(t=>{const e=this.as.convertCollectionDocData(t);return F({exers:e})},t=>{this.sbs.openSnackBar("Error occured!",6e3);const e=ne.a(t);return q({errMsg:e})}))))}}return t.\u0275fac=function(e){return new(e||t)(c.Yb(o.a),c.Yb(jv),c.Yb(Nv))},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac}),t})()],Cv=Object(s.p)({currentActionPage:null,loading:!1,allExers:[]},Object(s.r)(C,(t,{page:e})=>Object.assign(Object.assign({},t),{currentActionPage:e})),Object(s.r)(D,(t,{exerUnitType:e})=>Object.assign(Object.assign({},t),{newExerType:{name:e}})),Object(s.r)(k,(t,{timeStamp:e})=>Object.assign(Object.assign({},t),{saveNewExerBtnClickTimeStamp:e})),Object(s.r)(P,(t,{status:e})=>Object.assign(Object.assign({},t),{formValidState:e})),Object(s.r)(L,t=>Object.assign(Object.assign({},t),{saveNewExerBtnClickTimeStamp:void 0,newExerType:void 0,formValidState:!0})),Object(s.r)(U,(t,{exers:e})=>Object.assign(Object.assign({},t),{exersBeingAdded:[...e],loading:!0})),Object(s.r)(R,t=>Object.assign(Object.assign({},t),{loading:!1,errMsg:void 0,error:!1})),Object(s.r)(M,(t,{errMsg:e})=>Object.assign(Object.assign({},t),{loading:!1,errMsg:e,error:!0})),Object(s.r)(V,t=>Object.assign(Object.assign({},t),{loading:!0})),Object(s.r)(F,(t,{exers:e})=>Object.assign(Object.assign({},t),{loading:!1,errMsg:void 0,error:!1,allExers:e})),Object(s.r)(q,(t,{errMsg:e})=>Object.assign(Object.assign({},t),{loading:!1,errMsg:e,error:!0})));let Dv=(()=>{class t{}return t.\u0275mod=c.Mb({type:t}),t.\u0275inj=c.Lb({factory:function(e){return new(e||t)},providers:[],imports:[[Zt,u.a,r.c,i.r,i.k,s.j.forFeature("admin",Cv),o.b.forFeature(Av),a.a,h]]}),t})()}}]);